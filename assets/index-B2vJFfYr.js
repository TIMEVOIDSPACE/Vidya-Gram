function iP(r,e){for(var t=0;t<e.length;t++){const n=e[t];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in r)){const o=Object.getOwnPropertyDescriptor(n,s);o&&Object.defineProperty(r,s,o.get?o:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();function e0(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function dx(r){if(Object.prototype.hasOwnProperty.call(r,"__esModule"))return r;var e=r.default;if(typeof e=="function"){var t=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(n){var s=Object.getOwnPropertyDescriptor(r,n);Object.defineProperty(t,n,s.get?s:{enumerable:!0,get:function(){return r[n]}})}),t}var d_={exports:{}},rh={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pS;function sP(){if(pS)return rh;pS=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,s,o){var c=null;if(o!==void 0&&(c=""+o),s.key!==void 0&&(c=""+s.key),"key"in s){o={};for(var h in s)h!=="key"&&(o[h]=s[h])}else o=s;return s=o.ref,{$$typeof:r,type:n,key:c,ref:s!==void 0?s:null,props:o}}return rh.Fragment=e,rh.jsx=t,rh.jsxs=t,rh}var yS;function aP(){return yS||(yS=1,d_.exports=sP()),d_.exports}var w=aP(),f_={exports:{}},Pe={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _S;function oP(){if(_S)return Pe;_S=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),c=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),_=Symbol.for("react.activity"),E=Symbol.iterator;function S(V){return V===null||typeof V!="object"?null:(V=E&&V[E]||V["@@iterator"],typeof V=="function"?V:null)}var C={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k=Object.assign,N={};function G(V,W,de){this.props=V,this.context=W,this.refs=N,this.updater=de||C}G.prototype.isReactComponent={},G.prototype.setState=function(V,W){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,W,"setState")},G.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function J(){}J.prototype=G.prototype;function K(V,W,de){this.props=V,this.context=W,this.refs=N,this.updater=de||C}var se=K.prototype=new J;se.constructor=K,k(se,G.prototype),se.isPureReactComponent=!0;var ye=Array.isArray;function he(){}var R={H:null,A:null,T:null,S:null},x=Object.prototype.hasOwnProperty;function O(V,W,de){var ce=de.ref;return{$$typeof:r,type:V,key:W,ref:ce!==void 0?ce:null,props:de}}function L(V,W){return O(V.type,W,V.props)}function M(V){return typeof V=="object"&&V!==null&&V.$$typeof===r}function U(V){var W={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(de){return W[de]})}var P=/\/+/g;function et(V,W){return typeof V=="object"&&V!==null&&V.key!=null?U(""+V.key):W.toString(36)}function We(V){switch(V.status){case"fulfilled":return V.value;case"rejected":throw V.reason;default:switch(typeof V.status=="string"?V.then(he,he):(V.status="pending",V.then(function(W){V.status==="pending"&&(V.status="fulfilled",V.value=W)},function(W){V.status==="pending"&&(V.status="rejected",V.reason=W)})),V.status){case"fulfilled":return V.value;case"rejected":throw V.reason}}throw V}function ee(V,W,de,ce,Ie){var Ne=typeof V;(Ne==="undefined"||Ne==="boolean")&&(V=null);var Le=!1;if(V===null)Le=!0;else switch(Ne){case"bigint":case"string":case"number":Le=!0;break;case"object":switch(V.$$typeof){case r:case e:Le=!0;break;case y:return Le=V._init,ee(Le(V._payload),W,de,ce,Ie)}}if(Le)return Ie=Ie(V),Le=ce===""?"."+et(V,0):ce,ye(Ie)?(de="",Le!=null&&(de=Le.replace(P,"$&/")+"/"),ee(Ie,W,de,"",function(Ca){return Ca})):Ie!=null&&(M(Ie)&&(Ie=L(Ie,de+(Ie.key==null||V&&V.key===Ie.key?"":(""+Ie.key).replace(P,"$&/")+"/")+Le)),W.push(Ie)),1;Le=0;var Zt=ce===""?".":ce+":";if(ye(V))for(var _t=0;_t<V.length;_t++)ce=V[_t],Ne=Zt+et(ce,_t),Le+=ee(ce,W,de,Ne,Ie);else if(_t=S(V),typeof _t=="function")for(V=_t.call(V),_t=0;!(ce=V.next()).done;)ce=ce.value,Ne=Zt+et(ce,_t++),Le+=ee(ce,W,de,Ne,Ie);else if(Ne==="object"){if(typeof V.then=="function")return ee(We(V),W,de,ce,Ie);throw W=String(V),Error("Objects are not valid as a React child (found: "+(W==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":W)+"). If you meant to render a collection of children, use an array instead.")}return Le}function ue(V,W,de){if(V==null)return V;var ce=[],Ie=0;return ee(V,ce,"","",function(Ne){return W.call(de,Ne,Ie++)}),ce}function oe(V){if(V._status===-1){var W=V._result;W=W(),W.then(function(de){(V._status===0||V._status===-1)&&(V._status=1,V._result=de)},function(de){(V._status===0||V._status===-1)&&(V._status=2,V._result=de)}),V._status===-1&&(V._status=0,V._result=W)}if(V._status===1)return V._result.default;throw V._result}var Z=typeof reportError=="function"?reportError:function(V){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var W=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof V=="object"&&V!==null&&typeof V.message=="string"?String(V.message):String(V),error:V});if(!window.dispatchEvent(W))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",V);return}console.error(V)},ve={map:ue,forEach:function(V,W,de){ue(V,function(){W.apply(this,arguments)},de)},count:function(V){var W=0;return ue(V,function(){W++}),W},toArray:function(V){return ue(V,function(W){return W})||[]},only:function(V){if(!M(V))throw Error("React.Children.only expected to receive a single React element child.");return V}};return Pe.Activity=_,Pe.Children=ve,Pe.Component=G,Pe.Fragment=t,Pe.Profiler=s,Pe.PureComponent=K,Pe.StrictMode=n,Pe.Suspense=d,Pe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,Pe.__COMPILER_RUNTIME={__proto__:null,c:function(V){return R.H.useMemoCache(V)}},Pe.cache=function(V){return function(){return V.apply(null,arguments)}},Pe.cacheSignal=function(){return null},Pe.cloneElement=function(V,W,de){if(V==null)throw Error("The argument must be a React element, but you passed "+V+".");var ce=k({},V.props),Ie=V.key;if(W!=null)for(Ne in W.key!==void 0&&(Ie=""+W.key),W)!x.call(W,Ne)||Ne==="key"||Ne==="__self"||Ne==="__source"||Ne==="ref"&&W.ref===void 0||(ce[Ne]=W[Ne]);var Ne=arguments.length-2;if(Ne===1)ce.children=de;else if(1<Ne){for(var Le=Array(Ne),Zt=0;Zt<Ne;Zt++)Le[Zt]=arguments[Zt+2];ce.children=Le}return O(V.type,Ie,ce)},Pe.createContext=function(V){return V={$$typeof:c,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null},V.Provider=V,V.Consumer={$$typeof:o,_context:V},V},Pe.createElement=function(V,W,de){var ce,Ie={},Ne=null;if(W!=null)for(ce in W.key!==void 0&&(Ne=""+W.key),W)x.call(W,ce)&&ce!=="key"&&ce!=="__self"&&ce!=="__source"&&(Ie[ce]=W[ce]);var Le=arguments.length-2;if(Le===1)Ie.children=de;else if(1<Le){for(var Zt=Array(Le),_t=0;_t<Le;_t++)Zt[_t]=arguments[_t+2];Ie.children=Zt}if(V&&V.defaultProps)for(ce in Le=V.defaultProps,Le)Ie[ce]===void 0&&(Ie[ce]=Le[ce]);return O(V,Ne,Ie)},Pe.createRef=function(){return{current:null}},Pe.forwardRef=function(V){return{$$typeof:h,render:V}},Pe.isValidElement=M,Pe.lazy=function(V){return{$$typeof:y,_payload:{_status:-1,_result:V},_init:oe}},Pe.memo=function(V,W){return{$$typeof:m,type:V,compare:W===void 0?null:W}},Pe.startTransition=function(V){var W=R.T,de={};R.T=de;try{var ce=V(),Ie=R.S;Ie!==null&&Ie(de,ce),typeof ce=="object"&&ce!==null&&typeof ce.then=="function"&&ce.then(he,Z)}catch(Ne){Z(Ne)}finally{W!==null&&de.types!==null&&(W.types=de.types),R.T=W}},Pe.unstable_useCacheRefresh=function(){return R.H.useCacheRefresh()},Pe.use=function(V){return R.H.use(V)},Pe.useActionState=function(V,W,de){return R.H.useActionState(V,W,de)},Pe.useCallback=function(V,W){return R.H.useCallback(V,W)},Pe.useContext=function(V){return R.H.useContext(V)},Pe.useDebugValue=function(){},Pe.useDeferredValue=function(V,W){return R.H.useDeferredValue(V,W)},Pe.useEffect=function(V,W){return R.H.useEffect(V,W)},Pe.useEffectEvent=function(V){return R.H.useEffectEvent(V)},Pe.useId=function(){return R.H.useId()},Pe.useImperativeHandle=function(V,W,de){return R.H.useImperativeHandle(V,W,de)},Pe.useInsertionEffect=function(V,W){return R.H.useInsertionEffect(V,W)},Pe.useLayoutEffect=function(V,W){return R.H.useLayoutEffect(V,W)},Pe.useMemo=function(V,W){return R.H.useMemo(V,W)},Pe.useOptimistic=function(V,W){return R.H.useOptimistic(V,W)},Pe.useReducer=function(V,W,de){return R.H.useReducer(V,W,de)},Pe.useRef=function(V){return R.H.useRef(V)},Pe.useState=function(V){return R.H.useState(V)},Pe.useSyncExternalStore=function(V,W,de){return R.H.useSyncExternalStore(V,W,de)},Pe.useTransition=function(){return R.H.useTransition()},Pe.version="19.2.0",Pe}var vS;function t0(){return vS||(vS=1,f_.exports=oP()),f_.exports}var fe=t0();const fx=e0(fe);var m_={exports:{}},ih={},g_={exports:{}},p_={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wS;function lP(){return wS||(wS=1,(function(r){function e(ee,ue){var oe=ee.length;ee.push(ue);e:for(;0<oe;){var Z=oe-1>>>1,ve=ee[Z];if(0<s(ve,ue))ee[Z]=ue,ee[oe]=ve,oe=Z;else break e}}function t(ee){return ee.length===0?null:ee[0]}function n(ee){if(ee.length===0)return null;var ue=ee[0],oe=ee.pop();if(oe!==ue){ee[0]=oe;e:for(var Z=0,ve=ee.length,V=ve>>>1;Z<V;){var W=2*(Z+1)-1,de=ee[W],ce=W+1,Ie=ee[ce];if(0>s(de,oe))ce<ve&&0>s(Ie,de)?(ee[Z]=Ie,ee[ce]=oe,Z=ce):(ee[Z]=de,ee[W]=oe,Z=W);else if(ce<ve&&0>s(Ie,oe))ee[Z]=Ie,ee[ce]=oe,Z=ce;else break e}}return ue}function s(ee,ue){var oe=ee.sortIndex-ue.sortIndex;return oe!==0?oe:ee.id-ue.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;r.unstable_now=function(){return o.now()}}else{var c=Date,h=c.now();r.unstable_now=function(){return c.now()-h}}var d=[],m=[],y=1,_=null,E=3,S=!1,C=!1,k=!1,N=!1,G=typeof setTimeout=="function"?setTimeout:null,J=typeof clearTimeout=="function"?clearTimeout:null,K=typeof setImmediate<"u"?setImmediate:null;function se(ee){for(var ue=t(m);ue!==null;){if(ue.callback===null)n(m);else if(ue.startTime<=ee)n(m),ue.sortIndex=ue.expirationTime,e(d,ue);else break;ue=t(m)}}function ye(ee){if(k=!1,se(ee),!C)if(t(d)!==null)C=!0,he||(he=!0,U());else{var ue=t(m);ue!==null&&We(ye,ue.startTime-ee)}}var he=!1,R=-1,x=5,O=-1;function L(){return N?!0:!(r.unstable_now()-O<x)}function M(){if(N=!1,he){var ee=r.unstable_now();O=ee;var ue=!0;try{e:{C=!1,k&&(k=!1,J(R),R=-1),S=!0;var oe=E;try{t:{for(se(ee),_=t(d);_!==null&&!(_.expirationTime>ee&&L());){var Z=_.callback;if(typeof Z=="function"){_.callback=null,E=_.priorityLevel;var ve=Z(_.expirationTime<=ee);if(ee=r.unstable_now(),typeof ve=="function"){_.callback=ve,se(ee),ue=!0;break t}_===t(d)&&n(d),se(ee)}else n(d);_=t(d)}if(_!==null)ue=!0;else{var V=t(m);V!==null&&We(ye,V.startTime-ee),ue=!1}}break e}finally{_=null,E=oe,S=!1}ue=void 0}}finally{ue?U():he=!1}}}var U;if(typeof K=="function")U=function(){K(M)};else if(typeof MessageChannel<"u"){var P=new MessageChannel,et=P.port2;P.port1.onmessage=M,U=function(){et.postMessage(null)}}else U=function(){G(M,0)};function We(ee,ue){R=G(function(){ee(r.unstable_now())},ue)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(ee){ee.callback=null},r.unstable_forceFrameRate=function(ee){0>ee||125<ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):x=0<ee?Math.floor(1e3/ee):5},r.unstable_getCurrentPriorityLevel=function(){return E},r.unstable_next=function(ee){switch(E){case 1:case 2:case 3:var ue=3;break;default:ue=E}var oe=E;E=ue;try{return ee()}finally{E=oe}},r.unstable_requestPaint=function(){N=!0},r.unstable_runWithPriority=function(ee,ue){switch(ee){case 1:case 2:case 3:case 4:case 5:break;default:ee=3}var oe=E;E=ee;try{return ue()}finally{E=oe}},r.unstable_scheduleCallback=function(ee,ue,oe){var Z=r.unstable_now();switch(typeof oe=="object"&&oe!==null?(oe=oe.delay,oe=typeof oe=="number"&&0<oe?Z+oe:Z):oe=Z,ee){case 1:var ve=-1;break;case 2:ve=250;break;case 5:ve=1073741823;break;case 4:ve=1e4;break;default:ve=5e3}return ve=oe+ve,ee={id:y++,callback:ue,priorityLevel:ee,startTime:oe,expirationTime:ve,sortIndex:-1},oe>Z?(ee.sortIndex=oe,e(m,ee),t(d)===null&&ee===t(m)&&(k?(J(R),R=-1):k=!0,We(ye,oe-Z))):(ee.sortIndex=ve,e(d,ee),C||S||(C=!0,he||(he=!0,U()))),ee},r.unstable_shouldYield=L,r.unstable_wrapCallback=function(ee){var ue=E;return function(){var oe=E;E=ue;try{return ee.apply(this,arguments)}finally{E=oe}}}})(p_)),p_}var bS;function cP(){return bS||(bS=1,g_.exports=lP()),g_.exports}var y_={exports:{}},En={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ES;function uP(){if(ES)return En;ES=1;var r=t0();function e(d){var m="https://react.dev/errors/"+d;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var y=2;y<arguments.length;y++)m+="&args[]="+encodeURIComponent(arguments[y])}return"Minified React error #"+d+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function o(d,m,y){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:_==null?null:""+_,children:d,containerInfo:m,implementation:y}}var c=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(d,m){if(d==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return En.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,En.createPortal=function(d,m){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(e(299));return o(d,m,null,y)},En.flushSync=function(d){var m=c.T,y=n.p;try{if(c.T=null,n.p=2,d)return d()}finally{c.T=m,n.p=y,n.d.f()}},En.preconnect=function(d,m){typeof d=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,n.d.C(d,m))},En.prefetchDNS=function(d){typeof d=="string"&&n.d.D(d)},En.preinit=function(d,m){if(typeof d=="string"&&m&&typeof m.as=="string"){var y=m.as,_=h(y,m.crossOrigin),E=typeof m.integrity=="string"?m.integrity:void 0,S=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;y==="style"?n.d.S(d,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:_,integrity:E,fetchPriority:S}):y==="script"&&n.d.X(d,{crossOrigin:_,integrity:E,fetchPriority:S,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},En.preinitModule=function(d,m){if(typeof d=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var y=h(m.as,m.crossOrigin);n.d.M(d,{crossOrigin:y,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&n.d.M(d)},En.preload=function(d,m){if(typeof d=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var y=m.as,_=h(y,m.crossOrigin);n.d.L(d,y,{crossOrigin:_,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},En.preloadModule=function(d,m){if(typeof d=="string")if(m){var y=h(m.as,m.crossOrigin);n.d.m(d,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:y,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else n.d.m(d)},En.requestFormReset=function(d){n.d.r(d)},En.unstable_batchedUpdates=function(d,m){return d(m)},En.useFormState=function(d,m,y){return c.H.useFormState(d,m,y)},En.useFormStatus=function(){return c.H.useHostTransitionStatus()},En.version="19.2.0",En}var TS;function hP(){if(TS)return y_.exports;TS=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),y_.exports=uP(),y_.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var SS;function dP(){if(SS)return ih;SS=1;var r=cP(),e=t0(),t=hP();function n(i){var a="https://react.dev/errors/"+i;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)a+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+i+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function o(i){var a=i,l=i;if(i.alternate)for(;a.return;)a=a.return;else{i=a;do a=i,(a.flags&4098)!==0&&(l=a.return),i=a.return;while(i)}return a.tag===3?l:null}function c(i){if(i.tag===13){var a=i.memoizedState;if(a===null&&(i=i.alternate,i!==null&&(a=i.memoizedState)),a!==null)return a.dehydrated}return null}function h(i){if(i.tag===31){var a=i.memoizedState;if(a===null&&(i=i.alternate,i!==null&&(a=i.memoizedState)),a!==null)return a.dehydrated}return null}function d(i){if(o(i)!==i)throw Error(n(188))}function m(i){var a=i.alternate;if(!a){if(a=o(i),a===null)throw Error(n(188));return a!==i?null:i}for(var l=i,u=a;;){var g=l.return;if(g===null)break;var p=g.alternate;if(p===null){if(u=g.return,u!==null){l=u;continue}break}if(g.child===p.child){for(p=g.child;p;){if(p===l)return d(g),i;if(p===u)return d(g),a;p=p.sibling}throw Error(n(188))}if(l.return!==u.return)l=g,u=p;else{for(var b=!1,A=g.child;A;){if(A===l){b=!0,l=g,u=p;break}if(A===u){b=!0,u=g,l=p;break}A=A.sibling}if(!b){for(A=p.child;A;){if(A===l){b=!0,l=p,u=g;break}if(A===u){b=!0,u=p,l=g;break}A=A.sibling}if(!b)throw Error(n(189))}}if(l.alternate!==u)throw Error(n(190))}if(l.tag!==3)throw Error(n(188));return l.stateNode.current===l?i:a}function y(i){var a=i.tag;if(a===5||a===26||a===27||a===6)return i;for(i=i.child;i!==null;){if(a=y(i),a!==null)return a;i=i.sibling}return null}var _=Object.assign,E=Symbol.for("react.element"),S=Symbol.for("react.transitional.element"),C=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),G=Symbol.for("react.profiler"),J=Symbol.for("react.consumer"),K=Symbol.for("react.context"),se=Symbol.for("react.forward_ref"),ye=Symbol.for("react.suspense"),he=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),O=Symbol.for("react.activity"),L=Symbol.for("react.memo_cache_sentinel"),M=Symbol.iterator;function U(i){return i===null||typeof i!="object"?null:(i=M&&i[M]||i["@@iterator"],typeof i=="function"?i:null)}var P=Symbol.for("react.client.reference");function et(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===P?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case k:return"Fragment";case G:return"Profiler";case N:return"StrictMode";case ye:return"Suspense";case he:return"SuspenseList";case O:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case C:return"Portal";case K:return i.displayName||"Context";case J:return(i._context.displayName||"Context")+".Consumer";case se:var a=i.render;return i=i.displayName,i||(i=a.displayName||a.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case R:return a=i.displayName||null,a!==null?a:et(i.type)||"Memo";case x:a=i._payload,i=i._init;try{return et(i(a))}catch{}}return null}var We=Array.isArray,ee=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ue=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,oe={pending:!1,data:null,method:null,action:null},Z=[],ve=-1;function V(i){return{current:i}}function W(i){0>ve||(i.current=Z[ve],Z[ve]=null,ve--)}function de(i,a){ve++,Z[ve]=i.current,i.current=a}var ce=V(null),Ie=V(null),Ne=V(null),Le=V(null);function Zt(i,a){switch(de(Ne,a),de(Ie,i),de(ce,null),a.nodeType){case 9:case 11:i=(i=a.documentElement)&&(i=i.namespaceURI)?UT(i):0;break;default:if(i=a.tagName,a=a.namespaceURI)a=UT(a),i=BT(a,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}W(ce),de(ce,i)}function _t(){W(ce),W(Ie),W(Ne)}function Ca(i){i.memoizedState!==null&&de(Le,i);var a=ce.current,l=BT(a,i.type);a!==l&&(de(Ie,i),de(ce,l))}function Wo(i){Ie.current===i&&(W(ce),W(Ie)),Le.current===i&&(W(Le),Zu._currentValue=oe)}var Qo,Yo;function Jr(i){if(Qo===void 0)try{throw Error()}catch(l){var a=l.stack.trim().match(/\n( *(at )?)/);Qo=a&&a[1]||"",Yo=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Qo+i+Yo}var Zc=!1;function ka(i,a){if(!i||Zc)return"";Zc=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(a){var re=function(){throw Error()};if(Object.defineProperty(re.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(re,[])}catch(X){var H=X}Reflect.construct(i,[],re)}else{try{re.call()}catch(X){H=X}i.call(re.prototype)}}else{try{throw Error()}catch(X){H=X}(re=i())&&typeof re.catch=="function"&&re.catch(function(){})}}catch(X){if(X&&H&&typeof X.stack=="string")return[X.stack,H.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var p=u.DetermineComponentFrameRoot(),b=p[0],A=p[1];if(b&&A){var D=b.split(`
`),$=A.split(`
`);for(g=u=0;u<D.length&&!D[u].includes("DetermineComponentFrameRoot");)u++;for(;g<$.length&&!$[g].includes("DetermineComponentFrameRoot");)g++;if(u===D.length||g===$.length)for(u=D.length-1,g=$.length-1;1<=u&&0<=g&&D[u]!==$[g];)g--;for(;1<=u&&0<=g;u--,g--)if(D[u]!==$[g]){if(u!==1||g!==1)do if(u--,g--,0>g||D[u]!==$[g]){var te=`
`+D[u].replace(" at new "," at ");return i.displayName&&te.includes("<anonymous>")&&(te=te.replace("<anonymous>",i.displayName)),te}while(1<=u&&0<=g);break}}}finally{Zc=!1,Error.prepareStackTrace=l}return(l=i?i.displayName||i.name:"")?Jr(l):""}function eu(i,a){switch(i.tag){case 26:case 27:case 5:return Jr(i.type);case 16:return Jr("Lazy");case 13:return i.child!==a&&a!==null?Jr("Suspense Fallback"):Jr("Suspense");case 19:return Jr("SuspenseList");case 0:case 15:return ka(i.type,!1);case 11:return ka(i.type.render,!1);case 1:return ka(i.type,!0);case 31:return Jr("Activity");default:return""}}function tu(i){try{var a="",l=null;do a+=eu(i,l),l=i,i=i.return;while(i);return a}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}var Bt=Object.prototype.hasOwnProperty,en=r.unstable_scheduleCallback,ms=r.unstable_cancelCallback,mp=r.unstable_shouldYield,jd=r.unstable_requestPaint,Cn=r.unstable_now,Na=r.unstable_getCurrentPriorityLevel,nu=r.unstable_ImmediatePriority,ru=r.unstable_UserBlockingPriority,gs=r.unstable_NormalPriority,gp=r.unstable_LowPriority,Ld=r.unstable_IdlePriority,Ud=r.log,Bd=r.unstable_setDisableYieldValue,Cr=null,dn=null;function dr(i){if(typeof Ud=="function"&&Bd(i),dn&&typeof dn.setStrictMode=="function")try{dn.setStrictMode(Cr,i)}catch{}}var Pt=Math.clz32?Math.clz32:zd,Fd=Math.log,Jo=Math.LN2;function zd(i){return i>>>=0,i===0?32:31-(Fd(i)/Jo|0)|0}var Xr=256,Oa=262144,Ft=4194304;function Zr(i){var a=i&42;if(a!==0)return a;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function ei(i,a,l){var u=i.pendingLanes;if(u===0)return 0;var g=0,p=i.suspendedLanes,b=i.pingedLanes;i=i.warmLanes;var A=u&134217727;return A!==0?(u=A&~p,u!==0?g=Zr(u):(b&=A,b!==0?g=Zr(b):l||(l=A&~i,l!==0&&(g=Zr(l))))):(A=u&~p,A!==0?g=Zr(A):b!==0?g=Zr(b):l||(l=u&~i,l!==0&&(g=Zr(l)))),g===0?0:a!==0&&a!==g&&(a&p)===0&&(p=g&-g,l=a&-a,p>=l||p===32&&(l&4194048)!==0)?a:g}function kr(i,a){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&a)===0}function pp(i,a){switch(i){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qd(){var i=Ft;return Ft<<=1,(Ft&62914560)===0&&(Ft=4194304),i}function ti(i){for(var a=[],l=0;31>l;l++)a.push(i);return a}function Pa(i,a){i.pendingLanes|=a,a!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function yp(i,a,l,u,g,p){var b=i.pendingLanes;i.pendingLanes=l,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=l,i.entangledLanes&=l,i.errorRecoveryDisabledLanes&=l,i.shellSuspendCounter=0;var A=i.entanglements,D=i.expirationTimes,$=i.hiddenUpdates;for(l=b&~l;0<l;){var te=31-Pt(l),re=1<<te;A[te]=0,D[te]=-1;var H=$[te];if(H!==null)for($[te]=null,te=0;te<H.length;te++){var X=H[te];X!==null&&(X.lane&=-536870913)}l&=~re}u!==0&&Da(i,u,0),p!==0&&g===0&&i.tag!==0&&(i.suspendedLanes|=p&~(b&~a))}function Da(i,a,l){i.pendingLanes|=a,i.suspendedLanes&=~a;var u=31-Pt(a);i.entangledLanes|=a,i.entanglements[u]=i.entanglements[u]|1073741824|l&261930}function iu(i,a){var l=i.entangledLanes|=a;for(i=i.entanglements;l;){var u=31-Pt(l),g=1<<u;g&a|i[u]&a&&(i[u]|=a),l&=~g}}function su(i,a){var l=a&-a;return l=(l&42)!==0?1:Va(l),(l&(i.suspendedLanes|a))!==0?0:l}function Va(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function Vi(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function $d(){var i=ue.p;return i!==0?i:(i=window.event,i===void 0?32:cS(i.type))}function Nr(i,a){var l=ue.p;try{return ue.p=i,a()}finally{ue.p=l}}var Or=Math.random().toString(36).slice(2),zt="__reactFiber$"+Or,an="__reactProps$"+Or,ni="__reactContainer$"+Or,Xo="__reactEvents$"+Or,_p="__reactListeners$"+Or,Hd="__reactHandles$"+Or,Gd="__reactResources$"+Or,ri="__reactMarker$"+Or;function Zo(i){delete i[zt],delete i[an],delete i[Xo],delete i[_p],delete i[Hd]}function ii(i){var a=i[zt];if(a)return a;for(var l=i.parentNode;l;){if(a=l[ni]||l[zt]){if(l=a.alternate,a.child!==null||l!==null&&l.child!==null)for(i=KT(i);i!==null;){if(l=i[zt])return l;i=KT(i)}return a}i=l,l=i.parentNode}return null}function fr(i){if(i=i[zt]||i[ni]){var a=i.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return i}return null}function Yn(i){var a=i.tag;if(a===5||a===26||a===27||a===6)return i.stateNode;throw Error(n(33))}function si(i){var a=i[Gd];return a||(a=i[Gd]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function qt(i){i[ri]=!0}var au=new Set,ou={};function ai(i,a){oi(i,a),oi(i+"Capture",a)}function oi(i,a){for(ou[i]=a,i=0;i<a.length;i++)au.add(a[i])}var lu=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),cu={},uu={};function Kd(i){return Bt.call(uu,i)?!0:Bt.call(cu,i)?!1:lu.test(i)?uu[i]=!0:(cu[i]=!0,!1)}function el(i,a,l){if(Kd(a))if(l===null)i.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":i.removeAttribute(a);return;case"boolean":var u=a.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){i.removeAttribute(a);return}}i.setAttribute(a,""+l)}}function Jn(i,a,l){if(l===null)i.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(a);return}i.setAttribute(a,""+l)}}function $t(i,a,l,u){if(u===null)i.removeAttribute(l);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(l);return}i.setAttributeNS(a,l,""+u)}}function on(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function ps(i){var a=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function hu(i,a,l){var u=Object.getOwnPropertyDescriptor(i.constructor.prototype,a);if(!i.hasOwnProperty(a)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var g=u.get,p=u.set;return Object.defineProperty(i,a,{configurable:!0,get:function(){return g.call(this)},set:function(b){l=""+b,p.call(this,b)}}),Object.defineProperty(i,a,{enumerable:u.enumerable}),{getValue:function(){return l},setValue:function(b){l=""+b},stopTracking:function(){i._valueTracker=null,delete i[a]}}}}function nt(i){if(!i._valueTracker){var a=ps(i)?"checked":"value";i._valueTracker=hu(i,a,""+i[a])}}function Ma(i){if(!i)return!1;var a=i._valueTracker;if(!a)return!0;var l=a.getValue(),u="";return i&&(u=ps(i)?i.checked?"true":"false":i.value),i=u,i!==l?(a.setValue(i),!0):!1}function li(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var ja=/[\n"\\]/g;function Ln(i){return i.replace(ja,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function tl(i,a,l,u,g,p,b,A){i.name="",b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"?i.type=b:i.removeAttribute("type"),a!=null?b==="number"?(a===0&&i.value===""||i.value!=a)&&(i.value=""+on(a)):i.value!==""+on(a)&&(i.value=""+on(a)):b!=="submit"&&b!=="reset"||i.removeAttribute("value"),a!=null?du(i,b,on(a)):l!=null?du(i,b,on(l)):u!=null&&i.removeAttribute("value"),g==null&&p!=null&&(i.defaultChecked=!!p),g!=null&&(i.checked=g&&typeof g!="function"&&typeof g!="symbol"),A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?i.name=""+on(A):i.removeAttribute("name")}function Wd(i,a,l,u,g,p,b,A){if(p!=null&&typeof p!="function"&&typeof p!="symbol"&&typeof p!="boolean"&&(i.type=p),a!=null||l!=null){if(!(p!=="submit"&&p!=="reset"||a!=null)){nt(i);return}l=l!=null?""+on(l):"",a=a!=null?""+on(a):l,A||a===i.value||(i.value=a),i.defaultValue=a}u=u??g,u=typeof u!="function"&&typeof u!="symbol"&&!!u,i.checked=A?i.checked:!!u,i.defaultChecked=!!u,b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(i.name=b),nt(i)}function du(i,a,l){a==="number"&&li(i.ownerDocument)===i||i.defaultValue===""+l||(i.defaultValue=""+l)}function ys(i,a,l,u){if(i=i.options,a){a={};for(var g=0;g<l.length;g++)a["$"+l[g]]=!0;for(l=0;l<i.length;l++)g=a.hasOwnProperty("$"+i[l].value),i[l].selected!==g&&(i[l].selected=g),g&&u&&(i[l].defaultSelected=!0)}else{for(l=""+on(l),a=null,g=0;g<i.length;g++){if(i[g].value===l){i[g].selected=!0,u&&(i[g].defaultSelected=!0);return}a!==null||i[g].disabled||(a=i[g])}a!==null&&(a.selected=!0)}}function Qd(i,a,l){if(a!=null&&(a=""+on(a),a!==i.value&&(i.value=a),l==null)){i.defaultValue!==a&&(i.defaultValue=a);return}i.defaultValue=l!=null?""+on(l):""}function _s(i,a,l,u){if(a==null){if(u!=null){if(l!=null)throw Error(n(92));if(We(u)){if(1<u.length)throw Error(n(93));u=u[0]}l=u}l==null&&(l=""),a=l}l=on(a),i.defaultValue=l,u=i.textContent,u===l&&u!==""&&u!==null&&(i.value=u),nt(i)}function Un(i,a){if(a){var l=i.firstChild;if(l&&l===i.lastChild&&l.nodeType===3){l.nodeValue=a;return}}i.textContent=a}var Yd=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function fu(i,a,l){var u=a.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?u?i.setProperty(a,""):a==="float"?i.cssFloat="":i[a]="":u?i.setProperty(a,l):typeof l!="number"||l===0||Yd.has(a)?a==="float"?i.cssFloat=l:i[a]=(""+l).trim():i[a]=l+"px"}function mu(i,a,l){if(a!=null&&typeof a!="object")throw Error(n(62));if(i=i.style,l!=null){for(var u in l)!l.hasOwnProperty(u)||a!=null&&a.hasOwnProperty(u)||(u.indexOf("--")===0?i.setProperty(u,""):u==="float"?i.cssFloat="":i[u]="");for(var g in a)u=a[g],a.hasOwnProperty(g)&&l[g]!==u&&fu(i,g,u)}else for(var p in a)a.hasOwnProperty(p)&&fu(i,p,a[p])}function nl(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Jd=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),vs=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function rl(i){return vs.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function Pr(){}var gu=null;function mr(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var ws=null,ci=null;function La(i){var a=fr(i);if(a&&(i=a.stateNode)){var l=i[an]||null;e:switch(i=a.stateNode,a.type){case"input":if(tl(i,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),a=l.name,l.type==="radio"&&a!=null){for(l=i;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+Ln(""+a)+'"][type="radio"]'),a=0;a<l.length;a++){var u=l[a];if(u!==i&&u.form===i.form){var g=u[an]||null;if(!g)throw Error(n(90));tl(u,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(a=0;a<l.length;a++)u=l[a],u.form===i.form&&Ma(u)}break e;case"textarea":Qd(i,l.value,l.defaultValue);break e;case"select":a=l.value,a!=null&&ys(i,!!l.multiple,a,!1)}}}var il=!1;function bs(i,a,l){if(il)return i(a,l);il=!0;try{var u=i(a);return u}finally{if(il=!1,(ws!==null||ci!==null)&&(Hf(),ws&&(a=ws,i=ci,ci=ws=null,La(a),i)))for(a=0;a<i.length;a++)La(i[a])}}function Dr(i,a){var l=i.stateNode;if(l===null)return null;var u=l[an]||null;if(u===null)return null;l=u[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(i=i.type,u=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!u;break e;default:i=!1}if(i)return null;if(l&&typeof l!="function")throw Error(n(231,a,typeof l));return l}var gr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ua=!1;if(gr)try{var ot={};Object.defineProperty(ot,"passive",{get:function(){Ua=!0}}),window.addEventListener("test",ot,ot),window.removeEventListener("test",ot,ot)}catch{Ua=!1}var ui=null,pu=null,Ba=null;function yu(){if(Ba)return Ba;var i,a=pu,l=a.length,u,g="value"in ui?ui.value:ui.textContent,p=g.length;for(i=0;i<l&&a[i]===g[i];i++);var b=l-i;for(u=1;u<=b&&a[l-u]===g[p-u];u++);return Ba=g.slice(i,1<u?1-u:void 0)}function Fa(i){var a=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&a===13&&(i=13)):i=a,i===10&&(i=13),32<=i||i===13?i:0}function Mi(){return!0}function Vr(){return!1}function fn(i){function a(l,u,g,p,b){this._reactName=l,this._targetInst=g,this.type=u,this.nativeEvent=p,this.target=b,this.currentTarget=null;for(var A in i)i.hasOwnProperty(A)&&(l=i[A],this[A]=l?l(p):p[A]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?Mi:Vr,this.isPropagationStopped=Vr,this}return _(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Mi)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Mi)},persist:function(){},isPersistent:Mi}),a}var ji={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hi=fn(ji),Es=_({},ji,{view:0,detail:0}),_u=fn(Es),Ts,sl,di,al=_({},Es,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ss,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==di&&(di&&i.type==="mousemove"?(Ts=i.screenX-di.screenX,sl=i.screenY-di.screenY):sl=Ts=0,di=i),Ts)},movementY:function(i){return"movementY"in i?i.movementY:sl}}),vu=fn(al),za=_({},al,{dataTransfer:0}),Xd=fn(za),Zd=_({},Es,{relatedTarget:0}),qa=fn(Zd),wu=_({},ji,{animationName:0,elapsedTime:0,pseudoElement:0}),ef=fn(wu),ol=_({},ji,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),tf=fn(ol),nf=_({},ji,{data:0}),fi=fn(nf),rf={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},sf={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},af={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function of(i){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(i):(i=af[i])?!!a[i]:!1}function Ss(){return of}var kn=_({},Es,{key:function(i){if(i.key){var a=rf[i.key]||i.key;if(a!=="Unidentified")return a}return i.type==="keypress"?(i=Fa(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?sf[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ss,charCode:function(i){return i.type==="keypress"?Fa(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Fa(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),lf=fn(kn),cf=_({},al,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Li=fn(cf),f=_({},Es,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ss}),v=fn(f),T=_({},ji,{propertyName:0,elapsedTime:0,pseudoElement:0}),I=fn(T),z=_({},al,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Y=fn(z),me=_({},ji,{newState:0,oldState:0}),De=fn(me),Dt=[9,13,27,32],Xe=gr&&"CompositionEvent"in window,vt=null;gr&&"documentMode"in document&&(vt=document.documentMode);var pr=gr&&"TextEvent"in window&&!vt,mi=gr&&(!Xe||vt&&8<vt&&11>=vt),Mr=" ",jr=!1;function $a(i,a){switch(i){case"keyup":return Dt.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ll(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var cl=!1;function RN(i,a){switch(i){case"compositionend":return ll(a);case"keypress":return a.which!==32?null:(jr=!0,Mr);case"textInput":return i=a.data,i===Mr&&jr?null:i;default:return null}}function CN(i,a){if(cl)return i==="compositionend"||!Xe&&$a(i,a)?(i=yu(),Ba=pu=ui=null,cl=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return mi&&a.locale!=="ko"?null:a.data;default:return null}}var kN={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Yw(i){var a=i&&i.nodeName&&i.nodeName.toLowerCase();return a==="input"?!!kN[i.type]:a==="textarea"}function Jw(i,a,l,u){ws?ci?ci.push(u):ci=[u]:ws=u,a=Xf(a,"onChange"),0<a.length&&(l=new hi("onChange","change",null,l,u),i.push({event:l,listeners:a}))}var bu=null,Eu=null;function NN(i){PT(i,0)}function uf(i){var a=Yn(i);if(Ma(a))return i}function Xw(i,a){if(i==="change")return a}var Zw=!1;if(gr){var vp;if(gr){var wp="oninput"in document;if(!wp){var eb=document.createElement("div");eb.setAttribute("oninput","return;"),wp=typeof eb.oninput=="function"}vp=wp}else vp=!1;Zw=vp&&(!document.documentMode||9<document.documentMode)}function tb(){bu&&(bu.detachEvent("onpropertychange",nb),Eu=bu=null)}function nb(i){if(i.propertyName==="value"&&uf(Eu)){var a=[];Jw(a,Eu,i,mr(i)),bs(NN,a)}}function ON(i,a,l){i==="focusin"?(tb(),bu=a,Eu=l,bu.attachEvent("onpropertychange",nb)):i==="focusout"&&tb()}function PN(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return uf(Eu)}function DN(i,a){if(i==="click")return uf(a)}function VN(i,a){if(i==="input"||i==="change")return uf(a)}function MN(i,a){return i===a&&(i!==0||1/i===1/a)||i!==i&&a!==a}var Xn=typeof Object.is=="function"?Object.is:MN;function Tu(i,a){if(Xn(i,a))return!0;if(typeof i!="object"||i===null||typeof a!="object"||a===null)return!1;var l=Object.keys(i),u=Object.keys(a);if(l.length!==u.length)return!1;for(u=0;u<l.length;u++){var g=l[u];if(!Bt.call(a,g)||!Xn(i[g],a[g]))return!1}return!0}function rb(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function ib(i,a){var l=rb(i);i=0;for(var u;l;){if(l.nodeType===3){if(u=i+l.textContent.length,i<=a&&u>=a)return{node:l,offset:a-i};i=u}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=rb(l)}}function sb(i,a){return i&&a?i===a?!0:i&&i.nodeType===3?!1:a&&a.nodeType===3?sb(i,a.parentNode):"contains"in i?i.contains(a):i.compareDocumentPosition?!!(i.compareDocumentPosition(a)&16):!1:!1}function ab(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var a=li(i.document);a instanceof i.HTMLIFrameElement;){try{var l=typeof a.contentWindow.location.href=="string"}catch{l=!1}if(l)i=a.contentWindow;else break;a=li(i.document)}return a}function bp(i){var a=i&&i.nodeName&&i.nodeName.toLowerCase();return a&&(a==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||a==="textarea"||i.contentEditable==="true")}var jN=gr&&"documentMode"in document&&11>=document.documentMode,ul=null,Ep=null,Su=null,Tp=!1;function ob(i,a,l){var u=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Tp||ul==null||ul!==li(u)||(u=ul,"selectionStart"in u&&bp(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),Su&&Tu(Su,u)||(Su=u,u=Xf(Ep,"onSelect"),0<u.length&&(a=new hi("onSelect","select",null,a,l),i.push({event:a,listeners:u}),a.target=ul)))}function Ha(i,a){var l={};return l[i.toLowerCase()]=a.toLowerCase(),l["Webkit"+i]="webkit"+a,l["Moz"+i]="moz"+a,l}var hl={animationend:Ha("Animation","AnimationEnd"),animationiteration:Ha("Animation","AnimationIteration"),animationstart:Ha("Animation","AnimationStart"),transitionrun:Ha("Transition","TransitionRun"),transitionstart:Ha("Transition","TransitionStart"),transitioncancel:Ha("Transition","TransitionCancel"),transitionend:Ha("Transition","TransitionEnd")},Sp={},lb={};gr&&(lb=document.createElement("div").style,"AnimationEvent"in window||(delete hl.animationend.animation,delete hl.animationiteration.animation,delete hl.animationstart.animation),"TransitionEvent"in window||delete hl.transitionend.transition);function Ga(i){if(Sp[i])return Sp[i];if(!hl[i])return i;var a=hl[i],l;for(l in a)if(a.hasOwnProperty(l)&&l in lb)return Sp[i]=a[l];return i}var cb=Ga("animationend"),ub=Ga("animationiteration"),hb=Ga("animationstart"),LN=Ga("transitionrun"),UN=Ga("transitionstart"),BN=Ga("transitioncancel"),db=Ga("transitionend"),fb=new Map,Ap="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Ap.push("scrollEnd");function Lr(i,a){fb.set(i,a),ai(a,[i])}var hf=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},yr=[],dl=0,Ip=0;function df(){for(var i=dl,a=Ip=dl=0;a<i;){var l=yr[a];yr[a++]=null;var u=yr[a];yr[a++]=null;var g=yr[a];yr[a++]=null;var p=yr[a];if(yr[a++]=null,u!==null&&g!==null){var b=u.pending;b===null?g.next=g:(g.next=b.next,b.next=g),u.pending=g}p!==0&&mb(l,g,p)}}function ff(i,a,l,u){yr[dl++]=i,yr[dl++]=a,yr[dl++]=l,yr[dl++]=u,Ip|=u,i.lanes|=u,i=i.alternate,i!==null&&(i.lanes|=u)}function xp(i,a,l,u){return ff(i,a,l,u),mf(i)}function Ka(i,a){return ff(i,null,null,a),mf(i)}function mb(i,a,l){i.lanes|=l;var u=i.alternate;u!==null&&(u.lanes|=l);for(var g=!1,p=i.return;p!==null;)p.childLanes|=l,u=p.alternate,u!==null&&(u.childLanes|=l),p.tag===22&&(i=p.stateNode,i===null||i._visibility&1||(g=!0)),i=p,p=p.return;return i.tag===3?(p=i.stateNode,g&&a!==null&&(g=31-Pt(l),i=p.hiddenUpdates,u=i[g],u===null?i[g]=[a]:u.push(a),a.lane=l|536870912),p):null}function mf(i){if(50<Gu)throw Gu=0,My=null,Error(n(185));for(var a=i.return;a!==null;)i=a,a=i.return;return i.tag===3?i.stateNode:null}var fl={};function FN(i,a,l,u){this.tag=i,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Zn(i,a,l,u){return new FN(i,a,l,u)}function Rp(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Ui(i,a){var l=i.alternate;return l===null?(l=Zn(i.tag,a,i.key,i.mode),l.elementType=i.elementType,l.type=i.type,l.stateNode=i.stateNode,l.alternate=i,i.alternate=l):(l.pendingProps=a,l.type=i.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=i.flags&65011712,l.childLanes=i.childLanes,l.lanes=i.lanes,l.child=i.child,l.memoizedProps=i.memoizedProps,l.memoizedState=i.memoizedState,l.updateQueue=i.updateQueue,a=i.dependencies,l.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},l.sibling=i.sibling,l.index=i.index,l.ref=i.ref,l.refCleanup=i.refCleanup,l}function gb(i,a){i.flags&=65011714;var l=i.alternate;return l===null?(i.childLanes=0,i.lanes=a,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,a=l.dependencies,i.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),i}function gf(i,a,l,u,g,p){var b=0;if(u=i,typeof i=="function")Rp(i)&&(b=1);else if(typeof i=="string")b=GO(i,l,ce.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case O:return i=Zn(31,l,a,g),i.elementType=O,i.lanes=p,i;case k:return Wa(l.children,g,p,a);case N:b=8,g|=24;break;case G:return i=Zn(12,l,a,g|2),i.elementType=G,i.lanes=p,i;case ye:return i=Zn(13,l,a,g),i.elementType=ye,i.lanes=p,i;case he:return i=Zn(19,l,a,g),i.elementType=he,i.lanes=p,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case K:b=10;break e;case J:b=9;break e;case se:b=11;break e;case R:b=14;break e;case x:b=16,u=null;break e}b=29,l=Error(n(130,i===null?"null":typeof i,"")),u=null}return a=Zn(b,l,a,g),a.elementType=i,a.type=u,a.lanes=p,a}function Wa(i,a,l,u){return i=Zn(7,i,u,a),i.lanes=l,i}function Cp(i,a,l){return i=Zn(6,i,null,a),i.lanes=l,i}function pb(i){var a=Zn(18,null,null,0);return a.stateNode=i,a}function kp(i,a,l){return a=Zn(4,i.children!==null?i.children:[],i.key,a),a.lanes=l,a.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},a}var yb=new WeakMap;function _r(i,a){if(typeof i=="object"&&i!==null){var l=yb.get(i);return l!==void 0?l:(a={value:i,source:a,stack:tu(a)},yb.set(i,a),a)}return{value:i,source:a,stack:tu(a)}}var ml=[],gl=0,pf=null,Au=0,vr=[],wr=0,As=null,gi=1,pi="";function Bi(i,a){ml[gl++]=Au,ml[gl++]=pf,pf=i,Au=a}function _b(i,a,l){vr[wr++]=gi,vr[wr++]=pi,vr[wr++]=As,As=i;var u=gi;i=pi;var g=32-Pt(u)-1;u&=~(1<<g),l+=1;var p=32-Pt(a)+g;if(30<p){var b=g-g%5;p=(u&(1<<b)-1).toString(32),u>>=b,g-=b,gi=1<<32-Pt(a)+g|l<<g|u,pi=p+i}else gi=1<<p|l<<g|u,pi=i}function Np(i){i.return!==null&&(Bi(i,1),_b(i,1,0))}function Op(i){for(;i===pf;)pf=ml[--gl],ml[gl]=null,Au=ml[--gl],ml[gl]=null;for(;i===As;)As=vr[--wr],vr[wr]=null,pi=vr[--wr],vr[wr]=null,gi=vr[--wr],vr[wr]=null}function vb(i,a){vr[wr++]=gi,vr[wr++]=pi,vr[wr++]=As,gi=a.id,pi=a.overflow,As=i}var mn=null,gt=null,Ge=!1,Is=null,br=!1,Pp=Error(n(519));function xs(i){var a=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Iu(_r(a,i)),Pp}function wb(i){var a=i.stateNode,l=i.type,u=i.memoizedProps;switch(a[zt]=i,a[an]=u,l){case"dialog":Be("cancel",a),Be("close",a);break;case"iframe":case"object":case"embed":Be("load",a);break;case"video":case"audio":for(l=0;l<Wu.length;l++)Be(Wu[l],a);break;case"source":Be("error",a);break;case"img":case"image":case"link":Be("error",a),Be("load",a);break;case"details":Be("toggle",a);break;case"input":Be("invalid",a),Wd(a,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0);break;case"select":Be("invalid",a);break;case"textarea":Be("invalid",a),_s(a,u.value,u.defaultValue,u.children)}l=u.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||a.textContent===""+l||u.suppressHydrationWarning===!0||jT(a.textContent,l)?(u.popover!=null&&(Be("beforetoggle",a),Be("toggle",a)),u.onScroll!=null&&Be("scroll",a),u.onScrollEnd!=null&&Be("scrollend",a),u.onClick!=null&&(a.onclick=Pr),a=!0):a=!1,a||xs(i,!0)}function bb(i){for(mn=i.return;mn;)switch(mn.tag){case 5:case 31:case 13:br=!1;return;case 27:case 3:br=!0;return;default:mn=mn.return}}function pl(i){if(i!==mn)return!1;if(!Ge)return bb(i),Ge=!0,!1;var a=i.tag,l;if((l=a!==3&&a!==27)&&((l=a===5)&&(l=i.type,l=!(l!=="form"&&l!=="button")||Jy(i.type,i.memoizedProps)),l=!l),l&&gt&&xs(i),bb(i),a===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(317));gt=GT(i)}else if(a===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(317));gt=GT(i)}else a===27?(a=gt,Fs(i.type)?(i=n_,n_=null,gt=i):gt=a):gt=mn?Tr(i.stateNode.nextSibling):null;return!0}function Qa(){gt=mn=null,Ge=!1}function Dp(){var i=Is;return i!==null&&(qn===null?qn=i:qn.push.apply(qn,i),Is=null),i}function Iu(i){Is===null?Is=[i]:Is.push(i)}var Vp=V(null),Ya=null,Fi=null;function Rs(i,a,l){de(Vp,a._currentValue),a._currentValue=l}function zi(i){i._currentValue=Vp.current,W(Vp)}function Mp(i,a,l){for(;i!==null;){var u=i.alternate;if((i.childLanes&a)!==a?(i.childLanes|=a,u!==null&&(u.childLanes|=a)):u!==null&&(u.childLanes&a)!==a&&(u.childLanes|=a),i===l)break;i=i.return}}function jp(i,a,l,u){var g=i.child;for(g!==null&&(g.return=i);g!==null;){var p=g.dependencies;if(p!==null){var b=g.child;p=p.firstContext;e:for(;p!==null;){var A=p;p=g;for(var D=0;D<a.length;D++)if(A.context===a[D]){p.lanes|=l,A=p.alternate,A!==null&&(A.lanes|=l),Mp(p.return,l,i),u||(b=null);break e}p=A.next}}else if(g.tag===18){if(b=g.return,b===null)throw Error(n(341));b.lanes|=l,p=b.alternate,p!==null&&(p.lanes|=l),Mp(b,l,i),b=null}else b=g.child;if(b!==null)b.return=g;else for(b=g;b!==null;){if(b===i){b=null;break}if(g=b.sibling,g!==null){g.return=b.return,b=g;break}b=b.return}g=b}}function yl(i,a,l,u){i=null;for(var g=a,p=!1;g!==null;){if(!p){if((g.flags&524288)!==0)p=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var b=g.alternate;if(b===null)throw Error(n(387));if(b=b.memoizedProps,b!==null){var A=g.type;Xn(g.pendingProps.value,b.value)||(i!==null?i.push(A):i=[A])}}else if(g===Le.current){if(b=g.alternate,b===null)throw Error(n(387));b.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(i!==null?i.push(Zu):i=[Zu])}g=g.return}i!==null&&jp(a,i,l,u),a.flags|=262144}function yf(i){for(i=i.firstContext;i!==null;){if(!Xn(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function Ja(i){Ya=i,Fi=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function gn(i){return Eb(Ya,i)}function _f(i,a){return Ya===null&&Ja(i),Eb(i,a)}function Eb(i,a){var l=a._currentValue;if(a={context:a,memoizedValue:l,next:null},Fi===null){if(i===null)throw Error(n(308));Fi=a,i.dependencies={lanes:0,firstContext:a},i.flags|=524288}else Fi=Fi.next=a;return l}var zN=typeof AbortController<"u"?AbortController:function(){var i=[],a=this.signal={aborted:!1,addEventListener:function(l,u){i.push(u)}};this.abort=function(){a.aborted=!0,i.forEach(function(l){return l()})}},qN=r.unstable_scheduleCallback,$N=r.unstable_NormalPriority,Ht={$$typeof:K,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Lp(){return{controller:new zN,data:new Map,refCount:0}}function xu(i){i.refCount--,i.refCount===0&&qN($N,function(){i.controller.abort()})}var Ru=null,Up=0,_l=0,vl=null;function HN(i,a){if(Ru===null){var l=Ru=[];Up=0,_l=zy(),vl={status:"pending",value:void 0,then:function(u){l.push(u)}}}return Up++,a.then(Tb,Tb),a}function Tb(){if(--Up===0&&Ru!==null){vl!==null&&(vl.status="fulfilled");var i=Ru;Ru=null,_l=0,vl=null;for(var a=0;a<i.length;a++)(0,i[a])()}}function GN(i,a){var l=[],u={status:"pending",value:null,reason:null,then:function(g){l.push(g)}};return i.then(function(){u.status="fulfilled",u.value=a;for(var g=0;g<l.length;g++)(0,l[g])(a)},function(g){for(u.status="rejected",u.reason=g,g=0;g<l.length;g++)(0,l[g])(void 0)}),u}var Sb=ee.S;ee.S=function(i,a){oT=Cn(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&HN(i,a),Sb!==null&&Sb(i,a)};var Xa=V(null);function Bp(){var i=Xa.current;return i!==null?i:ht.pooledCache}function vf(i,a){a===null?de(Xa,Xa.current):de(Xa,a.pool)}function Ab(){var i=Bp();return i===null?null:{parent:Ht._currentValue,pool:i}}var wl=Error(n(460)),Fp=Error(n(474)),wf=Error(n(542)),bf={then:function(){}};function Ib(i){return i=i.status,i==="fulfilled"||i==="rejected"}function xb(i,a,l){switch(l=i[l],l===void 0?i.push(a):l!==a&&(a.then(Pr,Pr),a=l),a.status){case"fulfilled":return a.value;case"rejected":throw i=a.reason,Cb(i),i;default:if(typeof a.status=="string")a.then(Pr,Pr);else{if(i=ht,i!==null&&100<i.shellSuspendCounter)throw Error(n(482));i=a,i.status="pending",i.then(function(u){if(a.status==="pending"){var g=a;g.status="fulfilled",g.value=u}},function(u){if(a.status==="pending"){var g=a;g.status="rejected",g.reason=u}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw i=a.reason,Cb(i),i}throw eo=a,wl}}function Za(i){try{var a=i._init;return a(i._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(eo=l,wl):l}}var eo=null;function Rb(){if(eo===null)throw Error(n(459));var i=eo;return eo=null,i}function Cb(i){if(i===wl||i===wf)throw Error(n(483))}var bl=null,Cu=0;function Ef(i){var a=Cu;return Cu+=1,bl===null&&(bl=[]),xb(bl,i,a)}function ku(i,a){a=a.props.ref,i.ref=a!==void 0?a:null}function Tf(i,a){throw a.$$typeof===E?Error(n(525)):(i=Object.prototype.toString.call(a),Error(n(31,i==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":i)))}function kb(i){function a(B,j){if(i){var q=B.deletions;q===null?(B.deletions=[j],B.flags|=16):q.push(j)}}function l(B,j){if(!i)return null;for(;j!==null;)a(B,j),j=j.sibling;return null}function u(B){for(var j=new Map;B!==null;)B.key!==null?j.set(B.key,B):j.set(B.index,B),B=B.sibling;return j}function g(B,j){return B=Ui(B,j),B.index=0,B.sibling=null,B}function p(B,j,q){return B.index=q,i?(q=B.alternate,q!==null?(q=q.index,q<j?(B.flags|=67108866,j):q):(B.flags|=67108866,j)):(B.flags|=1048576,j)}function b(B){return i&&B.alternate===null&&(B.flags|=67108866),B}function A(B,j,q,ne){return j===null||j.tag!==6?(j=Cp(q,B.mode,ne),j.return=B,j):(j=g(j,q),j.return=B,j)}function D(B,j,q,ne){var xe=q.type;return xe===k?te(B,j,q.props.children,ne,q.key):j!==null&&(j.elementType===xe||typeof xe=="object"&&xe!==null&&xe.$$typeof===x&&Za(xe)===j.type)?(j=g(j,q.props),ku(j,q),j.return=B,j):(j=gf(q.type,q.key,q.props,null,B.mode,ne),ku(j,q),j.return=B,j)}function $(B,j,q,ne){return j===null||j.tag!==4||j.stateNode.containerInfo!==q.containerInfo||j.stateNode.implementation!==q.implementation?(j=kp(q,B.mode,ne),j.return=B,j):(j=g(j,q.children||[]),j.return=B,j)}function te(B,j,q,ne,xe){return j===null||j.tag!==7?(j=Wa(q,B.mode,ne,xe),j.return=B,j):(j=g(j,q),j.return=B,j)}function re(B,j,q){if(typeof j=="string"&&j!==""||typeof j=="number"||typeof j=="bigint")return j=Cp(""+j,B.mode,q),j.return=B,j;if(typeof j=="object"&&j!==null){switch(j.$$typeof){case S:return q=gf(j.type,j.key,j.props,null,B.mode,q),ku(q,j),q.return=B,q;case C:return j=kp(j,B.mode,q),j.return=B,j;case x:return j=Za(j),re(B,j,q)}if(We(j)||U(j))return j=Wa(j,B.mode,q,null),j.return=B,j;if(typeof j.then=="function")return re(B,Ef(j),q);if(j.$$typeof===K)return re(B,_f(B,j),q);Tf(B,j)}return null}function H(B,j,q,ne){var xe=j!==null?j.key:null;if(typeof q=="string"&&q!==""||typeof q=="number"||typeof q=="bigint")return xe!==null?null:A(B,j,""+q,ne);if(typeof q=="object"&&q!==null){switch(q.$$typeof){case S:return q.key===xe?D(B,j,q,ne):null;case C:return q.key===xe?$(B,j,q,ne):null;case x:return q=Za(q),H(B,j,q,ne)}if(We(q)||U(q))return xe!==null?null:te(B,j,q,ne,null);if(typeof q.then=="function")return H(B,j,Ef(q),ne);if(q.$$typeof===K)return H(B,j,_f(B,q),ne);Tf(B,q)}return null}function X(B,j,q,ne,xe){if(typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint")return B=B.get(q)||null,A(j,B,""+ne,xe);if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case S:return B=B.get(ne.key===null?q:ne.key)||null,D(j,B,ne,xe);case C:return B=B.get(ne.key===null?q:ne.key)||null,$(j,B,ne,xe);case x:return ne=Za(ne),X(B,j,q,ne,xe)}if(We(ne)||U(ne))return B=B.get(q)||null,te(j,B,ne,xe,null);if(typeof ne.then=="function")return X(B,j,q,Ef(ne),xe);if(ne.$$typeof===K)return X(B,j,q,_f(j,ne),xe);Tf(j,ne)}return null}function we(B,j,q,ne){for(var xe=null,Qe=null,Ee=j,je=j=0,$e=null;Ee!==null&&je<q.length;je++){Ee.index>je?($e=Ee,Ee=null):$e=Ee.sibling;var Ye=H(B,Ee,q[je],ne);if(Ye===null){Ee===null&&(Ee=$e);break}i&&Ee&&Ye.alternate===null&&a(B,Ee),j=p(Ye,j,je),Qe===null?xe=Ye:Qe.sibling=Ye,Qe=Ye,Ee=$e}if(je===q.length)return l(B,Ee),Ge&&Bi(B,je),xe;if(Ee===null){for(;je<q.length;je++)Ee=re(B,q[je],ne),Ee!==null&&(j=p(Ee,j,je),Qe===null?xe=Ee:Qe.sibling=Ee,Qe=Ee);return Ge&&Bi(B,je),xe}for(Ee=u(Ee);je<q.length;je++)$e=X(Ee,B,je,q[je],ne),$e!==null&&(i&&$e.alternate!==null&&Ee.delete($e.key===null?je:$e.key),j=p($e,j,je),Qe===null?xe=$e:Qe.sibling=$e,Qe=$e);return i&&Ee.forEach(function(Gs){return a(B,Gs)}),Ge&&Bi(B,je),xe}function Ce(B,j,q,ne){if(q==null)throw Error(n(151));for(var xe=null,Qe=null,Ee=j,je=j=0,$e=null,Ye=q.next();Ee!==null&&!Ye.done;je++,Ye=q.next()){Ee.index>je?($e=Ee,Ee=null):$e=Ee.sibling;var Gs=H(B,Ee,Ye.value,ne);if(Gs===null){Ee===null&&(Ee=$e);break}i&&Ee&&Gs.alternate===null&&a(B,Ee),j=p(Gs,j,je),Qe===null?xe=Gs:Qe.sibling=Gs,Qe=Gs,Ee=$e}if(Ye.done)return l(B,Ee),Ge&&Bi(B,je),xe;if(Ee===null){for(;!Ye.done;je++,Ye=q.next())Ye=re(B,Ye.value,ne),Ye!==null&&(j=p(Ye,j,je),Qe===null?xe=Ye:Qe.sibling=Ye,Qe=Ye);return Ge&&Bi(B,je),xe}for(Ee=u(Ee);!Ye.done;je++,Ye=q.next())Ye=X(Ee,B,je,Ye.value,ne),Ye!==null&&(i&&Ye.alternate!==null&&Ee.delete(Ye.key===null?je:Ye.key),j=p(Ye,j,je),Qe===null?xe=Ye:Qe.sibling=Ye,Qe=Ye);return i&&Ee.forEach(function(rP){return a(B,rP)}),Ge&&Bi(B,je),xe}function ut(B,j,q,ne){if(typeof q=="object"&&q!==null&&q.type===k&&q.key===null&&(q=q.props.children),typeof q=="object"&&q!==null){switch(q.$$typeof){case S:e:{for(var xe=q.key;j!==null;){if(j.key===xe){if(xe=q.type,xe===k){if(j.tag===7){l(B,j.sibling),ne=g(j,q.props.children),ne.return=B,B=ne;break e}}else if(j.elementType===xe||typeof xe=="object"&&xe!==null&&xe.$$typeof===x&&Za(xe)===j.type){l(B,j.sibling),ne=g(j,q.props),ku(ne,q),ne.return=B,B=ne;break e}l(B,j);break}else a(B,j);j=j.sibling}q.type===k?(ne=Wa(q.props.children,B.mode,ne,q.key),ne.return=B,B=ne):(ne=gf(q.type,q.key,q.props,null,B.mode,ne),ku(ne,q),ne.return=B,B=ne)}return b(B);case C:e:{for(xe=q.key;j!==null;){if(j.key===xe)if(j.tag===4&&j.stateNode.containerInfo===q.containerInfo&&j.stateNode.implementation===q.implementation){l(B,j.sibling),ne=g(j,q.children||[]),ne.return=B,B=ne;break e}else{l(B,j);break}else a(B,j);j=j.sibling}ne=kp(q,B.mode,ne),ne.return=B,B=ne}return b(B);case x:return q=Za(q),ut(B,j,q,ne)}if(We(q))return we(B,j,q,ne);if(U(q)){if(xe=U(q),typeof xe!="function")throw Error(n(150));return q=xe.call(q),Ce(B,j,q,ne)}if(typeof q.then=="function")return ut(B,j,Ef(q),ne);if(q.$$typeof===K)return ut(B,j,_f(B,q),ne);Tf(B,q)}return typeof q=="string"&&q!==""||typeof q=="number"||typeof q=="bigint"?(q=""+q,j!==null&&j.tag===6?(l(B,j.sibling),ne=g(j,q),ne.return=B,B=ne):(l(B,j),ne=Cp(q,B.mode,ne),ne.return=B,B=ne),b(B)):l(B,j)}return function(B,j,q,ne){try{Cu=0;var xe=ut(B,j,q,ne);return bl=null,xe}catch(Ee){if(Ee===wl||Ee===wf)throw Ee;var Qe=Zn(29,Ee,null,B.mode);return Qe.lanes=ne,Qe.return=B,Qe}finally{}}}var to=kb(!0),Nb=kb(!1),Cs=!1;function zp(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function qp(i,a){i=i.updateQueue,a.updateQueue===i&&(a.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function ks(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function Ns(i,a,l){var u=i.updateQueue;if(u===null)return null;if(u=u.shared,(Ze&2)!==0){var g=u.pending;return g===null?a.next=a:(a.next=g.next,g.next=a),u.pending=a,a=mf(i),mb(i,null,l),a}return ff(i,u,a,l),mf(i)}function Nu(i,a,l){if(a=a.updateQueue,a!==null&&(a=a.shared,(l&4194048)!==0)){var u=a.lanes;u&=i.pendingLanes,l|=u,a.lanes=l,iu(i,l)}}function $p(i,a){var l=i.updateQueue,u=i.alternate;if(u!==null&&(u=u.updateQueue,l===u)){var g=null,p=null;if(l=l.firstBaseUpdate,l!==null){do{var b={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};p===null?g=p=b:p=p.next=b,l=l.next}while(l!==null);p===null?g=p=a:p=p.next=a}else g=p=a;l={baseState:u.baseState,firstBaseUpdate:g,lastBaseUpdate:p,shared:u.shared,callbacks:u.callbacks},i.updateQueue=l;return}i=l.lastBaseUpdate,i===null?l.firstBaseUpdate=a:i.next=a,l.lastBaseUpdate=a}var Hp=!1;function Ou(){if(Hp){var i=vl;if(i!==null)throw i}}function Pu(i,a,l,u){Hp=!1;var g=i.updateQueue;Cs=!1;var p=g.firstBaseUpdate,b=g.lastBaseUpdate,A=g.shared.pending;if(A!==null){g.shared.pending=null;var D=A,$=D.next;D.next=null,b===null?p=$:b.next=$,b=D;var te=i.alternate;te!==null&&(te=te.updateQueue,A=te.lastBaseUpdate,A!==b&&(A===null?te.firstBaseUpdate=$:A.next=$,te.lastBaseUpdate=D))}if(p!==null){var re=g.baseState;b=0,te=$=D=null,A=p;do{var H=A.lane&-536870913,X=H!==A.lane;if(X?(qe&H)===H:(u&H)===H){H!==0&&H===_l&&(Hp=!0),te!==null&&(te=te.next={lane:0,tag:A.tag,payload:A.payload,callback:null,next:null});e:{var we=i,Ce=A;H=a;var ut=l;switch(Ce.tag){case 1:if(we=Ce.payload,typeof we=="function"){re=we.call(ut,re,H);break e}re=we;break e;case 3:we.flags=we.flags&-65537|128;case 0:if(we=Ce.payload,H=typeof we=="function"?we.call(ut,re,H):we,H==null)break e;re=_({},re,H);break e;case 2:Cs=!0}}H=A.callback,H!==null&&(i.flags|=64,X&&(i.flags|=8192),X=g.callbacks,X===null?g.callbacks=[H]:X.push(H))}else X={lane:H,tag:A.tag,payload:A.payload,callback:A.callback,next:null},te===null?($=te=X,D=re):te=te.next=X,b|=H;if(A=A.next,A===null){if(A=g.shared.pending,A===null)break;X=A,A=X.next,X.next=null,g.lastBaseUpdate=X,g.shared.pending=null}}while(!0);te===null&&(D=re),g.baseState=D,g.firstBaseUpdate=$,g.lastBaseUpdate=te,p===null&&(g.shared.lanes=0),Ms|=b,i.lanes=b,i.memoizedState=re}}function Ob(i,a){if(typeof i!="function")throw Error(n(191,i));i.call(a)}function Pb(i,a){var l=i.callbacks;if(l!==null)for(i.callbacks=null,i=0;i<l.length;i++)Ob(l[i],a)}var El=V(null),Sf=V(0);function Db(i,a){i=Ji,de(Sf,i),de(El,a),Ji=i|a.baseLanes}function Gp(){de(Sf,Ji),de(El,El.current)}function Kp(){Ji=Sf.current,W(El),W(Sf)}var er=V(null),Er=null;function Os(i){var a=i.alternate;de(Vt,Vt.current&1),de(er,i),Er===null&&(a===null||El.current!==null||a.memoizedState!==null)&&(Er=i)}function Wp(i){de(Vt,Vt.current),de(er,i),Er===null&&(Er=i)}function Vb(i){i.tag===22?(de(Vt,Vt.current),de(er,i),Er===null&&(Er=i)):Ps()}function Ps(){de(Vt,Vt.current),de(er,er.current)}function tr(i){W(er),Er===i&&(Er=null),W(Vt)}var Vt=V(0);function Af(i){for(var a=i;a!==null;){if(a.tag===13){var l=a.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||e_(l)||t_(l)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break;for(;a.sibling===null;){if(a.return===null||a.return===i)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var qi=0,Ve=null,lt=null,Gt=null,If=!1,Tl=!1,no=!1,xf=0,Du=0,Sl=null,KN=0;function Rt(){throw Error(n(321))}function Qp(i,a){if(a===null)return!1;for(var l=0;l<a.length&&l<i.length;l++)if(!Xn(i[l],a[l]))return!1;return!0}function Yp(i,a,l,u,g,p){return qi=p,Ve=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,ee.H=i===null||i.memoizedState===null?_E:hy,no=!1,p=l(u,g),no=!1,Tl&&(p=jb(a,l,u,g)),Mb(i),p}function Mb(i){ee.H=ju;var a=lt!==null&&lt.next!==null;if(qi=0,Gt=lt=Ve=null,If=!1,Du=0,Sl=null,a)throw Error(n(300));i===null||Kt||(i=i.dependencies,i!==null&&yf(i)&&(Kt=!0))}function jb(i,a,l,u){Ve=i;var g=0;do{if(Tl&&(Sl=null),Du=0,Tl=!1,25<=g)throw Error(n(301));if(g+=1,Gt=lt=null,i.updateQueue!=null){var p=i.updateQueue;p.lastEffect=null,p.events=null,p.stores=null,p.memoCache!=null&&(p.memoCache.index=0)}ee.H=vE,p=a(l,u)}while(Tl);return p}function WN(){var i=ee.H,a=i.useState()[0];return a=typeof a.then=="function"?Vu(a):a,i=i.useState()[0],(lt!==null?lt.memoizedState:null)!==i&&(Ve.flags|=1024),a}function Jp(){var i=xf!==0;return xf=0,i}function Xp(i,a,l){a.updateQueue=i.updateQueue,a.flags&=-2053,i.lanes&=~l}function Zp(i){if(If){for(i=i.memoizedState;i!==null;){var a=i.queue;a!==null&&(a.pending=null),i=i.next}If=!1}qi=0,Gt=lt=Ve=null,Tl=!1,Du=xf=0,Sl=null}function Nn(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Gt===null?Ve.memoizedState=Gt=i:Gt=Gt.next=i,Gt}function Mt(){if(lt===null){var i=Ve.alternate;i=i!==null?i.memoizedState:null}else i=lt.next;var a=Gt===null?Ve.memoizedState:Gt.next;if(a!==null)Gt=a,lt=i;else{if(i===null)throw Ve.alternate===null?Error(n(467)):Error(n(310));lt=i,i={memoizedState:lt.memoizedState,baseState:lt.baseState,baseQueue:lt.baseQueue,queue:lt.queue,next:null},Gt===null?Ve.memoizedState=Gt=i:Gt=Gt.next=i}return Gt}function Rf(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Vu(i){var a=Du;return Du+=1,Sl===null&&(Sl=[]),i=xb(Sl,i,a),a=Ve,(Gt===null?a.memoizedState:Gt.next)===null&&(a=a.alternate,ee.H=a===null||a.memoizedState===null?_E:hy),i}function Cf(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return Vu(i);if(i.$$typeof===K)return gn(i)}throw Error(n(438,String(i)))}function ey(i){var a=null,l=Ve.updateQueue;if(l!==null&&(a=l.memoCache),a==null){var u=Ve.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(a={data:u.data.map(function(g){return g.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),l===null&&(l=Rf(),Ve.updateQueue=l),l.memoCache=a,l=a.data[a.index],l===void 0)for(l=a.data[a.index]=Array(i),u=0;u<i;u++)l[u]=L;return a.index++,l}function $i(i,a){return typeof a=="function"?a(i):a}function kf(i){var a=Mt();return ty(a,lt,i)}function ty(i,a,l){var u=i.queue;if(u===null)throw Error(n(311));u.lastRenderedReducer=l;var g=i.baseQueue,p=u.pending;if(p!==null){if(g!==null){var b=g.next;g.next=p.next,p.next=b}a.baseQueue=g=p,u.pending=null}if(p=i.baseState,g===null)i.memoizedState=p;else{a=g.next;var A=b=null,D=null,$=a,te=!1;do{var re=$.lane&-536870913;if(re!==$.lane?(qe&re)===re:(qi&re)===re){var H=$.revertLane;if(H===0)D!==null&&(D=D.next={lane:0,revertLane:0,gesture:null,action:$.action,hasEagerState:$.hasEagerState,eagerState:$.eagerState,next:null}),re===_l&&(te=!0);else if((qi&H)===H){$=$.next,H===_l&&(te=!0);continue}else re={lane:0,revertLane:$.revertLane,gesture:null,action:$.action,hasEagerState:$.hasEagerState,eagerState:$.eagerState,next:null},D===null?(A=D=re,b=p):D=D.next=re,Ve.lanes|=H,Ms|=H;re=$.action,no&&l(p,re),p=$.hasEagerState?$.eagerState:l(p,re)}else H={lane:re,revertLane:$.revertLane,gesture:$.gesture,action:$.action,hasEagerState:$.hasEagerState,eagerState:$.eagerState,next:null},D===null?(A=D=H,b=p):D=D.next=H,Ve.lanes|=re,Ms|=re;$=$.next}while($!==null&&$!==a);if(D===null?b=p:D.next=A,!Xn(p,i.memoizedState)&&(Kt=!0,te&&(l=vl,l!==null)))throw l;i.memoizedState=p,i.baseState=b,i.baseQueue=D,u.lastRenderedState=p}return g===null&&(u.lanes=0),[i.memoizedState,u.dispatch]}function ny(i){var a=Mt(),l=a.queue;if(l===null)throw Error(n(311));l.lastRenderedReducer=i;var u=l.dispatch,g=l.pending,p=a.memoizedState;if(g!==null){l.pending=null;var b=g=g.next;do p=i(p,b.action),b=b.next;while(b!==g);Xn(p,a.memoizedState)||(Kt=!0),a.memoizedState=p,a.baseQueue===null&&(a.baseState=p),l.lastRenderedState=p}return[p,u]}function Lb(i,a,l){var u=Ve,g=Mt(),p=Ge;if(p){if(l===void 0)throw Error(n(407));l=l()}else l=a();var b=!Xn((lt||g).memoizedState,l);if(b&&(g.memoizedState=l,Kt=!0),g=g.queue,sy(Fb.bind(null,u,g,i),[i]),g.getSnapshot!==a||b||Gt!==null&&Gt.memoizedState.tag&1){if(u.flags|=2048,Al(9,{destroy:void 0},Bb.bind(null,u,g,l,a),null),ht===null)throw Error(n(349));p||(qi&127)!==0||Ub(u,a,l)}return l}function Ub(i,a,l){i.flags|=16384,i={getSnapshot:a,value:l},a=Ve.updateQueue,a===null?(a=Rf(),Ve.updateQueue=a,a.stores=[i]):(l=a.stores,l===null?a.stores=[i]:l.push(i))}function Bb(i,a,l,u){a.value=l,a.getSnapshot=u,zb(a)&&qb(i)}function Fb(i,a,l){return l(function(){zb(a)&&qb(i)})}function zb(i){var a=i.getSnapshot;i=i.value;try{var l=a();return!Xn(i,l)}catch{return!0}}function qb(i){var a=Ka(i,2);a!==null&&$n(a,i,2)}function ry(i){var a=Nn();if(typeof i=="function"){var l=i;if(i=l(),no){dr(!0);try{l()}finally{dr(!1)}}}return a.memoizedState=a.baseState=i,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:$i,lastRenderedState:i},a}function $b(i,a,l,u){return i.baseState=l,ty(i,lt,typeof u=="function"?u:$i)}function QN(i,a,l,u,g){if(Pf(i))throw Error(n(485));if(i=a.action,i!==null){var p={payload:g,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(b){p.listeners.push(b)}};ee.T!==null?l(!0):p.isTransition=!1,u(p),l=a.pending,l===null?(p.next=a.pending=p,Hb(a,p)):(p.next=l.next,a.pending=l.next=p)}}function Hb(i,a){var l=a.action,u=a.payload,g=i.state;if(a.isTransition){var p=ee.T,b={};ee.T=b;try{var A=l(g,u),D=ee.S;D!==null&&D(b,A),Gb(i,a,A)}catch($){iy(i,a,$)}finally{p!==null&&b.types!==null&&(p.types=b.types),ee.T=p}}else try{p=l(g,u),Gb(i,a,p)}catch($){iy(i,a,$)}}function Gb(i,a,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(u){Kb(i,a,u)},function(u){return iy(i,a,u)}):Kb(i,a,l)}function Kb(i,a,l){a.status="fulfilled",a.value=l,Wb(a),i.state=l,a=i.pending,a!==null&&(l=a.next,l===a?i.pending=null:(l=l.next,a.next=l,Hb(i,l)))}function iy(i,a,l){var u=i.pending;if(i.pending=null,u!==null){u=u.next;do a.status="rejected",a.reason=l,Wb(a),a=a.next;while(a!==u)}i.action=null}function Wb(i){i=i.listeners;for(var a=0;a<i.length;a++)(0,i[a])()}function Qb(i,a){return a}function Yb(i,a){if(Ge){var l=ht.formState;if(l!==null){e:{var u=Ve;if(Ge){if(gt){t:{for(var g=gt,p=br;g.nodeType!==8;){if(!p){g=null;break t}if(g=Tr(g.nextSibling),g===null){g=null;break t}}p=g.data,g=p==="F!"||p==="F"?g:null}if(g){gt=Tr(g.nextSibling),u=g.data==="F!";break e}}xs(u)}u=!1}u&&(a=l[0])}}return l=Nn(),l.memoizedState=l.baseState=a,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qb,lastRenderedState:a},l.queue=u,l=gE.bind(null,Ve,u),u.dispatch=l,u=ry(!1),p=uy.bind(null,Ve,!1,u.queue),u=Nn(),g={state:a,dispatch:null,action:i,pending:null},u.queue=g,l=QN.bind(null,Ve,g,p,l),g.dispatch=l,u.memoizedState=i,[a,l,!1]}function Jb(i){var a=Mt();return Xb(a,lt,i)}function Xb(i,a,l){if(a=ty(i,a,Qb)[0],i=kf($i)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var u=Vu(a)}catch(b){throw b===wl?wf:b}else u=a;a=Mt();var g=a.queue,p=g.dispatch;return l!==a.memoizedState&&(Ve.flags|=2048,Al(9,{destroy:void 0},YN.bind(null,g,l),null)),[u,p,i]}function YN(i,a){i.action=a}function Zb(i){var a=Mt(),l=lt;if(l!==null)return Xb(a,l,i);Mt(),a=a.memoizedState,l=Mt();var u=l.queue.dispatch;return l.memoizedState=i,[a,u,!1]}function Al(i,a,l,u){return i={tag:i,create:l,deps:u,inst:a,next:null},a=Ve.updateQueue,a===null&&(a=Rf(),Ve.updateQueue=a),l=a.lastEffect,l===null?a.lastEffect=i.next=i:(u=l.next,l.next=i,i.next=u,a.lastEffect=i),i}function eE(){return Mt().memoizedState}function Nf(i,a,l,u){var g=Nn();Ve.flags|=i,g.memoizedState=Al(1|a,{destroy:void 0},l,u===void 0?null:u)}function Of(i,a,l,u){var g=Mt();u=u===void 0?null:u;var p=g.memoizedState.inst;lt!==null&&u!==null&&Qp(u,lt.memoizedState.deps)?g.memoizedState=Al(a,p,l,u):(Ve.flags|=i,g.memoizedState=Al(1|a,p,l,u))}function tE(i,a){Nf(8390656,8,i,a)}function sy(i,a){Of(2048,8,i,a)}function JN(i){Ve.flags|=4;var a=Ve.updateQueue;if(a===null)a=Rf(),Ve.updateQueue=a,a.events=[i];else{var l=a.events;l===null?a.events=[i]:l.push(i)}}function nE(i){var a=Mt().memoizedState;return JN({ref:a,nextImpl:i}),function(){if((Ze&2)!==0)throw Error(n(440));return a.impl.apply(void 0,arguments)}}function rE(i,a){return Of(4,2,i,a)}function iE(i,a){return Of(4,4,i,a)}function sE(i,a){if(typeof a=="function"){i=i();var l=a(i);return function(){typeof l=="function"?l():a(null)}}if(a!=null)return i=i(),a.current=i,function(){a.current=null}}function aE(i,a,l){l=l!=null?l.concat([i]):null,Of(4,4,sE.bind(null,a,i),l)}function ay(){}function oE(i,a){var l=Mt();a=a===void 0?null:a;var u=l.memoizedState;return a!==null&&Qp(a,u[1])?u[0]:(l.memoizedState=[i,a],i)}function lE(i,a){var l=Mt();a=a===void 0?null:a;var u=l.memoizedState;if(a!==null&&Qp(a,u[1]))return u[0];if(u=i(),no){dr(!0);try{i()}finally{dr(!1)}}return l.memoizedState=[u,a],u}function oy(i,a,l){return l===void 0||(qi&1073741824)!==0&&(qe&261930)===0?i.memoizedState=a:(i.memoizedState=l,i=cT(),Ve.lanes|=i,Ms|=i,l)}function cE(i,a,l,u){return Xn(l,a)?l:El.current!==null?(i=oy(i,l,u),Xn(i,a)||(Kt=!0),i):(qi&42)===0||(qi&1073741824)!==0&&(qe&261930)===0?(Kt=!0,i.memoizedState=l):(i=cT(),Ve.lanes|=i,Ms|=i,a)}function uE(i,a,l,u,g){var p=ue.p;ue.p=p!==0&&8>p?p:8;var b=ee.T,A={};ee.T=A,uy(i,!1,a,l);try{var D=g(),$=ee.S;if($!==null&&$(A,D),D!==null&&typeof D=="object"&&typeof D.then=="function"){var te=GN(D,u);Mu(i,a,te,ir(i))}else Mu(i,a,u,ir(i))}catch(re){Mu(i,a,{then:function(){},status:"rejected",reason:re},ir())}finally{ue.p=p,b!==null&&A.types!==null&&(b.types=A.types),ee.T=b}}function XN(){}function ly(i,a,l,u){if(i.tag!==5)throw Error(n(476));var g=hE(i).queue;uE(i,g,a,oe,l===null?XN:function(){return dE(i),l(u)})}function hE(i){var a=i.memoizedState;if(a!==null)return a;a={memoizedState:oe,baseState:oe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:$i,lastRenderedState:oe},next:null};var l={};return a.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:$i,lastRenderedState:l},next:null},i.memoizedState=a,i=i.alternate,i!==null&&(i.memoizedState=a),a}function dE(i){var a=hE(i);a.next===null&&(a=i.alternate.memoizedState),Mu(i,a.next.queue,{},ir())}function cy(){return gn(Zu)}function fE(){return Mt().memoizedState}function mE(){return Mt().memoizedState}function ZN(i){for(var a=i.return;a!==null;){switch(a.tag){case 24:case 3:var l=ir();i=ks(l);var u=Ns(a,i,l);u!==null&&($n(u,a,l),Nu(u,a,l)),a={cache:Lp()},i.payload=a;return}a=a.return}}function eO(i,a,l){var u=ir();l={lane:u,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},Pf(i)?pE(a,l):(l=xp(i,a,l,u),l!==null&&($n(l,i,u),yE(l,a,u)))}function gE(i,a,l){var u=ir();Mu(i,a,l,u)}function Mu(i,a,l,u){var g={lane:u,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(Pf(i))pE(a,g);else{var p=i.alternate;if(i.lanes===0&&(p===null||p.lanes===0)&&(p=a.lastRenderedReducer,p!==null))try{var b=a.lastRenderedState,A=p(b,l);if(g.hasEagerState=!0,g.eagerState=A,Xn(A,b))return ff(i,a,g,0),ht===null&&df(),!1}catch{}finally{}if(l=xp(i,a,g,u),l!==null)return $n(l,i,u),yE(l,a,u),!0}return!1}function uy(i,a,l,u){if(u={lane:2,revertLane:zy(),gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},Pf(i)){if(a)throw Error(n(479))}else a=xp(i,l,u,2),a!==null&&$n(a,i,2)}function Pf(i){var a=i.alternate;return i===Ve||a!==null&&a===Ve}function pE(i,a){Tl=If=!0;var l=i.pending;l===null?a.next=a:(a.next=l.next,l.next=a),i.pending=a}function yE(i,a,l){if((l&4194048)!==0){var u=a.lanes;u&=i.pendingLanes,l|=u,a.lanes=l,iu(i,l)}}var ju={readContext:gn,use:Cf,useCallback:Rt,useContext:Rt,useEffect:Rt,useImperativeHandle:Rt,useLayoutEffect:Rt,useInsertionEffect:Rt,useMemo:Rt,useReducer:Rt,useRef:Rt,useState:Rt,useDebugValue:Rt,useDeferredValue:Rt,useTransition:Rt,useSyncExternalStore:Rt,useId:Rt,useHostTransitionStatus:Rt,useFormState:Rt,useActionState:Rt,useOptimistic:Rt,useMemoCache:Rt,useCacheRefresh:Rt};ju.useEffectEvent=Rt;var _E={readContext:gn,use:Cf,useCallback:function(i,a){return Nn().memoizedState=[i,a===void 0?null:a],i},useContext:gn,useEffect:tE,useImperativeHandle:function(i,a,l){l=l!=null?l.concat([i]):null,Nf(4194308,4,sE.bind(null,a,i),l)},useLayoutEffect:function(i,a){return Nf(4194308,4,i,a)},useInsertionEffect:function(i,a){Nf(4,2,i,a)},useMemo:function(i,a){var l=Nn();a=a===void 0?null:a;var u=i();if(no){dr(!0);try{i()}finally{dr(!1)}}return l.memoizedState=[u,a],u},useReducer:function(i,a,l){var u=Nn();if(l!==void 0){var g=l(a);if(no){dr(!0);try{l(a)}finally{dr(!1)}}}else g=a;return u.memoizedState=u.baseState=g,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:g},u.queue=i,i=i.dispatch=eO.bind(null,Ve,i),[u.memoizedState,i]},useRef:function(i){var a=Nn();return i={current:i},a.memoizedState=i},useState:function(i){i=ry(i);var a=i.queue,l=gE.bind(null,Ve,a);return a.dispatch=l,[i.memoizedState,l]},useDebugValue:ay,useDeferredValue:function(i,a){var l=Nn();return oy(l,i,a)},useTransition:function(){var i=ry(!1);return i=uE.bind(null,Ve,i.queue,!0,!1),Nn().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,a,l){var u=Ve,g=Nn();if(Ge){if(l===void 0)throw Error(n(407));l=l()}else{if(l=a(),ht===null)throw Error(n(349));(qe&127)!==0||Ub(u,a,l)}g.memoizedState=l;var p={value:l,getSnapshot:a};return g.queue=p,tE(Fb.bind(null,u,p,i),[i]),u.flags|=2048,Al(9,{destroy:void 0},Bb.bind(null,u,p,l,a),null),l},useId:function(){var i=Nn(),a=ht.identifierPrefix;if(Ge){var l=pi,u=gi;l=(u&~(1<<32-Pt(u)-1)).toString(32)+l,a="_"+a+"R_"+l,l=xf++,0<l&&(a+="H"+l.toString(32)),a+="_"}else l=KN++,a="_"+a+"r_"+l.toString(32)+"_";return i.memoizedState=a},useHostTransitionStatus:cy,useFormState:Yb,useActionState:Yb,useOptimistic:function(i){var a=Nn();a.memoizedState=a.baseState=i;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=l,a=uy.bind(null,Ve,!0,l),l.dispatch=a,[i,a]},useMemoCache:ey,useCacheRefresh:function(){return Nn().memoizedState=ZN.bind(null,Ve)},useEffectEvent:function(i){var a=Nn(),l={impl:i};return a.memoizedState=l,function(){if((Ze&2)!==0)throw Error(n(440));return l.impl.apply(void 0,arguments)}}},hy={readContext:gn,use:Cf,useCallback:oE,useContext:gn,useEffect:sy,useImperativeHandle:aE,useInsertionEffect:rE,useLayoutEffect:iE,useMemo:lE,useReducer:kf,useRef:eE,useState:function(){return kf($i)},useDebugValue:ay,useDeferredValue:function(i,a){var l=Mt();return cE(l,lt.memoizedState,i,a)},useTransition:function(){var i=kf($i)[0],a=Mt().memoizedState;return[typeof i=="boolean"?i:Vu(i),a]},useSyncExternalStore:Lb,useId:fE,useHostTransitionStatus:cy,useFormState:Jb,useActionState:Jb,useOptimistic:function(i,a){var l=Mt();return $b(l,lt,i,a)},useMemoCache:ey,useCacheRefresh:mE};hy.useEffectEvent=nE;var vE={readContext:gn,use:Cf,useCallback:oE,useContext:gn,useEffect:sy,useImperativeHandle:aE,useInsertionEffect:rE,useLayoutEffect:iE,useMemo:lE,useReducer:ny,useRef:eE,useState:function(){return ny($i)},useDebugValue:ay,useDeferredValue:function(i,a){var l=Mt();return lt===null?oy(l,i,a):cE(l,lt.memoizedState,i,a)},useTransition:function(){var i=ny($i)[0],a=Mt().memoizedState;return[typeof i=="boolean"?i:Vu(i),a]},useSyncExternalStore:Lb,useId:fE,useHostTransitionStatus:cy,useFormState:Zb,useActionState:Zb,useOptimistic:function(i,a){var l=Mt();return lt!==null?$b(l,lt,i,a):(l.baseState=i,[i,l.queue.dispatch])},useMemoCache:ey,useCacheRefresh:mE};vE.useEffectEvent=nE;function dy(i,a,l,u){a=i.memoizedState,l=l(u,a),l=l==null?a:_({},a,l),i.memoizedState=l,i.lanes===0&&(i.updateQueue.baseState=l)}var fy={enqueueSetState:function(i,a,l){i=i._reactInternals;var u=ir(),g=ks(u);g.payload=a,l!=null&&(g.callback=l),a=Ns(i,g,u),a!==null&&($n(a,i,u),Nu(a,i,u))},enqueueReplaceState:function(i,a,l){i=i._reactInternals;var u=ir(),g=ks(u);g.tag=1,g.payload=a,l!=null&&(g.callback=l),a=Ns(i,g,u),a!==null&&($n(a,i,u),Nu(a,i,u))},enqueueForceUpdate:function(i,a){i=i._reactInternals;var l=ir(),u=ks(l);u.tag=2,a!=null&&(u.callback=a),a=Ns(i,u,l),a!==null&&($n(a,i,l),Nu(a,i,l))}};function wE(i,a,l,u,g,p,b){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(u,p,b):a.prototype&&a.prototype.isPureReactComponent?!Tu(l,u)||!Tu(g,p):!0}function bE(i,a,l,u){i=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(l,u),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(l,u),a.state!==i&&fy.enqueueReplaceState(a,a.state,null)}function ro(i,a){var l=a;if("ref"in a){l={};for(var u in a)u!=="ref"&&(l[u]=a[u])}if(i=i.defaultProps){l===a&&(l=_({},l));for(var g in i)l[g]===void 0&&(l[g]=i[g])}return l}function EE(i){hf(i)}function TE(i){console.error(i)}function SE(i){hf(i)}function Df(i,a){try{var l=i.onUncaughtError;l(a.value,{componentStack:a.stack})}catch(u){setTimeout(function(){throw u})}}function AE(i,a,l){try{var u=i.onCaughtError;u(l.value,{componentStack:l.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function my(i,a,l){return l=ks(l),l.tag=3,l.payload={element:null},l.callback=function(){Df(i,a)},l}function IE(i){return i=ks(i),i.tag=3,i}function xE(i,a,l,u){var g=l.type.getDerivedStateFromError;if(typeof g=="function"){var p=u.value;i.payload=function(){return g(p)},i.callback=function(){AE(a,l,u)}}var b=l.stateNode;b!==null&&typeof b.componentDidCatch=="function"&&(i.callback=function(){AE(a,l,u),typeof g!="function"&&(js===null?js=new Set([this]):js.add(this));var A=u.stack;this.componentDidCatch(u.value,{componentStack:A!==null?A:""})})}function tO(i,a,l,u,g){if(l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(a=l.alternate,a!==null&&yl(a,l,g,!0),l=er.current,l!==null){switch(l.tag){case 31:case 13:return Er===null?Gf():l.alternate===null&&Ct===0&&(Ct=3),l.flags&=-257,l.flags|=65536,l.lanes=g,u===bf?l.flags|=16384:(a=l.updateQueue,a===null?l.updateQueue=new Set([u]):a.add(u),Uy(i,u,g)),!1;case 22:return l.flags|=65536,u===bf?l.flags|=16384:(a=l.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([u])},l.updateQueue=a):(l=a.retryQueue,l===null?a.retryQueue=new Set([u]):l.add(u)),Uy(i,u,g)),!1}throw Error(n(435,l.tag))}return Uy(i,u,g),Gf(),!1}if(Ge)return a=er.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=g,u!==Pp&&(i=Error(n(422),{cause:u}),Iu(_r(i,l)))):(u!==Pp&&(a=Error(n(423),{cause:u}),Iu(_r(a,l))),i=i.current.alternate,i.flags|=65536,g&=-g,i.lanes|=g,u=_r(u,l),g=my(i.stateNode,u,g),$p(i,g),Ct!==4&&(Ct=2)),!1;var p=Error(n(520),{cause:u});if(p=_r(p,l),Hu===null?Hu=[p]:Hu.push(p),Ct!==4&&(Ct=2),a===null)return!0;u=_r(u,l),l=a;do{switch(l.tag){case 3:return l.flags|=65536,i=g&-g,l.lanes|=i,i=my(l.stateNode,u,i),$p(l,i),!1;case 1:if(a=l.type,p=l.stateNode,(l.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(js===null||!js.has(p))))return l.flags|=65536,g&=-g,l.lanes|=g,g=IE(g),xE(g,i,l,u),$p(l,g),!1}l=l.return}while(l!==null);return!1}var gy=Error(n(461)),Kt=!1;function pn(i,a,l,u){a.child=i===null?Nb(a,null,l,u):to(a,i.child,l,u)}function RE(i,a,l,u,g){l=l.render;var p=a.ref;if("ref"in u){var b={};for(var A in u)A!=="ref"&&(b[A]=u[A])}else b=u;return Ja(a),u=Yp(i,a,l,b,p,g),A=Jp(),i!==null&&!Kt?(Xp(i,a,g),Hi(i,a,g)):(Ge&&A&&Np(a),a.flags|=1,pn(i,a,u,g),a.child)}function CE(i,a,l,u,g){if(i===null){var p=l.type;return typeof p=="function"&&!Rp(p)&&p.defaultProps===void 0&&l.compare===null?(a.tag=15,a.type=p,kE(i,a,p,u,g)):(i=gf(l.type,null,u,a,a.mode,g),i.ref=a.ref,i.return=a,a.child=i)}if(p=i.child,!Ty(i,g)){var b=p.memoizedProps;if(l=l.compare,l=l!==null?l:Tu,l(b,u)&&i.ref===a.ref)return Hi(i,a,g)}return a.flags|=1,i=Ui(p,u),i.ref=a.ref,i.return=a,a.child=i}function kE(i,a,l,u,g){if(i!==null){var p=i.memoizedProps;if(Tu(p,u)&&i.ref===a.ref)if(Kt=!1,a.pendingProps=u=p,Ty(i,g))(i.flags&131072)!==0&&(Kt=!0);else return a.lanes=i.lanes,Hi(i,a,g)}return py(i,a,l,u,g)}function NE(i,a,l,u){var g=u.children,p=i!==null?i.memoizedState:null;if(i===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.mode==="hidden"){if((a.flags&128)!==0){if(p=p!==null?p.baseLanes|l:l,i!==null){for(u=a.child=i.child,g=0;u!==null;)g=g|u.lanes|u.childLanes,u=u.sibling;u=g&~p}else u=0,a.child=null;return OE(i,a,p,l,u)}if((l&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},i!==null&&vf(a,p!==null?p.cachePool:null),p!==null?Db(a,p):Gp(),Vb(a);else return u=a.lanes=536870912,OE(i,a,p!==null?p.baseLanes|l:l,l,u)}else p!==null?(vf(a,p.cachePool),Db(a,p),Ps(),a.memoizedState=null):(i!==null&&vf(a,null),Gp(),Ps());return pn(i,a,g,l),a.child}function Lu(i,a){return i!==null&&i.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function OE(i,a,l,u,g){var p=Bp();return p=p===null?null:{parent:Ht._currentValue,pool:p},a.memoizedState={baseLanes:l,cachePool:p},i!==null&&vf(a,null),Gp(),Vb(a),i!==null&&yl(i,a,u,!0),a.childLanes=g,null}function Vf(i,a){return a=jf({mode:a.mode,children:a.children},i.mode),a.ref=i.ref,i.child=a,a.return=i,a}function PE(i,a,l){return to(a,i.child,null,l),i=Vf(a,a.pendingProps),i.flags|=2,tr(a),a.memoizedState=null,i}function nO(i,a,l){var u=a.pendingProps,g=(a.flags&128)!==0;if(a.flags&=-129,i===null){if(Ge){if(u.mode==="hidden")return i=Vf(a,u),a.lanes=536870912,Lu(null,i);if(Wp(a),(i=gt)?(i=HT(i,br),i=i!==null&&i.data==="&"?i:null,i!==null&&(a.memoizedState={dehydrated:i,treeContext:As!==null?{id:gi,overflow:pi}:null,retryLane:536870912,hydrationErrors:null},l=pb(i),l.return=a,a.child=l,mn=a,gt=null)):i=null,i===null)throw xs(a);return a.lanes=536870912,null}return Vf(a,u)}var p=i.memoizedState;if(p!==null){var b=p.dehydrated;if(Wp(a),g)if(a.flags&256)a.flags&=-257,a=PE(i,a,l);else if(a.memoizedState!==null)a.child=i.child,a.flags|=128,a=null;else throw Error(n(558));else if(Kt||yl(i,a,l,!1),g=(l&i.childLanes)!==0,Kt||g){if(u=ht,u!==null&&(b=su(u,l),b!==0&&b!==p.retryLane))throw p.retryLane=b,Ka(i,b),$n(u,i,b),gy;Gf(),a=PE(i,a,l)}else i=p.treeContext,gt=Tr(b.nextSibling),mn=a,Ge=!0,Is=null,br=!1,i!==null&&vb(a,i),a=Vf(a,u),a.flags|=4096;return a}return i=Ui(i.child,{mode:u.mode,children:u.children}),i.ref=a.ref,a.child=i,i.return=a,i}function Mf(i,a){var l=a.ref;if(l===null)i!==null&&i.ref!==null&&(a.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(n(284));(i===null||i.ref!==l)&&(a.flags|=4194816)}}function py(i,a,l,u,g){return Ja(a),l=Yp(i,a,l,u,void 0,g),u=Jp(),i!==null&&!Kt?(Xp(i,a,g),Hi(i,a,g)):(Ge&&u&&Np(a),a.flags|=1,pn(i,a,l,g),a.child)}function DE(i,a,l,u,g,p){return Ja(a),a.updateQueue=null,l=jb(a,u,l,g),Mb(i),u=Jp(),i!==null&&!Kt?(Xp(i,a,p),Hi(i,a,p)):(Ge&&u&&Np(a),a.flags|=1,pn(i,a,l,p),a.child)}function VE(i,a,l,u,g){if(Ja(a),a.stateNode===null){var p=fl,b=l.contextType;typeof b=="object"&&b!==null&&(p=gn(b)),p=new l(u,p),a.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=fy,a.stateNode=p,p._reactInternals=a,p=a.stateNode,p.props=u,p.state=a.memoizedState,p.refs={},zp(a),b=l.contextType,p.context=typeof b=="object"&&b!==null?gn(b):fl,p.state=a.memoizedState,b=l.getDerivedStateFromProps,typeof b=="function"&&(dy(a,l,b,u),p.state=a.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(b=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),b!==p.state&&fy.enqueueReplaceState(p,p.state,null),Pu(a,u,p,g),Ou(),p.state=a.memoizedState),typeof p.componentDidMount=="function"&&(a.flags|=4194308),u=!0}else if(i===null){p=a.stateNode;var A=a.memoizedProps,D=ro(l,A);p.props=D;var $=p.context,te=l.contextType;b=fl,typeof te=="object"&&te!==null&&(b=gn(te));var re=l.getDerivedStateFromProps;te=typeof re=="function"||typeof p.getSnapshotBeforeUpdate=="function",A=a.pendingProps!==A,te||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(A||$!==b)&&bE(a,p,u,b),Cs=!1;var H=a.memoizedState;p.state=H,Pu(a,u,p,g),Ou(),$=a.memoizedState,A||H!==$||Cs?(typeof re=="function"&&(dy(a,l,re,u),$=a.memoizedState),(D=Cs||wE(a,l,D,u,H,$,b))?(te||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(a.flags|=4194308)):(typeof p.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=u,a.memoizedState=$),p.props=u,p.state=$,p.context=b,u=D):(typeof p.componentDidMount=="function"&&(a.flags|=4194308),u=!1)}else{p=a.stateNode,qp(i,a),b=a.memoizedProps,te=ro(l,b),p.props=te,re=a.pendingProps,H=p.context,$=l.contextType,D=fl,typeof $=="object"&&$!==null&&(D=gn($)),A=l.getDerivedStateFromProps,($=typeof A=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(b!==re||H!==D)&&bE(a,p,u,D),Cs=!1,H=a.memoizedState,p.state=H,Pu(a,u,p,g),Ou();var X=a.memoizedState;b!==re||H!==X||Cs||i!==null&&i.dependencies!==null&&yf(i.dependencies)?(typeof A=="function"&&(dy(a,l,A,u),X=a.memoizedState),(te=Cs||wE(a,l,te,u,H,X,D)||i!==null&&i.dependencies!==null&&yf(i.dependencies))?($||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(u,X,D),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(u,X,D)),typeof p.componentDidUpdate=="function"&&(a.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof p.componentDidUpdate!="function"||b===i.memoizedProps&&H===i.memoizedState||(a.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||b===i.memoizedProps&&H===i.memoizedState||(a.flags|=1024),a.memoizedProps=u,a.memoizedState=X),p.props=u,p.state=X,p.context=D,u=te):(typeof p.componentDidUpdate!="function"||b===i.memoizedProps&&H===i.memoizedState||(a.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||b===i.memoizedProps&&H===i.memoizedState||(a.flags|=1024),u=!1)}return p=u,Mf(i,a),u=(a.flags&128)!==0,p||u?(p=a.stateNode,l=u&&typeof l.getDerivedStateFromError!="function"?null:p.render(),a.flags|=1,i!==null&&u?(a.child=to(a,i.child,null,g),a.child=to(a,null,l,g)):pn(i,a,l,g),a.memoizedState=p.state,i=a.child):i=Hi(i,a,g),i}function ME(i,a,l,u){return Qa(),a.flags|=256,pn(i,a,l,u),a.child}var yy={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function _y(i){return{baseLanes:i,cachePool:Ab()}}function vy(i,a,l){return i=i!==null?i.childLanes&~l:0,a&&(i|=rr),i}function jE(i,a,l){var u=a.pendingProps,g=!1,p=(a.flags&128)!==0,b;if((b=p)||(b=i!==null&&i.memoizedState===null?!1:(Vt.current&2)!==0),b&&(g=!0,a.flags&=-129),b=(a.flags&32)!==0,a.flags&=-33,i===null){if(Ge){if(g?Os(a):Ps(),(i=gt)?(i=HT(i,br),i=i!==null&&i.data!=="&"?i:null,i!==null&&(a.memoizedState={dehydrated:i,treeContext:As!==null?{id:gi,overflow:pi}:null,retryLane:536870912,hydrationErrors:null},l=pb(i),l.return=a,a.child=l,mn=a,gt=null)):i=null,i===null)throw xs(a);return t_(i)?a.lanes=32:a.lanes=536870912,null}var A=u.children;return u=u.fallback,g?(Ps(),g=a.mode,A=jf({mode:"hidden",children:A},g),u=Wa(u,g,l,null),A.return=a,u.return=a,A.sibling=u,a.child=A,u=a.child,u.memoizedState=_y(l),u.childLanes=vy(i,b,l),a.memoizedState=yy,Lu(null,u)):(Os(a),wy(a,A))}var D=i.memoizedState;if(D!==null&&(A=D.dehydrated,A!==null)){if(p)a.flags&256?(Os(a),a.flags&=-257,a=by(i,a,l)):a.memoizedState!==null?(Ps(),a.child=i.child,a.flags|=128,a=null):(Ps(),A=u.fallback,g=a.mode,u=jf({mode:"visible",children:u.children},g),A=Wa(A,g,l,null),A.flags|=2,u.return=a,A.return=a,u.sibling=A,a.child=u,to(a,i.child,null,l),u=a.child,u.memoizedState=_y(l),u.childLanes=vy(i,b,l),a.memoizedState=yy,a=Lu(null,u));else if(Os(a),t_(A)){if(b=A.nextSibling&&A.nextSibling.dataset,b)var $=b.dgst;b=$,u=Error(n(419)),u.stack="",u.digest=b,Iu({value:u,source:null,stack:null}),a=by(i,a,l)}else if(Kt||yl(i,a,l,!1),b=(l&i.childLanes)!==0,Kt||b){if(b=ht,b!==null&&(u=su(b,l),u!==0&&u!==D.retryLane))throw D.retryLane=u,Ka(i,u),$n(b,i,u),gy;e_(A)||Gf(),a=by(i,a,l)}else e_(A)?(a.flags|=192,a.child=i.child,a=null):(i=D.treeContext,gt=Tr(A.nextSibling),mn=a,Ge=!0,Is=null,br=!1,i!==null&&vb(a,i),a=wy(a,u.children),a.flags|=4096);return a}return g?(Ps(),A=u.fallback,g=a.mode,D=i.child,$=D.sibling,u=Ui(D,{mode:"hidden",children:u.children}),u.subtreeFlags=D.subtreeFlags&65011712,$!==null?A=Ui($,A):(A=Wa(A,g,l,null),A.flags|=2),A.return=a,u.return=a,u.sibling=A,a.child=u,Lu(null,u),u=a.child,A=i.child.memoizedState,A===null?A=_y(l):(g=A.cachePool,g!==null?(D=Ht._currentValue,g=g.parent!==D?{parent:D,pool:D}:g):g=Ab(),A={baseLanes:A.baseLanes|l,cachePool:g}),u.memoizedState=A,u.childLanes=vy(i,b,l),a.memoizedState=yy,Lu(i.child,u)):(Os(a),l=i.child,i=l.sibling,l=Ui(l,{mode:"visible",children:u.children}),l.return=a,l.sibling=null,i!==null&&(b=a.deletions,b===null?(a.deletions=[i],a.flags|=16):b.push(i)),a.child=l,a.memoizedState=null,l)}function wy(i,a){return a=jf({mode:"visible",children:a},i.mode),a.return=i,i.child=a}function jf(i,a){return i=Zn(22,i,null,a),i.lanes=0,i}function by(i,a,l){return to(a,i.child,null,l),i=wy(a,a.pendingProps.children),i.flags|=2,a.memoizedState=null,i}function LE(i,a,l){i.lanes|=a;var u=i.alternate;u!==null&&(u.lanes|=a),Mp(i.return,a,l)}function Ey(i,a,l,u,g,p){var b=i.memoizedState;b===null?i.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:u,tail:l,tailMode:g,treeForkCount:p}:(b.isBackwards=a,b.rendering=null,b.renderingStartTime=0,b.last=u,b.tail=l,b.tailMode=g,b.treeForkCount=p)}function UE(i,a,l){var u=a.pendingProps,g=u.revealOrder,p=u.tail;u=u.children;var b=Vt.current,A=(b&2)!==0;if(A?(b=b&1|2,a.flags|=128):b&=1,de(Vt,b),pn(i,a,u,l),u=Ge?Au:0,!A&&i!==null&&(i.flags&128)!==0)e:for(i=a.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&LE(i,l,a);else if(i.tag===19)LE(i,l,a);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===a)break e;for(;i.sibling===null;){if(i.return===null||i.return===a)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(g){case"forwards":for(l=a.child,g=null;l!==null;)i=l.alternate,i!==null&&Af(i)===null&&(g=l),l=l.sibling;l=g,l===null?(g=a.child,a.child=null):(g=l.sibling,l.sibling=null),Ey(a,!1,g,l,p,u);break;case"backwards":case"unstable_legacy-backwards":for(l=null,g=a.child,a.child=null;g!==null;){if(i=g.alternate,i!==null&&Af(i)===null){a.child=g;break}i=g.sibling,g.sibling=l,l=g,g=i}Ey(a,!0,l,null,p,u);break;case"together":Ey(a,!1,null,null,void 0,u);break;default:a.memoizedState=null}return a.child}function Hi(i,a,l){if(i!==null&&(a.dependencies=i.dependencies),Ms|=a.lanes,(l&a.childLanes)===0)if(i!==null){if(yl(i,a,l,!1),(l&a.childLanes)===0)return null}else return null;if(i!==null&&a.child!==i.child)throw Error(n(153));if(a.child!==null){for(i=a.child,l=Ui(i,i.pendingProps),a.child=l,l.return=a;i.sibling!==null;)i=i.sibling,l=l.sibling=Ui(i,i.pendingProps),l.return=a;l.sibling=null}return a.child}function Ty(i,a){return(i.lanes&a)!==0?!0:(i=i.dependencies,!!(i!==null&&yf(i)))}function rO(i,a,l){switch(a.tag){case 3:Zt(a,a.stateNode.containerInfo),Rs(a,Ht,i.memoizedState.cache),Qa();break;case 27:case 5:Ca(a);break;case 4:Zt(a,a.stateNode.containerInfo);break;case 10:Rs(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,Wp(a),null;break;case 13:var u=a.memoizedState;if(u!==null)return u.dehydrated!==null?(Os(a),a.flags|=128,null):(l&a.child.childLanes)!==0?jE(i,a,l):(Os(a),i=Hi(i,a,l),i!==null?i.sibling:null);Os(a);break;case 19:var g=(i.flags&128)!==0;if(u=(l&a.childLanes)!==0,u||(yl(i,a,l,!1),u=(l&a.childLanes)!==0),g){if(u)return UE(i,a,l);a.flags|=128}if(g=a.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),de(Vt,Vt.current),u)break;return null;case 22:return a.lanes=0,NE(i,a,l,a.pendingProps);case 24:Rs(a,Ht,i.memoizedState.cache)}return Hi(i,a,l)}function BE(i,a,l){if(i!==null)if(i.memoizedProps!==a.pendingProps)Kt=!0;else{if(!Ty(i,l)&&(a.flags&128)===0)return Kt=!1,rO(i,a,l);Kt=(i.flags&131072)!==0}else Kt=!1,Ge&&(a.flags&1048576)!==0&&_b(a,Au,a.index);switch(a.lanes=0,a.tag){case 16:e:{var u=a.pendingProps;if(i=Za(a.elementType),a.type=i,typeof i=="function")Rp(i)?(u=ro(i,u),a.tag=1,a=VE(null,a,i,u,l)):(a.tag=0,a=py(null,a,i,u,l));else{if(i!=null){var g=i.$$typeof;if(g===se){a.tag=11,a=RE(null,a,i,u,l);break e}else if(g===R){a.tag=14,a=CE(null,a,i,u,l);break e}}throw a=et(i)||i,Error(n(306,a,""))}}return a;case 0:return py(i,a,a.type,a.pendingProps,l);case 1:return u=a.type,g=ro(u,a.pendingProps),VE(i,a,u,g,l);case 3:e:{if(Zt(a,a.stateNode.containerInfo),i===null)throw Error(n(387));u=a.pendingProps;var p=a.memoizedState;g=p.element,qp(i,a),Pu(a,u,null,l);var b=a.memoizedState;if(u=b.cache,Rs(a,Ht,u),u!==p.cache&&jp(a,[Ht],l,!0),Ou(),u=b.element,p.isDehydrated)if(p={element:u,isDehydrated:!1,cache:b.cache},a.updateQueue.baseState=p,a.memoizedState=p,a.flags&256){a=ME(i,a,u,l);break e}else if(u!==g){g=_r(Error(n(424)),a),Iu(g),a=ME(i,a,u,l);break e}else{switch(i=a.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(gt=Tr(i.firstChild),mn=a,Ge=!0,Is=null,br=!0,l=Nb(a,null,u,l),a.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(Qa(),u===g){a=Hi(i,a,l);break e}pn(i,a,u,l)}a=a.child}return a;case 26:return Mf(i,a),i===null?(l=JT(a.type,null,a.pendingProps,null))?a.memoizedState=l:Ge||(l=a.type,i=a.pendingProps,u=Zf(Ne.current).createElement(l),u[zt]=a,u[an]=i,yn(u,l,i),qt(u),a.stateNode=u):a.memoizedState=JT(a.type,i.memoizedProps,a.pendingProps,i.memoizedState),null;case 27:return Ca(a),i===null&&Ge&&(u=a.stateNode=WT(a.type,a.pendingProps,Ne.current),mn=a,br=!0,g=gt,Fs(a.type)?(n_=g,gt=Tr(u.firstChild)):gt=g),pn(i,a,a.pendingProps.children,l),Mf(i,a),i===null&&(a.flags|=4194304),a.child;case 5:return i===null&&Ge&&((g=u=gt)&&(u=PO(u,a.type,a.pendingProps,br),u!==null?(a.stateNode=u,mn=a,gt=Tr(u.firstChild),br=!1,g=!0):g=!1),g||xs(a)),Ca(a),g=a.type,p=a.pendingProps,b=i!==null?i.memoizedProps:null,u=p.children,Jy(g,p)?u=null:b!==null&&Jy(g,b)&&(a.flags|=32),a.memoizedState!==null&&(g=Yp(i,a,WN,null,null,l),Zu._currentValue=g),Mf(i,a),pn(i,a,u,l),a.child;case 6:return i===null&&Ge&&((i=l=gt)&&(l=DO(l,a.pendingProps,br),l!==null?(a.stateNode=l,mn=a,gt=null,i=!0):i=!1),i||xs(a)),null;case 13:return jE(i,a,l);case 4:return Zt(a,a.stateNode.containerInfo),u=a.pendingProps,i===null?a.child=to(a,null,u,l):pn(i,a,u,l),a.child;case 11:return RE(i,a,a.type,a.pendingProps,l);case 7:return pn(i,a,a.pendingProps,l),a.child;case 8:return pn(i,a,a.pendingProps.children,l),a.child;case 12:return pn(i,a,a.pendingProps.children,l),a.child;case 10:return u=a.pendingProps,Rs(a,a.type,u.value),pn(i,a,u.children,l),a.child;case 9:return g=a.type._context,u=a.pendingProps.children,Ja(a),g=gn(g),u=u(g),a.flags|=1,pn(i,a,u,l),a.child;case 14:return CE(i,a,a.type,a.pendingProps,l);case 15:return kE(i,a,a.type,a.pendingProps,l);case 19:return UE(i,a,l);case 31:return nO(i,a,l);case 22:return NE(i,a,l,a.pendingProps);case 24:return Ja(a),u=gn(Ht),i===null?(g=Bp(),g===null&&(g=ht,p=Lp(),g.pooledCache=p,p.refCount++,p!==null&&(g.pooledCacheLanes|=l),g=p),a.memoizedState={parent:u,cache:g},zp(a),Rs(a,Ht,g)):((i.lanes&l)!==0&&(qp(i,a),Pu(a,null,null,l),Ou()),g=i.memoizedState,p=a.memoizedState,g.parent!==u?(g={parent:u,cache:u},a.memoizedState=g,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=g),Rs(a,Ht,u)):(u=p.cache,Rs(a,Ht,u),u!==g.cache&&jp(a,[Ht],l,!0))),pn(i,a,a.pendingProps.children,l),a.child;case 29:throw a.pendingProps}throw Error(n(156,a.tag))}function Gi(i){i.flags|=4}function Sy(i,a,l,u,g){if((a=(i.mode&32)!==0)&&(a=!1),a){if(i.flags|=16777216,(g&335544128)===g)if(i.stateNode.complete)i.flags|=8192;else if(fT())i.flags|=8192;else throw eo=bf,Fp}else i.flags&=-16777217}function FE(i,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!nS(a))if(fT())i.flags|=8192;else throw eo=bf,Fp}function Lf(i,a){a!==null&&(i.flags|=4),i.flags&16384&&(a=i.tag!==22?qd():536870912,i.lanes|=a,Cl|=a)}function Uu(i,a){if(!Ge)switch(i.tailMode){case"hidden":a=i.tail;for(var l=null;a!==null;)a.alternate!==null&&(l=a),a=a.sibling;l===null?i.tail=null:l.sibling=null;break;case"collapsed":l=i.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?a||i.tail===null?i.tail=null:i.tail.sibling=null:u.sibling=null}}function pt(i){var a=i.alternate!==null&&i.alternate.child===i.child,l=0,u=0;if(a)for(var g=i.child;g!==null;)l|=g.lanes|g.childLanes,u|=g.subtreeFlags&65011712,u|=g.flags&65011712,g.return=i,g=g.sibling;else for(g=i.child;g!==null;)l|=g.lanes|g.childLanes,u|=g.subtreeFlags,u|=g.flags,g.return=i,g=g.sibling;return i.subtreeFlags|=u,i.childLanes=l,a}function iO(i,a,l){var u=a.pendingProps;switch(Op(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return pt(a),null;case 1:return pt(a),null;case 3:return l=a.stateNode,u=null,i!==null&&(u=i.memoizedState.cache),a.memoizedState.cache!==u&&(a.flags|=2048),zi(Ht),_t(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(i===null||i.child===null)&&(pl(a)?Gi(a):i===null||i.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Dp())),pt(a),null;case 26:var g=a.type,p=a.memoizedState;return i===null?(Gi(a),p!==null?(pt(a),FE(a,p)):(pt(a),Sy(a,g,null,u,l))):p?p!==i.memoizedState?(Gi(a),pt(a),FE(a,p)):(pt(a),a.flags&=-16777217):(i=i.memoizedProps,i!==u&&Gi(a),pt(a),Sy(a,g,i,u,l)),null;case 27:if(Wo(a),l=Ne.current,g=a.type,i!==null&&a.stateNode!=null)i.memoizedProps!==u&&Gi(a);else{if(!u){if(a.stateNode===null)throw Error(n(166));return pt(a),null}i=ce.current,pl(a)?wb(a):(i=WT(g,u,l),a.stateNode=i,Gi(a))}return pt(a),null;case 5:if(Wo(a),g=a.type,i!==null&&a.stateNode!=null)i.memoizedProps!==u&&Gi(a);else{if(!u){if(a.stateNode===null)throw Error(n(166));return pt(a),null}if(p=ce.current,pl(a))wb(a);else{var b=Zf(Ne.current);switch(p){case 1:p=b.createElementNS("http://www.w3.org/2000/svg",g);break;case 2:p=b.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;default:switch(g){case"svg":p=b.createElementNS("http://www.w3.org/2000/svg",g);break;case"math":p=b.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;case"script":p=b.createElement("div"),p.innerHTML="<script><\/script>",p=p.removeChild(p.firstChild);break;case"select":p=typeof u.is=="string"?b.createElement("select",{is:u.is}):b.createElement("select"),u.multiple?p.multiple=!0:u.size&&(p.size=u.size);break;default:p=typeof u.is=="string"?b.createElement(g,{is:u.is}):b.createElement(g)}}p[zt]=a,p[an]=u;e:for(b=a.child;b!==null;){if(b.tag===5||b.tag===6)p.appendChild(b.stateNode);else if(b.tag!==4&&b.tag!==27&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===a)break e;for(;b.sibling===null;){if(b.return===null||b.return===a)break e;b=b.return}b.sibling.return=b.return,b=b.sibling}a.stateNode=p;e:switch(yn(p,g,u),g){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&Gi(a)}}return pt(a),Sy(a,a.type,i===null?null:i.memoizedProps,a.pendingProps,l),null;case 6:if(i&&a.stateNode!=null)i.memoizedProps!==u&&Gi(a);else{if(typeof u!="string"&&a.stateNode===null)throw Error(n(166));if(i=Ne.current,pl(a)){if(i=a.stateNode,l=a.memoizedProps,u=null,g=mn,g!==null)switch(g.tag){case 27:case 5:u=g.memoizedProps}i[zt]=a,i=!!(i.nodeValue===l||u!==null&&u.suppressHydrationWarning===!0||jT(i.nodeValue,l)),i||xs(a,!0)}else i=Zf(i).createTextNode(u),i[zt]=a,a.stateNode=i}return pt(a),null;case 31:if(l=a.memoizedState,i===null||i.memoizedState!==null){if(u=pl(a),l!==null){if(i===null){if(!u)throw Error(n(318));if(i=a.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(557));i[zt]=a}else Qa(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;pt(a),i=!1}else l=Dp(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=l),i=!0;if(!i)return a.flags&256?(tr(a),a):(tr(a),null);if((a.flags&128)!==0)throw Error(n(558))}return pt(a),null;case 13:if(u=a.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(g=pl(a),u!==null&&u.dehydrated!==null){if(i===null){if(!g)throw Error(n(318));if(g=a.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(n(317));g[zt]=a}else Qa(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;pt(a),g=!1}else g=Dp(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=g),g=!0;if(!g)return a.flags&256?(tr(a),a):(tr(a),null)}return tr(a),(a.flags&128)!==0?(a.lanes=l,a):(l=u!==null,i=i!==null&&i.memoizedState!==null,l&&(u=a.child,g=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(g=u.alternate.memoizedState.cachePool.pool),p=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(p=u.memoizedState.cachePool.pool),p!==g&&(u.flags|=2048)),l!==i&&l&&(a.child.flags|=8192),Lf(a,a.updateQueue),pt(a),null);case 4:return _t(),i===null&&Gy(a.stateNode.containerInfo),pt(a),null;case 10:return zi(a.type),pt(a),null;case 19:if(W(Vt),u=a.memoizedState,u===null)return pt(a),null;if(g=(a.flags&128)!==0,p=u.rendering,p===null)if(g)Uu(u,!1);else{if(Ct!==0||i!==null&&(i.flags&128)!==0)for(i=a.child;i!==null;){if(p=Af(i),p!==null){for(a.flags|=128,Uu(u,!1),i=p.updateQueue,a.updateQueue=i,Lf(a,i),a.subtreeFlags=0,i=l,l=a.child;l!==null;)gb(l,i),l=l.sibling;return de(Vt,Vt.current&1|2),Ge&&Bi(a,u.treeForkCount),a.child}i=i.sibling}u.tail!==null&&Cn()>qf&&(a.flags|=128,g=!0,Uu(u,!1),a.lanes=4194304)}else{if(!g)if(i=Af(p),i!==null){if(a.flags|=128,g=!0,i=i.updateQueue,a.updateQueue=i,Lf(a,i),Uu(u,!0),u.tail===null&&u.tailMode==="hidden"&&!p.alternate&&!Ge)return pt(a),null}else 2*Cn()-u.renderingStartTime>qf&&l!==536870912&&(a.flags|=128,g=!0,Uu(u,!1),a.lanes=4194304);u.isBackwards?(p.sibling=a.child,a.child=p):(i=u.last,i!==null?i.sibling=p:a.child=p,u.last=p)}return u.tail!==null?(i=u.tail,u.rendering=i,u.tail=i.sibling,u.renderingStartTime=Cn(),i.sibling=null,l=Vt.current,de(Vt,g?l&1|2:l&1),Ge&&Bi(a,u.treeForkCount),i):(pt(a),null);case 22:case 23:return tr(a),Kp(),u=a.memoizedState!==null,i!==null?i.memoizedState!==null!==u&&(a.flags|=8192):u&&(a.flags|=8192),u?(l&536870912)!==0&&(a.flags&128)===0&&(pt(a),a.subtreeFlags&6&&(a.flags|=8192)):pt(a),l=a.updateQueue,l!==null&&Lf(a,l.retryQueue),l=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(l=i.memoizedState.cachePool.pool),u=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(u=a.memoizedState.cachePool.pool),u!==l&&(a.flags|=2048),i!==null&&W(Xa),null;case 24:return l=null,i!==null&&(l=i.memoizedState.cache),a.memoizedState.cache!==l&&(a.flags|=2048),zi(Ht),pt(a),null;case 25:return null;case 30:return null}throw Error(n(156,a.tag))}function sO(i,a){switch(Op(a),a.tag){case 1:return i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 3:return zi(Ht),_t(),i=a.flags,(i&65536)!==0&&(i&128)===0?(a.flags=i&-65537|128,a):null;case 26:case 27:case 5:return Wo(a),null;case 31:if(a.memoizedState!==null){if(tr(a),a.alternate===null)throw Error(n(340));Qa()}return i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 13:if(tr(a),i=a.memoizedState,i!==null&&i.dehydrated!==null){if(a.alternate===null)throw Error(n(340));Qa()}return i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 19:return W(Vt),null;case 4:return _t(),null;case 10:return zi(a.type),null;case 22:case 23:return tr(a),Kp(),i!==null&&W(Xa),i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 24:return zi(Ht),null;case 25:return null;default:return null}}function zE(i,a){switch(Op(a),a.tag){case 3:zi(Ht),_t();break;case 26:case 27:case 5:Wo(a);break;case 4:_t();break;case 31:a.memoizedState!==null&&tr(a);break;case 13:tr(a);break;case 19:W(Vt);break;case 10:zi(a.type);break;case 22:case 23:tr(a),Kp(),i!==null&&W(Xa);break;case 24:zi(Ht)}}function Bu(i,a){try{var l=a.updateQueue,u=l!==null?l.lastEffect:null;if(u!==null){var g=u.next;l=g;do{if((l.tag&i)===i){u=void 0;var p=l.create,b=l.inst;u=p(),b.destroy=u}l=l.next}while(l!==g)}}catch(A){it(a,a.return,A)}}function Ds(i,a,l){try{var u=a.updateQueue,g=u!==null?u.lastEffect:null;if(g!==null){var p=g.next;u=p;do{if((u.tag&i)===i){var b=u.inst,A=b.destroy;if(A!==void 0){b.destroy=void 0,g=a;var D=l,$=A;try{$()}catch(te){it(g,D,te)}}}u=u.next}while(u!==p)}}catch(te){it(a,a.return,te)}}function qE(i){var a=i.updateQueue;if(a!==null){var l=i.stateNode;try{Pb(a,l)}catch(u){it(i,i.return,u)}}}function $E(i,a,l){l.props=ro(i.type,i.memoizedProps),l.state=i.memoizedState;try{l.componentWillUnmount()}catch(u){it(i,a,u)}}function Fu(i,a){try{var l=i.ref;if(l!==null){switch(i.tag){case 26:case 27:case 5:var u=i.stateNode;break;case 30:u=i.stateNode;break;default:u=i.stateNode}typeof l=="function"?i.refCleanup=l(u):l.current=u}}catch(g){it(i,a,g)}}function yi(i,a){var l=i.ref,u=i.refCleanup;if(l!==null)if(typeof u=="function")try{u()}catch(g){it(i,a,g)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(g){it(i,a,g)}else l.current=null}function HE(i){var a=i.type,l=i.memoizedProps,u=i.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":l.autoFocus&&u.focus();break e;case"img":l.src?u.src=l.src:l.srcSet&&(u.srcset=l.srcSet)}}catch(g){it(i,i.return,g)}}function Ay(i,a,l){try{var u=i.stateNode;xO(u,i.type,l,a),u[an]=a}catch(g){it(i,i.return,g)}}function GE(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&Fs(i.type)||i.tag===4}function Iy(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||GE(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&Fs(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function xy(i,a,l){var u=i.tag;if(u===5||u===6)i=i.stateNode,a?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(i,a):(a=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,a.appendChild(i),l=l._reactRootContainer,l!=null||a.onclick!==null||(a.onclick=Pr));else if(u!==4&&(u===27&&Fs(i.type)&&(l=i.stateNode,a=null),i=i.child,i!==null))for(xy(i,a,l),i=i.sibling;i!==null;)xy(i,a,l),i=i.sibling}function Uf(i,a,l){var u=i.tag;if(u===5||u===6)i=i.stateNode,a?l.insertBefore(i,a):l.appendChild(i);else if(u!==4&&(u===27&&Fs(i.type)&&(l=i.stateNode),i=i.child,i!==null))for(Uf(i,a,l),i=i.sibling;i!==null;)Uf(i,a,l),i=i.sibling}function KE(i){var a=i.stateNode,l=i.memoizedProps;try{for(var u=i.type,g=a.attributes;g.length;)a.removeAttributeNode(g[0]);yn(a,u,l),a[zt]=i,a[an]=l}catch(p){it(i,i.return,p)}}var Ki=!1,Wt=!1,Ry=!1,WE=typeof WeakSet=="function"?WeakSet:Set,ln=null;function aO(i,a){if(i=i.containerInfo,Qy=am,i=ab(i),bp(i)){if("selectionStart"in i)var l={start:i.selectionStart,end:i.selectionEnd};else e:{l=(l=i.ownerDocument)&&l.defaultView||window;var u=l.getSelection&&l.getSelection();if(u&&u.rangeCount!==0){l=u.anchorNode;var g=u.anchorOffset,p=u.focusNode;u=u.focusOffset;try{l.nodeType,p.nodeType}catch{l=null;break e}var b=0,A=-1,D=-1,$=0,te=0,re=i,H=null;t:for(;;){for(var X;re!==l||g!==0&&re.nodeType!==3||(A=b+g),re!==p||u!==0&&re.nodeType!==3||(D=b+u),re.nodeType===3&&(b+=re.nodeValue.length),(X=re.firstChild)!==null;)H=re,re=X;for(;;){if(re===i)break t;if(H===l&&++$===g&&(A=b),H===p&&++te===u&&(D=b),(X=re.nextSibling)!==null)break;re=H,H=re.parentNode}re=X}l=A===-1||D===-1?null:{start:A,end:D}}else l=null}l=l||{start:0,end:0}}else l=null;for(Yy={focusedElem:i,selectionRange:l},am=!1,ln=a;ln!==null;)if(a=ln,i=a.child,(a.subtreeFlags&1028)!==0&&i!==null)i.return=a,ln=i;else for(;ln!==null;){switch(a=ln,p=a.alternate,i=a.flags,a.tag){case 0:if((i&4)!==0&&(i=a.updateQueue,i=i!==null?i.events:null,i!==null))for(l=0;l<i.length;l++)g=i[l],g.ref.impl=g.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&p!==null){i=void 0,l=a,g=p.memoizedProps,p=p.memoizedState,u=l.stateNode;try{var we=ro(l.type,g);i=u.getSnapshotBeforeUpdate(we,p),u.__reactInternalSnapshotBeforeUpdate=i}catch(Ce){it(l,l.return,Ce)}}break;case 3:if((i&1024)!==0){if(i=a.stateNode.containerInfo,l=i.nodeType,l===9)Zy(i);else if(l===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":Zy(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(n(163))}if(i=a.sibling,i!==null){i.return=a.return,ln=i;break}ln=a.return}}function QE(i,a,l){var u=l.flags;switch(l.tag){case 0:case 11:case 15:Qi(i,l),u&4&&Bu(5,l);break;case 1:if(Qi(i,l),u&4)if(i=l.stateNode,a===null)try{i.componentDidMount()}catch(b){it(l,l.return,b)}else{var g=ro(l.type,a.memoizedProps);a=a.memoizedState;try{i.componentDidUpdate(g,a,i.__reactInternalSnapshotBeforeUpdate)}catch(b){it(l,l.return,b)}}u&64&&qE(l),u&512&&Fu(l,l.return);break;case 3:if(Qi(i,l),u&64&&(i=l.updateQueue,i!==null)){if(a=null,l.child!==null)switch(l.child.tag){case 27:case 5:a=l.child.stateNode;break;case 1:a=l.child.stateNode}try{Pb(i,a)}catch(b){it(l,l.return,b)}}break;case 27:a===null&&u&4&&KE(l);case 26:case 5:Qi(i,l),a===null&&u&4&&HE(l),u&512&&Fu(l,l.return);break;case 12:Qi(i,l);break;case 31:Qi(i,l),u&4&&XE(i,l);break;case 13:Qi(i,l),u&4&&ZE(i,l),u&64&&(i=l.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(l=gO.bind(null,l),VO(i,l))));break;case 22:if(u=l.memoizedState!==null||Ki,!u){a=a!==null&&a.memoizedState!==null||Wt,g=Ki;var p=Wt;Ki=u,(Wt=a)&&!p?Yi(i,l,(l.subtreeFlags&8772)!==0):Qi(i,l),Ki=g,Wt=p}break;case 30:break;default:Qi(i,l)}}function YE(i){var a=i.alternate;a!==null&&(i.alternate=null,YE(a)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(a=i.stateNode,a!==null&&Zo(a)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var wt=null,Bn=!1;function Wi(i,a,l){for(l=l.child;l!==null;)JE(i,a,l),l=l.sibling}function JE(i,a,l){if(dn&&typeof dn.onCommitFiberUnmount=="function")try{dn.onCommitFiberUnmount(Cr,l)}catch{}switch(l.tag){case 26:Wt||yi(l,a),Wi(i,a,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:Wt||yi(l,a);var u=wt,g=Bn;Fs(l.type)&&(wt=l.stateNode,Bn=!1),Wi(i,a,l),Yu(l.stateNode),wt=u,Bn=g;break;case 5:Wt||yi(l,a);case 6:if(u=wt,g=Bn,wt=null,Wi(i,a,l),wt=u,Bn=g,wt!==null)if(Bn)try{(wt.nodeType===9?wt.body:wt.nodeName==="HTML"?wt.ownerDocument.body:wt).removeChild(l.stateNode)}catch(p){it(l,a,p)}else try{wt.removeChild(l.stateNode)}catch(p){it(l,a,p)}break;case 18:wt!==null&&(Bn?(i=wt,qT(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,l.stateNode),jl(i)):qT(wt,l.stateNode));break;case 4:u=wt,g=Bn,wt=l.stateNode.containerInfo,Bn=!0,Wi(i,a,l),wt=u,Bn=g;break;case 0:case 11:case 14:case 15:Ds(2,l,a),Wt||Ds(4,l,a),Wi(i,a,l);break;case 1:Wt||(yi(l,a),u=l.stateNode,typeof u.componentWillUnmount=="function"&&$E(l,a,u)),Wi(i,a,l);break;case 21:Wi(i,a,l);break;case 22:Wt=(u=Wt)||l.memoizedState!==null,Wi(i,a,l),Wt=u;break;default:Wi(i,a,l)}}function XE(i,a){if(a.memoizedState===null&&(i=a.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{jl(i)}catch(l){it(a,a.return,l)}}}function ZE(i,a){if(a.memoizedState===null&&(i=a.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{jl(i)}catch(l){it(a,a.return,l)}}function oO(i){switch(i.tag){case 31:case 13:case 19:var a=i.stateNode;return a===null&&(a=i.stateNode=new WE),a;case 22:return i=i.stateNode,a=i._retryCache,a===null&&(a=i._retryCache=new WE),a;default:throw Error(n(435,i.tag))}}function Bf(i,a){var l=oO(i);a.forEach(function(u){if(!l.has(u)){l.add(u);var g=pO.bind(null,i,u);u.then(g,g)}})}function Fn(i,a){var l=a.deletions;if(l!==null)for(var u=0;u<l.length;u++){var g=l[u],p=i,b=a,A=b;e:for(;A!==null;){switch(A.tag){case 27:if(Fs(A.type)){wt=A.stateNode,Bn=!1;break e}break;case 5:wt=A.stateNode,Bn=!1;break e;case 3:case 4:wt=A.stateNode.containerInfo,Bn=!0;break e}A=A.return}if(wt===null)throw Error(n(160));JE(p,b,g),wt=null,Bn=!1,p=g.alternate,p!==null&&(p.return=null),g.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)eT(a,i),a=a.sibling}var Ur=null;function eT(i,a){var l=i.alternate,u=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:Fn(a,i),zn(i),u&4&&(Ds(3,i,i.return),Bu(3,i),Ds(5,i,i.return));break;case 1:Fn(a,i),zn(i),u&512&&(Wt||l===null||yi(l,l.return)),u&64&&Ki&&(i=i.updateQueue,i!==null&&(u=i.callbacks,u!==null&&(l=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=l===null?u:l.concat(u))));break;case 26:var g=Ur;if(Fn(a,i),zn(i),u&512&&(Wt||l===null||yi(l,l.return)),u&4){var p=l!==null?l.memoizedState:null;if(u=i.memoizedState,l===null)if(u===null)if(i.stateNode===null){e:{u=i.type,l=i.memoizedProps,g=g.ownerDocument||g;t:switch(u){case"title":p=g.getElementsByTagName("title")[0],(!p||p[ri]||p[zt]||p.namespaceURI==="http://www.w3.org/2000/svg"||p.hasAttribute("itemprop"))&&(p=g.createElement(u),g.head.insertBefore(p,g.querySelector("head > title"))),yn(p,u,l),p[zt]=i,qt(p),u=p;break e;case"link":var b=eS("link","href",g).get(u+(l.href||""));if(b){for(var A=0;A<b.length;A++)if(p=b[A],p.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&p.getAttribute("rel")===(l.rel==null?null:l.rel)&&p.getAttribute("title")===(l.title==null?null:l.title)&&p.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){b.splice(A,1);break t}}p=g.createElement(u),yn(p,u,l),g.head.appendChild(p);break;case"meta":if(b=eS("meta","content",g).get(u+(l.content||""))){for(A=0;A<b.length;A++)if(p=b[A],p.getAttribute("content")===(l.content==null?null:""+l.content)&&p.getAttribute("name")===(l.name==null?null:l.name)&&p.getAttribute("property")===(l.property==null?null:l.property)&&p.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&p.getAttribute("charset")===(l.charSet==null?null:l.charSet)){b.splice(A,1);break t}}p=g.createElement(u),yn(p,u,l),g.head.appendChild(p);break;default:throw Error(n(468,u))}p[zt]=i,qt(p),u=p}i.stateNode=u}else tS(g,i.type,i.stateNode);else i.stateNode=ZT(g,u,i.memoizedProps);else p!==u?(p===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):p.count--,u===null?tS(g,i.type,i.stateNode):ZT(g,u,i.memoizedProps)):u===null&&i.stateNode!==null&&Ay(i,i.memoizedProps,l.memoizedProps)}break;case 27:Fn(a,i),zn(i),u&512&&(Wt||l===null||yi(l,l.return)),l!==null&&u&4&&Ay(i,i.memoizedProps,l.memoizedProps);break;case 5:if(Fn(a,i),zn(i),u&512&&(Wt||l===null||yi(l,l.return)),i.flags&32){g=i.stateNode;try{Un(g,"")}catch(we){it(i,i.return,we)}}u&4&&i.stateNode!=null&&(g=i.memoizedProps,Ay(i,g,l!==null?l.memoizedProps:g)),u&1024&&(Ry=!0);break;case 6:if(Fn(a,i),zn(i),u&4){if(i.stateNode===null)throw Error(n(162));u=i.memoizedProps,l=i.stateNode;try{l.nodeValue=u}catch(we){it(i,i.return,we)}}break;case 3:if(nm=null,g=Ur,Ur=em(a.containerInfo),Fn(a,i),Ur=g,zn(i),u&4&&l!==null&&l.memoizedState.isDehydrated)try{jl(a.containerInfo)}catch(we){it(i,i.return,we)}Ry&&(Ry=!1,tT(i));break;case 4:u=Ur,Ur=em(i.stateNode.containerInfo),Fn(a,i),zn(i),Ur=u;break;case 12:Fn(a,i),zn(i);break;case 31:Fn(a,i),zn(i),u&4&&(u=i.updateQueue,u!==null&&(i.updateQueue=null,Bf(i,u)));break;case 13:Fn(a,i),zn(i),i.child.flags&8192&&i.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(zf=Cn()),u&4&&(u=i.updateQueue,u!==null&&(i.updateQueue=null,Bf(i,u)));break;case 22:g=i.memoizedState!==null;var D=l!==null&&l.memoizedState!==null,$=Ki,te=Wt;if(Ki=$||g,Wt=te||D,Fn(a,i),Wt=te,Ki=$,zn(i),u&8192)e:for(a=i.stateNode,a._visibility=g?a._visibility&-2:a._visibility|1,g&&(l===null||D||Ki||Wt||io(i)),l=null,a=i;;){if(a.tag===5||a.tag===26){if(l===null){D=l=a;try{if(p=D.stateNode,g)b=p.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none";else{A=D.stateNode;var re=D.memoizedProps.style,H=re!=null&&re.hasOwnProperty("display")?re.display:null;A.style.display=H==null||typeof H=="boolean"?"":(""+H).trim()}}catch(we){it(D,D.return,we)}}}else if(a.tag===6){if(l===null){D=a;try{D.stateNode.nodeValue=g?"":D.memoizedProps}catch(we){it(D,D.return,we)}}}else if(a.tag===18){if(l===null){D=a;try{var X=D.stateNode;g?$T(X,!0):$T(D.stateNode,!1)}catch(we){it(D,D.return,we)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===i)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break e;for(;a.sibling===null;){if(a.return===null||a.return===i)break e;l===a&&(l=null),a=a.return}l===a&&(l=null),a.sibling.return=a.return,a=a.sibling}u&4&&(u=i.updateQueue,u!==null&&(l=u.retryQueue,l!==null&&(u.retryQueue=null,Bf(i,l))));break;case 19:Fn(a,i),zn(i),u&4&&(u=i.updateQueue,u!==null&&(i.updateQueue=null,Bf(i,u)));break;case 30:break;case 21:break;default:Fn(a,i),zn(i)}}function zn(i){var a=i.flags;if(a&2){try{for(var l,u=i.return;u!==null;){if(GE(u)){l=u;break}u=u.return}if(l==null)throw Error(n(160));switch(l.tag){case 27:var g=l.stateNode,p=Iy(i);Uf(i,p,g);break;case 5:var b=l.stateNode;l.flags&32&&(Un(b,""),l.flags&=-33);var A=Iy(i);Uf(i,A,b);break;case 3:case 4:var D=l.stateNode.containerInfo,$=Iy(i);xy(i,$,D);break;default:throw Error(n(161))}}catch(te){it(i,i.return,te)}i.flags&=-3}a&4096&&(i.flags&=-4097)}function tT(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var a=i;tT(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),i=i.sibling}}function Qi(i,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)QE(i,a.alternate,a),a=a.sibling}function io(i){for(i=i.child;i!==null;){var a=i;switch(a.tag){case 0:case 11:case 14:case 15:Ds(4,a,a.return),io(a);break;case 1:yi(a,a.return);var l=a.stateNode;typeof l.componentWillUnmount=="function"&&$E(a,a.return,l),io(a);break;case 27:Yu(a.stateNode);case 26:case 5:yi(a,a.return),io(a);break;case 22:a.memoizedState===null&&io(a);break;case 30:io(a);break;default:io(a)}i=i.sibling}}function Yi(i,a,l){for(l=l&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var u=a.alternate,g=i,p=a,b=p.flags;switch(p.tag){case 0:case 11:case 15:Yi(g,p,l),Bu(4,p);break;case 1:if(Yi(g,p,l),u=p,g=u.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch($){it(u,u.return,$)}if(u=p,g=u.updateQueue,g!==null){var A=u.stateNode;try{var D=g.shared.hiddenCallbacks;if(D!==null)for(g.shared.hiddenCallbacks=null,g=0;g<D.length;g++)Ob(D[g],A)}catch($){it(u,u.return,$)}}l&&b&64&&qE(p),Fu(p,p.return);break;case 27:KE(p);case 26:case 5:Yi(g,p,l),l&&u===null&&b&4&&HE(p),Fu(p,p.return);break;case 12:Yi(g,p,l);break;case 31:Yi(g,p,l),l&&b&4&&XE(g,p);break;case 13:Yi(g,p,l),l&&b&4&&ZE(g,p);break;case 22:p.memoizedState===null&&Yi(g,p,l),Fu(p,p.return);break;case 30:break;default:Yi(g,p,l)}a=a.sibling}}function Cy(i,a){var l=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(l=i.memoizedState.cachePool.pool),i=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(i=a.memoizedState.cachePool.pool),i!==l&&(i!=null&&i.refCount++,l!=null&&xu(l))}function ky(i,a){i=null,a.alternate!==null&&(i=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==i&&(a.refCount++,i!=null&&xu(i))}function Br(i,a,l,u){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)nT(i,a,l,u),a=a.sibling}function nT(i,a,l,u){var g=a.flags;switch(a.tag){case 0:case 11:case 15:Br(i,a,l,u),g&2048&&Bu(9,a);break;case 1:Br(i,a,l,u);break;case 3:Br(i,a,l,u),g&2048&&(i=null,a.alternate!==null&&(i=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==i&&(a.refCount++,i!=null&&xu(i)));break;case 12:if(g&2048){Br(i,a,l,u),i=a.stateNode;try{var p=a.memoizedProps,b=p.id,A=p.onPostCommit;typeof A=="function"&&A(b,a.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(D){it(a,a.return,D)}}else Br(i,a,l,u);break;case 31:Br(i,a,l,u);break;case 13:Br(i,a,l,u);break;case 23:break;case 22:p=a.stateNode,b=a.alternate,a.memoizedState!==null?p._visibility&2?Br(i,a,l,u):zu(i,a):p._visibility&2?Br(i,a,l,u):(p._visibility|=2,Il(i,a,l,u,(a.subtreeFlags&10256)!==0||!1)),g&2048&&Cy(b,a);break;case 24:Br(i,a,l,u),g&2048&&ky(a.alternate,a);break;default:Br(i,a,l,u)}}function Il(i,a,l,u,g){for(g=g&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var p=i,b=a,A=l,D=u,$=b.flags;switch(b.tag){case 0:case 11:case 15:Il(p,b,A,D,g),Bu(8,b);break;case 23:break;case 22:var te=b.stateNode;b.memoizedState!==null?te._visibility&2?Il(p,b,A,D,g):zu(p,b):(te._visibility|=2,Il(p,b,A,D,g)),g&&$&2048&&Cy(b.alternate,b);break;case 24:Il(p,b,A,D,g),g&&$&2048&&ky(b.alternate,b);break;default:Il(p,b,A,D,g)}a=a.sibling}}function zu(i,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var l=i,u=a,g=u.flags;switch(u.tag){case 22:zu(l,u),g&2048&&Cy(u.alternate,u);break;case 24:zu(l,u),g&2048&&ky(u.alternate,u);break;default:zu(l,u)}a=a.sibling}}var qu=8192;function xl(i,a,l){if(i.subtreeFlags&qu)for(i=i.child;i!==null;)rT(i,a,l),i=i.sibling}function rT(i,a,l){switch(i.tag){case 26:xl(i,a,l),i.flags&qu&&i.memoizedState!==null&&KO(l,Ur,i.memoizedState,i.memoizedProps);break;case 5:xl(i,a,l);break;case 3:case 4:var u=Ur;Ur=em(i.stateNode.containerInfo),xl(i,a,l),Ur=u;break;case 22:i.memoizedState===null&&(u=i.alternate,u!==null&&u.memoizedState!==null?(u=qu,qu=16777216,xl(i,a,l),qu=u):xl(i,a,l));break;default:xl(i,a,l)}}function iT(i){var a=i.alternate;if(a!==null&&(i=a.child,i!==null)){a.child=null;do a=i.sibling,i.sibling=null,i=a;while(i!==null)}}function $u(i){var a=i.deletions;if((i.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var u=a[l];ln=u,aT(u,i)}iT(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)sT(i),i=i.sibling}function sT(i){switch(i.tag){case 0:case 11:case 15:$u(i),i.flags&2048&&Ds(9,i,i.return);break;case 3:$u(i);break;case 12:$u(i);break;case 22:var a=i.stateNode;i.memoizedState!==null&&a._visibility&2&&(i.return===null||i.return.tag!==13)?(a._visibility&=-3,Ff(i)):$u(i);break;default:$u(i)}}function Ff(i){var a=i.deletions;if((i.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var u=a[l];ln=u,aT(u,i)}iT(i)}for(i=i.child;i!==null;){switch(a=i,a.tag){case 0:case 11:case 15:Ds(8,a,a.return),Ff(a);break;case 22:l=a.stateNode,l._visibility&2&&(l._visibility&=-3,Ff(a));break;default:Ff(a)}i=i.sibling}}function aT(i,a){for(;ln!==null;){var l=ln;switch(l.tag){case 0:case 11:case 15:Ds(8,l,a);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var u=l.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:xu(l.memoizedState.cache)}if(u=l.child,u!==null)u.return=l,ln=u;else e:for(l=i;ln!==null;){u=ln;var g=u.sibling,p=u.return;if(YE(u),u===l){ln=null;break e}if(g!==null){g.return=p,ln=g;break e}ln=p}}}var lO={getCacheForType:function(i){var a=gn(Ht),l=a.data.get(i);return l===void 0&&(l=i(),a.data.set(i,l)),l},cacheSignal:function(){return gn(Ht).controller.signal}},cO=typeof WeakMap=="function"?WeakMap:Map,Ze=0,ht=null,Ue=null,qe=0,rt=0,nr=null,Vs=!1,Rl=!1,Ny=!1,Ji=0,Ct=0,Ms=0,so=0,Oy=0,rr=0,Cl=0,Hu=null,qn=null,Py=!1,zf=0,oT=0,qf=1/0,$f=null,js=null,tn=0,Ls=null,kl=null,Xi=0,Dy=0,Vy=null,lT=null,Gu=0,My=null;function ir(){return(Ze&2)!==0&&qe!==0?qe&-qe:ee.T!==null?zy():$d()}function cT(){if(rr===0)if((qe&536870912)===0||Ge){var i=Oa;Oa<<=1,(Oa&3932160)===0&&(Oa=262144),rr=i}else rr=536870912;return i=er.current,i!==null&&(i.flags|=32),rr}function $n(i,a,l){(i===ht&&(rt===2||rt===9)||i.cancelPendingCommit!==null)&&(Nl(i,0),Us(i,qe,rr,!1)),Pa(i,l),((Ze&2)===0||i!==ht)&&(i===ht&&((Ze&2)===0&&(so|=l),Ct===4&&Us(i,qe,rr,!1)),_i(i))}function uT(i,a,l){if((Ze&6)!==0)throw Error(n(327));var u=!l&&(a&127)===0&&(a&i.expiredLanes)===0||kr(i,a),g=u?dO(i,a):Ly(i,a,!0),p=u;do{if(g===0){Rl&&!u&&Us(i,a,0,!1);break}else{if(l=i.current.alternate,p&&!uO(l)){g=Ly(i,a,!1),p=!1;continue}if(g===2){if(p=a,i.errorRecoveryDisabledLanes&p)var b=0;else b=i.pendingLanes&-536870913,b=b!==0?b:b&536870912?536870912:0;if(b!==0){a=b;e:{var A=i;g=Hu;var D=A.current.memoizedState.isDehydrated;if(D&&(Nl(A,b).flags|=256),b=Ly(A,b,!1),b!==2){if(Ny&&!D){A.errorRecoveryDisabledLanes|=p,so|=p,g=4;break e}p=qn,qn=g,p!==null&&(qn===null?qn=p:qn.push.apply(qn,p))}g=b}if(p=!1,g!==2)continue}}if(g===1){Nl(i,0),Us(i,a,0,!0);break}e:{switch(u=i,p=g,p){case 0:case 1:throw Error(n(345));case 4:if((a&4194048)!==a)break;case 6:Us(u,a,rr,!Vs);break e;case 2:qn=null;break;case 3:case 5:break;default:throw Error(n(329))}if((a&62914560)===a&&(g=zf+300-Cn(),10<g)){if(Us(u,a,rr,!Vs),ei(u,0,!0)!==0)break e;Xi=a,u.timeoutHandle=FT(hT.bind(null,u,l,qn,$f,Py,a,rr,so,Cl,Vs,p,"Throttled",-0,0),g);break e}hT(u,l,qn,$f,Py,a,rr,so,Cl,Vs,p,null,-0,0)}}break}while(!0);_i(i)}function hT(i,a,l,u,g,p,b,A,D,$,te,re,H,X){if(i.timeoutHandle=-1,re=a.subtreeFlags,re&8192||(re&16785408)===16785408){re={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Pr},rT(a,p,re);var we=(p&62914560)===p?zf-Cn():(p&4194048)===p?oT-Cn():0;if(we=WO(re,we),we!==null){Xi=p,i.cancelPendingCommit=we(vT.bind(null,i,a,p,l,u,g,b,A,D,te,re,null,H,X)),Us(i,p,b,!$);return}}vT(i,a,p,l,u,g,b,A,D)}function uO(i){for(var a=i;;){var l=a.tag;if((l===0||l===11||l===15)&&a.flags&16384&&(l=a.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var u=0;u<l.length;u++){var g=l[u],p=g.getSnapshot;g=g.value;try{if(!Xn(p(),g))return!1}catch{return!1}}if(l=a.child,a.subtreeFlags&16384&&l!==null)l.return=a,a=l;else{if(a===i)break;for(;a.sibling===null;){if(a.return===null||a.return===i)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Us(i,a,l,u){a&=~Oy,a&=~so,i.suspendedLanes|=a,i.pingedLanes&=~a,u&&(i.warmLanes|=a),u=i.expirationTimes;for(var g=a;0<g;){var p=31-Pt(g),b=1<<p;u[p]=-1,g&=~b}l!==0&&Da(i,l,a)}function Hf(){return(Ze&6)===0?(Ku(0),!1):!0}function jy(){if(Ue!==null){if(rt===0)var i=Ue.return;else i=Ue,Fi=Ya=null,Zp(i),bl=null,Cu=0,i=Ue;for(;i!==null;)zE(i.alternate,i),i=i.return;Ue=null}}function Nl(i,a){var l=i.timeoutHandle;l!==-1&&(i.timeoutHandle=-1,kO(l)),l=i.cancelPendingCommit,l!==null&&(i.cancelPendingCommit=null,l()),Xi=0,jy(),ht=i,Ue=l=Ui(i.current,null),qe=a,rt=0,nr=null,Vs=!1,Rl=kr(i,a),Ny=!1,Cl=rr=Oy=so=Ms=Ct=0,qn=Hu=null,Py=!1,(a&8)!==0&&(a|=a&32);var u=i.entangledLanes;if(u!==0)for(i=i.entanglements,u&=a;0<u;){var g=31-Pt(u),p=1<<g;a|=i[g],u&=~p}return Ji=a,df(),l}function dT(i,a){Ve=null,ee.H=ju,a===wl||a===wf?(a=Rb(),rt=3):a===Fp?(a=Rb(),rt=4):rt=a===gy?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,nr=a,Ue===null&&(Ct=1,Df(i,_r(a,i.current)))}function fT(){var i=er.current;return i===null?!0:(qe&4194048)===qe?Er===null:(qe&62914560)===qe||(qe&536870912)!==0?i===Er:!1}function mT(){var i=ee.H;return ee.H=ju,i===null?ju:i}function gT(){var i=ee.A;return ee.A=lO,i}function Gf(){Ct=4,Vs||(qe&4194048)!==qe&&er.current!==null||(Rl=!0),(Ms&134217727)===0&&(so&134217727)===0||ht===null||Us(ht,qe,rr,!1)}function Ly(i,a,l){var u=Ze;Ze|=2;var g=mT(),p=gT();(ht!==i||qe!==a)&&($f=null,Nl(i,a)),a=!1;var b=Ct;e:do try{if(rt!==0&&Ue!==null){var A=Ue,D=nr;switch(rt){case 8:jy(),b=6;break e;case 3:case 2:case 9:case 6:er.current===null&&(a=!0);var $=rt;if(rt=0,nr=null,Ol(i,A,D,$),l&&Rl){b=0;break e}break;default:$=rt,rt=0,nr=null,Ol(i,A,D,$)}}hO(),b=Ct;break}catch(te){dT(i,te)}while(!0);return a&&i.shellSuspendCounter++,Fi=Ya=null,Ze=u,ee.H=g,ee.A=p,Ue===null&&(ht=null,qe=0,df()),b}function hO(){for(;Ue!==null;)pT(Ue)}function dO(i,a){var l=Ze;Ze|=2;var u=mT(),g=gT();ht!==i||qe!==a?($f=null,qf=Cn()+500,Nl(i,a)):Rl=kr(i,a);e:do try{if(rt!==0&&Ue!==null){a=Ue;var p=nr;t:switch(rt){case 1:rt=0,nr=null,Ol(i,a,p,1);break;case 2:case 9:if(Ib(p)){rt=0,nr=null,yT(a);break}a=function(){rt!==2&&rt!==9||ht!==i||(rt=7),_i(i)},p.then(a,a);break e;case 3:rt=7;break e;case 4:rt=5;break e;case 7:Ib(p)?(rt=0,nr=null,yT(a)):(rt=0,nr=null,Ol(i,a,p,7));break;case 5:var b=null;switch(Ue.tag){case 26:b=Ue.memoizedState;case 5:case 27:var A=Ue;if(b?nS(b):A.stateNode.complete){rt=0,nr=null;var D=A.sibling;if(D!==null)Ue=D;else{var $=A.return;$!==null?(Ue=$,Kf($)):Ue=null}break t}}rt=0,nr=null,Ol(i,a,p,5);break;case 6:rt=0,nr=null,Ol(i,a,p,6);break;case 8:jy(),Ct=6;break e;default:throw Error(n(462))}}fO();break}catch(te){dT(i,te)}while(!0);return Fi=Ya=null,ee.H=u,ee.A=g,Ze=l,Ue!==null?0:(ht=null,qe=0,df(),Ct)}function fO(){for(;Ue!==null&&!mp();)pT(Ue)}function pT(i){var a=BE(i.alternate,i,Ji);i.memoizedProps=i.pendingProps,a===null?Kf(i):Ue=a}function yT(i){var a=i,l=a.alternate;switch(a.tag){case 15:case 0:a=DE(l,a,a.pendingProps,a.type,void 0,qe);break;case 11:a=DE(l,a,a.pendingProps,a.type.render,a.ref,qe);break;case 5:Zp(a);default:zE(l,a),a=Ue=gb(a,Ji),a=BE(l,a,Ji)}i.memoizedProps=i.pendingProps,a===null?Kf(i):Ue=a}function Ol(i,a,l,u){Fi=Ya=null,Zp(a),bl=null,Cu=0;var g=a.return;try{if(tO(i,g,a,l,qe)){Ct=1,Df(i,_r(l,i.current)),Ue=null;return}}catch(p){if(g!==null)throw Ue=g,p;Ct=1,Df(i,_r(l,i.current)),Ue=null;return}a.flags&32768?(Ge||u===1?i=!0:Rl||(qe&536870912)!==0?i=!1:(Vs=i=!0,(u===2||u===9||u===3||u===6)&&(u=er.current,u!==null&&u.tag===13&&(u.flags|=16384))),_T(a,i)):Kf(a)}function Kf(i){var a=i;do{if((a.flags&32768)!==0){_T(a,Vs);return}i=a.return;var l=iO(a.alternate,a,Ji);if(l!==null){Ue=l;return}if(a=a.sibling,a!==null){Ue=a;return}Ue=a=i}while(a!==null);Ct===0&&(Ct=5)}function _T(i,a){do{var l=sO(i.alternate,i);if(l!==null){l.flags&=32767,Ue=l;return}if(l=i.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!a&&(i=i.sibling,i!==null)){Ue=i;return}Ue=i=l}while(i!==null);Ct=6,Ue=null}function vT(i,a,l,u,g,p,b,A,D){i.cancelPendingCommit=null;do Wf();while(tn!==0);if((Ze&6)!==0)throw Error(n(327));if(a!==null){if(a===i.current)throw Error(n(177));if(p=a.lanes|a.childLanes,p|=Ip,yp(i,l,p,b,A,D),i===ht&&(Ue=ht=null,qe=0),kl=a,Ls=i,Xi=l,Dy=p,Vy=g,lT=u,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,yO(gs,function(){return ST(),null})):(i.callbackNode=null,i.callbackPriority=0),u=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||u){u=ee.T,ee.T=null,g=ue.p,ue.p=2,b=Ze,Ze|=4;try{aO(i,a,l)}finally{Ze=b,ue.p=g,ee.T=u}}tn=1,wT(),bT(),ET()}}function wT(){if(tn===1){tn=0;var i=Ls,a=kl,l=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||l){l=ee.T,ee.T=null;var u=ue.p;ue.p=2;var g=Ze;Ze|=4;try{eT(a,i);var p=Yy,b=ab(i.containerInfo),A=p.focusedElem,D=p.selectionRange;if(b!==A&&A&&A.ownerDocument&&sb(A.ownerDocument.documentElement,A)){if(D!==null&&bp(A)){var $=D.start,te=D.end;if(te===void 0&&(te=$),"selectionStart"in A)A.selectionStart=$,A.selectionEnd=Math.min(te,A.value.length);else{var re=A.ownerDocument||document,H=re&&re.defaultView||window;if(H.getSelection){var X=H.getSelection(),we=A.textContent.length,Ce=Math.min(D.start,we),ut=D.end===void 0?Ce:Math.min(D.end,we);!X.extend&&Ce>ut&&(b=ut,ut=Ce,Ce=b);var B=ib(A,Ce),j=ib(A,ut);if(B&&j&&(X.rangeCount!==1||X.anchorNode!==B.node||X.anchorOffset!==B.offset||X.focusNode!==j.node||X.focusOffset!==j.offset)){var q=re.createRange();q.setStart(B.node,B.offset),X.removeAllRanges(),Ce>ut?(X.addRange(q),X.extend(j.node,j.offset)):(q.setEnd(j.node,j.offset),X.addRange(q))}}}}for(re=[],X=A;X=X.parentNode;)X.nodeType===1&&re.push({element:X,left:X.scrollLeft,top:X.scrollTop});for(typeof A.focus=="function"&&A.focus(),A=0;A<re.length;A++){var ne=re[A];ne.element.scrollLeft=ne.left,ne.element.scrollTop=ne.top}}am=!!Qy,Yy=Qy=null}finally{Ze=g,ue.p=u,ee.T=l}}i.current=a,tn=2}}function bT(){if(tn===2){tn=0;var i=Ls,a=kl,l=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||l){l=ee.T,ee.T=null;var u=ue.p;ue.p=2;var g=Ze;Ze|=4;try{QE(i,a.alternate,a)}finally{Ze=g,ue.p=u,ee.T=l}}tn=3}}function ET(){if(tn===4||tn===3){tn=0,jd();var i=Ls,a=kl,l=Xi,u=lT;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?tn=5:(tn=0,kl=Ls=null,TT(i,i.pendingLanes));var g=i.pendingLanes;if(g===0&&(js=null),Vi(l),a=a.stateNode,dn&&typeof dn.onCommitFiberRoot=="function")try{dn.onCommitFiberRoot(Cr,a,void 0,(a.current.flags&128)===128)}catch{}if(u!==null){a=ee.T,g=ue.p,ue.p=2,ee.T=null;try{for(var p=i.onRecoverableError,b=0;b<u.length;b++){var A=u[b];p(A.value,{componentStack:A.stack})}}finally{ee.T=a,ue.p=g}}(Xi&3)!==0&&Wf(),_i(i),g=i.pendingLanes,(l&261930)!==0&&(g&42)!==0?i===My?Gu++:(Gu=0,My=i):Gu=0,Ku(0)}}function TT(i,a){(i.pooledCacheLanes&=a)===0&&(a=i.pooledCache,a!=null&&(i.pooledCache=null,xu(a)))}function Wf(){return wT(),bT(),ET(),ST()}function ST(){if(tn!==5)return!1;var i=Ls,a=Dy;Dy=0;var l=Vi(Xi),u=ee.T,g=ue.p;try{ue.p=32>l?32:l,ee.T=null,l=Vy,Vy=null;var p=Ls,b=Xi;if(tn=0,kl=Ls=null,Xi=0,(Ze&6)!==0)throw Error(n(331));var A=Ze;if(Ze|=4,sT(p.current),nT(p,p.current,b,l),Ze=A,Ku(0,!1),dn&&typeof dn.onPostCommitFiberRoot=="function")try{dn.onPostCommitFiberRoot(Cr,p)}catch{}return!0}finally{ue.p=g,ee.T=u,TT(i,a)}}function AT(i,a,l){a=_r(l,a),a=my(i.stateNode,a,2),i=Ns(i,a,2),i!==null&&(Pa(i,2),_i(i))}function it(i,a,l){if(i.tag===3)AT(i,i,l);else for(;a!==null;){if(a.tag===3){AT(a,i,l);break}else if(a.tag===1){var u=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(js===null||!js.has(u))){i=_r(l,i),l=IE(2),u=Ns(a,l,2),u!==null&&(xE(l,u,a,i),Pa(u,2),_i(u));break}}a=a.return}}function Uy(i,a,l){var u=i.pingCache;if(u===null){u=i.pingCache=new cO;var g=new Set;u.set(a,g)}else g=u.get(a),g===void 0&&(g=new Set,u.set(a,g));g.has(l)||(Ny=!0,g.add(l),i=mO.bind(null,i,a,l),a.then(i,i))}function mO(i,a,l){var u=i.pingCache;u!==null&&u.delete(a),i.pingedLanes|=i.suspendedLanes&l,i.warmLanes&=~l,ht===i&&(qe&l)===l&&(Ct===4||Ct===3&&(qe&62914560)===qe&&300>Cn()-zf?(Ze&2)===0&&Nl(i,0):Oy|=l,Cl===qe&&(Cl=0)),_i(i)}function IT(i,a){a===0&&(a=qd()),i=Ka(i,a),i!==null&&(Pa(i,a),_i(i))}function gO(i){var a=i.memoizedState,l=0;a!==null&&(l=a.retryLane),IT(i,l)}function pO(i,a){var l=0;switch(i.tag){case 31:case 13:var u=i.stateNode,g=i.memoizedState;g!==null&&(l=g.retryLane);break;case 19:u=i.stateNode;break;case 22:u=i.stateNode._retryCache;break;default:throw Error(n(314))}u!==null&&u.delete(a),IT(i,l)}function yO(i,a){return en(i,a)}var Qf=null,Pl=null,By=!1,Yf=!1,Fy=!1,Bs=0;function _i(i){i!==Pl&&i.next===null&&(Pl===null?Qf=Pl=i:Pl=Pl.next=i),Yf=!0,By||(By=!0,vO())}function Ku(i,a){if(!Fy&&Yf){Fy=!0;do for(var l=!1,u=Qf;u!==null;){if(i!==0){var g=u.pendingLanes;if(g===0)var p=0;else{var b=u.suspendedLanes,A=u.pingedLanes;p=(1<<31-Pt(42|i)+1)-1,p&=g&~(b&~A),p=p&201326741?p&201326741|1:p?p|2:0}p!==0&&(l=!0,kT(u,p))}else p=qe,p=ei(u,u===ht?p:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(p&3)===0||kr(u,p)||(l=!0,kT(u,p));u=u.next}while(l);Fy=!1}}function _O(){xT()}function xT(){Yf=By=!1;var i=0;Bs!==0&&CO()&&(i=Bs);for(var a=Cn(),l=null,u=Qf;u!==null;){var g=u.next,p=RT(u,a);p===0?(u.next=null,l===null?Qf=g:l.next=g,g===null&&(Pl=l)):(l=u,(i!==0||(p&3)!==0)&&(Yf=!0)),u=g}tn!==0&&tn!==5||Ku(i),Bs!==0&&(Bs=0)}function RT(i,a){for(var l=i.suspendedLanes,u=i.pingedLanes,g=i.expirationTimes,p=i.pendingLanes&-62914561;0<p;){var b=31-Pt(p),A=1<<b,D=g[b];D===-1?((A&l)===0||(A&u)!==0)&&(g[b]=pp(A,a)):D<=a&&(i.expiredLanes|=A),p&=~A}if(a=ht,l=qe,l=ei(i,i===a?l:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),u=i.callbackNode,l===0||i===a&&(rt===2||rt===9)||i.cancelPendingCommit!==null)return u!==null&&u!==null&&ms(u),i.callbackNode=null,i.callbackPriority=0;if((l&3)===0||kr(i,l)){if(a=l&-l,a===i.callbackPriority)return a;switch(u!==null&&ms(u),Vi(l)){case 2:case 8:l=ru;break;case 32:l=gs;break;case 268435456:l=Ld;break;default:l=gs}return u=CT.bind(null,i),l=en(l,u),i.callbackPriority=a,i.callbackNode=l,a}return u!==null&&u!==null&&ms(u),i.callbackPriority=2,i.callbackNode=null,2}function CT(i,a){if(tn!==0&&tn!==5)return i.callbackNode=null,i.callbackPriority=0,null;var l=i.callbackNode;if(Wf()&&i.callbackNode!==l)return null;var u=qe;return u=ei(i,i===ht?u:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),u===0?null:(uT(i,u,a),RT(i,Cn()),i.callbackNode!=null&&i.callbackNode===l?CT.bind(null,i):null)}function kT(i,a){if(Wf())return null;uT(i,a,!0)}function vO(){NO(function(){(Ze&6)!==0?en(nu,_O):xT()})}function zy(){if(Bs===0){var i=_l;i===0&&(i=Xr,Xr<<=1,(Xr&261888)===0&&(Xr=256)),Bs=i}return Bs}function NT(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:rl(""+i)}function OT(i,a){var l=a.ownerDocument.createElement("input");return l.name=a.name,l.value=a.value,i.id&&l.setAttribute("form",i.id),a.parentNode.insertBefore(l,a),i=new FormData(i),l.parentNode.removeChild(l),i}function wO(i,a,l,u,g){if(a==="submit"&&l&&l.stateNode===g){var p=NT((g[an]||null).action),b=u.submitter;b&&(a=(a=b[an]||null)?NT(a.formAction):b.getAttribute("formAction"),a!==null&&(p=a,b=null));var A=new hi("action","action",null,u,g);i.push({event:A,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(Bs!==0){var D=b?OT(g,b):new FormData(g);ly(l,{pending:!0,data:D,method:g.method,action:p},null,D)}}else typeof p=="function"&&(A.preventDefault(),D=b?OT(g,b):new FormData(g),ly(l,{pending:!0,data:D,method:g.method,action:p},p,D))},currentTarget:g}]})}}for(var qy=0;qy<Ap.length;qy++){var $y=Ap[qy],bO=$y.toLowerCase(),EO=$y[0].toUpperCase()+$y.slice(1);Lr(bO,"on"+EO)}Lr(cb,"onAnimationEnd"),Lr(ub,"onAnimationIteration"),Lr(hb,"onAnimationStart"),Lr("dblclick","onDoubleClick"),Lr("focusin","onFocus"),Lr("focusout","onBlur"),Lr(LN,"onTransitionRun"),Lr(UN,"onTransitionStart"),Lr(BN,"onTransitionCancel"),Lr(db,"onTransitionEnd"),oi("onMouseEnter",["mouseout","mouseover"]),oi("onMouseLeave",["mouseout","mouseover"]),oi("onPointerEnter",["pointerout","pointerover"]),oi("onPointerLeave",["pointerout","pointerover"]),ai("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ai("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ai("onBeforeInput",["compositionend","keypress","textInput","paste"]),ai("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ai("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ai("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Wu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),TO=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Wu));function PT(i,a){a=(a&4)!==0;for(var l=0;l<i.length;l++){var u=i[l],g=u.event;u=u.listeners;e:{var p=void 0;if(a)for(var b=u.length-1;0<=b;b--){var A=u[b],D=A.instance,$=A.currentTarget;if(A=A.listener,D!==p&&g.isPropagationStopped())break e;p=A,g.currentTarget=$;try{p(g)}catch(te){hf(te)}g.currentTarget=null,p=D}else for(b=0;b<u.length;b++){if(A=u[b],D=A.instance,$=A.currentTarget,A=A.listener,D!==p&&g.isPropagationStopped())break e;p=A,g.currentTarget=$;try{p(g)}catch(te){hf(te)}g.currentTarget=null,p=D}}}}function Be(i,a){var l=a[Xo];l===void 0&&(l=a[Xo]=new Set);var u=i+"__bubble";l.has(u)||(DT(a,i,2,!1),l.add(u))}function Hy(i,a,l){var u=0;a&&(u|=4),DT(l,i,u,a)}var Jf="_reactListening"+Math.random().toString(36).slice(2);function Gy(i){if(!i[Jf]){i[Jf]=!0,au.forEach(function(l){l!=="selectionchange"&&(TO.has(l)||Hy(l,!1,i),Hy(l,!0,i))});var a=i.nodeType===9?i:i.ownerDocument;a===null||a[Jf]||(a[Jf]=!0,Hy("selectionchange",!1,a))}}function DT(i,a,l,u){switch(cS(a)){case 2:var g=JO;break;case 8:g=XO;break;default:g=o_}l=g.bind(null,a,l,i),g=void 0,!Ua||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(g=!0),u?g!==void 0?i.addEventListener(a,l,{capture:!0,passive:g}):i.addEventListener(a,l,!0):g!==void 0?i.addEventListener(a,l,{passive:g}):i.addEventListener(a,l,!1)}function Ky(i,a,l,u,g){var p=u;if((a&1)===0&&(a&2)===0&&u!==null)e:for(;;){if(u===null)return;var b=u.tag;if(b===3||b===4){var A=u.stateNode.containerInfo;if(A===g)break;if(b===4)for(b=u.return;b!==null;){var D=b.tag;if((D===3||D===4)&&b.stateNode.containerInfo===g)return;b=b.return}for(;A!==null;){if(b=ii(A),b===null)return;if(D=b.tag,D===5||D===6||D===26||D===27){u=p=b;continue e}A=A.parentNode}}u=u.return}bs(function(){var $=p,te=mr(l),re=[];e:{var H=fb.get(i);if(H!==void 0){var X=hi,we=i;switch(i){case"keypress":if(Fa(l)===0)break e;case"keydown":case"keyup":X=lf;break;case"focusin":we="focus",X=qa;break;case"focusout":we="blur",X=qa;break;case"beforeblur":case"afterblur":X=qa;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":X=vu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":X=Xd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":X=v;break;case cb:case ub:case hb:X=ef;break;case db:X=I;break;case"scroll":case"scrollend":X=_u;break;case"wheel":X=Y;break;case"copy":case"cut":case"paste":X=tf;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":X=Li;break;case"toggle":case"beforetoggle":X=De}var Ce=(a&4)!==0,ut=!Ce&&(i==="scroll"||i==="scrollend"),B=Ce?H!==null?H+"Capture":null:H;Ce=[];for(var j=$,q;j!==null;){var ne=j;if(q=ne.stateNode,ne=ne.tag,ne!==5&&ne!==26&&ne!==27||q===null||B===null||(ne=Dr(j,B),ne!=null&&Ce.push(Qu(j,ne,q))),ut)break;j=j.return}0<Ce.length&&(H=new X(H,we,null,l,te),re.push({event:H,listeners:Ce}))}}if((a&7)===0){e:{if(H=i==="mouseover"||i==="pointerover",X=i==="mouseout"||i==="pointerout",H&&l!==gu&&(we=l.relatedTarget||l.fromElement)&&(ii(we)||we[ni]))break e;if((X||H)&&(H=te.window===te?te:(H=te.ownerDocument)?H.defaultView||H.parentWindow:window,X?(we=l.relatedTarget||l.toElement,X=$,we=we?ii(we):null,we!==null&&(ut=o(we),Ce=we.tag,we!==ut||Ce!==5&&Ce!==27&&Ce!==6)&&(we=null)):(X=null,we=$),X!==we)){if(Ce=vu,ne="onMouseLeave",B="onMouseEnter",j="mouse",(i==="pointerout"||i==="pointerover")&&(Ce=Li,ne="onPointerLeave",B="onPointerEnter",j="pointer"),ut=X==null?H:Yn(X),q=we==null?H:Yn(we),H=new Ce(ne,j+"leave",X,l,te),H.target=ut,H.relatedTarget=q,ne=null,ii(te)===$&&(Ce=new Ce(B,j+"enter",we,l,te),Ce.target=q,Ce.relatedTarget=ut,ne=Ce),ut=ne,X&&we)t:{for(Ce=SO,B=X,j=we,q=0,ne=B;ne;ne=Ce(ne))q++;ne=0;for(var xe=j;xe;xe=Ce(xe))ne++;for(;0<q-ne;)B=Ce(B),q--;for(;0<ne-q;)j=Ce(j),ne--;for(;q--;){if(B===j||j!==null&&B===j.alternate){Ce=B;break t}B=Ce(B),j=Ce(j)}Ce=null}else Ce=null;X!==null&&VT(re,H,X,Ce,!1),we!==null&&ut!==null&&VT(re,ut,we,Ce,!0)}}e:{if(H=$?Yn($):window,X=H.nodeName&&H.nodeName.toLowerCase(),X==="select"||X==="input"&&H.type==="file")var Qe=Xw;else if(Yw(H))if(Zw)Qe=VN;else{Qe=PN;var Ee=ON}else X=H.nodeName,!X||X.toLowerCase()!=="input"||H.type!=="checkbox"&&H.type!=="radio"?$&&nl($.elementType)&&(Qe=Xw):Qe=DN;if(Qe&&(Qe=Qe(i,$))){Jw(re,Qe,l,te);break e}Ee&&Ee(i,H,$),i==="focusout"&&$&&H.type==="number"&&$.memoizedProps.value!=null&&du(H,"number",H.value)}switch(Ee=$?Yn($):window,i){case"focusin":(Yw(Ee)||Ee.contentEditable==="true")&&(ul=Ee,Ep=$,Su=null);break;case"focusout":Su=Ep=ul=null;break;case"mousedown":Tp=!0;break;case"contextmenu":case"mouseup":case"dragend":Tp=!1,ob(re,l,te);break;case"selectionchange":if(jN)break;case"keydown":case"keyup":ob(re,l,te)}var je;if(Xe)e:{switch(i){case"compositionstart":var $e="onCompositionStart";break e;case"compositionend":$e="onCompositionEnd";break e;case"compositionupdate":$e="onCompositionUpdate";break e}$e=void 0}else cl?$a(i,l)&&($e="onCompositionEnd"):i==="keydown"&&l.keyCode===229&&($e="onCompositionStart");$e&&(mi&&l.locale!=="ko"&&(cl||$e!=="onCompositionStart"?$e==="onCompositionEnd"&&cl&&(je=yu()):(ui=te,pu="value"in ui?ui.value:ui.textContent,cl=!0)),Ee=Xf($,$e),0<Ee.length&&($e=new fi($e,i,null,l,te),re.push({event:$e,listeners:Ee}),je?$e.data=je:(je=ll(l),je!==null&&($e.data=je)))),(je=pr?RN(i,l):CN(i,l))&&($e=Xf($,"onBeforeInput"),0<$e.length&&(Ee=new fi("onBeforeInput","beforeinput",null,l,te),re.push({event:Ee,listeners:$e}),Ee.data=je)),wO(re,i,$,l,te)}PT(re,a)})}function Qu(i,a,l){return{instance:i,listener:a,currentTarget:l}}function Xf(i,a){for(var l=a+"Capture",u=[];i!==null;){var g=i,p=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||p===null||(g=Dr(i,l),g!=null&&u.unshift(Qu(i,g,p)),g=Dr(i,a),g!=null&&u.push(Qu(i,g,p))),i.tag===3)return u;i=i.return}return[]}function SO(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function VT(i,a,l,u,g){for(var p=a._reactName,b=[];l!==null&&l!==u;){var A=l,D=A.alternate,$=A.stateNode;if(A=A.tag,D!==null&&D===u)break;A!==5&&A!==26&&A!==27||$===null||(D=$,g?($=Dr(l,p),$!=null&&b.unshift(Qu(l,$,D))):g||($=Dr(l,p),$!=null&&b.push(Qu(l,$,D)))),l=l.return}b.length!==0&&i.push({event:a,listeners:b})}var AO=/\r\n?/g,IO=/\u0000|\uFFFD/g;function MT(i){return(typeof i=="string"?i:""+i).replace(AO,`
`).replace(IO,"")}function jT(i,a){return a=MT(a),MT(i)===a}function ct(i,a,l,u,g,p){switch(l){case"children":typeof u=="string"?a==="body"||a==="textarea"&&u===""||Un(i,u):(typeof u=="number"||typeof u=="bigint")&&a!=="body"&&Un(i,""+u);break;case"className":Jn(i,"class",u);break;case"tabIndex":Jn(i,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":Jn(i,l,u);break;case"style":mu(i,u,p);break;case"data":if(a!=="object"){Jn(i,"data",u);break}case"src":case"href":if(u===""&&(a!=="a"||l!=="href")){i.removeAttribute(l);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){i.removeAttribute(l);break}u=rl(""+u),i.setAttribute(l,u);break;case"action":case"formAction":if(typeof u=="function"){i.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof p=="function"&&(l==="formAction"?(a!=="input"&&ct(i,a,"name",g.name,g,null),ct(i,a,"formEncType",g.formEncType,g,null),ct(i,a,"formMethod",g.formMethod,g,null),ct(i,a,"formTarget",g.formTarget,g,null)):(ct(i,a,"encType",g.encType,g,null),ct(i,a,"method",g.method,g,null),ct(i,a,"target",g.target,g,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){i.removeAttribute(l);break}u=rl(""+u),i.setAttribute(l,u);break;case"onClick":u!=null&&(i.onclick=Pr);break;case"onScroll":u!=null&&Be("scroll",i);break;case"onScrollEnd":u!=null&&Be("scrollend",i);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(n(61));if(l=u.__html,l!=null){if(g.children!=null)throw Error(n(60));i.innerHTML=l}}break;case"multiple":i.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":i.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){i.removeAttribute("xlink:href");break}l=rl(""+u),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?i.setAttribute(l,""+u):i.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?i.setAttribute(l,""):i.removeAttribute(l);break;case"capture":case"download":u===!0?i.setAttribute(l,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?i.setAttribute(l,u):i.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?i.setAttribute(l,u):i.removeAttribute(l);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?i.removeAttribute(l):i.setAttribute(l,u);break;case"popover":Be("beforetoggle",i),Be("toggle",i),el(i,"popover",u);break;case"xlinkActuate":$t(i,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":$t(i,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":$t(i,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":$t(i,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":$t(i,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":$t(i,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":$t(i,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":$t(i,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":$t(i,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":el(i,"is",u);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=Jd.get(l)||l,el(i,l,u))}}function Wy(i,a,l,u,g,p){switch(l){case"style":mu(i,u,p);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(n(61));if(l=u.__html,l!=null){if(g.children!=null)throw Error(n(60));i.innerHTML=l}}break;case"children":typeof u=="string"?Un(i,u):(typeof u=="number"||typeof u=="bigint")&&Un(i,""+u);break;case"onScroll":u!=null&&Be("scroll",i);break;case"onScrollEnd":u!=null&&Be("scrollend",i);break;case"onClick":u!=null&&(i.onclick=Pr);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ou.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(g=l.endsWith("Capture"),a=l.slice(2,g?l.length-7:void 0),p=i[an]||null,p=p!=null?p[l]:null,typeof p=="function"&&i.removeEventListener(a,p,g),typeof u=="function")){typeof p!="function"&&p!==null&&(l in i?i[l]=null:i.hasAttribute(l)&&i.removeAttribute(l)),i.addEventListener(a,u,g);break e}l in i?i[l]=u:u===!0?i.setAttribute(l,""):el(i,l,u)}}}function yn(i,a,l){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Be("error",i),Be("load",i);var u=!1,g=!1,p;for(p in l)if(l.hasOwnProperty(p)){var b=l[p];if(b!=null)switch(p){case"src":u=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,a));default:ct(i,a,p,b,l,null)}}g&&ct(i,a,"srcSet",l.srcSet,l,null),u&&ct(i,a,"src",l.src,l,null);return;case"input":Be("invalid",i);var A=p=b=g=null,D=null,$=null;for(u in l)if(l.hasOwnProperty(u)){var te=l[u];if(te!=null)switch(u){case"name":g=te;break;case"type":b=te;break;case"checked":D=te;break;case"defaultChecked":$=te;break;case"value":p=te;break;case"defaultValue":A=te;break;case"children":case"dangerouslySetInnerHTML":if(te!=null)throw Error(n(137,a));break;default:ct(i,a,u,te,l,null)}}Wd(i,p,A,D,$,b,g,!1);return;case"select":Be("invalid",i),u=b=p=null;for(g in l)if(l.hasOwnProperty(g)&&(A=l[g],A!=null))switch(g){case"value":p=A;break;case"defaultValue":b=A;break;case"multiple":u=A;default:ct(i,a,g,A,l,null)}a=p,l=b,i.multiple=!!u,a!=null?ys(i,!!u,a,!1):l!=null&&ys(i,!!u,l,!0);return;case"textarea":Be("invalid",i),p=g=u=null;for(b in l)if(l.hasOwnProperty(b)&&(A=l[b],A!=null))switch(b){case"value":u=A;break;case"defaultValue":g=A;break;case"children":p=A;break;case"dangerouslySetInnerHTML":if(A!=null)throw Error(n(91));break;default:ct(i,a,b,A,l,null)}_s(i,u,g,p);return;case"option":for(D in l)if(l.hasOwnProperty(D)&&(u=l[D],u!=null))switch(D){case"selected":i.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:ct(i,a,D,u,l,null)}return;case"dialog":Be("beforetoggle",i),Be("toggle",i),Be("cancel",i),Be("close",i);break;case"iframe":case"object":Be("load",i);break;case"video":case"audio":for(u=0;u<Wu.length;u++)Be(Wu[u],i);break;case"image":Be("error",i),Be("load",i);break;case"details":Be("toggle",i);break;case"embed":case"source":case"link":Be("error",i),Be("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for($ in l)if(l.hasOwnProperty($)&&(u=l[$],u!=null))switch($){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,a));default:ct(i,a,$,u,l,null)}return;default:if(nl(a)){for(te in l)l.hasOwnProperty(te)&&(u=l[te],u!==void 0&&Wy(i,a,te,u,l,void 0));return}}for(A in l)l.hasOwnProperty(A)&&(u=l[A],u!=null&&ct(i,a,A,u,l,null))}function xO(i,a,l,u){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,p=null,b=null,A=null,D=null,$=null,te=null;for(X in l){var re=l[X];if(l.hasOwnProperty(X)&&re!=null)switch(X){case"checked":break;case"value":break;case"defaultValue":D=re;default:u.hasOwnProperty(X)||ct(i,a,X,null,u,re)}}for(var H in u){var X=u[H];if(re=l[H],u.hasOwnProperty(H)&&(X!=null||re!=null))switch(H){case"type":p=X;break;case"name":g=X;break;case"checked":$=X;break;case"defaultChecked":te=X;break;case"value":b=X;break;case"defaultValue":A=X;break;case"children":case"dangerouslySetInnerHTML":if(X!=null)throw Error(n(137,a));break;default:X!==re&&ct(i,a,H,X,u,re)}}tl(i,b,A,D,$,te,p,g);return;case"select":X=b=A=H=null;for(p in l)if(D=l[p],l.hasOwnProperty(p)&&D!=null)switch(p){case"value":break;case"multiple":X=D;default:u.hasOwnProperty(p)||ct(i,a,p,null,u,D)}for(g in u)if(p=u[g],D=l[g],u.hasOwnProperty(g)&&(p!=null||D!=null))switch(g){case"value":H=p;break;case"defaultValue":A=p;break;case"multiple":b=p;default:p!==D&&ct(i,a,g,p,u,D)}a=A,l=b,u=X,H!=null?ys(i,!!l,H,!1):!!u!=!!l&&(a!=null?ys(i,!!l,a,!0):ys(i,!!l,l?[]:"",!1));return;case"textarea":X=H=null;for(A in l)if(g=l[A],l.hasOwnProperty(A)&&g!=null&&!u.hasOwnProperty(A))switch(A){case"value":break;case"children":break;default:ct(i,a,A,null,u,g)}for(b in u)if(g=u[b],p=l[b],u.hasOwnProperty(b)&&(g!=null||p!=null))switch(b){case"value":H=g;break;case"defaultValue":X=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(n(91));break;default:g!==p&&ct(i,a,b,g,u,p)}Qd(i,H,X);return;case"option":for(var we in l)if(H=l[we],l.hasOwnProperty(we)&&H!=null&&!u.hasOwnProperty(we))switch(we){case"selected":i.selected=!1;break;default:ct(i,a,we,null,u,H)}for(D in u)if(H=u[D],X=l[D],u.hasOwnProperty(D)&&H!==X&&(H!=null||X!=null))switch(D){case"selected":i.selected=H&&typeof H!="function"&&typeof H!="symbol";break;default:ct(i,a,D,H,u,X)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ce in l)H=l[Ce],l.hasOwnProperty(Ce)&&H!=null&&!u.hasOwnProperty(Ce)&&ct(i,a,Ce,null,u,H);for($ in u)if(H=u[$],X=l[$],u.hasOwnProperty($)&&H!==X&&(H!=null||X!=null))switch($){case"children":case"dangerouslySetInnerHTML":if(H!=null)throw Error(n(137,a));break;default:ct(i,a,$,H,u,X)}return;default:if(nl(a)){for(var ut in l)H=l[ut],l.hasOwnProperty(ut)&&H!==void 0&&!u.hasOwnProperty(ut)&&Wy(i,a,ut,void 0,u,H);for(te in u)H=u[te],X=l[te],!u.hasOwnProperty(te)||H===X||H===void 0&&X===void 0||Wy(i,a,te,H,u,X);return}}for(var B in l)H=l[B],l.hasOwnProperty(B)&&H!=null&&!u.hasOwnProperty(B)&&ct(i,a,B,null,u,H);for(re in u)H=u[re],X=l[re],!u.hasOwnProperty(re)||H===X||H==null&&X==null||ct(i,a,re,H,u,X)}function LT(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function RO(){if(typeof performance.getEntriesByType=="function"){for(var i=0,a=0,l=performance.getEntriesByType("resource"),u=0;u<l.length;u++){var g=l[u],p=g.transferSize,b=g.initiatorType,A=g.duration;if(p&&A&&LT(b)){for(b=0,A=g.responseEnd,u+=1;u<l.length;u++){var D=l[u],$=D.startTime;if($>A)break;var te=D.transferSize,re=D.initiatorType;te&&LT(re)&&(D=D.responseEnd,b+=te*(D<A?1:(A-$)/(D-$)))}if(--u,a+=8*(p+b)/(g.duration/1e3),i++,10<i)break}}if(0<i)return a/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var Qy=null,Yy=null;function Zf(i){return i.nodeType===9?i:i.ownerDocument}function UT(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function BT(i,a){if(i===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&a==="foreignObject"?0:i}function Jy(i,a){return i==="textarea"||i==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var Xy=null;function CO(){var i=window.event;return i&&i.type==="popstate"?i===Xy?!1:(Xy=i,!0):(Xy=null,!1)}var FT=typeof setTimeout=="function"?setTimeout:void 0,kO=typeof clearTimeout=="function"?clearTimeout:void 0,zT=typeof Promise=="function"?Promise:void 0,NO=typeof queueMicrotask=="function"?queueMicrotask:typeof zT<"u"?function(i){return zT.resolve(null).then(i).catch(OO)}:FT;function OO(i){setTimeout(function(){throw i})}function Fs(i){return i==="head"}function qT(i,a){var l=a,u=0;do{var g=l.nextSibling;if(i.removeChild(l),g&&g.nodeType===8)if(l=g.data,l==="/$"||l==="/&"){if(u===0){i.removeChild(g),jl(a);return}u--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")u++;else if(l==="html")Yu(i.ownerDocument.documentElement);else if(l==="head"){l=i.ownerDocument.head,Yu(l);for(var p=l.firstChild;p;){var b=p.nextSibling,A=p.nodeName;p[ri]||A==="SCRIPT"||A==="STYLE"||A==="LINK"&&p.rel.toLowerCase()==="stylesheet"||l.removeChild(p),p=b}}else l==="body"&&Yu(i.ownerDocument.body);l=g}while(l);jl(a)}function $T(i,a){var l=i;i=0;do{var u=l.nextSibling;if(l.nodeType===1?a?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(a?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),u&&u.nodeType===8)if(l=u.data,l==="/$"){if(i===0)break;i--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||i++;l=u}while(l)}function Zy(i){var a=i.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var l=a;switch(a=a.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":Zy(l),Zo(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}i.removeChild(l)}}function PO(i,a,l,u){for(;i.nodeType===1;){var g=l;if(i.nodeName.toLowerCase()!==a.toLowerCase()){if(!u&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(u){if(!i[ri])switch(a){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(p=i.getAttribute("rel"),p==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(p!==g.rel||i.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||i.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||i.getAttribute("title")!==(g.title==null?null:g.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(p=i.getAttribute("src"),(p!==(g.src==null?null:g.src)||i.getAttribute("type")!==(g.type==null?null:g.type)||i.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&p&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(a==="input"&&i.type==="hidden"){var p=g.name==null?null:""+g.name;if(g.type==="hidden"&&i.getAttribute("name")===p)return i}else return i;if(i=Tr(i.nextSibling),i===null)break}return null}function DO(i,a,l){if(a==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!l||(i=Tr(i.nextSibling),i===null))return null;return i}function HT(i,a){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!a||(i=Tr(i.nextSibling),i===null))return null;return i}function e_(i){return i.data==="$?"||i.data==="$~"}function t_(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function VO(i,a){var l=i.ownerDocument;if(i.data==="$~")i._reactRetry=a;else if(i.data!=="$?"||l.readyState!=="loading")a();else{var u=function(){a(),l.removeEventListener("DOMContentLoaded",u)};l.addEventListener("DOMContentLoaded",u),i._reactRetry=u}}function Tr(i){for(;i!=null;i=i.nextSibling){var a=i.nodeType;if(a===1||a===3)break;if(a===8){if(a=i.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return i}var n_=null;function GT(i){i=i.nextSibling;for(var a=0;i;){if(i.nodeType===8){var l=i.data;if(l==="/$"||l==="/&"){if(a===0)return Tr(i.nextSibling);a--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||a++}i=i.nextSibling}return null}function KT(i){i=i.previousSibling;for(var a=0;i;){if(i.nodeType===8){var l=i.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(a===0)return i;a--}else l!=="/$"&&l!=="/&"||a++}i=i.previousSibling}return null}function WT(i,a,l){switch(a=Zf(l),i){case"html":if(i=a.documentElement,!i)throw Error(n(452));return i;case"head":if(i=a.head,!i)throw Error(n(453));return i;case"body":if(i=a.body,!i)throw Error(n(454));return i;default:throw Error(n(451))}}function Yu(i){for(var a=i.attributes;a.length;)i.removeAttributeNode(a[0]);Zo(i)}var Sr=new Map,QT=new Set;function em(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var Zi=ue.d;ue.d={f:MO,r:jO,D:LO,C:UO,L:BO,m:FO,X:qO,S:zO,M:$O};function MO(){var i=Zi.f(),a=Hf();return i||a}function jO(i){var a=fr(i);a!==null&&a.tag===5&&a.type==="form"?dE(a):Zi.r(i)}var Dl=typeof document>"u"?null:document;function YT(i,a,l){var u=Dl;if(u&&typeof a=="string"&&a){var g=Ln(a);g='link[rel="'+i+'"][href="'+g+'"]',typeof l=="string"&&(g+='[crossorigin="'+l+'"]'),QT.has(g)||(QT.add(g),i={rel:i,crossOrigin:l,href:a},u.querySelector(g)===null&&(a=u.createElement("link"),yn(a,"link",i),qt(a),u.head.appendChild(a)))}}function LO(i){Zi.D(i),YT("dns-prefetch",i,null)}function UO(i,a){Zi.C(i,a),YT("preconnect",i,a)}function BO(i,a,l){Zi.L(i,a,l);var u=Dl;if(u&&i&&a){var g='link[rel="preload"][as="'+Ln(a)+'"]';a==="image"&&l&&l.imageSrcSet?(g+='[imagesrcset="'+Ln(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(g+='[imagesizes="'+Ln(l.imageSizes)+'"]')):g+='[href="'+Ln(i)+'"]';var p=g;switch(a){case"style":p=Vl(i);break;case"script":p=Ml(i)}Sr.has(p)||(i=_({rel:"preload",href:a==="image"&&l&&l.imageSrcSet?void 0:i,as:a},l),Sr.set(p,i),u.querySelector(g)!==null||a==="style"&&u.querySelector(Ju(p))||a==="script"&&u.querySelector(Xu(p))||(a=u.createElement("link"),yn(a,"link",i),qt(a),u.head.appendChild(a)))}}function FO(i,a){Zi.m(i,a);var l=Dl;if(l&&i){var u=a&&typeof a.as=="string"?a.as:"script",g='link[rel="modulepreload"][as="'+Ln(u)+'"][href="'+Ln(i)+'"]',p=g;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":p=Ml(i)}if(!Sr.has(p)&&(i=_({rel:"modulepreload",href:i},a),Sr.set(p,i),l.querySelector(g)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(Xu(p)))return}u=l.createElement("link"),yn(u,"link",i),qt(u),l.head.appendChild(u)}}}function zO(i,a,l){Zi.S(i,a,l);var u=Dl;if(u&&i){var g=si(u).hoistableStyles,p=Vl(i);a=a||"default";var b=g.get(p);if(!b){var A={loading:0,preload:null};if(b=u.querySelector(Ju(p)))A.loading=5;else{i=_({rel:"stylesheet",href:i,"data-precedence":a},l),(l=Sr.get(p))&&r_(i,l);var D=b=u.createElement("link");qt(D),yn(D,"link",i),D._p=new Promise(function($,te){D.onload=$,D.onerror=te}),D.addEventListener("load",function(){A.loading|=1}),D.addEventListener("error",function(){A.loading|=2}),A.loading|=4,tm(b,a,u)}b={type:"stylesheet",instance:b,count:1,state:A},g.set(p,b)}}}function qO(i,a){Zi.X(i,a);var l=Dl;if(l&&i){var u=si(l).hoistableScripts,g=Ml(i),p=u.get(g);p||(p=l.querySelector(Xu(g)),p||(i=_({src:i,async:!0},a),(a=Sr.get(g))&&i_(i,a),p=l.createElement("script"),qt(p),yn(p,"link",i),l.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},u.set(g,p))}}function $O(i,a){Zi.M(i,a);var l=Dl;if(l&&i){var u=si(l).hoistableScripts,g=Ml(i),p=u.get(g);p||(p=l.querySelector(Xu(g)),p||(i=_({src:i,async:!0,type:"module"},a),(a=Sr.get(g))&&i_(i,a),p=l.createElement("script"),qt(p),yn(p,"link",i),l.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},u.set(g,p))}}function JT(i,a,l,u){var g=(g=Ne.current)?em(g):null;if(!g)throw Error(n(446));switch(i){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(a=Vl(l.href),l=si(g).hoistableStyles,u=l.get(a),u||(u={type:"style",instance:null,count:0,state:null},l.set(a,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){i=Vl(l.href);var p=si(g).hoistableStyles,b=p.get(i);if(b||(g=g.ownerDocument||g,b={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},p.set(i,b),(p=g.querySelector(Ju(i)))&&!p._p&&(b.instance=p,b.state.loading=5),Sr.has(i)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},Sr.set(i,l),p||HO(g,i,l,b.state))),a&&u===null)throw Error(n(528,""));return b}if(a&&u!==null)throw Error(n(529,""));return null;case"script":return a=l.async,l=l.src,typeof l=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Ml(l),l=si(g).hoistableScripts,u=l.get(a),u||(u={type:"script",instance:null,count:0,state:null},l.set(a,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,i))}}function Vl(i){return'href="'+Ln(i)+'"'}function Ju(i){return'link[rel="stylesheet"]['+i+"]"}function XT(i){return _({},i,{"data-precedence":i.precedence,precedence:null})}function HO(i,a,l,u){i.querySelector('link[rel="preload"][as="style"]['+a+"]")?u.loading=1:(a=i.createElement("link"),u.preload=a,a.addEventListener("load",function(){return u.loading|=1}),a.addEventListener("error",function(){return u.loading|=2}),yn(a,"link",l),qt(a),i.head.appendChild(a))}function Ml(i){return'[src="'+Ln(i)+'"]'}function Xu(i){return"script[async]"+i}function ZT(i,a,l){if(a.count++,a.instance===null)switch(a.type){case"style":var u=i.querySelector('style[data-href~="'+Ln(l.href)+'"]');if(u)return a.instance=u,qt(u),u;var g=_({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return u=(i.ownerDocument||i).createElement("style"),qt(u),yn(u,"style",g),tm(u,l.precedence,i),a.instance=u;case"stylesheet":g=Vl(l.href);var p=i.querySelector(Ju(g));if(p)return a.state.loading|=4,a.instance=p,qt(p),p;u=XT(l),(g=Sr.get(g))&&r_(u,g),p=(i.ownerDocument||i).createElement("link"),qt(p);var b=p;return b._p=new Promise(function(A,D){b.onload=A,b.onerror=D}),yn(p,"link",u),a.state.loading|=4,tm(p,l.precedence,i),a.instance=p;case"script":return p=Ml(l.src),(g=i.querySelector(Xu(p)))?(a.instance=g,qt(g),g):(u=l,(g=Sr.get(p))&&(u=_({},l),i_(u,g)),i=i.ownerDocument||i,g=i.createElement("script"),qt(g),yn(g,"link",u),i.head.appendChild(g),a.instance=g);case"void":return null;default:throw Error(n(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(u=a.instance,a.state.loading|=4,tm(u,l.precedence,i));return a.instance}function tm(i,a,l){for(var u=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=u.length?u[u.length-1]:null,p=g,b=0;b<u.length;b++){var A=u[b];if(A.dataset.precedence===a)p=A;else if(p!==g)break}p?p.parentNode.insertBefore(i,p.nextSibling):(a=l.nodeType===9?l.head:l,a.insertBefore(i,a.firstChild))}function r_(i,a){i.crossOrigin==null&&(i.crossOrigin=a.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=a.referrerPolicy),i.title==null&&(i.title=a.title)}function i_(i,a){i.crossOrigin==null&&(i.crossOrigin=a.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=a.referrerPolicy),i.integrity==null&&(i.integrity=a.integrity)}var nm=null;function eS(i,a,l){if(nm===null){var u=new Map,g=nm=new Map;g.set(l,u)}else g=nm,u=g.get(l),u||(u=new Map,g.set(l,u));if(u.has(i))return u;for(u.set(i,null),l=l.getElementsByTagName(i),g=0;g<l.length;g++){var p=l[g];if(!(p[ri]||p[zt]||i==="link"&&p.getAttribute("rel")==="stylesheet")&&p.namespaceURI!=="http://www.w3.org/2000/svg"){var b=p.getAttribute(a)||"";b=i+b;var A=u.get(b);A?A.push(p):u.set(b,[p])}}return u}function tS(i,a,l){i=i.ownerDocument||i,i.head.insertBefore(l,a==="title"?i.querySelector("head > title"):null)}function GO(i,a,l){if(l===1||a.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return i=a.disabled,typeof a.precedence=="string"&&i==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function nS(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function KO(i,a,l,u){if(l.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var g=Vl(u.href),p=a.querySelector(Ju(g));if(p){a=p._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(i.count++,i=rm.bind(i),a.then(i,i)),l.state.loading|=4,l.instance=p,qt(p);return}p=a.ownerDocument||a,u=XT(u),(g=Sr.get(g))&&r_(u,g),p=p.createElement("link"),qt(p);var b=p;b._p=new Promise(function(A,D){b.onload=A,b.onerror=D}),yn(p,"link",u),l.instance=p}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(l,a),(a=l.state.preload)&&(l.state.loading&3)===0&&(i.count++,l=rm.bind(i),a.addEventListener("load",l),a.addEventListener("error",l))}}var s_=0;function WO(i,a){return i.stylesheets&&i.count===0&&sm(i,i.stylesheets),0<i.count||0<i.imgCount?function(l){var u=setTimeout(function(){if(i.stylesheets&&sm(i,i.stylesheets),i.unsuspend){var p=i.unsuspend;i.unsuspend=null,p()}},6e4+a);0<i.imgBytes&&s_===0&&(s_=62500*RO());var g=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&sm(i,i.stylesheets),i.unsuspend)){var p=i.unsuspend;i.unsuspend=null,p()}},(i.imgBytes>s_?50:800)+a);return i.unsuspend=l,function(){i.unsuspend=null,clearTimeout(u),clearTimeout(g)}}:null}function rm(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)sm(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var im=null;function sm(i,a){i.stylesheets=null,i.unsuspend!==null&&(i.count++,im=new Map,a.forEach(QO,i),im=null,rm.call(i))}function QO(i,a){if(!(a.state.loading&4)){var l=im.get(i);if(l)var u=l.get(null);else{l=new Map,im.set(i,l);for(var g=i.querySelectorAll("link[data-precedence],style[data-precedence]"),p=0;p<g.length;p++){var b=g[p];(b.nodeName==="LINK"||b.getAttribute("media")!=="not all")&&(l.set(b.dataset.precedence,b),u=b)}u&&l.set(null,u)}g=a.instance,b=g.getAttribute("data-precedence"),p=l.get(b)||u,p===u&&l.set(null,g),l.set(b,g),this.count++,u=rm.bind(this),g.addEventListener("load",u),g.addEventListener("error",u),p?p.parentNode.insertBefore(g,p.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(g,i.firstChild)),a.state.loading|=4}}var Zu={$$typeof:K,Provider:null,Consumer:null,_currentValue:oe,_currentValue2:oe,_threadCount:0};function YO(i,a,l,u,g,p,b,A,D){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ti(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ti(0),this.hiddenUpdates=ti(null),this.identifierPrefix=u,this.onUncaughtError=g,this.onCaughtError=p,this.onRecoverableError=b,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=D,this.incompleteTransitions=new Map}function rS(i,a,l,u,g,p,b,A,D,$,te,re){return i=new YO(i,a,l,b,D,$,te,re,A),a=1,p===!0&&(a|=24),p=Zn(3,null,null,a),i.current=p,p.stateNode=i,a=Lp(),a.refCount++,i.pooledCache=a,a.refCount++,p.memoizedState={element:u,isDehydrated:l,cache:a},zp(p),i}function iS(i){return i?(i=fl,i):fl}function sS(i,a,l,u,g,p){g=iS(g),u.context===null?u.context=g:u.pendingContext=g,u=ks(a),u.payload={element:l},p=p===void 0?null:p,p!==null&&(u.callback=p),l=Ns(i,u,a),l!==null&&($n(l,i,a),Nu(l,i,a))}function aS(i,a){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var l=i.retryLane;i.retryLane=l!==0&&l<a?l:a}}function a_(i,a){aS(i,a),(i=i.alternate)&&aS(i,a)}function oS(i){if(i.tag===13||i.tag===31){var a=Ka(i,67108864);a!==null&&$n(a,i,67108864),a_(i,67108864)}}function lS(i){if(i.tag===13||i.tag===31){var a=ir();a=Va(a);var l=Ka(i,a);l!==null&&$n(l,i,a),a_(i,a)}}var am=!0;function JO(i,a,l,u){var g=ee.T;ee.T=null;var p=ue.p;try{ue.p=2,o_(i,a,l,u)}finally{ue.p=p,ee.T=g}}function XO(i,a,l,u){var g=ee.T;ee.T=null;var p=ue.p;try{ue.p=8,o_(i,a,l,u)}finally{ue.p=p,ee.T=g}}function o_(i,a,l,u){if(am){var g=l_(u);if(g===null)Ky(i,a,u,om,l),uS(i,u);else if(eP(g,i,a,l,u))u.stopPropagation();else if(uS(i,u),a&4&&-1<ZO.indexOf(i)){for(;g!==null;){var p=fr(g);if(p!==null)switch(p.tag){case 3:if(p=p.stateNode,p.current.memoizedState.isDehydrated){var b=Zr(p.pendingLanes);if(b!==0){var A=p;for(A.pendingLanes|=2,A.entangledLanes|=2;b;){var D=1<<31-Pt(b);A.entanglements[1]|=D,b&=~D}_i(p),(Ze&6)===0&&(qf=Cn()+500,Ku(0))}}break;case 31:case 13:A=Ka(p,2),A!==null&&$n(A,p,2),Hf(),a_(p,2)}if(p=l_(u),p===null&&Ky(i,a,u,om,l),p===g)break;g=p}g!==null&&u.stopPropagation()}else Ky(i,a,u,null,l)}}function l_(i){return i=mr(i),c_(i)}var om=null;function c_(i){if(om=null,i=ii(i),i!==null){var a=o(i);if(a===null)i=null;else{var l=a.tag;if(l===13){if(i=c(a),i!==null)return i;i=null}else if(l===31){if(i=h(a),i!==null)return i;i=null}else if(l===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;i=null}else a!==i&&(i=null)}}return om=i,null}function cS(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Na()){case nu:return 2;case ru:return 8;case gs:case gp:return 32;case Ld:return 268435456;default:return 32}default:return 32}}var u_=!1,zs=null,qs=null,$s=null,eh=new Map,th=new Map,Hs=[],ZO="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function uS(i,a){switch(i){case"focusin":case"focusout":zs=null;break;case"dragenter":case"dragleave":qs=null;break;case"mouseover":case"mouseout":$s=null;break;case"pointerover":case"pointerout":eh.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":th.delete(a.pointerId)}}function nh(i,a,l,u,g,p){return i===null||i.nativeEvent!==p?(i={blockedOn:a,domEventName:l,eventSystemFlags:u,nativeEvent:p,targetContainers:[g]},a!==null&&(a=fr(a),a!==null&&oS(a)),i):(i.eventSystemFlags|=u,a=i.targetContainers,g!==null&&a.indexOf(g)===-1&&a.push(g),i)}function eP(i,a,l,u,g){switch(a){case"focusin":return zs=nh(zs,i,a,l,u,g),!0;case"dragenter":return qs=nh(qs,i,a,l,u,g),!0;case"mouseover":return $s=nh($s,i,a,l,u,g),!0;case"pointerover":var p=g.pointerId;return eh.set(p,nh(eh.get(p)||null,i,a,l,u,g)),!0;case"gotpointercapture":return p=g.pointerId,th.set(p,nh(th.get(p)||null,i,a,l,u,g)),!0}return!1}function hS(i){var a=ii(i.target);if(a!==null){var l=o(a);if(l!==null){if(a=l.tag,a===13){if(a=c(l),a!==null){i.blockedOn=a,Nr(i.priority,function(){lS(l)});return}}else if(a===31){if(a=h(l),a!==null){i.blockedOn=a,Nr(i.priority,function(){lS(l)});return}}else if(a===3&&l.stateNode.current.memoizedState.isDehydrated){i.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}i.blockedOn=null}function lm(i){if(i.blockedOn!==null)return!1;for(var a=i.targetContainers;0<a.length;){var l=l_(i.nativeEvent);if(l===null){l=i.nativeEvent;var u=new l.constructor(l.type,l);gu=u,l.target.dispatchEvent(u),gu=null}else return a=fr(l),a!==null&&oS(a),i.blockedOn=l,!1;a.shift()}return!0}function dS(i,a,l){lm(i)&&l.delete(a)}function tP(){u_=!1,zs!==null&&lm(zs)&&(zs=null),qs!==null&&lm(qs)&&(qs=null),$s!==null&&lm($s)&&($s=null),eh.forEach(dS),th.forEach(dS)}function cm(i,a){i.blockedOn===a&&(i.blockedOn=null,u_||(u_=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,tP)))}var um=null;function fS(i){um!==i&&(um=i,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){um===i&&(um=null);for(var a=0;a<i.length;a+=3){var l=i[a],u=i[a+1],g=i[a+2];if(typeof u!="function"){if(c_(u||l)===null)continue;break}var p=fr(l);p!==null&&(i.splice(a,3),a-=3,ly(p,{pending:!0,data:g,method:l.method,action:u},u,g))}}))}function jl(i){function a(D){return cm(D,i)}zs!==null&&cm(zs,i),qs!==null&&cm(qs,i),$s!==null&&cm($s,i),eh.forEach(a),th.forEach(a);for(var l=0;l<Hs.length;l++){var u=Hs[l];u.blockedOn===i&&(u.blockedOn=null)}for(;0<Hs.length&&(l=Hs[0],l.blockedOn===null);)hS(l),l.blockedOn===null&&Hs.shift();if(l=(i.ownerDocument||i).$$reactFormReplay,l!=null)for(u=0;u<l.length;u+=3){var g=l[u],p=l[u+1],b=g[an]||null;if(typeof p=="function")b||fS(l);else if(b){var A=null;if(p&&p.hasAttribute("formAction")){if(g=p,b=p[an]||null)A=b.formAction;else if(c_(g)!==null)continue}else A=b.action;typeof A=="function"?l[u+1]=A:(l.splice(u,3),u-=3),fS(l)}}}function mS(){function i(p){p.canIntercept&&p.info==="react-transition"&&p.intercept({handler:function(){return new Promise(function(b){return g=b})},focusReset:"manual",scroll:"manual"})}function a(){g!==null&&(g(),g=null),u||setTimeout(l,20)}function l(){if(!u&&!navigation.transition){var p=navigation.currentEntry;p&&p.url!=null&&navigation.navigate(p.url,{state:p.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var u=!1,g=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(l,100),function(){u=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),g!==null&&(g(),g=null)}}}function h_(i){this._internalRoot=i}hm.prototype.render=h_.prototype.render=function(i){var a=this._internalRoot;if(a===null)throw Error(n(409));var l=a.current,u=ir();sS(l,u,i,a,null,null)},hm.prototype.unmount=h_.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var a=i.containerInfo;sS(i.current,2,null,i,null,null),Hf(),a[ni]=null}};function hm(i){this._internalRoot=i}hm.prototype.unstable_scheduleHydration=function(i){if(i){var a=$d();i={blockedOn:null,target:i,priority:a};for(var l=0;l<Hs.length&&a!==0&&a<Hs[l].priority;l++);Hs.splice(l,0,i),l===0&&hS(i)}};var gS=e.version;if(gS!=="19.2.0")throw Error(n(527,gS,"19.2.0"));ue.findDOMNode=function(i){var a=i._reactInternals;if(a===void 0)throw typeof i.render=="function"?Error(n(188)):(i=Object.keys(i).join(","),Error(n(268,i)));return i=m(a),i=i!==null?y(i):null,i=i===null?null:i.stateNode,i};var nP={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:ee,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var dm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!dm.isDisabled&&dm.supportsFiber)try{Cr=dm.inject(nP),dn=dm}catch{}}return ih.createRoot=function(i,a){if(!s(i))throw Error(n(299));var l=!1,u="",g=EE,p=TE,b=SE;return a!=null&&(a.unstable_strictMode===!0&&(l=!0),a.identifierPrefix!==void 0&&(u=a.identifierPrefix),a.onUncaughtError!==void 0&&(g=a.onUncaughtError),a.onCaughtError!==void 0&&(p=a.onCaughtError),a.onRecoverableError!==void 0&&(b=a.onRecoverableError)),a=rS(i,1,!1,null,null,l,u,null,g,p,b,mS),i[ni]=a.current,Gy(i),new h_(a)},ih.hydrateRoot=function(i,a,l){if(!s(i))throw Error(n(299));var u=!1,g="",p=EE,b=TE,A=SE,D=null;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(g=l.identifierPrefix),l.onUncaughtError!==void 0&&(p=l.onUncaughtError),l.onCaughtError!==void 0&&(b=l.onCaughtError),l.onRecoverableError!==void 0&&(A=l.onRecoverableError),l.formState!==void 0&&(D=l.formState)),a=rS(i,1,!0,a,l??null,u,g,D,p,b,A,mS),a.context=iS(null),l=a.current,u=ir(),u=Va(u),g=ks(u),g.callback=null,Ns(l,g,u),l=u,a.current.lanes=l,Pa(a,l),_i(a),i[ni]=a.current,Gy(i),new hm(a)},ih.version="19.2.0",ih}var AS;function fP(){if(AS)return m_.exports;AS=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),m_.exports=dP(),m_.exports}var mP=fP();const gP=e0(mP);/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pP=()=>{};var IS={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mx=function(r){const e=[];let t=0;for(let n=0;n<r.length;n++){let s=r.charCodeAt(n);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&n+1<r.length&&(r.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(r.charCodeAt(++n)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},yP=function(r){const e=[];let t=0,n=0;for(;t<r.length;){const s=r[t++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const o=r[t++];e[n++]=String.fromCharCode((s&31)<<6|o&63)}else if(s>239&&s<365){const o=r[t++],c=r[t++],h=r[t++],d=((s&7)<<18|(o&63)<<12|(c&63)<<6|h&63)-65536;e[n++]=String.fromCharCode(55296+(d>>10)),e[n++]=String.fromCharCode(56320+(d&1023))}else{const o=r[t++],c=r[t++];e[n++]=String.fromCharCode((s&15)<<12|(o&63)<<6|c&63)}}return e.join("")},gx={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(r,e){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<r.length;s+=3){const o=r[s],c=s+1<r.length,h=c?r[s+1]:0,d=s+2<r.length,m=d?r[s+2]:0,y=o>>2,_=(o&3)<<4|h>>4;let E=(h&15)<<2|m>>6,S=m&63;d||(S=64,c||(E=64)),n.push(t[y],t[_],t[E],t[S])}return n.join("")},encodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(r):this.encodeByteArray(mx(r),e)},decodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(r):yP(this.decodeStringToByteArray(r,e))},decodeStringToByteArray(r,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<r.length;){const o=t[r.charAt(s++)],h=s<r.length?t[r.charAt(s)]:0;++s;const m=s<r.length?t[r.charAt(s)]:64;++s;const _=s<r.length?t[r.charAt(s)]:64;if(++s,o==null||h==null||m==null||_==null)throw new _P;const E=o<<2|h>>4;if(n.push(E),m!==64){const S=h<<4&240|m>>2;if(n.push(S),_!==64){const C=m<<6&192|_;n.push(C)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};class _P extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const vP=function(r){const e=mx(r);return gx.encodeByteArray(e,!0)},Km=function(r){return vP(r).replace(/\./g,"")},n0=function(r){try{return gx.decodeString(r,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Wm(r,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:r===void 0&&(r={});break;case Array:r=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!wP(t)||(r[t]=Wm(r[t],e[t]));return r}function wP(r){return r!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r0(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bP=()=>r0().__FIREBASE_DEFAULTS__,EP=()=>{if(typeof process>"u"||typeof IS>"u")return;const r=IS.__FIREBASE_DEFAULTS__;if(r)return JSON.parse(r)},TP=()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=r&&n0(r[1]);return e&&JSON.parse(e)},i0=()=>{try{return pP()||bP()||EP()||TP()}catch(r){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`);return}},s0=()=>{var r;return(r=i0())==null?void 0:r.config},SP=r=>{var e;return(e=i0())==null?void 0:e[`_${r}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let AP=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}};/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jc(r){try{return(r.startsWith("http://")||r.startsWith("https://")?new URL(r).hostname:r).endsWith(".cloudworkstations.dev")}catch{return!1}}async function px(r){return(await fetch(r,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IP(r,e){if(r.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},n=e||"demo-project",s=r.iat||0,o=r.sub||r.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const c={iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...r};return[Km(JSON.stringify(t)),Km(JSON.stringify(c)),""].join(".")}const Th={};function xP(){const r={prod:[],emulator:[]};for(const e of Object.keys(Th))Th[e]?r.emulator.push(e):r.prod.push(e);return r}function RP(r){let e=document.getElementById(r),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",r),t=!0),{created:t,element:e}}let xS=!1;function yx(r,e){if(typeof window>"u"||typeof document>"u"||!jc(window.location.host)||Th[r]===e||Th[r]||xS)return;Th[r]=e;function t(E){return`__firebase__banner__${E}`}const n="__firebase__banner",o=xP().prod.length>0;function c(){const E=document.getElementById(n);E&&E.remove()}function h(E){E.style.display="flex",E.style.background="#7faaf0",E.style.position="fixed",E.style.bottom="5px",E.style.left="5px",E.style.padding=".5em",E.style.borderRadius="5px",E.style.alignItems="center"}function d(E,S){E.setAttribute("width","24"),E.setAttribute("id",S),E.setAttribute("height","24"),E.setAttribute("viewBox","0 0 24 24"),E.setAttribute("fill","none"),E.style.marginLeft="-6px"}function m(){const E=document.createElement("span");return E.style.cursor="pointer",E.style.marginLeft="16px",E.style.fontSize="24px",E.innerHTML=" &times;",E.onclick=()=>{xS=!0,c()},E}function y(E,S){E.setAttribute("id",S),E.innerText="Learn more",E.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",E.setAttribute("target","__blank"),E.style.paddingLeft="5px",E.style.textDecoration="underline"}function _(){const E=RP(n),S=t("text"),C=document.getElementById(S)||document.createElement("span"),k=t("learnmore"),N=document.getElementById(k)||document.createElement("a"),G=t("preprendIcon"),J=document.getElementById(G)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(E.created){const K=E.element;h(K),y(N,k);const se=m();d(J,G),K.append(J,C,N,se),document.body.appendChild(K)}o?(C.innerText="Preview backend disconnected.",J.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(J.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,C.innerText="Preview backend running in this workspace."),C.setAttribute("id",S)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",_):_()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function It(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function CP(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(It())}function Ag(){var e;const r=(e=i0())==null?void 0:e.forceEnvironment;if(r==="node")return!0;if(r==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function kP(){return typeof window<"u"||_x()}function _x(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function NP(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function vx(){const r=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof r=="object"&&r.id!==void 0}function a0(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function wx(){const r=It();return r.indexOf("MSIE ")>=0||r.indexOf("Trident/")>=0}function bx(){return!Ag()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Ex(){return!Ag()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function Fh(){try{return typeof indexedDB=="object"}catch{return!1}}function OP(){return new Promise((r,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(n),r(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var o;e(((o=s.error)==null?void 0:o.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PP="FirebaseError";class Vn extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=PP,Object.setPrototypeOf(this,Vn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Fo.prototype.create)}}class Fo{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},s=`${this.service}/${e}`,o=this.errors[e],c=o?DP(o,n):"Error",h=`${this.serviceName}: ${c} (${s}).`;return new Vn(s,h,n)}}function DP(r,e){return r.replace(VP,(t,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const VP=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RS(r,e){return Object.prototype.hasOwnProperty.call(r,e)}function MP(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}function ca(r,e){if(r===e)return!0;const t=Object.keys(r),n=Object.keys(e);for(const s of t){if(!n.includes(s))return!1;const o=r[s],c=e[s];if(CS(o)&&CS(c)){if(!ca(o,c))return!1}else if(o!==c)return!1}for(const s of n)if(!t.includes(s))return!1;return!0}function CS(r){return r!==null&&typeof r=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lc(r){const e=[];for(const[t,n]of Object.entries(r))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function ic(r){const e={};return r.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[s,o]=n.split("=");e[decodeURIComponent(s)]=decodeURIComponent(o)}}),e}function mh(r){const e=r.indexOf("?");if(!e)return"";const t=r.indexOf("#",e);return r.substring(e,t>0?t:void 0)}function Tx(r,e){const t=new jP(r,e);return t.subscribe.bind(t)}class jP{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let s;if(e===void 0&&t===void 0&&n===void 0)throw new Error("Missing Observer.");LP(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:n},s.next===void 0&&(s.next=__),s.error===void 0&&(s.error=__),s.complete===void 0&&(s.complete=__);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function LP(r,e){if(typeof r!="object"||r===null)return!1;for(const t of e)if(t in r&&typeof r[t]=="function")return!0;return!1}function __(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Re(r){return r&&r._delegate?r._delegate:r}class Ni{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const co="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UP{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new AP;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),n=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(s){if(n)return null;throw s}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(FP(e))try{this.getOrInitializeService({instanceIdentifier:co})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:s});n.resolve(o)}catch{}}}}clearInstance(e=co){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=co){return this.instances.has(e)}getOptions(e=co){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[o,c]of this.instancesDeferred.entries()){const h=this.normalizeInstanceIdentifier(o);n===h&&c.resolve(s)}return s}onInit(e,t){const n=this.normalizeInstanceIdentifier(t),s=this.onInitCallbacks.get(n)??new Set;s.add(e),this.onInitCallbacks.set(n,s);const o=this.instances.get(n);return o&&e(o,n),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const s of n)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:BP(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=co){return this.component?this.component.multipleInstances?e:co:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function BP(r){return r===co?void 0:r}function FP(r){return r.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sx{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new UP(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o0=[];var Fe;(function(r){r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT"})(Fe||(Fe={}));const Ax={debug:Fe.DEBUG,verbose:Fe.VERBOSE,info:Fe.INFO,warn:Fe.WARN,error:Fe.ERROR,silent:Fe.SILENT},zP=Fe.INFO,qP={[Fe.DEBUG]:"log",[Fe.VERBOSE]:"log",[Fe.INFO]:"info",[Fe.WARN]:"warn",[Fe.ERROR]:"error"},$P=(r,e,...t)=>{if(e<r.logLevel)return;const n=new Date().toISOString(),s=qP[e];if(s)console[s](`[${n}]  ${r.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ig{constructor(e){this.name=e,this._logLevel=zP,this._logHandler=$P,this._userLogHandler=null,o0.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Fe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Ax[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Fe.DEBUG,...e),this._logHandler(this,Fe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Fe.VERBOSE,...e),this._logHandler(this,Fe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Fe.INFO,...e),this._logHandler(this,Fe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Fe.WARN,...e),this._logHandler(this,Fe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Fe.ERROR,...e),this._logHandler(this,Fe.ERROR,...e)}}function HP(r){o0.forEach(e=>{e.setLogLevel(r)})}function GP(r,e){for(const t of o0){let n=null;e&&e.level&&(n=Ax[e.level]),r===null?t.userLogHandler=null:t.userLogHandler=(s,o,...c)=>{const h=c.map(d=>{if(d==null)return null;if(typeof d=="string")return d;if(typeof d=="number"||typeof d=="boolean")return d.toString();if(d instanceof Error)return d.message;try{return JSON.stringify(d)}catch{return null}}).filter(d=>d).join(" ");o>=(n??s.logLevel)&&r({level:Fe[o].toLowerCase(),message:h,args:c,type:s.name})}}}const KP=(r,e)=>e.some(t=>r instanceof t);let kS,NS;function WP(){return kS||(kS=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function QP(){return NS||(NS=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Ix=new WeakMap,Y_=new WeakMap,xx=new WeakMap,v_=new WeakMap,l0=new WeakMap;function YP(r){const e=new Promise((t,n)=>{const s=()=>{r.removeEventListener("success",o),r.removeEventListener("error",c)},o=()=>{t(ia(r.result)),s()},c=()=>{n(r.error),s()};r.addEventListener("success",o),r.addEventListener("error",c)});return e.then(t=>{t instanceof IDBCursor&&Ix.set(t,r)}).catch(()=>{}),l0.set(e,r),e}function JP(r){if(Y_.has(r))return;const e=new Promise((t,n)=>{const s=()=>{r.removeEventListener("complete",o),r.removeEventListener("error",c),r.removeEventListener("abort",c)},o=()=>{t(),s()},c=()=>{n(r.error||new DOMException("AbortError","AbortError")),s()};r.addEventListener("complete",o),r.addEventListener("error",c),r.addEventListener("abort",c)});Y_.set(r,e)}let J_={get(r,e,t){if(r instanceof IDBTransaction){if(e==="done")return Y_.get(r);if(e==="objectStoreNames")return r.objectStoreNames||xx.get(r);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ia(r[e])},set(r,e,t){return r[e]=t,!0},has(r,e){return r instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in r}};function XP(r){J_=r(J_)}function ZP(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=r.call(w_(this),e,...t);return xx.set(n,e.sort?e.sort():[e]),ia(n)}:QP().includes(r)?function(...e){return r.apply(w_(this),e),ia(Ix.get(this))}:function(...e){return ia(r.apply(w_(this),e))}}function eD(r){return typeof r=="function"?ZP(r):(r instanceof IDBTransaction&&JP(r),KP(r,WP())?new Proxy(r,J_):r)}function ia(r){if(r instanceof IDBRequest)return YP(r);if(v_.has(r))return v_.get(r);const e=eD(r);return e!==r&&(v_.set(r,e),l0.set(e,r)),e}const w_=r=>l0.get(r);function tD(r,e,{blocked:t,upgrade:n,blocking:s,terminated:o}={}){const c=indexedDB.open(r,e),h=ia(c);return n&&c.addEventListener("upgradeneeded",d=>{n(ia(c.result),d.oldVersion,d.newVersion,ia(c.transaction),d)}),t&&c.addEventListener("blocked",d=>t(d.oldVersion,d.newVersion,d)),h.then(d=>{o&&d.addEventListener("close",()=>o()),s&&d.addEventListener("versionchange",m=>s(m.oldVersion,m.newVersion,m))}).catch(()=>{}),h}const nD=["get","getKey","getAll","getAllKeys","count"],rD=["put","add","delete","clear"],b_=new Map;function OS(r,e){if(!(r instanceof IDBDatabase&&!(e in r)&&typeof e=="string"))return;if(b_.get(e))return b_.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,s=rD.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(s||nD.includes(t)))return;const o=async function(c,...h){const d=this.transaction(c,s?"readwrite":"readonly");let m=d.store;return n&&(m=m.index(h.shift())),(await Promise.all([m[t](...h),s&&d.done]))[0]};return b_.set(e,o),o}XP(r=>({...r,get:(e,t,n)=>OS(e,t)||r.get(e,t,n),has:(e,t)=>!!OS(e,t)||r.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iD{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(sD(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function sD(r){const e=r.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Qm="@firebase/app",X_="0.14.5";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const is=new Ig("@firebase/app"),aD="@firebase/app-compat",oD="@firebase/analytics-compat",lD="@firebase/analytics",cD="@firebase/app-check-compat",uD="@firebase/app-check",hD="@firebase/auth",dD="@firebase/auth-compat",fD="@firebase/database",mD="@firebase/data-connect",gD="@firebase/database-compat",pD="@firebase/functions",yD="@firebase/functions-compat",_D="@firebase/installations",vD="@firebase/installations-compat",wD="@firebase/messaging",bD="@firebase/messaging-compat",ED="@firebase/performance",TD="@firebase/performance-compat",SD="@firebase/remote-config",AD="@firebase/remote-config-compat",ID="@firebase/storage",xD="@firebase/storage-compat",RD="@firebase/firestore",CD="@firebase/ai",kD="@firebase/firestore-compat",ND="firebase",OD="12.5.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ua="[DEFAULT]",PD={[Qm]:"fire-core",[aD]:"fire-core-compat",[lD]:"fire-analytics",[oD]:"fire-analytics-compat",[uD]:"fire-app-check",[cD]:"fire-app-check-compat",[hD]:"fire-auth",[dD]:"fire-auth-compat",[fD]:"fire-rtdb",[mD]:"fire-data-connect",[gD]:"fire-rtdb-compat",[pD]:"fire-fn",[yD]:"fire-fn-compat",[_D]:"fire-iid",[vD]:"fire-iid-compat",[wD]:"fire-fcm",[bD]:"fire-fcm-compat",[ED]:"fire-perf",[TD]:"fire-perf-compat",[SD]:"fire-rc",[AD]:"fire-rc-compat",[ID]:"fire-gcs",[xD]:"fire-gcs-compat",[RD]:"fire-fst",[kD]:"fire-fst-compat",[CD]:"fire-vertex","fire-js":"fire-js",[ND]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ha=new Map,dc=new Map,fc=new Map;function zh(r,e){try{r.container.addComponent(e)}catch(t){is.debug(`Component ${e.name} failed to register with FirebaseApp ${r.name}`,t)}}function Rx(r,e){r.container.addOrOverwriteComponent(e)}function da(r){const e=r.name;if(fc.has(e))return is.debug(`There were multiple attempts to register component ${e}.`),!1;fc.set(e,r);for(const t of ha.values())zh(t,r);for(const t of dc.values())zh(t,r);return!0}function Cx(r,e){const t=r.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),r.container.getProvider(e)}function DD(r,e,t=ua){Cx(r,e).clearInstance(t)}function c0(r){return r.options!==void 0}function kx(r){return c0(r)?!1:"authIdToken"in r||"appCheckToken"in r||"releaseOnDeref"in r||"automaticDataCollectionEnabled"in r}function Et(r){return r==null?!1:r.settings!==void 0}function VD(){fc.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MD={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ur=new Fo("app","Firebase",MD);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Nx=class{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Ni("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ur.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PS(r,e){const t=n0(r.split(".")[1]);if(t===null){console.error(`FirebaseServerApp ${e} is invalid: second part could not be parsed.`);return}if(JSON.parse(t).exp===void 0){console.error(`FirebaseServerApp ${e} is invalid: expiration claim could not be parsed`);return}const s=JSON.parse(t).exp*1e3,o=new Date().getTime();s-o<=0&&console.error(`FirebaseServerApp ${e} is invalid: the token has expired.`)}class jD extends Nx{constructor(e,t,n,s){const o=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!0,c={name:n,automaticDataCollectionEnabled:o};if(e.apiKey!==void 0)super(e,c,s);else{const h=e;super(h.options,c,s)}this._serverConfig={automaticDataCollectionEnabled:o,...t},this._serverConfig.authIdToken&&PS(this._serverConfig.authIdToken,"authIdToken"),this._serverConfig.appCheckToken&&PS(this._serverConfig.appCheckToken,"appCheckToken"),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,Kr(Qm,X_,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){h0(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw ur.create("server-app-deleted")}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ba=OD;function u0(r,e={}){let t=r;typeof e!="object"&&(e={name:e});const n={name:ua,automaticDataCollectionEnabled:!0,...e},s=n.name;if(typeof s!="string"||!s)throw ur.create("bad-app-name",{appName:String(s)});if(t||(t=s0()),!t)throw ur.create("no-options");const o=ha.get(s);if(o){if(ca(t,o.options)&&ca(n,o.config))return o;throw ur.create("duplicate-app",{appName:s})}const c=new Sx(s);for(const d of fc.values())c.addComponent(d);const h=new Nx(t,n,c);return ha.set(s,h),h}function LD(r,e={}){if(kP()&&!_x())throw ur.create("invalid-server-app-environment");let t,n=e||{};if(r&&(c0(r)?t=r.options:kx(r)?n=r:t=r),n.automaticDataCollectionEnabled===void 0&&(n.automaticDataCollectionEnabled=!0),t||(t=s0()),!t)throw ur.create("no-options");const s={...n,...t};s.releaseOnDeref!==void 0&&delete s.releaseOnDeref;const o=y=>[...y].reduce((_,E)=>Math.imul(31,_)+E.charCodeAt(0)|0,0);if(n.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw ur.create("finalization-registry-not-supported",{});const c=""+o(JSON.stringify(s)),h=dc.get(c);if(h)return h.incRefCount(n.releaseOnDeref),h;const d=new Sx(c);for(const y of fc.values())d.addComponent(y);const m=new jD(t,n,c,d);return dc.set(c,m),m}function UD(r=ua){const e=ha.get(r);if(!e&&r===ua&&s0())return u0();if(!e)throw ur.create("no-app",{appName:r});return e}function BD(){return Array.from(ha.values())}async function h0(r){let e=!1;const t=r.name;ha.has(t)?(e=!0,ha.delete(t)):dc.has(t)&&r.decRefCount()<=0&&(dc.delete(t),e=!0),e&&(await Promise.all(r.container.getProviders().map(n=>n.delete())),r.isDeleted=!0)}function Kr(r,e,t){let n=PD[r]??r;t&&(n+=`-${t}`);const s=n.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const c=[`Unable to register library "${n}" with version "${e}":`];s&&c.push(`library name "${n}" contains illegal characters (whitespace or "/")`),s&&o&&c.push("and"),o&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),is.warn(c.join(" "));return}da(new Ni(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}function Ox(r,e){if(r!==null&&typeof r!="function")throw ur.create("invalid-log-argument");GP(r,e)}function Px(r){HP(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FD="firebase-heartbeat-database",zD=1,qh="firebase-heartbeat-store";let E_=null;function Dx(){return E_||(E_=tD(FD,zD,{upgrade:(r,e)=>{switch(e){case 0:try{r.createObjectStore(qh)}catch(t){console.warn(t)}}}}).catch(r=>{throw ur.create("idb-open",{originalErrorMessage:r.message})})),E_}async function qD(r){try{const t=(await Dx()).transaction(qh),n=await t.objectStore(qh).get(Vx(r));return await t.done,n}catch(e){if(e instanceof Vn)is.warn(e.message);else{const t=ur.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});is.warn(t.message)}}}async function DS(r,e){try{const n=(await Dx()).transaction(qh,"readwrite");await n.objectStore(qh).put(e,Vx(r)),await n.done}catch(t){if(t instanceof Vn)is.warn(t.message);else{const n=ur.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});is.warn(n.message)}}}function Vx(r){return`${r.name}!${r.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $D=1024,HD=30;class GD{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new WD(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=VS();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(c=>c.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:s}),this._heartbeatsCache.heartbeats.length>HD){const c=QD(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(c,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){is.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=VS(),{heartbeatsToSend:n,unsentEntries:s}=KD(this._heartbeatsCache.heartbeats),o=Km(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(t){return is.warn(t),""}}}function VS(){return new Date().toISOString().substring(0,10)}function KD(r,e=$D){const t=[];let n=r.slice();for(const s of r){const o=t.find(c=>c.agent===s.agent);if(o){if(o.dates.push(s.date),MS(t)>e){o.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),MS(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class WD{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Fh()?OP().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await qD(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return DS(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return DS(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function MS(r){return Km(JSON.stringify({version:2,heartbeats:r})).length}function QD(r){if(r.length===0)return-1;let e=0,t=r[0].date;for(let n=1;n<r.length;n++)r[n].date<t&&(t=r[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YD(r){da(new Ni("platform-logger",e=>new iD(e),"PRIVATE")),da(new Ni("heartbeat",e=>new GD(e),"PRIVATE")),Kr(Qm,X_,r),Kr(Qm,X_,"esm2020"),Kr("fire-js","")}YD("");const JD=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:Vn,SDK_VERSION:ba,_DEFAULT_ENTRY_NAME:ua,_addComponent:zh,_addOrOverwriteComponent:Rx,_apps:ha,_clearComponents:VD,_components:fc,_getProvider:Cx,_isFirebaseApp:c0,_isFirebaseServerApp:Et,_isFirebaseServerAppSettings:kx,_registerComponent:da,_removeServiceInstance:DD,_serverApps:dc,deleteApp:h0,getApp:UD,getApps:BD,initializeApp:u0,initializeServerApp:LD,onLog:Ox,registerVersion:Kr,setLogLevel:Px},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XD{constructor(e,t){this._delegate=e,this.firebase=t,zh(e,new Ni("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),h0(this._delegate)))}_getService(e,t=ua){var s;this._delegate.checkDestroyed();const n=this._delegate.container.getProvider(e);return!n.isInitialized()&&((s=n.getComponent())==null?void 0:s.instantiationMode)==="EXPLICIT"&&n.initialize(),n.getImmediate({identifier:t})}_removeServiceInstance(e,t=ua){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){zh(this._delegate,e)}_addOrOverwriteComponent(e){Rx(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZD={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},jS=new Fo("app-compat","Firebase",ZD);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e2(r){const e={},t={__esModule:!0,initializeApp:o,app:s,registerVersion:Kr,setLogLevel:Px,onLog:Ox,apps:null,SDK_VERSION:ba,INTERNAL:{registerComponent:h,removeApp:n,useAsService:d,modularAPIs:JD}};t.default=t,Object.defineProperty(t,"apps",{get:c});function n(m){delete e[m]}function s(m){if(m=m||ua,!RS(e,m))throw jS.create("no-app",{appName:m});return e[m]}s.App=r;function o(m,y={}){const _=u0(m,y);if(RS(e,_.name))return e[_.name];const E=new r(_,t);return e[_.name]=E,E}function c(){return Object.keys(e).map(m=>e[m])}function h(m){const y=m.name,_=y.replace("-compat","");if(da(m)&&m.type==="PUBLIC"){const E=(S=s())=>{if(typeof S[_]!="function")throw jS.create("invalid-app-argument",{appName:y});return S[_]()};m.serviceProps!==void 0&&Wm(E,m.serviceProps),t[_]=E,r.prototype[_]=function(...S){return this._getService.bind(this,y).apply(this,m.multipleInstances?S:[])}}return m.type==="PUBLIC"?t[_]:null}function d(m,y){return y==="serverAuth"?null:y}return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mx(){const r=e2(XD);r.INTERNAL={...r.INTERNAL,createFirebaseNamespace:Mx,extendNamespace:e,createSubscribe:Tx,ErrorFactory:Fo,deepExtend:Wm};function e(t){Wm(r,t)}return r}const t2=Mx();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LS=new Ig("@firebase/app-compat"),n2="@firebase/app-compat",r2="0.5.5";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i2(r){Kr(n2,r2,r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */try{const r=r0();if(r.firebase!==void 0){LS.warn(`
      Warning: Firebase is already defined in the global scope. Please make sure
      Firebase library is only loaded once.
    `);const e=r.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&LS.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}}catch{}const xr=t2;i2();var s2="firebase",a2="12.5.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */xr.registerVersion(s2,a2,"app-compat");const sh={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",TWITTER:"twitter.com"},Ll={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o2(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements.","invalid-hosting-link-domain":"The provided Hosting link domain is not configured in Firebase Hosting or is not owned by the current project. This cannot be a default Hosting domain (`web.app` or `firebaseapp.com`)."}}function jx(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const l2=o2,c2=jx,Lx=new Fo("auth","Firebase",jx());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ym=new Ig("@firebase/auth");function u2(r,...e){Ym.logLevel<=Fe.WARN&&Ym.warn(`Auth (${ba}): ${r}`,...e)}function Om(r,...e){Ym.logLevel<=Fe.ERROR&&Ym.error(`Auth (${ba}): ${r}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bn(r,...e){throw f0(r,...e)}function rn(r,...e){return f0(r,...e)}function d0(r,e,t){const n={...c2(),[e]:t};return new Fo("auth","Firebase",n).create(e,{appName:r.name})}function hn(r){return d0(r,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Uc(r,e,t){const n=t;if(!(e instanceof n))throw n.name!==e.constructor.name&&bn(r,"argument-error"),d0(r,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function f0(r,...e){if(typeof r!="string"){const t=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=r.name),r._errorFactory.create(t,...n)}return Lx.create(r,...e)}function le(r,e,...t){if(!r)throw f0(e,...t)}function Ai(r){const e="INTERNAL ASSERTION FAILED: "+r;throw Om(e),new Error(e)}function Yr(r,e){r||Ai(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $h(){var r;return typeof self<"u"&&((r=self.location)==null?void 0:r.href)||""}function m0(){return US()==="http:"||US()==="https:"}function US(){var r;return typeof self<"u"&&((r=self.location)==null?void 0:r.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h2(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(m0()||vx()||"connection"in navigator)?navigator.onLine:!0}function d2(){if(typeof navigator>"u")return null;const r=navigator;return r.languages&&r.languages[0]||r.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fd{constructor(e,t){this.shortDelay=e,this.longDelay=t,Yr(t>e,"Short delay should be less than long delay!"),this.isMobile=CP()||a0()}get(){return h2()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g0(r,e){Yr(r.emulator,"Emulator should always be set here");const{url:t}=r.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ux{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ai("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ai("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ai("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f2={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m2=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],g2=new fd(3e4,6e4);function Nt(r,e){return r.tenantId&&!e.tenantId?{...e,tenantId:r.tenantId}:e}async function Ot(r,e,t,n,s={}){return Bx(r,s,async()=>{let o={},c={};n&&(e==="GET"?c=n:o={body:JSON.stringify(n)});const h=Lc({key:r.config.apiKey,...c}).slice(1),d=await r._getAdditionalHeaders();d["Content-Type"]="application/json",r.languageCode&&(d["X-Firebase-Locale"]=r.languageCode);const m={method:e,headers:d,...o};return NP()||(m.referrerPolicy="no-referrer"),r.emulatorConfig&&jc(r.emulatorConfig.host)&&(m.credentials="include"),Ux.fetch()(await Fx(r,r.config.apiHost,t,h),m)})}async function Bx(r,e,t){r._canInitEmulator=!1;const n={...f2,...e};try{const s=new y2(r),o=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const c=await o.json();if("needConfirmation"in c)throw gh(r,"account-exists-with-different-credential",c);if(o.ok&&!("errorMessage"in c))return c;{const h=o.ok?c.errorMessage:c.error.message,[d,m]=h.split(" : ");if(d==="FEDERATED_USER_ID_ALREADY_LINKED")throw gh(r,"credential-already-in-use",c);if(d==="EMAIL_EXISTS")throw gh(r,"email-already-in-use",c);if(d==="USER_DISABLED")throw gh(r,"user-disabled",c);const y=n[d]||d.toLowerCase().replace(/[_\s]+/g,"-");if(m)throw d0(r,y,m);bn(r,y)}}catch(s){if(s instanceof Vn)throw s;bn(r,"network-request-failed",{message:String(s)})}}async function ls(r,e,t,n,s={}){const o=await Ot(r,e,t,n,s);return"mfaPendingCredential"in o&&bn(r,"multi-factor-auth-required",{_serverResponse:o}),o}async function Fx(r,e,t,n){const s=`${e}${t}?${n}`,o=r,c=o.config.emulator?g0(r.config,s):`${r.config.apiScheme}://${s}`;return m2.includes(t)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(c).toString():c}function p2(r){switch(r){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class y2{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,n)=>{this.timer=setTimeout(()=>n(rn(this.auth,"network-request-failed")),g2.get())})}}function gh(r,e,t){const n={appName:r.name};t.email&&(n.email=t.email),t.phoneNumber&&(n.phoneNumber=t.phoneNumber);const s=rn(r,e,n);return s.customData._tokenResponse=t,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BS(r){return r!==void 0&&r.getResponse!==void 0}function FS(r){return r!==void 0&&r.enterprise!==void 0}class zx{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return p2(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _2(r){return(await Ot(r,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function qx(r,e){return Ot(r,"GET","/v2/recaptchaConfig",Nt(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function v2(r,e){return Ot(r,"POST","/v1/accounts:delete",e)}async function w2(r,e){return Ot(r,"POST","/v1/accounts:update",e)}async function Jm(r,e){return Ot(r,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sh(r){if(r)try{const e=new Date(Number(r));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function b2(r,e=!1){const t=Re(r),n=await t.getIdToken(e),s=xg(n);le(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const o=typeof s.firebase=="object"?s.firebase:void 0,c=o==null?void 0:o.sign_in_provider;return{claims:s,token:n,authTime:Sh(T_(s.auth_time)),issuedAtTime:Sh(T_(s.iat)),expirationTime:Sh(T_(s.exp)),signInProvider:c||null,signInSecondFactor:(o==null?void 0:o.sign_in_second_factor)||null}}function T_(r){return Number(r)*1e3}function xg(r){const[e,t,n]=r.split(".");if(e===void 0||t===void 0||n===void 0)return Om("JWT malformed, contained fewer than 3 sections"),null;try{const s=n0(t);return s?JSON.parse(s):(Om("Failed to decode base64 JWT payload"),null)}catch(s){return Om("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function zS(r){const e=xg(r);return le(e,"internal-error"),le(typeof e.exp<"u","internal-error"),le(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ss(r,e,t=!1){if(t)return e;try{return await e}catch(n){throw n instanceof Vn&&E2(n)&&r.auth.currentUser===r&&await r.auth.signOut(),n}}function E2({code:r}){return r==="auth/user-disabled"||r==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T2{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z_{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Sh(this.lastLoginAt),this.creationTime=Sh(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hh(r){var _;const e=r.auth,t=await r.getIdToken(),n=await ss(r,Jm(e,{idToken:t}));le(n==null?void 0:n.users.length,e,"internal-error");const s=n.users[0];r._notifyReloadListener(s);const o=(_=s.providerUserInfo)!=null&&_.length?$x(s.providerUserInfo):[],c=A2(r.providerData,o),h=r.isAnonymous,d=!(r.email&&s.passwordHash)&&!(c!=null&&c.length),m=h?d:!1,y={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:c,metadata:new Z_(s.createdAt,s.lastLoginAt),isAnonymous:m};Object.assign(r,y)}async function S2(r){const e=Re(r);await Hh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function A2(r,e){return[...r.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function $x(r){return r.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function I2(r,e){const t=await Bx(r,{},async()=>{const n=Lc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:o}=r.config,c=await Fx(r,s,"/v1/token",`key=${o}`),h=await r._getAdditionalHeaders();h["Content-Type"]="application/x-www-form-urlencoded";const d={method:"POST",headers:h,body:n};return r.emulatorConfig&&jc(r.emulatorConfig.host)&&(d.credentials="include"),Ux.fetch()(c,d)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function x2(r,e){return Ot(r,"POST","/v2/accounts:revokeToken",Nt(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){le(e.idToken,"internal-error"),le(typeof e.idToken<"u","internal-error"),le(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):zS(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){le(e.length!==0,"internal-error");const t=zS(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(le(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:s,expiresIn:o}=await I2(e,t);this.updateTokensAndExpiration(n,s,Number(o))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,t){const{refreshToken:n,accessToken:s,expirationTime:o}=t,c=new sc;return n&&(le(typeof n=="string","internal-error",{appName:e}),c.refreshToken=n),s&&(le(typeof s=="string","internal-error",{appName:e}),c.accessToken=s),o&&(le(typeof o=="number","internal-error",{appName:e}),c.expirationTime=o),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new sc,this.toJSON())}_performRefresh(){return Ai("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ks(r,e){le(typeof r=="string"||typeof r>"u","internal-error",{appName:e})}class Gr{constructor({uid:e,auth:t,stsTokenManager:n,...s}){this.providerId="firebase",this.proactiveRefresh=new T2(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Z_(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await ss(this,this.stsTokenManager.getToken(this.auth,e));return le(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return b2(this,e)}reload(){return S2(this)}_assign(e){this!==e&&(le(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Gr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){le(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await Hh(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Et(this.auth.app))return Promise.reject(hn(this.auth));const e=await this.getIdToken();return await ss(this,v2(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const n=t.displayName??void 0,s=t.email??void 0,o=t.phoneNumber??void 0,c=t.photoURL??void 0,h=t.tenantId??void 0,d=t._redirectEventId??void 0,m=t.createdAt??void 0,y=t.lastLoginAt??void 0,{uid:_,emailVerified:E,isAnonymous:S,providerData:C,stsTokenManager:k}=t;le(_&&k,e,"internal-error");const N=sc.fromJSON(this.name,k);le(typeof _=="string",e,"internal-error"),Ks(n,e.name),Ks(s,e.name),le(typeof E=="boolean",e,"internal-error"),le(typeof S=="boolean",e,"internal-error"),Ks(o,e.name),Ks(c,e.name),Ks(h,e.name),Ks(d,e.name),Ks(m,e.name),Ks(y,e.name);const G=new Gr({uid:_,auth:e,email:s,emailVerified:E,displayName:n,isAnonymous:S,photoURL:c,phoneNumber:o,tenantId:h,stsTokenManager:N,createdAt:m,lastLoginAt:y});return C&&Array.isArray(C)&&(G.providerData=C.map(J=>({...J}))),d&&(G._redirectEventId=d),G}static async _fromIdTokenResponse(e,t,n=!1){const s=new sc;s.updateFromServerResponse(t);const o=new Gr({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await Hh(o),o}static async _fromGetAccountInfoResponse(e,t,n){const s=t.users[0];le(s.localId!==void 0,"internal-error");const o=s.providerUserInfo!==void 0?$x(s.providerUserInfo):[],c=!(s.email&&s.passwordHash)&&!(o!=null&&o.length),h=new sc;h.updateFromIdToken(n);const d=new Gr({uid:s.localId,auth:e,stsTokenManager:h,isAnonymous:c}),m={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Z_(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(o!=null&&o.length)};return Object.assign(d,m),d}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qS=new Map;function cr(r){Yr(r instanceof Function,"Expected a class definition");let e=qS.get(r);return e?(Yr(e instanceof r,"Instance stored in cache mismatched with class"),e):(e=new r,qS.set(r,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hx{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Hx.type="NONE";const mc=Hx;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Io(r,e,t){return`firebase:${r}:${e}:${t}`}class ac{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:s,name:o}=this.auth;this.fullUserKey=Io(this.userKey,s.apiKey,o),this.fullPersistenceKey=Io("persistence",s.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Jm(this.auth,{idToken:e}).catch(()=>{});return t?Gr._fromGetAccountInfoResponse(this.auth,t,e):null}return Gr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new ac(cr(mc),e,n);const s=(await Promise.all(t.map(async m=>{if(await m._isAvailable())return m}))).filter(m=>m);let o=s[0]||cr(mc);const c=Io(n,e.config.apiKey,e.name);let h=null;for(const m of t)try{const y=await m._get(c);if(y){let _;if(typeof y=="string"){const E=await Jm(e,{idToken:y}).catch(()=>{});if(!E)break;_=await Gr._fromGetAccountInfoResponse(e,E,y)}else _=Gr._fromJSON(e,y);m!==o&&(h=_),o=m;break}}catch{}const d=s.filter(m=>m._shouldAllowMigration);return!o._shouldAllowMigration||!d.length?new ac(o,e,n):(o=d[0],h&&await o._set(c,h.toJSON()),await Promise.all(t.map(async m=>{if(m!==o)try{await m._remove(c)}catch{}})),new ac(o,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $S(r){const e=r.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Qx(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Gx(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Yx(e))return"Blackberry";if(Jx(e))return"Webos";if(Kx(e))return"Safari";if((e.includes("chrome/")||Wx(e))&&!e.includes("edge/"))return"Chrome";if(md(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=r.match(t);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function Gx(r=It()){return/firefox\//i.test(r)}function Kx(r=It()){const e=r.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Wx(r=It()){return/crios\//i.test(r)}function Qx(r=It()){return/iemobile/i.test(r)}function md(r=It()){return/android/i.test(r)}function Yx(r=It()){return/blackberry/i.test(r)}function Jx(r=It()){return/webos/i.test(r)}function gd(r=It()){return/iphone|ipad|ipod/i.test(r)||/macintosh/i.test(r)&&/mobile/i.test(r)}function R2(r=It()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(r)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(r)}function C2(r=It()){var e;return gd(r)&&!!((e=window.navigator)!=null&&e.standalone)}function k2(){return wx()&&document.documentMode===10}function Xx(r=It()){return gd(r)||md(r)||Jx(r)||Yx(r)||/windows phone/i.test(r)||Qx(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zx(r,e=[]){let t;switch(r){case"Browser":t=$S(It());break;case"Worker":t=`${$S(It())}-${r}`;break;default:t=r}const n=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${ba}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N2{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=o=>new Promise((c,h)=>{try{const d=e(o);c(d)}catch(d){h(d)}});n.onAbort=t,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function O2(r,e={}){return Ot(r,"GET","/v2/passwordPolicy",Nt(r,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P2=6;class D2{constructor(e){var n;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??P2,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((n=e.allowedNonAlphanumericCharacters)==null?void 0:n.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,s,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V2{constructor(e,t,n,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new HS(this),this.idTokenSubscription=new HS(this),this.beforeStateQueue=new N2(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Lx,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=cr(t)),this._initializationPromise=this.queue(async()=>{var n,s,o;if(!this._deleted&&(this.persistenceManager=await ac.create(this,e),(n=this._resolvePersistenceManagerAvailable)==null||n.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((o=this.currentUser)==null?void 0:o.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Jm(this,{idToken:e}),n=await Gr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var o;if(Et(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(h=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(h,h))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let n=t,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=(o=this.redirectUser)==null?void 0:o._redirectEventId,h=n==null?void 0:n._redirectEventId,d=await this.tryRedirectSignIn(e);(!c||c===h)&&(d!=null&&d.user)&&(n=d.user,s=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(n)}catch(c){n=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return le(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Hh(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=d2()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Et(this.app))return Promise.reject(hn(this));const t=e?Re(e):null;return t&&le(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&le(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Et(this.app)?Promise.reject(hn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Et(this.app)?Promise.reject(hn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(cr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await O2(this),t=new D2(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Fo("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(n.tenantId=this.tenantId),await x2(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&cr(e)||this._popupRedirectResolver;le(t,this,"argument-error"),this.redirectPersistenceManager=await ac.create(this,[cr(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((n=this.redirectUser)==null?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,s){if(this._deleted)return()=>{};const o=typeof t=="function"?t:t.next.bind(t);let c=!1;const h=this._isInitialized?Promise.resolve():this._initializationPromise;if(le(h,this,"internal-error"),h.then(()=>{c||o(this.currentUser)}),typeof t=="function"){const d=e.addObserver(t,n,s);return()=>{c=!0,d()}}else{const d=e.addObserver(t);return()=>{c=!0,d()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return le(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Zx(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){var t;if(Et(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&u2(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function xt(r){return Re(r)}class HS{constructor(e){this.auth=e,this.observer=null,this.addObserver=Tx(t=>this.observer=t)}get next(){return le(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pd={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function M2(r){pd=r}function p0(r){return pd.loadJS(r)}function j2(){return pd.recaptchaV2Script}function L2(){return pd.recaptchaEnterpriseScript}function U2(){return pd.gapiScript}function eR(r){return`__${r}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B2=500,F2=6e4,fm=1e12;class z2{constructor(e){this.auth=e,this.counter=fm,this._widgets=new Map}render(e,t){const n=this.counter;return this._widgets.set(n,new H2(e,this.auth.name,t||{})),this.counter++,n}reset(e){var n;const t=e||fm;(n=this._widgets.get(t))==null||n.delete(),this._widgets.delete(t)}getResponse(e){var n;const t=e||fm;return((n=this._widgets.get(t))==null?void 0:n.getResponse())||""}async execute(e){var n;const t=e||fm;return(n=this._widgets.get(t))==null||n.execute(),""}}class q2{constructor(){this.enterprise=new $2}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class $2{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class H2{constructor(e,t,n){this.params=n,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const s=typeof e=="string"?document.getElementById(e):e;le(s,"argument-error",{appName:t}),this.container=s,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=G2(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},F2)},B2))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function G2(r){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let n=0;n<r;n++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}const K2="recaptcha-enterprise",Ah="NO_RECAPTCHA";class tR{constructor(e){this.type=K2,this.auth=xt(e)}async verify(e="verify",t=!1){async function n(o){if(!t){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(c,h)=>{qx(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(d=>{if(d.recaptchaKey===void 0)h(new Error("recaptcha Enterprise site key undefined"));else{const m=new zx(d);return o.tenantId==null?o._agentRecaptchaConfig=m:o._tenantRecaptchaConfigs[o.tenantId]=m,c(m.siteKey)}}).catch(d=>{h(d)})})}function s(o,c,h){const d=window.grecaptcha;FS(d)?d.enterprise.ready(()=>{d.enterprise.execute(o,{action:e}).then(m=>{c(m)}).catch(()=>{c(Ah)})}):h(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new q2().execute("siteKey",{action:"verify"}):new Promise((o,c)=>{n(this.auth).then(h=>{if(!t&&FS(window.grecaptcha))s(h,o,c);else{if(typeof window>"u"){c(new Error("RecaptchaVerifier is only supported in browser"));return}let d=L2();d.length!==0&&(d+=h),p0(d).then(()=>{s(h,o,c)}).catch(m=>{c(m)})}}).catch(h=>{c(h)})})}}async function ah(r,e,t,n=!1,s=!1){const o=new tR(r);let c;if(s)c=Ah;else try{c=await o.verify(t)}catch{c=await o.verify(t,!0)}const h={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in h){const d=h.phoneEnrollmentInfo.phoneNumber,m=h.phoneEnrollmentInfo.recaptchaToken;Object.assign(h,{phoneEnrollmentInfo:{phoneNumber:d,recaptchaToken:m,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in h){const d=h.phoneSignInInfo.recaptchaToken;Object.assign(h,{phoneSignInInfo:{recaptchaToken:d,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return h}return n?Object.assign(h,{captchaResp:c}):Object.assign(h,{captchaResponse:c}),Object.assign(h,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(h,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),h}async function sa(r,e,t,n,s){var o,c;if(s==="EMAIL_PASSWORD_PROVIDER")if((o=r._getRecaptchaConfig())!=null&&o.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const h=await ah(r,e,t,t==="getOobCode");return n(r,h)}else return n(r,e).catch(async h=>{if(h.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await ah(r,e,t,t==="getOobCode");return n(r,d)}else return Promise.reject(h)});else if(s==="PHONE_PROVIDER")if((c=r._getRecaptchaConfig())!=null&&c.isProviderEnabled("PHONE_PROVIDER")){const h=await ah(r,e,t);return n(r,h).catch(async d=>{var m;if(((m=r._getRecaptchaConfig())==null?void 0:m.getProviderEnforcementState("PHONE_PROVIDER"))==="AUDIT"&&(d.code==="auth/missing-recaptcha-token"||d.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${t} flow.`);const y=await ah(r,e,t,!1,!0);return n(r,y)}return Promise.reject(d)})}else{const h=await ah(r,e,t,!1,!0);return n(r,h)}else return Promise.reject(s+" provider is not supported.")}async function W2(r){const e=xt(r),t=await qx(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),n=new zx(t);e.tenantId==null?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,n.isAnyProviderEnabled()&&new tR(e).verify()}function Q2(r,e){const t=(e==null?void 0:e.persistence)||[],n=(Array.isArray(t)?t:[t]).map(cr);e!=null&&e.errorMap&&r._updateErrorMap(e.errorMap),r._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function Y2(r,e,t){const n=xt(r);le(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!!(t!=null&&t.disableWarnings),o=nR(e),{host:c,port:h}=J2(e),d=h===null?"":`:${h}`,m={url:`${o}//${c}${d}/`},y=Object.freeze({host:c,port:h,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!n._canInitEmulator){le(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),le(ca(m,n.config.emulator)&&ca(y,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=m,n.emulatorConfig=y,n.settings.appVerificationDisabledForTesting=!0,jc(c)?(px(`${o}//${c}${d}`),yx("Auth",!0)):s||X2()}function nR(r){const e=r.indexOf(":");return e<0?"":r.substr(0,e+1)}function J2(r){const e=nR(r),t=/(\/\/)?([^?#/]+)/.exec(r.substr(e.length));if(!t)return{host:"",port:null};const n=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const o=s[1];return{host:o,port:GS(n.substr(o.length+1))}}else{const[o,c]=n.split(":");return{host:o,port:GS(c)}}}function GS(r){if(!r)return null;const e=Number(r);return isNaN(e)?null:e}function X2(){function r(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",r):r())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bc{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ai("not implemented")}_getIdTokenResponse(e){return Ai("not implemented")}_linkToIdToken(e,t){return Ai("not implemented")}_getReauthenticationResolver(e){return Ai("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rR(r,e){return Ot(r,"POST","/v1/accounts:resetPassword",Nt(r,e))}async function Z2(r,e){return Ot(r,"POST","/v1/accounts:update",e)}async function eV(r,e){return Ot(r,"POST","/v1/accounts:signUp",e)}async function tV(r,e){return Ot(r,"POST","/v1/accounts:update",Nt(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nV(r,e){return ls(r,"POST","/v1/accounts:signInWithPassword",Nt(r,e))}async function Rg(r,e){return Ot(r,"POST","/v1/accounts:sendOobCode",Nt(r,e))}async function rV(r,e){return Rg(r,e)}async function iV(r,e){return Rg(r,e)}async function sV(r,e){return Rg(r,e)}async function aV(r,e){return Rg(r,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oV(r,e){return ls(r,"POST","/v1/accounts:signInWithEmailLink",Nt(r,e))}async function lV(r,e){return ls(r,"POST","/v1/accounts:signInWithEmailLink",Nt(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gh extends Bc{constructor(e,t,n,s=null){super("password",n),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new Gh(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new Gh(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return sa(e,t,"signInWithPassword",nV,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return oV(e,{email:this._email,oobCode:this._password});default:bn(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const n={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return sa(e,n,"signUpPassword",eV,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return lV(e,{idToken:t,email:this._email,oobCode:this._password});default:bn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rs(r,e){return ls(r,"POST","/v1/accounts:signInWithIdp",Nt(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cV="http://localhost";class Oi extends Bc{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Oi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):bn("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s,...o}=t;if(!n||!s)return null;const c=new Oi(n,s);return c.idToken=o.idToken||void 0,c.accessToken=o.accessToken||void 0,c.secret=o.secret,c.nonce=o.nonce,c.pendingToken=o.pendingToken||null,c}_getIdTokenResponse(e){const t=this.buildRequest();return rs(e,t)}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,rs(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,rs(e,t)}buildRequest(){const e={requestUri:cV,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Lc(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KS(r,e){return Ot(r,"POST","/v1/accounts:sendVerificationCode",Nt(r,e))}async function uV(r,e){return ls(r,"POST","/v1/accounts:signInWithPhoneNumber",Nt(r,e))}async function hV(r,e){const t=await ls(r,"POST","/v1/accounts:signInWithPhoneNumber",Nt(r,e));if(t.temporaryProof)throw gh(r,"account-exists-with-different-credential",t);return t}const dV={USER_NOT_FOUND:"user-not-found"};async function fV(r,e){const t={...e,operation:"REAUTH"};return ls(r,"POST","/v1/accounts:signInWithPhoneNumber",Nt(r,t),dV)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo extends Bc{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new xo({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new xo({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return uV(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return hV(e,{idToken:t,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return fV(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:s}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:s}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:s,temporaryProof:o}=e;return!n&&!t&&!s&&!o?null:new xo({verificationId:t,verificationCode:n,phoneNumber:s,temporaryProof:o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mV(r){switch(r){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function gV(r){const e=ic(mh(r)).link,t=e?ic(mh(e)).deep_link_id:null,n=ic(mh(r)).deep_link_id;return(n?ic(mh(n)).link:null)||n||t||e||r}class Cg{constructor(e){const t=ic(mh(e)),n=t.apiKey??null,s=t.oobCode??null,o=mV(t.mode??null);le(n&&s&&o,"argument-error"),this.apiKey=n,this.operation=o,this.code=s,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=gV(e);try{return new Cg(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ea{constructor(){this.providerId=Ea.PROVIDER_ID}static credential(e,t){return Gh._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Cg.parseLink(t);return le(n,"argument-error"),Gh._fromEmailAndCode(e,n.code,n.tenantId)}}Ea.PROVIDER_ID="password";Ea.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ea.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cs{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fc extends cs{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class oc extends Fc{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return le("providerId"in t&&"signInMethod"in t,"argument-error"),Oi._fromParams(t)}credential(e){return this._credential({...e,nonce:e.rawNonce})}_credential(e){return le(e.idToken||e.accessToken,"argument-error"),Oi._fromParams({...e,providerId:this.providerId,signInMethod:this.providerId})}static credentialFromResult(e){return oc.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return oc.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n,oauthTokenSecret:s,pendingToken:o,nonce:c,providerId:h}=e;if(!n&&!s&&!t&&!o||!h)return null;try{return new oc(h)._credential({idToken:t,accessToken:n,nonce:c,pendingToken:o})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bi extends Fc{constructor(){super("facebook.com")}static credential(e){return Oi._fromParams({providerId:bi.PROVIDER_ID,signInMethod:bi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return bi.credentialFromTaggedObject(e)}static credentialFromError(e){return bi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return bi.credential(e.oauthAccessToken)}catch{return null}}}bi.FACEBOOK_SIGN_IN_METHOD="facebook.com";bi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ei extends Fc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Oi._fromParams({providerId:Ei.PROVIDER_ID,signInMethod:Ei.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ei.credentialFromTaggedObject(e)}static credentialFromError(e){return Ei.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return Ei.credential(t,n)}catch{return null}}}Ei.GOOGLE_SIGN_IN_METHOD="google.com";Ei.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ti extends Fc{constructor(){super("github.com")}static credential(e){return Oi._fromParams({providerId:Ti.PROVIDER_ID,signInMethod:Ti.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ti.credentialFromTaggedObject(e)}static credentialFromError(e){return Ti.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ti.credential(e.oauthAccessToken)}catch{return null}}}Ti.GITHUB_SIGN_IN_METHOD="github.com";Ti.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pV="http://localhost";class gc extends Bc{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){const t=this.buildRequest();return rs(e,t)}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,rs(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,rs(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s,pendingToken:o}=t;return!n||!s||!o||n!==s?null:new gc(n,o)}static _create(e,t){return new gc(e,t)}buildRequest(){return{requestUri:pV,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yV="saml.";class Xm extends cs{constructor(e){le(e.startsWith(yV),"argument-error"),super(e)}static credentialFromResult(e){return Xm.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return Xm.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=gc.fromJSON(e);return le(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:n}=e;if(!t||!n)return null;try{return gc._create(n,t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Si extends Fc{constructor(){super("twitter.com")}static credential(e,t){return Oi._fromParams({providerId:Si.PROVIDER_ID,signInMethod:Si.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Si.credentialFromTaggedObject(e)}static credentialFromError(e){return Si.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Si.credential(t,n)}catch{return null}}}Si.TWITTER_SIGN_IN_METHOD="twitter.com";Si.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iR(r,e){return ls(r,"POST","/v1/accounts:signUp",Nt(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rr{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,s=!1){const o=await Gr._fromIdTokenResponse(e,n,s),c=WS(n);return new Rr({user:o,providerId:c,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const s=WS(n);return new Rr({user:e,providerId:s,_tokenResponse:n,operationType:t})}}function WS(r){return r.providerId?r.providerId:"phoneNumber"in r?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _V(r){var s;if(Et(r.app))return Promise.reject(hn(r));const e=xt(r);if(await e._initializationPromise,(s=e.currentUser)!=null&&s.isAnonymous)return new Rr({user:e.currentUser,providerId:null,operationType:"signIn"});const t=await iR(e,{returnSecureToken:!0}),n=await Rr._fromIdTokenResponse(e,"signIn",t,!0);return await e._updateCurrentUser(n.user),n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zm extends Vn{constructor(e,t,n,s){super(t.code,t.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,Zm.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,s){return new Zm(e,t,n,s)}}function sR(r,e,t,n){return(e==="reauthenticate"?t._getReauthenticationResolver(r):t._getIdTokenResponse(r)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?Zm._fromErrorAndOperation(r,o,e,n):o})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aR(r){return new Set(r.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vV(r,e){const t=Re(r);await kg(!0,t,e);const{providerUserInfo:n}=await w2(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),s=aR(n||[]);return t.providerData=t.providerData.filter(o=>s.has(o.providerId)),s.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function y0(r,e,t=!1){const n=await ss(r,e._linkToIdToken(r.auth,await r.getIdToken()),t);return Rr._forOperation(r,"link",n)}async function kg(r,e,t){await Hh(e);const n=aR(e.providerData),s=r===!1?"provider-already-linked":"no-such-provider";le(n.has(t)===r,e.auth,s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oR(r,e,t=!1){const{auth:n}=r;if(Et(n.app))return Promise.reject(hn(n));const s="reauthenticate";try{const o=await ss(r,sR(n,s,e,r),t);le(o.idToken,n,"internal-error");const c=xg(o.idToken);le(c,n,"internal-error");const{sub:h}=c;return le(r.uid===h,n,"user-mismatch"),Rr._forOperation(r,s,o)}catch(o){throw(o==null?void 0:o.code)==="auth/user-not-found"&&bn(n,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lR(r,e,t=!1){if(Et(r.app))return Promise.reject(hn(r));const n="signIn",s=await sR(r,n,e),o=await Rr._fromIdTokenResponse(r,n,s);return t||await r._updateCurrentUser(o.user),o}async function Ng(r,e){return lR(xt(r),e)}async function cR(r,e){const t=Re(r);return await kg(!1,t,e.providerId),y0(t,e)}async function uR(r,e){return oR(Re(r),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wV(r,e){return ls(r,"POST","/v1/accounts:signInWithCustomToken",Nt(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bV(r,e){if(Et(r.app))return Promise.reject(hn(r));const t=xt(r),n=await wV(t,{token:e,returnSecureToken:!0}),s=await Rr._fromIdTokenResponse(t,"signIn",n);return await t._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yd{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?_0._fromServerResponse(e,t):"totpInfo"in t?v0._fromServerResponse(e,t):bn(e,"internal-error")}}class _0 extends yd{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new _0(t)}}class v0 extends yd{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new v0(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Og(r,e,t){var n;le(((n=t.url)==null?void 0:n.length)>0,r,"invalid-continue-uri"),le(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,r,"invalid-dynamic-link-domain"),le(typeof t.linkDomain>"u"||t.linkDomain.length>0,r,"invalid-hosting-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.linkDomain=t.linkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(le(t.iOS.bundleId.length>0,r,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(le(t.android.packageName.length>0,r,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function w0(r){const e=xt(r);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function EV(r,e,t){const n=xt(r),s={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&Og(n,s,t),await sa(n,s,"getOobCode",iV,"EMAIL_PASSWORD_PROVIDER")}async function TV(r,e,t){await rR(Re(r),{oobCode:e,newPassword:t}).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&w0(r),n})}async function SV(r,e){await tV(Re(r),{oobCode:e})}async function hR(r,e){const t=Re(r),n=await rR(t,{oobCode:e}),s=n.requestType;switch(le(s,t,"internal-error"),s){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":le(n.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":le(n.mfaInfo,t,"internal-error");default:le(n.email,t,"internal-error")}let o=null;return n.mfaInfo&&(o=yd._fromServerResponse(xt(t),n.mfaInfo)),{data:{email:(n.requestType==="VERIFY_AND_CHANGE_EMAIL"?n.newEmail:n.email)||null,previousEmail:(n.requestType==="VERIFY_AND_CHANGE_EMAIL"?n.email:n.newEmail)||null,multiFactorInfo:o},operation:s}}async function AV(r,e){const{data:t}=await hR(Re(r),e);return t.email}async function IV(r,e,t){if(Et(r.app))return Promise.reject(hn(r));const n=xt(r),c=await sa(n,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",iR,"EMAIL_PASSWORD_PROVIDER").catch(d=>{throw d.code==="auth/password-does-not-meet-requirements"&&w0(r),d}),h=await Rr._fromIdTokenResponse(n,"signIn",c);return await n._updateCurrentUser(h.user),h}function xV(r,e,t){return Et(r.app)?Promise.reject(hn(r)):Ng(Re(r),Ea.credential(e,t)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&w0(r),n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RV(r,e,t){const n=xt(r),s={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function o(c,h){le(h.handleCodeInApp,n,"argument-error"),h&&Og(n,c,h)}o(s,t),await sa(n,s,"getOobCode",sV,"EMAIL_PASSWORD_PROVIDER")}function CV(r,e){const t=Cg.parseLink(e);return(t==null?void 0:t.operation)==="EMAIL_SIGNIN"}async function kV(r,e,t){if(Et(r.app))return Promise.reject(hn(r));const n=Re(r),s=Ea.credentialWithLink(e,t||$h());return le(s._tenantId===(n.tenantId||null),n,"tenant-id-mismatch"),Ng(n,s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NV(r,e){return Ot(r,"POST","/v1/accounts:createAuthUri",Nt(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OV(r,e){const t=m0()?$h():"http://localhost",n={identifier:e,continueUri:t},{signinMethods:s}=await NV(Re(r),n);return s||[]}async function PV(r,e){const t=Re(r),s={requestType:"VERIFY_EMAIL",idToken:await r.getIdToken()};e&&Og(t.auth,s,e);const{email:o}=await rV(t.auth,s);o!==r.email&&await r.reload()}async function DV(r,e,t){const n=Re(r),o={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await r.getIdToken(),newEmail:e};t&&Og(n.auth,o,t);const{email:c}=await aV(n.auth,o);c!==r.email&&await r.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VV(r,e){return Ot(r,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MV(r,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const n=Re(r),o={idToken:await n.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},c=await ss(n,VV(n.auth,o));n.displayName=c.displayName||null,n.photoURL=c.photoUrl||null;const h=n.providerData.find(({providerId:d})=>d==="password");h&&(h.displayName=n.displayName,h.photoURL=n.photoURL),await n._updateTokensIfNecessary(c)}function jV(r,e){const t=Re(r);return Et(t.auth.app)?Promise.reject(hn(t.auth)):dR(t,e,null)}function LV(r,e){return dR(Re(r),null,e)}async function dR(r,e,t){const{auth:n}=r,o={idToken:await r.getIdToken(),returnSecureToken:!0};e&&(o.email=e),t&&(o.password=t);const c=await ss(r,Z2(n,o));await r._updateTokensIfNecessary(c,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UV(r){var s,o;if(!r)return null;const{providerId:e}=r,t=r.rawUserInfo?JSON.parse(r.rawUserInfo):{},n=r.isNewUser||r.kind==="identitytoolkit#SignupNewUserResponse";if(!e&&(r!=null&&r.idToken)){const c=(o=(s=xg(r.idToken))==null?void 0:s.firebase)==null?void 0:o.sign_in_provider;if(c){const h=c!=="anonymous"&&c!=="custom"?c:null;return new lc(n,h)}}if(!e)return null;switch(e){case"facebook.com":return new BV(n,t);case"github.com":return new FV(n,t);case"google.com":return new zV(n,t);case"twitter.com":return new qV(n,t,r.screenName||null);case"custom":case"anonymous":return new lc(n,null);default:return new lc(n,e,t)}}class lc{constructor(e,t,n={}){this.isNewUser=e,this.providerId=t,this.profile=n}}class fR extends lc{constructor(e,t,n,s){super(e,t,n),this.username=s}}class BV extends lc{constructor(e,t){super(e,"facebook.com",t)}}class FV extends fR{constructor(e,t){super(e,"github.com",t,typeof(t==null?void 0:t.login)=="string"?t==null?void 0:t.login:null)}}class zV extends lc{constructor(e,t){super(e,"google.com",t)}}class qV extends fR{constructor(e,t,n){super(e,"twitter.com",t,n)}}function $V(r){const{user:e,_tokenResponse:t}=r;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:UV(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo{constructor(e,t,n){this.type=e,this.credential=t,this.user=n}static _fromIdtoken(e,t){return new bo("enroll",e,t)}static _fromMfaPendingCredential(e){return new bo("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,n;if(e!=null&&e.multiFactorSession){if((t=e.multiFactorSession)!=null&&t.pendingCredential)return bo._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if((n=e.multiFactorSession)!=null&&n.idToken)return bo._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b0{constructor(e,t,n){this.session=e,this.hints=t,this.signInResolver=n}static _fromError(e,t){const n=xt(e),s=t.customData._serverResponse,o=(s.mfaInfo||[]).map(h=>yd._fromServerResponse(n,h));le(s.mfaPendingCredential,n,"internal-error");const c=bo._fromMfaPendingCredential(s.mfaPendingCredential);return new b0(c,o,async h=>{const d=await h._process(n,c);delete s.mfaInfo,delete s.mfaPendingCredential;const m={...s,idToken:d.idToken,refreshToken:d.refreshToken};switch(t.operationType){case"signIn":const y=await Rr._fromIdTokenResponse(n,t.operationType,m);return await n._updateCurrentUser(y.user),y;case"reauthenticate":return le(t.user,n,"internal-error"),Rr._forOperation(t.user,t.operationType,m);default:bn(n,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function HV(r,e){var s;const t=Re(r),n=e;return le(e.customData.operationType,t,"argument-error"),le((s=n.customData._serverResponse)==null?void 0:s.mfaPendingCredential,t,"argument-error"),b0._fromError(t,n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QS(r,e){return Ot(r,"POST","/v2/accounts/mfaEnrollment:start",Nt(r,e))}function GV(r,e){return Ot(r,"POST","/v2/accounts/mfaEnrollment:finalize",Nt(r,e))}function KV(r,e){return Ot(r,"POST","/v2/accounts/mfaEnrollment:withdraw",Nt(r,e))}class E0{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(n=>yd._fromServerResponse(e.auth,n)))})}static _fromUser(e){return new E0(e)}async getSession(){return bo._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const n=e,s=await this.getSession(),o=await ss(this.user,n._process(this.user.auth,s,t));return await this.user._updateTokensIfNecessary(o),this.user.reload()}async unenroll(e){const t=typeof e=="string"?e:e.uid,n=await this.user.getIdToken();try{const s=await ss(this.user,KV(this.user.auth,{idToken:n,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:o})=>o!==t),await this.user._updateTokensIfNecessary(s),await this.user.reload()}catch(s){throw s}}}const S_=new WeakMap;function WV(r){const e=Re(r);return S_.has(e)||S_.set(e,E0._fromUser(e)),S_.get(e)}const eg="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mR{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(eg,"1"),this.storage.removeItem(eg),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QV=1e3,YV=10;class gR extends mR{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Xx(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),s=this.localCache[t];n!==s&&e(t,s,n)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((c,h,d)=>{this.notifyListeners(c,d)});return}const n=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const c=this.storage.getItem(n);!t&&this.localCache[n]===c||this.notifyListeners(n,c)},o=this.storage.getItem(n);k2()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,YV):s()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},QV)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}gR.type="LOCAL";const T0=gR;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pR extends mR{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}pR.type="SESSION";const Co=pR;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JV(r){return Promise.all(r.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pg{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const n=new Pg(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:s,data:o}=t.data,c=this.handlersMap[s];if(!(c!=null&&c.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const h=Array.from(c).map(async m=>m(t.origin,o)),d=await JV(h);t.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:d})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Pg.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _d(r="",e=10){let t="";for(let n=0;n<e;n++)t+=Math.floor(Math.random()*10);return r+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XV{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let o,c;return new Promise((h,d)=>{const m=_d("",20);s.port1.start();const y=setTimeout(()=>{d(new Error("unsupported_event"))},n);c={messageChannel:s,onMessage(_){const E=_;if(E.data.eventId===m)switch(E.data.status){case"ack":clearTimeout(y),o=setTimeout(()=>{d(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),h(E.data.response);break;default:clearTimeout(y),clearTimeout(o),d(new Error("invalid_response"));break}}},this.handlers.add(c),s.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:e,eventId:m,data:t},[s.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jt(){return window}function ZV(r){Jt().location.href=r}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S0(){return typeof Jt().WorkerGlobalScope<"u"&&typeof Jt().importScripts=="function"}async function eM(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function tM(){var r;return((r=navigator==null?void 0:navigator.serviceWorker)==null?void 0:r.controller)||null}function nM(){return S0()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yR="firebaseLocalStorageDb",rM=1,tg="firebaseLocalStorage",_R="fbase_key";class vd{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Dg(r,e){return r.transaction([tg],e?"readwrite":"readonly").objectStore(tg)}function iM(){const r=indexedDB.deleteDatabase(yR);return new vd(r).toPromise()}function ev(){const r=indexedDB.open(yR,rM);return new Promise((e,t)=>{r.addEventListener("error",()=>{t(r.error)}),r.addEventListener("upgradeneeded",()=>{const n=r.result;try{n.createObjectStore(tg,{keyPath:_R})}catch(s){t(s)}}),r.addEventListener("success",async()=>{const n=r.result;n.objectStoreNames.contains(tg)?e(n):(n.close(),await iM(),e(await ev()))})})}async function YS(r,e,t){const n=Dg(r,!0).put({[_R]:e,value:t});return new vd(n).toPromise()}async function sM(r,e){const t=Dg(r,!1).get(e),n=await new vd(t).toPromise();return n===void 0?null:n.value}function JS(r,e){const t=Dg(r,!0).delete(e);return new vd(t).toPromise()}const aM=800,oM=3;class vR{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await ev(),this.db)}async _withRetries(e){let t=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(t++>oM)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return S0()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Pg._getInstance(nM()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,n;if(this.activeServiceWorker=await eM(),!this.activeServiceWorker)return;this.sender=new XV(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(n=e[0])!=null&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||tM()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await ev();return await YS(e,eg,"1"),await JS(e,eg),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>YS(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(n=>sM(n,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>JS(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const o=Dg(s,!1).getAll();return new vd(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:o}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),aM)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}vR.type="LOCAL";const Kh=vR;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XS(r,e){return Ot(r,"POST","/v2/accounts/mfaSignIn:start",Nt(r,e))}function lM(r,e){return Ot(r,"POST","/v2/accounts/mfaSignIn:finalize",Nt(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A_=eR("rcb"),cM=new fd(3e4,6e4);class uM{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!((e=Jt().grecaptcha)!=null&&e.render)}load(e,t=""){return le(hM(t),e,"argument-error"),this.shouldResolveImmediately(t)&&BS(Jt().grecaptcha)?Promise.resolve(Jt().grecaptcha):new Promise((n,s)=>{const o=Jt().setTimeout(()=>{s(rn(e,"network-request-failed"))},cM.get());Jt()[A_]=()=>{Jt().clearTimeout(o),delete Jt()[A_];const h=Jt().grecaptcha;if(!h||!BS(h)){s(rn(e,"internal-error"));return}const d=h.render;h.render=(m,y)=>{const _=d(m,y);return this.counter++,_},this.hostLanguage=t,n(h)};const c=`${j2()}?${Lc({onload:A_,render:"explicit",hl:t})}`;p0(c).catch(()=>{clearTimeout(o),s(rn(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!((t=Jt().grecaptcha)!=null&&t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function hM(r){return r.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(r)}class dM{async load(e){return new z2(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ih="recaptcha",fM={theme:"light",type:"image"};let mM=class{constructor(e,t,n={...fM}){this.parameters=n,this.type=Ih,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=xt(e),this.isInvisible=this.parameters.size==="invisible",le(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const s=typeof t=="string"?document.getElementById(t):t;le(s,this.auth,"argument-error"),this.container=s,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new dM:new uM,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),n=t.getResponse(e);return n||new Promise(s=>{const o=c=>{c&&(this.tokenChangeListeners.delete(o),s(c))};this.tokenChangeListeners.add(o),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){le(!this.parameters.sitekey,this.auth,"argument-error"),le(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),le(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(n=>n(t)),typeof e=="function")e(t);else if(typeof e=="string"){const n=Jt()[e];typeof n=="function"&&n(t)}}}assertNotDestroyed(){le(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){le(m0()&&!S0(),this.auth,"internal-error"),await gM(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await _2(this.auth);le(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return le(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function gM(){let r=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}r=()=>e(),window.addEventListener("load",r)}).catch(e=>{throw r&&window.removeEventListener("load",r),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A0{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=xo._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function pM(r,e,t){if(Et(r.app))return Promise.reject(hn(r));const n=xt(r),s=await Vg(n,e,Re(t));return new A0(s,o=>Ng(n,o))}async function yM(r,e,t){const n=Re(r);await kg(!1,n,"phone");const s=await Vg(n.auth,e,Re(t));return new A0(s,o=>cR(n,o))}async function _M(r,e,t){const n=Re(r);if(Et(n.auth.app))return Promise.reject(hn(n.auth));const s=await Vg(n.auth,e,Re(t));return new A0(s,o=>uR(n,o))}async function Vg(r,e,t){var n;if(!r._getRecaptchaConfig())try{await W2(r)}catch{console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let s;if(typeof e=="string"?s={phoneNumber:e}:s=e,"session"in s){const o=s.session;if("phoneNumber"in s){le(o.type==="enroll",r,"internal-error");const c={idToken:o.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,clientType:"CLIENT_TYPE_WEB"}};return(await sa(r,c,"mfaSmsEnrollment",async(y,_)=>{if(_.phoneEnrollmentInfo.captchaResponse===Ah){le((t==null?void 0:t.type)===Ih,y,"argument-error");const E=await I_(y,_,t);return QS(y,E)}return QS(y,_)},"PHONE_PROVIDER").catch(y=>Promise.reject(y))).phoneSessionInfo.sessionInfo}else{le(o.type==="signin",r,"internal-error");const c=((n=s.multiFactorHint)==null?void 0:n.uid)||s.multiFactorUid;le(c,r,"missing-multi-factor-info");const h={mfaPendingCredential:o.credential,mfaEnrollmentId:c,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}};return(await sa(r,h,"mfaSmsSignIn",async(_,E)=>{if(E.phoneSignInInfo.captchaResponse===Ah){le((t==null?void 0:t.type)===Ih,_,"argument-error");const S=await I_(_,E,t);return XS(_,S)}return XS(_,E)},"PHONE_PROVIDER").catch(_=>Promise.reject(_))).phoneResponseInfo.sessionInfo}}else{const o={phoneNumber:s.phoneNumber,clientType:"CLIENT_TYPE_WEB"};return(await sa(r,o,"sendVerificationCode",async(m,y)=>{if(y.captchaResponse===Ah){le((t==null?void 0:t.type)===Ih,m,"argument-error");const _=await I_(m,y,t);return KS(m,_)}return KS(m,y)},"PHONE_PROVIDER").catch(m=>Promise.reject(m))).sessionInfo}}finally{t==null||t._reset()}}async function vM(r,e){const t=Re(r);if(Et(t.auth.app))return Promise.reject(hn(t.auth));await y0(t,e)}async function I_(r,e,t){le(t.type===Ih,r,"argument-error");const n=await t.verify();le(typeof n=="string",r,"argument-error");const s={...e};if("phoneEnrollmentInfo"in s){const o=s.phoneEnrollmentInfo.phoneNumber,c=s.phoneEnrollmentInfo.captchaResponse,h=s.phoneEnrollmentInfo.clientType,d=s.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(s,{phoneEnrollmentInfo:{phoneNumber:o,recaptchaToken:n,captchaResponse:c,clientType:h,recaptchaVersion:d}}),s}else if("phoneSignInInfo"in s){const o=s.phoneSignInInfo.captchaResponse,c=s.phoneSignInInfo.clientType,h=s.phoneSignInInfo.recaptchaVersion;return Object.assign(s,{phoneSignInInfo:{recaptchaToken:n,captchaResponse:o,clientType:c,recaptchaVersion:h}}),s}else return Object.assign(s,{recaptchaToken:n}),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ko=class Pm{constructor(e){this.providerId=Pm.PROVIDER_ID,this.auth=xt(e)}verifyPhoneNumber(e,t){return Vg(this.auth,e,Re(t))}static credential(e,t){return xo._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Pm.credentialFromTaggedObject(t)}static credentialFromError(e){return Pm.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:n}=e;return t&&n?xo._fromTokenResponse(t,n):null}};ko.PROVIDER_ID="phone";ko.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zo(r,e){return e?cr(e):(le(r._popupRedirectResolver,r,"argument-error"),r._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I0 extends Bc{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return rs(e,this._buildIdpRequest())}_linkToIdToken(e,t){return rs(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return rs(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function wM(r){return lR(r.auth,new I0(r),r.bypassAuthState)}function bM(r){const{auth:e,user:t}=r;return le(t,e,"internal-error"),oR(t,new I0(r),r.bypassAuthState)}async function EM(r){const{auth:e,user:t}=r;return le(t,e,"internal-error"),y0(t,new I0(r),r.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wR{constructor(e,t,n,s,o=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:s,tenantId:o,error:c,type:h}=e;if(c){this.reject(c);return}const d={auth:this.auth,requestUri:t,sessionId:n,tenantId:o||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(h)(d))}catch(m){this.reject(m)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return wM;case"linkViaPopup":case"linkViaRedirect":return EM;case"reauthViaPopup":case"reauthViaRedirect":return bM;default:bn(this.auth,"internal-error")}}resolve(e){Yr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Yr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TM=new fd(2e3,1e4);async function SM(r,e,t){if(Et(r.app))return Promise.reject(rn(r,"operation-not-supported-in-this-environment"));const n=xt(r);Uc(r,e,cs);const s=zo(n,t);return new ts(n,"signInViaPopup",e,s).executeNotNull()}async function AM(r,e,t){const n=Re(r);if(Et(n.auth.app))return Promise.reject(rn(n.auth,"operation-not-supported-in-this-environment"));Uc(n.auth,e,cs);const s=zo(n.auth,t);return new ts(n.auth,"reauthViaPopup",e,s,n).executeNotNull()}async function IM(r,e,t){const n=Re(r);Uc(n.auth,e,cs);const s=zo(n.auth,t);return new ts(n.auth,"linkViaPopup",e,s,n).executeNotNull()}class ts extends wR{constructor(e,t,n,s,o){super(e,t,s,o),this.provider=n,this.authWindow=null,this.pollId=null,ts.currentPopupAction&&ts.currentPopupAction.cancel(),ts.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return le(e,this.auth,"internal-error"),e}async onExecution(){Yr(this.filter.length===1,"Popup operations only handle one event");const e=_d();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(rn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(rn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ts.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;if((n=(t=this.authWindow)==null?void 0:t.window)!=null&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(rn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,TM.get())};e()}}ts.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xM="pendingRedirect",xh=new Map;class RM extends wR{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=xh.get(this.auth._key());if(!e){try{const n=await CM(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}xh.set(this.auth._key(),e)}return this.bypassAuthState||xh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function CM(r,e){const t=ER(e),n=bR(r);if(!await n._isAvailable())return!1;const s=await n._get(t)==="true";return await n._remove(t),s}async function x0(r,e){return bR(r)._set(ER(e),"true")}function kM(){xh.clear()}function R0(r,e){xh.set(r._key(),e)}function bR(r){return cr(r._redirectPersistence)}function ER(r){return Io(xM,r.config.apiKey,r.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NM(r,e,t){return OM(r,e,t)}async function OM(r,e,t){if(Et(r.app))return Promise.reject(hn(r));const n=xt(r);Uc(r,e,cs),await n._initializationPromise;const s=zo(n,t);return await x0(s,n),s._openRedirect(n,e,"signInViaRedirect")}function PM(r,e,t){return DM(r,e,t)}async function DM(r,e,t){const n=Re(r);if(Uc(n.auth,e,cs),Et(n.auth.app))return Promise.reject(hn(n.auth));await n.auth._initializationPromise;const s=zo(n.auth,t);await x0(s,n.auth);const o=await TR(n);return s._openRedirect(n.auth,e,"reauthViaRedirect",o)}function VM(r,e,t){return MM(r,e,t)}async function MM(r,e,t){const n=Re(r);Uc(n.auth,e,cs),await n.auth._initializationPromise;const s=zo(n.auth,t);await kg(!1,n,e.providerId),await x0(s,n.auth);const o=await TR(n);return s._openRedirect(n.auth,e,"linkViaRedirect",o)}async function jM(r,e){return await xt(r)._initializationPromise,Mg(r,e,!1)}async function Mg(r,e,t=!1){if(Et(r.app))return Promise.reject(hn(r));const n=xt(r),s=zo(n,e),c=await new RM(n,s,t).execute();return c&&!t&&(delete c.user._redirectEventId,await n._persistUserIfCurrent(c.user),await n._setRedirectUser(null,e)),c}async function TR(r){const e=_d(`${r.uid}:::`);return r._redirectEventId=e,await r.auth._setRedirectUser(r),await r.auth._persistUserIfCurrent(r),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LM=600*1e3;class SR{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!UM(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!AR(e)){const s=((n=e.error.code)==null?void 0:n.split("auth/")[1])||"internal-error";t.onError(rn(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=LM&&this.cachedEventUids.clear(),this.cachedEventUids.has(ZS(e))}saveEventToCache(e){this.cachedEventUids.add(ZS(e)),this.lastProcessedEventTime=Date.now()}}function ZS(r){return[r.type,r.eventId,r.sessionId,r.tenantId].filter(e=>e).join("-")}function AR({type:r,error:e}){return r==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function UM(r){switch(r.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return AR(r);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IR(r,e={}){return Ot(r,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BM=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,FM=/^https?/;async function zM(r){if(r.config.emulator)return;const{authorizedDomains:e}=await IR(r);for(const t of e)try{if(qM(t))return}catch{}bn(r,"unauthorized-domain")}function qM(r){const e=$h(),{protocol:t,hostname:n}=new URL(e);if(r.startsWith("chrome-extension://")){const c=new URL(r);return c.hostname===""&&n===""?t==="chrome-extension:"&&r.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&c.hostname===n}if(!FM.test(t))return!1;if(BM.test(r))return n===r;const s=r.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $M=new fd(3e4,6e4);function eA(){const r=Jt().___jsl;if(r!=null&&r.H){for(const e of Object.keys(r.H))if(r.H[e].r=r.H[e].r||[],r.H[e].L=r.H[e].L||[],r.H[e].r=[...r.H[e].L],r.CP)for(let t=0;t<r.CP.length;t++)r.CP[t]=null}}function HM(r){return new Promise((e,t)=>{var s,o,c;function n(){eA(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{eA(),t(rn(r,"network-request-failed"))},timeout:$M.get()})}if((o=(s=Jt().gapi)==null?void 0:s.iframes)!=null&&o.Iframe)e(gapi.iframes.getContext());else if((c=Jt().gapi)!=null&&c.load)n();else{const h=eR("iframefcb");return Jt()[h]=()=>{gapi.load?n():t(rn(r,"network-request-failed"))},p0(`${U2()}?onload=${h}`).catch(d=>t(d))}}).catch(e=>{throw Dm=null,e})}let Dm=null;function GM(r){return Dm=Dm||HM(r),Dm}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KM=new fd(5e3,15e3),WM="__/auth/iframe",QM="emulator/auth/iframe",YM={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},JM=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function XM(r){const e=r.config;le(e.authDomain,r,"auth-domain-config-required");const t=e.emulator?g0(e,QM):`https://${r.config.authDomain}/${WM}`,n={apiKey:e.apiKey,appName:r.name,v:ba},s=JM.get(r.config.apiHost);s&&(n.eid=s);const o=r._getFrameworks();return o.length&&(n.fw=o.join(",")),`${t}?${Lc(n).slice(1)}`}async function ZM(r){const e=await GM(r),t=Jt().gapi;return le(t,r,"internal-error"),e.open({where:document.body,url:XM(r),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:YM,dontclear:!0},n=>new Promise(async(s,o)=>{await n.restyle({setHideOnLeave:!1});const c=rn(r,"network-request-failed"),h=Jt().setTimeout(()=>{o(c)},KM.get());function d(){Jt().clearTimeout(h),s(n)}n.ping(d).then(d,()=>{o(c)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ej={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},tj=500,nj=600,rj="_blank",ij="http://localhost";class tA{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function sj(r,e,t,n=tj,s=nj){const o=Math.max((window.screen.availHeight-s)/2,0).toString(),c=Math.max((window.screen.availWidth-n)/2,0).toString();let h="";const d={...ej,width:n.toString(),height:s.toString(),top:o,left:c},m=It().toLowerCase();t&&(h=Wx(m)?rj:t),Gx(m)&&(e=e||ij,d.scrollbars="yes");const y=Object.entries(d).reduce((E,[S,C])=>`${E}${S}=${C},`,"");if(C2(m)&&h!=="_self")return aj(e||"",h),new tA(null);const _=window.open(e||"",h,y);le(_,r,"popup-blocked");try{_.focus()}catch{}return new tA(_)}function aj(r,e){const t=document.createElement("a");t.href=r,t.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oj="__/auth/handler",lj="emulator/auth/handler",cj=encodeURIComponent("fac");async function tv(r,e,t,n,s,o){le(r.config.authDomain,r,"auth-domain-config-required"),le(r.config.apiKey,r,"invalid-api-key");const c={apiKey:r.config.apiKey,appName:r.name,authType:t,redirectUrl:n,v:ba,eventId:s};if(e instanceof cs){e.setDefaultLanguage(r.languageCode),c.providerId=e.providerId||"",MP(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[y,_]of Object.entries(o||{}))c[y]=_}if(e instanceof Fc){const y=e.getScopes().filter(_=>_!=="");y.length>0&&(c.scopes=y.join(","))}r.tenantId&&(c.tid=r.tenantId);const h=c;for(const y of Object.keys(h))h[y]===void 0&&delete h[y];const d=await r._getAppCheckToken(),m=d?`#${cj}=${encodeURIComponent(d)}`:"";return`${uj(r)}?${Lc(h).slice(1)}${m}`}function uj({config:r}){return r.emulator?g0(r,lj):`https://${r.authDomain}/${oj}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x_="webStorageSupport";class hj{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Co,this._completeRedirectFn=Mg,this._overrideRedirectResult=R0}async _openPopup(e,t,n,s){var c;Yr((c=this.eventManagers[e._key()])==null?void 0:c.manager,"_initialize() not called before _openPopup()");const o=await tv(e,t,n,$h(),s);return sj(e,o,_d())}async _openRedirect(e,t,n,s){await this._originValidation(e);const o=await tv(e,t,n,$h(),s);return ZV(o),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:o}=this.eventManagers[t];return s?Promise.resolve(s):(Yr(o,"If manager is not set, promise should be"),o)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await ZM(e),n=new SR(e);return t.register("authEvent",s=>(le(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(x_,{type:x_},s=>{var c;const o=(c=s==null?void 0:s[0])==null?void 0:c[x_];o!==void 0&&t(!!o),bn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=zM(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Xx()||Kx()||gd()}}const dj=hj;class fj{constructor(e){this.factorId=e}_process(e,t,n){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,n);case"signin":return this._finalizeSignIn(e,t.credential);default:return Ai("unexpected MultiFactorSessionType")}}}class C0 extends fj{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new C0(e)}_finalizeEnroll(e,t,n){return GV(e,{idToken:t,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return lM(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class xR{constructor(){}static assertion(e){return C0._fromCredential(e)}}xR.FACTOR_ID="phone";var nA="@firebase/auth",rA="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mj{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){le(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gj(r){switch(r){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function pj(r){da(new Ni("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:c,authDomain:h}=n.options;le(c&&!c.includes(":"),"invalid-api-key",{appName:n.name});const d={apiKey:c,authDomain:h,clientPlatform:r,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Zx(r)},m=new V2(n,s,o,d);return Q2(m,t),m},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),da(new Ni("auth-internal",e=>{const t=xt(e.getProvider("auth").getImmediate());return(n=>new mj(n))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Kr(nA,rA,gj(r)),Kr(nA,rA,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yj=300;SP("authIdTokenMaxAge");function _j(){var r;return((r=document.getElementsByTagName("head"))==null?void 0:r[0])??document}M2({loadJS(r){return new Promise((e,t)=>{const n=document.createElement("script");n.setAttribute("src",r),n.onload=e,n.onerror=s=>{const o=rn("internal-error");o.customData=s,t(o)},n.type="text/javascript",n.charset="UTF-8",_j().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});pj("Browser");/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function No(){return window}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vj=2e3;async function wj(r,e,t){const{BuildInfo:n}=No();Yr(e.sessionId,"AuthEvent did not contain a session ID");const s=await Aj(e.sessionId),o={};return gd()?o.ibi=n.packageName:md()?o.apn=n.packageName:bn(r,"operation-not-supported-in-this-environment"),n.displayName&&(o.appDisplayName=n.displayName),o.sessionId=s,tv(r,t,e.type,void 0,e.eventId??void 0,o)}async function bj(r){const{BuildInfo:e}=No(),t={};gd()?t.iosBundleId=e.packageName:md()?t.androidPackageName=e.packageName:bn(r,"operation-not-supported-in-this-environment"),await IR(r,t)}function Ej(r){const{cordova:e}=No();return new Promise(t=>{e.plugins.browsertab.isAvailable(n=>{let s=null;n?e.plugins.browsertab.openUrl(r):s=e.InAppBrowser.open(r,R2()?"_blank":"_system","location=yes"),t(s)})})}async function Tj(r,e,t){const{cordova:n}=No();let s=()=>{};try{await new Promise((o,c)=>{let h=null;function d(){var E;o();const _=(E=n.plugins.browsertab)==null?void 0:E.close;typeof _=="function"&&_(),typeof(t==null?void 0:t.close)=="function"&&t.close()}function m(){h||(h=window.setTimeout(()=>{c(rn(r,"redirect-cancelled-by-user"))},vj))}function y(){(document==null?void 0:document.visibilityState)==="visible"&&m()}e.addPassiveListener(d),document.addEventListener("resume",m,!1),md()&&document.addEventListener("visibilitychange",y,!1),s=()=>{e.removePassiveListener(d),document.removeEventListener("resume",m,!1),document.removeEventListener("visibilitychange",y,!1),h&&window.clearTimeout(h)}})}finally{s()}}function Sj(r){var t,n,s,o,c,h,d,m,y,_;const e=No();le(typeof((t=e==null?void 0:e.universalLinks)==null?void 0:t.subscribe)=="function",r,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),le(typeof((n=e==null?void 0:e.BuildInfo)==null?void 0:n.packageName)<"u",r,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),le(typeof((c=(o=(s=e==null?void 0:e.cordova)==null?void 0:s.plugins)==null?void 0:o.browsertab)==null?void 0:c.openUrl)=="function",r,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),le(typeof((m=(d=(h=e==null?void 0:e.cordova)==null?void 0:h.plugins)==null?void 0:d.browsertab)==null?void 0:m.isAvailable)=="function",r,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),le(typeof((_=(y=e==null?void 0:e.cordova)==null?void 0:y.InAppBrowser)==null?void 0:_.open)=="function",r,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function Aj(r){const e=Ij(r),t=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(s=>s.toString(16).padStart(2,"0")).join("")}function Ij(r){if(Yr(/[0-9a-zA-Z]+/.test(r),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(r);const e=new ArrayBuffer(r.length),t=new Uint8Array(e);for(let n=0;n<r.length;n++)t[n]=r.charCodeAt(n);return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xj=20;class Rj extends SR{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInitialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInitialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function Cj(r,e,t=null){return{type:e,eventId:t,urlResponse:null,sessionId:Oj(),postBody:null,tenantId:r.tenantId,error:rn(r,"no-auth-event")}}function kj(r,e){return nv()._set(rv(r),e)}async function iA(r){const e=await nv()._get(rv(r));return e&&await nv()._remove(rv(r)),e}function Nj(r,e){var n,s;const t=Dj(e);if(t.includes("/__/auth/callback")){const o=Vm(t),c=o.firebaseError?Pj(decodeURIComponent(o.firebaseError)):null,h=(s=(n=c==null?void 0:c.code)==null?void 0:n.split("auth/"))==null?void 0:s[1],d=h?rn(h):null;return d?{type:r.type,eventId:r.eventId,tenantId:r.tenantId,error:d,urlResponse:null,sessionId:null,postBody:null}:{type:r.type,eventId:r.eventId,tenantId:r.tenantId,sessionId:r.sessionId,urlResponse:t,postBody:null}}return null}function Oj(){const r=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<xj;t++){const n=Math.floor(Math.random()*e.length);r.push(e.charAt(n))}return r.join("")}function nv(){return cr(T0)}function rv(r){return Io("authEvent",r.config.apiKey,r.name)}function Pj(r){try{return JSON.parse(r)}catch{return null}}function Dj(r){const e=Vm(r),t=e.link?decodeURIComponent(e.link):void 0,n=Vm(t).link,s=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return Vm(s).link||s||n||t||r}function Vm(r){if(!(r!=null&&r.includes("?")))return{};const[e,...t]=r.split("?");return ic(t.join("?"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vj=500;class Mj{constructor(){this._redirectPersistence=Co,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Mg,this._overrideRedirectResult=R0}async _initialize(e){const t=e._key();let n=this.eventManagers.get(t);return n||(n=new Rj(e),this.eventManagers.set(t,n),this.attachCallbackListeners(e,n)),n}_openPopup(e){bn(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,n,s){Sj(e);const o=await this._initialize(e);await o.initialized(),o.resetRedirect(),kM(),await this._originValidation(e);const c=Cj(e,n,s);await kj(e,c);const h=await wj(e,c,t),d=await Ej(h);return Tj(e,o,d)}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=bj(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){const{universalLinks:n,handleOpenURL:s,BuildInfo:o}=No(),c=setTimeout(async()=>{await iA(e),t.onEvent(sA())},Vj),h=async y=>{clearTimeout(c);const _=await iA(e);let E=null;_&&(y!=null&&y.url)&&(E=Nj(_,y.url)),t.onEvent(E||sA())};typeof n<"u"&&typeof n.subscribe=="function"&&n.subscribe(null,h);const d=s,m=`${o.packageName.toLowerCase()}://`;No().handleOpenURL=async y=>{if(y.toLowerCase().startsWith(m)&&h({url:y}),typeof d=="function")try{d(y)}catch(_){console.error(_)}}}}const jj=Mj;function sA(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:rn("no-auth-event")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lj(r,e){xt(r)._logFramework(e)}var Uj="@firebase/auth-compat",Bj="0.6.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fj=1e3;function Rh(){var r;return((r=self==null?void 0:self.location)==null?void 0:r.protocol)||null}function zj(){return Rh()==="http:"||Rh()==="https:"}function RR(r=It()){return!!((Rh()==="file:"||Rh()==="ionic:"||Rh()==="capacitor:")&&r.toLowerCase().match(/iphone|ipad|ipod|android/))}function qj(){return a0()||Ag()}function $j(){return wx()&&(document==null?void 0:document.documentMode)===11}function Hj(r=It()){return/Edge\/\d+/.test(r)}function Gj(r=It()){return $j()||Hj(r)}function CR(){try{const r=self.localStorage,e=_d();if(r)return r.setItem(e,"1"),r.removeItem(e),Gj()?Fh():!0}catch{return k0()&&Fh()}return!1}function k0(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function R_(){return(zj()||vx()||RR())&&!qj()&&CR()&&!k0()}function kR(){return RR()&&typeof document<"u"}async function Kj(){return kR()?new Promise(r=>{const e=setTimeout(()=>{r(!1)},Fj);document.addEventListener("deviceready",()=>{clearTimeout(e),r(!0)})}):!1}function Wj(){return typeof window<"u"?window:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ar={LOCAL:"local",NONE:"none",SESSION:"session"},oh=le,NR="persistence";function Qj(r,e){if(oh(Object.values(ar).includes(e),r,"invalid-persistence-type"),a0()){oh(e!==ar.SESSION,r,"unsupported-persistence-type");return}if(Ag()){oh(e===ar.NONE,r,"unsupported-persistence-type");return}if(k0()){oh(e===ar.NONE||e===ar.LOCAL&&Fh(),r,"unsupported-persistence-type");return}oh(e===ar.NONE||CR(),r,"unsupported-persistence-type")}async function iv(r){await r._initializationPromise;const e=OR(),t=Io(NR,r.config.apiKey,r.name);e&&e.setItem(t,r._getPersistenceType())}function Yj(r,e){const t=OR();if(!t)return[];const n=Io(NR,r,e);switch(t.getItem(n)){case ar.NONE:return[mc];case ar.LOCAL:return[Kh,Co];case ar.SESSION:return[Co];default:return[]}}function OR(){var r;try{return((r=Wj())==null?void 0:r.sessionStorage)||null}catch{return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jj=le;class ta{constructor(){this.browserResolver=cr(dj),this.cordovaResolver=cr(jj),this.underlyingResolver=null,this._redirectPersistence=Co,this._completeRedirectFn=Mg,this._overrideRedirectResult=R0}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,n,s){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,n,s)}async _openRedirect(e,t,n,s){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,n,s)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return kR()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return Jj(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await Kj();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PR(r){return r.unwrap()}function Xj(r){return r.wrapped()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zj(r){return DR(r)}function e4(r,e){var n;const t=(n=e.customData)==null?void 0:n._tokenResponse;if((e==null?void 0:e.code)==="auth/multi-factor-auth-required"){const s=e;s.resolver=new t4(r,HV(r,e))}else if(t){const s=DR(e),o=e;s&&(o.credential=s,o.tenantId=t.tenantId||void 0,o.email=t.email||void 0,o.phoneNumber=t.phoneNumber||void 0)}}function DR(r){const{_tokenResponse:e}=r instanceof Vn?r.customData:r;if(!e)return null;if(!(r instanceof Vn)&&"temporaryProof"in e&&"phoneNumber"in e)return ko.credentialFromResult(r);const t=e.providerId;if(!t||t===sh.PASSWORD)return null;let n;switch(t){case sh.GOOGLE:n=Ei;break;case sh.FACEBOOK:n=bi;break;case sh.GITHUB:n=Ti;break;case sh.TWITTER:n=Si;break;default:const{oauthIdToken:s,oauthAccessToken:o,oauthTokenSecret:c,pendingToken:h,nonce:d}=e;return!o&&!c&&!s&&!h?null:h?t.startsWith("saml.")?gc._create(t,h):Oi._fromParams({providerId:t,signInMethod:t,pendingToken:h,idToken:s,accessToken:o}):new oc(t).credential({idToken:s,accessToken:o,rawNonce:d})}return r instanceof Vn?n.credentialFromError(r):n.credentialFromResult(r)}function Hn(r,e){return e.catch(t=>{throw t instanceof Vn&&e4(r,t),t}).then(t=>{const n=t.operationType,s=t.user;return{operationType:n,credential:Zj(t),additionalUserInfo:$V(t),user:jg.getOrCreate(s)}})}async function sv(r,e){const t=await e;return{verificationId:t.verificationId,confirm:n=>Hn(r,t.confirm(n))}}class t4{constructor(e,t){this.resolver=t,this.auth=Xj(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return Hn(PR(this.auth),this.resolver.resolveSignIn(e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jg=class ph{constructor(e){this._delegate=e,this.multiFactor=WV(e)}static getOrCreate(e){return ph.USER_MAP.has(e)||ph.USER_MAP.set(e,new ph(e)),ph.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return Hn(this.auth,cR(this._delegate,e))}async linkWithPhoneNumber(e,t){return sv(this.auth,yM(this._delegate,e,t))}async linkWithPopup(e){return Hn(this.auth,IM(this._delegate,e,ta))}async linkWithRedirect(e){return await iv(xt(this.auth)),VM(this._delegate,e,ta)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return Hn(this.auth,uR(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return sv(this.auth,_M(this._delegate,e,t))}reauthenticateWithPopup(e){return Hn(this.auth,AM(this._delegate,e,ta))}async reauthenticateWithRedirect(e){return await iv(xt(this.auth)),PM(this._delegate,e,ta)}sendEmailVerification(e){return PV(this._delegate,e)}async unlink(e){return await vV(this._delegate,e),this}updateEmail(e){return jV(this._delegate,e)}updatePassword(e){return LV(this._delegate,e)}updatePhoneNumber(e){return vM(this._delegate,e)}updateProfile(e){return MV(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return DV(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}};jg.USER_MAP=new WeakMap;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lh=le;let av=class{constructor(e,t){if(this.app=e,t.isInitialized()){this._delegate=t.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:n}=e.options;lh(n,"invalid-api-key",{appName:e.name}),lh(n,"invalid-api-key",{appName:e.name});const s=typeof window<"u"?ta:void 0;this._delegate=t.initialize({options:{persistence:n4(n,e.name),popupRedirectResolver:s}}),this._delegate._updateErrorMap(l2),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?jg.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){Y2(this._delegate,e,t)}applyActionCode(e){return SV(this._delegate,e)}checkActionCode(e){return hR(this._delegate,e)}confirmPasswordReset(e,t){return TV(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return Hn(this._delegate,IV(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return OV(this._delegate,e)}isSignInWithEmailLink(e){return CV(this._delegate,e)}async getRedirectResult(){lh(R_(),this._delegate,"operation-not-supported-in-this-environment");const e=await jM(this._delegate,ta);return e?Hn(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){Lj(this._delegate,e)}onAuthStateChanged(e,t,n){const{next:s,error:o,complete:c}=aA(e,t,n);return this._delegate.onAuthStateChanged(s,o,c)}onIdTokenChanged(e,t,n){const{next:s,error:o,complete:c}=aA(e,t,n);return this._delegate.onIdTokenChanged(s,o,c)}sendSignInLinkToEmail(e,t){return RV(this._delegate,e,t)}sendPasswordResetEmail(e,t){return EV(this._delegate,e,t||void 0)}async setPersistence(e){Qj(this._delegate,e);let t;switch(e){case ar.SESSION:t=Co;break;case ar.LOCAL:t=await cr(Kh)._isAvailable()?Kh:T0;break;case ar.NONE:t=mc;break;default:return bn("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return Hn(this._delegate,_V(this._delegate))}signInWithCredential(e){return Hn(this._delegate,Ng(this._delegate,e))}signInWithCustomToken(e){return Hn(this._delegate,bV(this._delegate,e))}signInWithEmailAndPassword(e,t){return Hn(this._delegate,xV(this._delegate,e,t))}signInWithEmailLink(e,t){return Hn(this._delegate,kV(this._delegate,e,t))}signInWithPhoneNumber(e,t){return sv(this._delegate,pM(this._delegate,e,t))}async signInWithPopup(e){return lh(R_(),this._delegate,"operation-not-supported-in-this-environment"),Hn(this._delegate,SM(this._delegate,e,ta))}async signInWithRedirect(e){return lh(R_(),this._delegate,"operation-not-supported-in-this-environment"),await iv(this._delegate),NM(this._delegate,e,ta)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return AV(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}};av.Persistence=ar;function aA(r,e,t){let n=r;typeof r!="function"&&({next:n,error:e,complete:t}=r);const s=n;return{next:c=>s(c&&jg.getOrCreate(c)),error:e,complete:t}}function n4(r,e){const t=Yj(r,e);if(typeof self<"u"&&!t.includes(Kh)&&t.push(Kh),typeof window<"u")for(const n of[T0,Co])t.includes(n)||t.push(n);return t.includes(mc)||t.push(mc),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N0{static credential(e,t){return ko.credential(e,t)}constructor(){this.providerId="phone",this._delegate=new ko(PR(xr.auth()))}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}N0.PHONE_SIGN_IN_METHOD=ko.PHONE_SIGN_IN_METHOD;N0.PROVIDER_ID=ko.PROVIDER_ID;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r4=le;class i4{constructor(e,t,n=xr.app()){var s;r4((s=n.options)==null?void 0:s.apiKey,"invalid-api-key",{appName:n.name}),this._delegate=new mM(n.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s4="auth-compat";function a4(r){r.INTERNAL.registerComponent(new Ni(s4,e=>{const t=e.getProvider("app-compat").getImmediate(),n=e.getProvider("auth");return new av(t,n)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Ll.EMAIL_SIGNIN,PASSWORD_RESET:Ll.PASSWORD_RESET,RECOVER_EMAIL:Ll.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:Ll.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:Ll.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:Ll.VERIFY_EMAIL}},EmailAuthProvider:Ea,FacebookAuthProvider:bi,GithubAuthProvider:Ti,GoogleAuthProvider:Ei,OAuthProvider:oc,SAMLAuthProvider:Xm,PhoneAuthProvider:N0,PhoneMultiFactorGenerator:xR,RecaptchaVerifier:i4,TwitterAuthProvider:Si,Auth:av,AuthCredential:Bc,Error:Vn}).setInstantiationMode("LAZY").setMultipleInstances(!1)),r.registerVersion(Uj,Bj)}a4(xr);var oA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var aa,VR;(function(){var r;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(R,x){function O(){}O.prototype=x.prototype,R.F=x.prototype,R.prototype=new O,R.prototype.constructor=R,R.D=function(L,M,U){for(var P=Array(arguments.length-2),et=2;et<arguments.length;et++)P[et-2]=arguments[et];return x.prototype[M].apply(L,P)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(n,t),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(R,x,O){O||(O=0);const L=Array(16);if(typeof x=="string")for(var M=0;M<16;++M)L[M]=x.charCodeAt(O++)|x.charCodeAt(O++)<<8|x.charCodeAt(O++)<<16|x.charCodeAt(O++)<<24;else for(M=0;M<16;++M)L[M]=x[O++]|x[O++]<<8|x[O++]<<16|x[O++]<<24;x=R.g[0],O=R.g[1],M=R.g[2];let U=R.g[3],P;P=x+(U^O&(M^U))+L[0]+3614090360&4294967295,x=O+(P<<7&4294967295|P>>>25),P=U+(M^x&(O^M))+L[1]+3905402710&4294967295,U=x+(P<<12&4294967295|P>>>20),P=M+(O^U&(x^O))+L[2]+606105819&4294967295,M=U+(P<<17&4294967295|P>>>15),P=O+(x^M&(U^x))+L[3]+3250441966&4294967295,O=M+(P<<22&4294967295|P>>>10),P=x+(U^O&(M^U))+L[4]+4118548399&4294967295,x=O+(P<<7&4294967295|P>>>25),P=U+(M^x&(O^M))+L[5]+1200080426&4294967295,U=x+(P<<12&4294967295|P>>>20),P=M+(O^U&(x^O))+L[6]+2821735955&4294967295,M=U+(P<<17&4294967295|P>>>15),P=O+(x^M&(U^x))+L[7]+4249261313&4294967295,O=M+(P<<22&4294967295|P>>>10),P=x+(U^O&(M^U))+L[8]+1770035416&4294967295,x=O+(P<<7&4294967295|P>>>25),P=U+(M^x&(O^M))+L[9]+2336552879&4294967295,U=x+(P<<12&4294967295|P>>>20),P=M+(O^U&(x^O))+L[10]+4294925233&4294967295,M=U+(P<<17&4294967295|P>>>15),P=O+(x^M&(U^x))+L[11]+2304563134&4294967295,O=M+(P<<22&4294967295|P>>>10),P=x+(U^O&(M^U))+L[12]+1804603682&4294967295,x=O+(P<<7&4294967295|P>>>25),P=U+(M^x&(O^M))+L[13]+4254626195&4294967295,U=x+(P<<12&4294967295|P>>>20),P=M+(O^U&(x^O))+L[14]+2792965006&4294967295,M=U+(P<<17&4294967295|P>>>15),P=O+(x^M&(U^x))+L[15]+1236535329&4294967295,O=M+(P<<22&4294967295|P>>>10),P=x+(M^U&(O^M))+L[1]+4129170786&4294967295,x=O+(P<<5&4294967295|P>>>27),P=U+(O^M&(x^O))+L[6]+3225465664&4294967295,U=x+(P<<9&4294967295|P>>>23),P=M+(x^O&(U^x))+L[11]+643717713&4294967295,M=U+(P<<14&4294967295|P>>>18),P=O+(U^x&(M^U))+L[0]+3921069994&4294967295,O=M+(P<<20&4294967295|P>>>12),P=x+(M^U&(O^M))+L[5]+3593408605&4294967295,x=O+(P<<5&4294967295|P>>>27),P=U+(O^M&(x^O))+L[10]+38016083&4294967295,U=x+(P<<9&4294967295|P>>>23),P=M+(x^O&(U^x))+L[15]+3634488961&4294967295,M=U+(P<<14&4294967295|P>>>18),P=O+(U^x&(M^U))+L[4]+3889429448&4294967295,O=M+(P<<20&4294967295|P>>>12),P=x+(M^U&(O^M))+L[9]+568446438&4294967295,x=O+(P<<5&4294967295|P>>>27),P=U+(O^M&(x^O))+L[14]+3275163606&4294967295,U=x+(P<<9&4294967295|P>>>23),P=M+(x^O&(U^x))+L[3]+4107603335&4294967295,M=U+(P<<14&4294967295|P>>>18),P=O+(U^x&(M^U))+L[8]+1163531501&4294967295,O=M+(P<<20&4294967295|P>>>12),P=x+(M^U&(O^M))+L[13]+2850285829&4294967295,x=O+(P<<5&4294967295|P>>>27),P=U+(O^M&(x^O))+L[2]+4243563512&4294967295,U=x+(P<<9&4294967295|P>>>23),P=M+(x^O&(U^x))+L[7]+1735328473&4294967295,M=U+(P<<14&4294967295|P>>>18),P=O+(U^x&(M^U))+L[12]+2368359562&4294967295,O=M+(P<<20&4294967295|P>>>12),P=x+(O^M^U)+L[5]+4294588738&4294967295,x=O+(P<<4&4294967295|P>>>28),P=U+(x^O^M)+L[8]+2272392833&4294967295,U=x+(P<<11&4294967295|P>>>21),P=M+(U^x^O)+L[11]+1839030562&4294967295,M=U+(P<<16&4294967295|P>>>16),P=O+(M^U^x)+L[14]+4259657740&4294967295,O=M+(P<<23&4294967295|P>>>9),P=x+(O^M^U)+L[1]+2763975236&4294967295,x=O+(P<<4&4294967295|P>>>28),P=U+(x^O^M)+L[4]+1272893353&4294967295,U=x+(P<<11&4294967295|P>>>21),P=M+(U^x^O)+L[7]+4139469664&4294967295,M=U+(P<<16&4294967295|P>>>16),P=O+(M^U^x)+L[10]+3200236656&4294967295,O=M+(P<<23&4294967295|P>>>9),P=x+(O^M^U)+L[13]+681279174&4294967295,x=O+(P<<4&4294967295|P>>>28),P=U+(x^O^M)+L[0]+3936430074&4294967295,U=x+(P<<11&4294967295|P>>>21),P=M+(U^x^O)+L[3]+3572445317&4294967295,M=U+(P<<16&4294967295|P>>>16),P=O+(M^U^x)+L[6]+76029189&4294967295,O=M+(P<<23&4294967295|P>>>9),P=x+(O^M^U)+L[9]+3654602809&4294967295,x=O+(P<<4&4294967295|P>>>28),P=U+(x^O^M)+L[12]+3873151461&4294967295,U=x+(P<<11&4294967295|P>>>21),P=M+(U^x^O)+L[15]+530742520&4294967295,M=U+(P<<16&4294967295|P>>>16),P=O+(M^U^x)+L[2]+3299628645&4294967295,O=M+(P<<23&4294967295|P>>>9),P=x+(M^(O|~U))+L[0]+4096336452&4294967295,x=O+(P<<6&4294967295|P>>>26),P=U+(O^(x|~M))+L[7]+1126891415&4294967295,U=x+(P<<10&4294967295|P>>>22),P=M+(x^(U|~O))+L[14]+2878612391&4294967295,M=U+(P<<15&4294967295|P>>>17),P=O+(U^(M|~x))+L[5]+4237533241&4294967295,O=M+(P<<21&4294967295|P>>>11),P=x+(M^(O|~U))+L[12]+1700485571&4294967295,x=O+(P<<6&4294967295|P>>>26),P=U+(O^(x|~M))+L[3]+2399980690&4294967295,U=x+(P<<10&4294967295|P>>>22),P=M+(x^(U|~O))+L[10]+4293915773&4294967295,M=U+(P<<15&4294967295|P>>>17),P=O+(U^(M|~x))+L[1]+2240044497&4294967295,O=M+(P<<21&4294967295|P>>>11),P=x+(M^(O|~U))+L[8]+1873313359&4294967295,x=O+(P<<6&4294967295|P>>>26),P=U+(O^(x|~M))+L[15]+4264355552&4294967295,U=x+(P<<10&4294967295|P>>>22),P=M+(x^(U|~O))+L[6]+2734768916&4294967295,M=U+(P<<15&4294967295|P>>>17),P=O+(U^(M|~x))+L[13]+1309151649&4294967295,O=M+(P<<21&4294967295|P>>>11),P=x+(M^(O|~U))+L[4]+4149444226&4294967295,x=O+(P<<6&4294967295|P>>>26),P=U+(O^(x|~M))+L[11]+3174756917&4294967295,U=x+(P<<10&4294967295|P>>>22),P=M+(x^(U|~O))+L[2]+718787259&4294967295,M=U+(P<<15&4294967295|P>>>17),P=O+(U^(M|~x))+L[9]+3951481745&4294967295,R.g[0]=R.g[0]+x&4294967295,R.g[1]=R.g[1]+(M+(P<<21&4294967295|P>>>11))&4294967295,R.g[2]=R.g[2]+M&4294967295,R.g[3]=R.g[3]+U&4294967295}n.prototype.v=function(R,x){x===void 0&&(x=R.length);const O=x-this.blockSize,L=this.C;let M=this.h,U=0;for(;U<x;){if(M==0)for(;U<=O;)s(this,R,U),U+=this.blockSize;if(typeof R=="string"){for(;U<x;)if(L[M++]=R.charCodeAt(U++),M==this.blockSize){s(this,L),M=0;break}}else for(;U<x;)if(L[M++]=R[U++],M==this.blockSize){s(this,L),M=0;break}}this.h=M,this.o+=x},n.prototype.A=function(){var R=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);R[0]=128;for(var x=1;x<R.length-8;++x)R[x]=0;x=this.o*8;for(var O=R.length-8;O<R.length;++O)R[O]=x&255,x/=256;for(this.v(R),R=Array(16),x=0,O=0;O<4;++O)for(let L=0;L<32;L+=8)R[x++]=this.g[O]>>>L&255;return R};function o(R,x){var O=h;return Object.prototype.hasOwnProperty.call(O,R)?O[R]:O[R]=x(R)}function c(R,x){this.h=x;const O=[];let L=!0;for(let M=R.length-1;M>=0;M--){const U=R[M]|0;L&&U==x||(O[M]=U,L=!1)}this.g=O}var h={};function d(R){return-128<=R&&R<128?o(R,function(x){return new c([x|0],x<0?-1:0)}):new c([R|0],R<0?-1:0)}function m(R){if(isNaN(R)||!isFinite(R))return _;if(R<0)return N(m(-R));const x=[];let O=1;for(let L=0;R>=O;L++)x[L]=R/O|0,O*=4294967296;return new c(x,0)}function y(R,x){if(R.length==0)throw Error("number format error: empty string");if(x=x||10,x<2||36<x)throw Error("radix out of range: "+x);if(R.charAt(0)=="-")return N(y(R.substring(1),x));if(R.indexOf("-")>=0)throw Error('number format error: interior "-" character');const O=m(Math.pow(x,8));let L=_;for(let U=0;U<R.length;U+=8){var M=Math.min(8,R.length-U);const P=parseInt(R.substring(U,U+M),x);M<8?(M=m(Math.pow(x,M)),L=L.j(M).add(m(P))):(L=L.j(O),L=L.add(m(P)))}return L}var _=d(0),E=d(1),S=d(16777216);r=c.prototype,r.m=function(){if(k(this))return-N(this).m();let R=0,x=1;for(let O=0;O<this.g.length;O++){const L=this.i(O);R+=(L>=0?L:4294967296+L)*x,x*=4294967296}return R},r.toString=function(R){if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(C(this))return"0";if(k(this))return"-"+N(this).toString(R);const x=m(Math.pow(R,6));var O=this;let L="";for(;;){const M=se(O,x).g;O=G(O,M.j(x));let U=((O.g.length>0?O.g[0]:O.h)>>>0).toString(R);if(O=M,C(O))return U+L;for(;U.length<6;)U="0"+U;L=U+L}},r.i=function(R){return R<0?0:R<this.g.length?this.g[R]:this.h};function C(R){if(R.h!=0)return!1;for(let x=0;x<R.g.length;x++)if(R.g[x]!=0)return!1;return!0}function k(R){return R.h==-1}r.l=function(R){return R=G(this,R),k(R)?-1:C(R)?0:1};function N(R){const x=R.g.length,O=[];for(let L=0;L<x;L++)O[L]=~R.g[L];return new c(O,~R.h).add(E)}r.abs=function(){return k(this)?N(this):this},r.add=function(R){const x=Math.max(this.g.length,R.g.length),O=[];let L=0;for(let M=0;M<=x;M++){let U=L+(this.i(M)&65535)+(R.i(M)&65535),P=(U>>>16)+(this.i(M)>>>16)+(R.i(M)>>>16);L=P>>>16,U&=65535,P&=65535,O[M]=P<<16|U}return new c(O,O[O.length-1]&-2147483648?-1:0)};function G(R,x){return R.add(N(x))}r.j=function(R){if(C(this)||C(R))return _;if(k(this))return k(R)?N(this).j(N(R)):N(N(this).j(R));if(k(R))return N(this.j(N(R)));if(this.l(S)<0&&R.l(S)<0)return m(this.m()*R.m());const x=this.g.length+R.g.length,O=[];for(var L=0;L<2*x;L++)O[L]=0;for(L=0;L<this.g.length;L++)for(let M=0;M<R.g.length;M++){const U=this.i(L)>>>16,P=this.i(L)&65535,et=R.i(M)>>>16,We=R.i(M)&65535;O[2*L+2*M]+=P*We,J(O,2*L+2*M),O[2*L+2*M+1]+=U*We,J(O,2*L+2*M+1),O[2*L+2*M+1]+=P*et,J(O,2*L+2*M+1),O[2*L+2*M+2]+=U*et,J(O,2*L+2*M+2)}for(R=0;R<x;R++)O[R]=O[2*R+1]<<16|O[2*R];for(R=x;R<2*x;R++)O[R]=0;return new c(O,0)};function J(R,x){for(;(R[x]&65535)!=R[x];)R[x+1]+=R[x]>>>16,R[x]&=65535,x++}function K(R,x){this.g=R,this.h=x}function se(R,x){if(C(x))throw Error("division by zero");if(C(R))return new K(_,_);if(k(R))return x=se(N(R),x),new K(N(x.g),N(x.h));if(k(x))return x=se(R,N(x)),new K(N(x.g),x.h);if(R.g.length>30){if(k(R)||k(x))throw Error("slowDivide_ only works with positive integers.");for(var O=E,L=x;L.l(R)<=0;)O=ye(O),L=ye(L);var M=he(O,1),U=he(L,1);for(L=he(L,2),O=he(O,2);!C(L);){var P=U.add(L);P.l(R)<=0&&(M=M.add(O),U=P),L=he(L,1),O=he(O,1)}return x=G(R,M.j(x)),new K(M,x)}for(M=_;R.l(x)>=0;){for(O=Math.max(1,Math.floor(R.m()/x.m())),L=Math.ceil(Math.log(O)/Math.LN2),L=L<=48?1:Math.pow(2,L-48),U=m(O),P=U.j(x);k(P)||P.l(R)>0;)O-=L,U=m(O),P=U.j(x);C(U)&&(U=E),M=M.add(U),R=G(R,P)}return new K(M,R)}r.B=function(R){return se(this,R).h},r.and=function(R){const x=Math.max(this.g.length,R.g.length),O=[];for(let L=0;L<x;L++)O[L]=this.i(L)&R.i(L);return new c(O,this.h&R.h)},r.or=function(R){const x=Math.max(this.g.length,R.g.length),O=[];for(let L=0;L<x;L++)O[L]=this.i(L)|R.i(L);return new c(O,this.h|R.h)},r.xor=function(R){const x=Math.max(this.g.length,R.g.length),O=[];for(let L=0;L<x;L++)O[L]=this.i(L)^R.i(L);return new c(O,this.h^R.h)};function ye(R){const x=R.g.length+1,O=[];for(let L=0;L<x;L++)O[L]=R.i(L)<<1|R.i(L-1)>>>31;return new c(O,R.h)}function he(R,x){const O=x>>5;x%=32;const L=R.g.length-O,M=[];for(let U=0;U<L;U++)M[U]=x>0?R.i(U+O)>>>x|R.i(U+O+1)<<32-x:R.i(U+O);return new c(M,R.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,VR=n,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.B,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=m,c.fromString=y,aa=c}).apply(typeof oA<"u"?oA:typeof self<"u"?self:typeof window<"u"?window:{});var mm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var MR,yh,jR,Mm,ov,LR,UR,BR;(function(){var r,e=Object.defineProperty;function t(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof mm=="object"&&mm];for(var v=0;v<f.length;++v){var T=f[v];if(T&&T.Math==Math)return T}throw Error("Cannot find global object")}var n=t(this);function s(f,v){if(v)e:{var T=n;f=f.split(".");for(var I=0;I<f.length-1;I++){var z=f[I];if(!(z in T))break e;T=T[z]}f=f[f.length-1],I=T[f],v=v(I),v!=I&&v!=null&&e(T,f,{configurable:!0,writable:!0,value:v})}}s("Symbol.dispose",function(f){return f||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(f){return f||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(f){return f||function(v){var T=[],I;for(I in v)Object.prototype.hasOwnProperty.call(v,I)&&T.push([I,v[I]]);return T}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},c=this||self;function h(f){var v=typeof f;return v=="object"&&f!=null||v=="function"}function d(f,v,T){return f.call.apply(f.bind,arguments)}function m(f,v,T){return m=d,m.apply(null,arguments)}function y(f,v){var T=Array.prototype.slice.call(arguments,1);return function(){var I=T.slice();return I.push.apply(I,arguments),f.apply(this,I)}}function _(f,v){function T(){}T.prototype=v.prototype,f.Z=v.prototype,f.prototype=new T,f.prototype.constructor=f,f.Ob=function(I,z,Y){for(var me=Array(arguments.length-2),De=2;De<arguments.length;De++)me[De-2]=arguments[De];return v.prototype[z].apply(I,me)}}var E=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?f=>f&&AsyncContext.Snapshot.wrap(f):f=>f;function S(f){const v=f.length;if(v>0){const T=Array(v);for(let I=0;I<v;I++)T[I]=f[I];return T}return[]}function C(f,v){for(let I=1;I<arguments.length;I++){const z=arguments[I];var T=typeof z;if(T=T!="object"?T:z?Array.isArray(z)?"array":T:"null",T=="array"||T=="object"&&typeof z.length=="number"){T=f.length||0;const Y=z.length||0;f.length=T+Y;for(let me=0;me<Y;me++)f[T+me]=z[me]}else f.push(z)}}class k{constructor(v,T){this.i=v,this.j=T,this.h=0,this.g=null}get(){let v;return this.h>0?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function N(f){c.setTimeout(()=>{throw f},0)}function G(){var f=R;let v=null;return f.g&&(v=f.g,f.g=f.g.next,f.g||(f.h=null),v.next=null),v}class J{constructor(){this.h=this.g=null}add(v,T){const I=K.get();I.set(v,T),this.h?this.h.next=I:this.g=I,this.h=I}}var K=new k(()=>new se,f=>f.reset());class se{constructor(){this.next=this.g=this.h=null}set(v,T){this.h=v,this.g=T,this.next=null}reset(){this.next=this.g=this.h=null}}let ye,he=!1,R=new J,x=()=>{const f=Promise.resolve(void 0);ye=()=>{f.then(O)}};function O(){for(var f;f=G();){try{f.h.call(f.g)}catch(T){N(T)}var v=K;v.j(f),v.h<100&&(v.h++,f.next=v.g,v.g=f)}he=!1}function L(){this.u=this.u,this.C=this.C}L.prototype.u=!1,L.prototype.dispose=function(){this.u||(this.u=!0,this.N())},L.prototype[Symbol.dispose]=function(){this.dispose()},L.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function M(f,v){this.type=f,this.g=this.target=v,this.defaultPrevented=!1}M.prototype.h=function(){this.defaultPrevented=!0};var U=(function(){if(!c.addEventListener||!Object.defineProperty)return!1;var f=!1,v=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const T=()=>{};c.addEventListener("test",T,v),c.removeEventListener("test",T,v)}catch{}return f})();function P(f){return/^[\s\xa0]*$/.test(f)}function et(f,v){M.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f&&this.init(f,v)}_(et,M),et.prototype.init=function(f,v){const T=this.type=f.type,I=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;this.target=f.target||f.srcElement,this.g=v,v=f.relatedTarget,v||(T=="mouseover"?v=f.fromElement:T=="mouseout"&&(v=f.toElement)),this.relatedTarget=v,I?(this.clientX=I.clientX!==void 0?I.clientX:I.pageX,this.clientY=I.clientY!==void 0?I.clientY:I.pageY,this.screenX=I.screenX||0,this.screenY=I.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=f.pointerType,this.state=f.state,this.i=f,f.defaultPrevented&&et.Z.h.call(this)},et.prototype.h=function(){et.Z.h.call(this);const f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var We="closure_listenable_"+(Math.random()*1e6|0),ee=0;function ue(f,v,T,I,z){this.listener=f,this.proxy=null,this.src=v,this.type=T,this.capture=!!I,this.ha=z,this.key=++ee,this.da=this.fa=!1}function oe(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function Z(f,v,T){for(const I in f)v.call(T,f[I],I,f)}function ve(f,v){for(const T in f)v.call(void 0,f[T],T,f)}function V(f){const v={};for(const T in f)v[T]=f[T];return v}const W="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function de(f,v){let T,I;for(let z=1;z<arguments.length;z++){I=arguments[z];for(T in I)f[T]=I[T];for(let Y=0;Y<W.length;Y++)T=W[Y],Object.prototype.hasOwnProperty.call(I,T)&&(f[T]=I[T])}}function ce(f){this.src=f,this.g={},this.h=0}ce.prototype.add=function(f,v,T,I,z){const Y=f.toString();f=this.g[Y],f||(f=this.g[Y]=[],this.h++);const me=Ne(f,v,I,z);return me>-1?(v=f[me],T||(v.fa=!1)):(v=new ue(v,this.src,Y,!!I,z),v.fa=T,f.push(v)),v};function Ie(f,v){const T=v.type;if(T in f.g){var I=f.g[T],z=Array.prototype.indexOf.call(I,v,void 0),Y;(Y=z>=0)&&Array.prototype.splice.call(I,z,1),Y&&(oe(v),f.g[T].length==0&&(delete f.g[T],f.h--))}}function Ne(f,v,T,I){for(let z=0;z<f.length;++z){const Y=f[z];if(!Y.da&&Y.listener==v&&Y.capture==!!T&&Y.ha==I)return z}return-1}var Le="closure_lm_"+(Math.random()*1e6|0),Zt={};function _t(f,v,T,I,z){if(Array.isArray(v)){for(let Y=0;Y<v.length;Y++)_t(f,v[Y],T,I,z);return null}return T=tu(T),f&&f[We]?f.J(v,T,h(I)?!!I.capture:!1,z):Ca(f,v,T,!1,I,z)}function Ca(f,v,T,I,z,Y){if(!v)throw Error("Invalid event type");const me=h(z)?!!z.capture:!!z;let De=ka(f);if(De||(f[Le]=De=new ce(f)),T=De.add(v,T,I,me,Y),T.proxy)return T;if(I=Wo(),T.proxy=I,I.src=f,I.listener=T,f.addEventListener)U||(z=me),z===void 0&&(z=!1),f.addEventListener(v.toString(),I,z);else if(f.attachEvent)f.attachEvent(Jr(v.toString()),I);else if(f.addListener&&f.removeListener)f.addListener(I);else throw Error("addEventListener and attachEvent are unavailable.");return T}function Wo(){function f(T){return v.call(f.src,f.listener,T)}const v=Zc;return f}function Qo(f,v,T,I,z){if(Array.isArray(v))for(var Y=0;Y<v.length;Y++)Qo(f,v[Y],T,I,z);else I=h(I)?!!I.capture:!!I,T=tu(T),f&&f[We]?(f=f.i,Y=String(v).toString(),Y in f.g&&(v=f.g[Y],T=Ne(v,T,I,z),T>-1&&(oe(v[T]),Array.prototype.splice.call(v,T,1),v.length==0&&(delete f.g[Y],f.h--)))):f&&(f=ka(f))&&(v=f.g[v.toString()],f=-1,v&&(f=Ne(v,T,I,z)),(T=f>-1?v[f]:null)&&Yo(T))}function Yo(f){if(typeof f!="number"&&f&&!f.da){var v=f.src;if(v&&v[We])Ie(v.i,f);else{var T=f.type,I=f.proxy;v.removeEventListener?v.removeEventListener(T,I,f.capture):v.detachEvent?v.detachEvent(Jr(T),I):v.addListener&&v.removeListener&&v.removeListener(I),(T=ka(v))?(Ie(T,f),T.h==0&&(T.src=null,v[Le]=null)):oe(f)}}}function Jr(f){return f in Zt?Zt[f]:Zt[f]="on"+f}function Zc(f,v){if(f.da)f=!0;else{v=new et(v,this);const T=f.listener,I=f.ha||f.src;f.fa&&Yo(f),f=T.call(I,v)}return f}function ka(f){return f=f[Le],f instanceof ce?f:null}var eu="__closure_events_fn_"+(Math.random()*1e9>>>0);function tu(f){return typeof f=="function"?f:(f[eu]||(f[eu]=function(v){return f.handleEvent(v)}),f[eu])}function Bt(){L.call(this),this.i=new ce(this),this.M=this,this.G=null}_(Bt,L),Bt.prototype[We]=!0,Bt.prototype.removeEventListener=function(f,v,T,I){Qo(this,f,v,T,I)};function en(f,v){var T,I=f.G;if(I)for(T=[];I;I=I.G)T.push(I);if(f=f.M,I=v.type||v,typeof v=="string")v=new M(v,f);else if(v instanceof M)v.target=v.target||f;else{var z=v;v=new M(I,f),de(v,z)}z=!0;let Y,me;if(T)for(me=T.length-1;me>=0;me--)Y=v.g=T[me],z=ms(Y,I,!0,v)&&z;if(Y=v.g=f,z=ms(Y,I,!0,v)&&z,z=ms(Y,I,!1,v)&&z,T)for(me=0;me<T.length;me++)Y=v.g=T[me],z=ms(Y,I,!1,v)&&z}Bt.prototype.N=function(){if(Bt.Z.N.call(this),this.i){var f=this.i;for(const v in f.g){const T=f.g[v];for(let I=0;I<T.length;I++)oe(T[I]);delete f.g[v],f.h--}}this.G=null},Bt.prototype.J=function(f,v,T,I){return this.i.add(String(f),v,!1,T,I)},Bt.prototype.K=function(f,v,T,I){return this.i.add(String(f),v,!0,T,I)};function ms(f,v,T,I){if(v=f.i.g[String(v)],!v)return!0;v=v.concat();let z=!0;for(let Y=0;Y<v.length;++Y){const me=v[Y];if(me&&!me.da&&me.capture==T){const De=me.listener,Dt=me.ha||me.src;me.fa&&Ie(f.i,me),z=De.call(Dt,I)!==!1&&z}}return z&&!I.defaultPrevented}function mp(f,v){if(typeof f!="function")if(f&&typeof f.handleEvent=="function")f=m(f.handleEvent,f);else throw Error("Invalid listener argument");return Number(v)>2147483647?-1:c.setTimeout(f,v||0)}function jd(f){f.g=mp(()=>{f.g=null,f.i&&(f.i=!1,jd(f))},f.l);const v=f.h;f.h=null,f.m.apply(null,v)}class Cn extends L{constructor(v,T){super(),this.m=v,this.l=T,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:jd(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Na(f){L.call(this),this.h=f,this.g={}}_(Na,L);var nu=[];function ru(f){Z(f.g,function(v,T){this.g.hasOwnProperty(T)&&Yo(v)},f),f.g={}}Na.prototype.N=function(){Na.Z.N.call(this),ru(this)},Na.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var gs=c.JSON.stringify,gp=c.JSON.parse,Ld=class{stringify(f){return c.JSON.stringify(f,void 0)}parse(f){return c.JSON.parse(f,void 0)}};function Ud(){}function Bd(){}var Cr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function dn(){M.call(this,"d")}_(dn,M);function dr(){M.call(this,"c")}_(dr,M);var Pt={},Fd=null;function Jo(){return Fd=Fd||new Bt}Pt.Ia="serverreachability";function zd(f){M.call(this,Pt.Ia,f)}_(zd,M);function Xr(f){const v=Jo();en(v,new zd(v))}Pt.STAT_EVENT="statevent";function Oa(f,v){M.call(this,Pt.STAT_EVENT,f),this.stat=v}_(Oa,M);function Ft(f){const v=Jo();en(v,new Oa(v,f))}Pt.Ja="timingevent";function Zr(f,v){M.call(this,Pt.Ja,f),this.size=v}_(Zr,M);function ei(f,v){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){f()},v)}function kr(){this.g=!0}kr.prototype.ua=function(){this.g=!1};function pp(f,v,T,I,z,Y){f.info(function(){if(f.g)if(Y){var me="",De=Y.split("&");for(let Xe=0;Xe<De.length;Xe++){var Dt=De[Xe].split("=");if(Dt.length>1){const vt=Dt[0];Dt=Dt[1];const pr=vt.split("_");me=pr.length>=2&&pr[1]=="type"?me+(vt+"="+Dt+"&"):me+(vt+"=redacted&")}}}else me=null;else me=Y;return"XMLHTTP REQ ("+I+") [attempt "+z+"]: "+v+`
`+T+`
`+me})}function qd(f,v,T,I,z,Y,me){f.info(function(){return"XMLHTTP RESP ("+I+") [ attempt "+z+"]: "+v+`
`+T+`
`+Y+" "+me})}function ti(f,v,T,I){f.info(function(){return"XMLHTTP TEXT ("+v+"): "+yp(f,T)+(I?" "+I:"")})}function Pa(f,v){f.info(function(){return"TIMEOUT: "+v})}kr.prototype.info=function(){};function yp(f,v){if(!f.g)return v;if(!v)return null;try{const Y=JSON.parse(v);if(Y){for(f=0;f<Y.length;f++)if(Array.isArray(Y[f])){var T=Y[f];if(!(T.length<2)){var I=T[1];if(Array.isArray(I)&&!(I.length<1)){var z=I[0];if(z!="noop"&&z!="stop"&&z!="close")for(let me=1;me<I.length;me++)I[me]=""}}}}return gs(Y)}catch{return v}}var Da={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},iu={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},su;function Va(){}_(Va,Ud),Va.prototype.g=function(){return new XMLHttpRequest},su=new Va;function Vi(f){return encodeURIComponent(String(f))}function $d(f){var v=1;f=f.split(":");const T=[];for(;v>0&&f.length;)T.push(f.shift()),v--;return f.length&&T.push(f.join(":")),T}function Nr(f,v,T,I){this.j=f,this.i=v,this.l=T,this.S=I||1,this.V=new Na(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Or}function Or(){this.i=null,this.g="",this.h=!1}var zt={},an={};function ni(f,v,T){f.M=1,f.A=Ma($t(v)),f.u=T,f.R=!0,Xo(f,null)}function Xo(f,v){f.F=Date.now(),ri(f),f.B=$t(f.A);var T=f.B,I=f.S;Array.isArray(I)||(I=[String(I)]),nl(T.i,"t",I),f.C=0,T=f.j.L,f.h=new Or,f.g=af(f.j,T?v:null,!f.u),f.P>0&&(f.O=new Cn(m(f.Y,f,f.g),f.P)),v=f.V,T=f.g,I=f.ba;var z="readystatechange";Array.isArray(z)||(z&&(nu[0]=z.toString()),z=nu);for(let Y=0;Y<z.length;Y++){const me=_t(T,z[Y],I||v.handleEvent,!1,v.h||v);if(!me)break;v.g[me.key]=me}v=f.J?V(f.J):{},f.u?(f.v||(f.v="POST"),v["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.B,f.v,f.u,v)):(f.v="GET",f.g.ea(f.B,f.v,null,v)),Xr(),pp(f.i,f.v,f.B,f.l,f.S,f.u)}Nr.prototype.ba=function(f){f=f.target;const v=this.O;v&&Vr(f)==3?v.j():this.Y(f)},Nr.prototype.Y=function(f){try{if(f==this.g)e:{const De=Vr(this.g),Dt=this.g.ya(),Xe=this.g.ca();if(!(De<3)&&(De!=3||this.g&&(this.h.h||this.g.la()||fn(this.g)))){this.K||De!=4||Dt==7||(Dt==8||Xe<=0?Xr(3):Xr(2)),ii(this);var v=this.g.ca();this.X=v;var T=_p(this);if(this.o=v==200,qd(this.i,this.v,this.B,this.l,this.S,De,v),this.o){if(this.U&&!this.L){t:{if(this.g){var I,z=this.g;if((I=z.g?z.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!P(I)){var Y=I;break t}}Y=null}if(f=Y)ti(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,si(this,f);else{this.o=!1,this.m=3,Ft(12),Yn(this),fr(this);break e}}if(this.R){f=!0;let vt;for(;!this.K&&this.C<T.length;)if(vt=Gd(this,T),vt==an){De==4&&(this.m=4,Ft(14),f=!1),ti(this.i,this.l,null,"[Incomplete Response]");break}else if(vt==zt){this.m=4,Ft(15),ti(this.i,this.l,T,"[Invalid Chunk]"),f=!1;break}else ti(this.i,this.l,vt,null),si(this,vt);if(Hd(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),De!=4||T.length!=0||this.h.h||(this.m=1,Ft(16),f=!1),this.o=this.o&&f,!f)ti(this.i,this.l,T,"[Invalid Chunked Response]"),Yn(this),fr(this);else if(T.length>0&&!this.W){this.W=!0;var me=this.j;me.g==this&&me.aa&&!me.P&&(me.j.info("Great, no buffering proxy detected. Bytes received: "+T.length),wu(me),me.P=!0,Ft(11))}}else ti(this.i,this.l,T,null),si(this,T);De==4&&Yn(this),this.o&&!this.K&&(De==4?tf(this.j,this):(this.o=!1,ri(this)))}else ji(this.g),v==400&&T.indexOf("Unknown SID")>0?(this.m=3,Ft(12)):(this.m=0,Ft(13)),Yn(this),fr(this)}}}catch{}finally{}};function _p(f){if(!Hd(f))return f.g.la();const v=fn(f.g);if(v==="")return"";let T="";const I=v.length,z=Vr(f.g)==4;if(!f.h.i){if(typeof TextDecoder>"u")return Yn(f),fr(f),"";f.h.i=new c.TextDecoder}for(let Y=0;Y<I;Y++)f.h.h=!0,T+=f.h.i.decode(v[Y],{stream:!(z&&Y==I-1)});return v.length=0,f.h.g+=T,f.C=0,f.h.g}function Hd(f){return f.g?f.v=="GET"&&f.M!=2&&f.j.Aa:!1}function Gd(f,v){var T=f.C,I=v.indexOf(`
`,T);return I==-1?an:(T=Number(v.substring(T,I)),isNaN(T)?zt:(I+=1,I+T>v.length?an:(v=v.slice(I,I+T),f.C=I+T,v)))}Nr.prototype.cancel=function(){this.K=!0,Yn(this)};function ri(f){f.T=Date.now()+f.H,Zo(f,f.H)}function Zo(f,v){if(f.D!=null)throw Error("WatchDog timer not null");f.D=ei(m(f.aa,f),v)}function ii(f){f.D&&(c.clearTimeout(f.D),f.D=null)}Nr.prototype.aa=function(){this.D=null;const f=Date.now();f-this.T>=0?(Pa(this.i,this.B),this.M!=2&&(Xr(),Ft(17)),Yn(this),this.m=2,fr(this)):Zo(this,this.T-f)};function fr(f){f.j.I==0||f.K||tf(f.j,f)}function Yn(f){ii(f);var v=f.O;v&&typeof v.dispose=="function"&&v.dispose(),f.O=null,ru(f.V),f.g&&(v=f.g,f.g=null,v.abort(),v.dispose())}function si(f,v){try{var T=f.j;if(T.I!=0&&(T.g==f||oi(T.h,f))){if(!f.L&&oi(T.h,f)&&T.I==3){try{var I=T.Ba.g.parse(v)}catch{I=null}if(Array.isArray(I)&&I.length==3){var z=I;if(z[0]==0){e:if(!T.v){if(T.g)if(T.g.F+3e3<f.F)ol(T),Ts(T);else break e;qa(T),Ft(18)}}else T.xa=z[1],0<T.xa-T.K&&z[2]<37500&&T.F&&T.A==0&&!T.C&&(T.C=ei(m(T.Va,T),6e3));ai(T.h)<=1&&T.ta&&(T.ta=void 0)}else fi(T,11)}else if((f.L||T.g==f)&&ol(T),!P(v))for(z=T.Ba.g.parse(v),v=0;v<z.length;v++){let Xe=z[v];const vt=Xe[0];if(!(vt<=T.K))if(T.K=vt,Xe=Xe[1],T.I==2)if(Xe[0]=="c"){T.M=Xe[1],T.ba=Xe[2];const pr=Xe[3];pr!=null&&(T.ka=pr,T.j.info("VER="+T.ka));const mi=Xe[4];mi!=null&&(T.za=mi,T.j.info("SVER="+T.za));const Mr=Xe[5];Mr!=null&&typeof Mr=="number"&&Mr>0&&(I=1.5*Mr,T.O=I,T.j.info("backChannelRequestTimeoutMs_="+I)),I=T;const jr=f.g;if(jr){const $a=jr.g?jr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if($a){var Y=I.h;Y.g||$a.indexOf("spdy")==-1&&$a.indexOf("quic")==-1&&$a.indexOf("h2")==-1||(Y.j=Y.l,Y.g=new Set,Y.h&&(lu(Y,Y.h),Y.h=null))}if(I.G){const ll=jr.g?jr.g.getResponseHeader("X-HTTP-Session-Id"):null;ll&&(I.wa=ll,nt(I.J,I.G,ll))}}T.I=3,T.l&&T.l.ra(),T.aa&&(T.T=Date.now()-f.F,T.j.info("Handshake RTT: "+T.T+"ms")),I=T;var me=f;if(I.na=sf(I,I.L?I.ba:null,I.W),me.L){cu(I.h,me);var De=me,Dt=I.O;Dt&&(De.H=Dt),De.D&&(ii(De),ri(De)),I.g=me}else Zd(I);T.i.length>0&&di(T)}else Xe[0]!="stop"&&Xe[0]!="close"||fi(T,7);else T.I==3&&(Xe[0]=="stop"||Xe[0]=="close"?Xe[0]=="stop"?fi(T,7):_u(T):Xe[0]!="noop"&&T.l&&T.l.qa(Xe),T.A=0)}}Xr(4)}catch{}}var qt=class{constructor(f,v){this.g=f,this.map=v}};function au(f){this.l=f||10,c.PerformanceNavigationTiming?(f=c.performance.getEntriesByType("navigation"),f=f.length>0&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function ou(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function ai(f){return f.h?1:f.g?f.g.size:0}function oi(f,v){return f.h?f.h==v:f.g?f.g.has(v):!1}function lu(f,v){f.g?f.g.add(v):f.h=v}function cu(f,v){f.h&&f.h==v?f.h=null:f.g&&f.g.has(v)&&f.g.delete(v)}au.prototype.cancel=function(){if(this.i=uu(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function uu(f){if(f.h!=null)return f.i.concat(f.h.G);if(f.g!=null&&f.g.size!==0){let v=f.i;for(const T of f.g.values())v=v.concat(T.G);return v}return S(f.i)}var Kd=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function el(f,v){if(f){f=f.split("&");for(let T=0;T<f.length;T++){const I=f[T].indexOf("=");let z,Y=null;I>=0?(z=f[T].substring(0,I),Y=f[T].substring(I+1)):z=f[T],v(z,Y?decodeURIComponent(Y.replace(/\+/g," ")):"")}}}function Jn(f){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let v;f instanceof Jn?(this.l=f.l,on(this,f.j),this.o=f.o,this.g=f.g,ps(this,f.u),this.h=f.h,hu(this,Jd(f.i)),this.m=f.m):f&&(v=String(f).match(Kd))?(this.l=!1,on(this,v[1]||"",!0),this.o=li(v[2]||""),this.g=li(v[3]||"",!0),ps(this,v[4]),this.h=li(v[5]||"",!0),hu(this,v[6]||"",!0),this.m=li(v[7]||"")):(this.l=!1,this.i=new _s(null,this.l))}Jn.prototype.toString=function(){const f=[];var v=this.j;v&&f.push(ja(v,tl,!0),":");var T=this.g;return(T||v=="file")&&(f.push("//"),(v=this.o)&&f.push(ja(v,tl,!0),"@"),f.push(Vi(T).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),T=this.u,T!=null&&f.push(":",String(T))),(T=this.h)&&(this.g&&T.charAt(0)!="/"&&f.push("/"),f.push(ja(T,T.charAt(0)=="/"?du:Wd,!0))),(T=this.i.toString())&&f.push("?",T),(T=this.m)&&f.push("#",ja(T,Qd)),f.join("")},Jn.prototype.resolve=function(f){const v=$t(this);let T=!!f.j;T?on(v,f.j):T=!!f.o,T?v.o=f.o:T=!!f.g,T?v.g=f.g:T=f.u!=null;var I=f.h;if(T)ps(v,f.u);else if(T=!!f.h){if(I.charAt(0)!="/")if(this.g&&!this.h)I="/"+I;else{var z=v.h.lastIndexOf("/");z!=-1&&(I=v.h.slice(0,z+1)+I)}if(z=I,z==".."||z==".")I="";else if(z.indexOf("./")!=-1||z.indexOf("/.")!=-1){I=z.lastIndexOf("/",0)==0,z=z.split("/");const Y=[];for(let me=0;me<z.length;){const De=z[me++];De=="."?I&&me==z.length&&Y.push(""):De==".."?((Y.length>1||Y.length==1&&Y[0]!="")&&Y.pop(),I&&me==z.length&&Y.push("")):(Y.push(De),I=!0)}I=Y.join("/")}else I=z}return T?v.h=I:T=f.i.toString()!=="",T?hu(v,Jd(f.i)):T=!!f.m,T&&(v.m=f.m),v};function $t(f){return new Jn(f)}function on(f,v,T){f.j=T?li(v,!0):v,f.j&&(f.j=f.j.replace(/:$/,""))}function ps(f,v){if(v){if(v=Number(v),isNaN(v)||v<0)throw Error("Bad port number "+v);f.u=v}else f.u=null}function hu(f,v,T){v instanceof _s?(f.i=v,rl(f.i,f.l)):(T||(v=ja(v,ys)),f.i=new _s(v,f.l))}function nt(f,v,T){f.i.set(v,T)}function Ma(f){return nt(f,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),f}function li(f,v){return f?v?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function ja(f,v,T){return typeof f=="string"?(f=encodeURI(f).replace(v,Ln),T&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function Ln(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var tl=/[#\/\?@]/g,Wd=/[#\?:]/g,du=/[#\?]/g,ys=/[#\?@]/g,Qd=/#/g;function _s(f,v){this.h=this.g=null,this.i=f||null,this.j=!!v}function Un(f){f.g||(f.g=new Map,f.h=0,f.i&&el(f.i,function(v,T){f.add(decodeURIComponent(v.replace(/\+/g," ")),T)}))}r=_s.prototype,r.add=function(f,v){Un(this),this.i=null,f=vs(this,f);let T=this.g.get(f);return T||this.g.set(f,T=[]),T.push(v),this.h+=1,this};function Yd(f,v){Un(f),v=vs(f,v),f.g.has(v)&&(f.i=null,f.h-=f.g.get(v).length,f.g.delete(v))}function fu(f,v){return Un(f),v=vs(f,v),f.g.has(v)}r.forEach=function(f,v){Un(this),this.g.forEach(function(T,I){T.forEach(function(z){f.call(v,z,I,this)},this)},this)};function mu(f,v){Un(f);let T=[];if(typeof v=="string")fu(f,v)&&(T=T.concat(f.g.get(vs(f,v))));else for(f=Array.from(f.g.values()),v=0;v<f.length;v++)T=T.concat(f[v]);return T}r.set=function(f,v){return Un(this),this.i=null,f=vs(this,f),fu(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[v]),this.h+=1,this},r.get=function(f,v){return f?(f=mu(this,f),f.length>0?String(f[0]):v):v};function nl(f,v,T){Yd(f,v),T.length>0&&(f.i=null,f.g.set(vs(f,v),S(T)),f.h+=T.length)}r.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],v=Array.from(this.g.keys());for(let I=0;I<v.length;I++){var T=v[I];const z=Vi(T);T=mu(this,T);for(let Y=0;Y<T.length;Y++){let me=z;T[Y]!==""&&(me+="="+Vi(T[Y])),f.push(me)}}return this.i=f.join("&")};function Jd(f){const v=new _s;return v.i=f.i,f.g&&(v.g=new Map(f.g),v.h=f.h),v}function vs(f,v){return v=String(v),f.j&&(v=v.toLowerCase()),v}function rl(f,v){v&&!f.j&&(Un(f),f.i=null,f.g.forEach(function(T,I){const z=I.toLowerCase();I!=z&&(Yd(this,I),nl(this,z,T))},f)),f.j=v}function Pr(f,v){const T=new kr;if(c.Image){const I=new Image;I.onload=y(mr,T,"TestLoadImage: loaded",!0,v,I),I.onerror=y(mr,T,"TestLoadImage: error",!1,v,I),I.onabort=y(mr,T,"TestLoadImage: abort",!1,v,I),I.ontimeout=y(mr,T,"TestLoadImage: timeout",!1,v,I),c.setTimeout(function(){I.ontimeout&&I.ontimeout()},1e4),I.src=f}else v(!1)}function gu(f,v){const T=new kr,I=new AbortController,z=setTimeout(()=>{I.abort(),mr(T,"TestPingServer: timeout",!1,v)},1e4);fetch(f,{signal:I.signal}).then(Y=>{clearTimeout(z),Y.ok?mr(T,"TestPingServer: ok",!0,v):mr(T,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(z),mr(T,"TestPingServer: error",!1,v)})}function mr(f,v,T,I,z){try{z&&(z.onload=null,z.onerror=null,z.onabort=null,z.ontimeout=null),I(T)}catch{}}function ws(){this.g=new Ld}function ci(f){this.i=f.Sb||null,this.h=f.ab||!1}_(ci,Ud),ci.prototype.g=function(){return new La(this.i,this.h)};function La(f,v){Bt.call(this),this.H=f,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}_(La,Bt),r=La.prototype,r.open=function(f,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=f,this.D=v,this.readyState=1,Dr(this)},r.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const v={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};f&&(v.body=f),(this.H||c).fetch(new Request(this.D,v)).then(this.Pa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,bs(this)),this.readyState=0},r.Pa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,Dr(this)),this.g&&(this.readyState=3,Dr(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;il(this)}else f.text().then(this.Oa.bind(this),this.ga.bind(this))};function il(f){f.j.read().then(f.Ma.bind(f)).catch(f.ga.bind(f))}r.Ma=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var v=f.value?f.value:new Uint8Array(0);(v=this.B.decode(v,{stream:!f.done}))&&(this.response=this.responseText+=v)}f.done?bs(this):Dr(this),this.readyState==3&&il(this)}},r.Oa=function(f){this.g&&(this.response=this.responseText=f,bs(this))},r.Na=function(f){this.g&&(this.response=f,bs(this))},r.ga=function(){this.g&&bs(this)};function bs(f){f.readyState=4,f.l=null,f.j=null,f.B=null,Dr(f)}r.setRequestHeader=function(f,v){this.A.append(f,v)},r.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],v=this.h.entries();for(var T=v.next();!T.done;)T=T.value,f.push(T[0]+": "+T[1]),T=v.next();return f.join(`\r
`)};function Dr(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(La.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function gr(f){let v="";return Z(f,function(T,I){v+=I,v+=":",v+=T,v+=`\r
`}),v}function Ua(f,v,T){e:{for(I in T){var I=!1;break e}I=!0}I||(T=gr(T),typeof f=="string"?T!=null&&Vi(T):nt(f,v,T))}function ot(f){Bt.call(this),this.headers=new Map,this.L=f||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}_(ot,Bt);var ui=/^https?$/i,pu=["POST","PUT"];r=ot.prototype,r.Fa=function(f){this.H=f},r.ea=function(f,v,T,I){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);v=v?v.toUpperCase():"GET",this.D=f,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():su.g(),this.g.onreadystatechange=E(m(this.Ca,this));try{this.B=!0,this.g.open(v,String(f),!0),this.B=!1}catch(Y){Ba(this,Y);return}if(f=T||"",T=new Map(this.headers),I)if(Object.getPrototypeOf(I)===Object.prototype)for(var z in I)T.set(z,I[z]);else if(typeof I.keys=="function"&&typeof I.get=="function")for(const Y of I.keys())T.set(Y,I.get(Y));else throw Error("Unknown input type for opt_headers: "+String(I));I=Array.from(T.keys()).find(Y=>Y.toLowerCase()=="content-type"),z=c.FormData&&f instanceof c.FormData,!(Array.prototype.indexOf.call(pu,v,void 0)>=0)||I||z||T.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Y,me]of T)this.g.setRequestHeader(Y,me);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(f),this.v=!1}catch(Y){Ba(this,Y)}};function Ba(f,v){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=v,f.o=5,yu(f),Mi(f)}function yu(f){f.A||(f.A=!0,en(f,"complete"),en(f,"error"))}r.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=f||7,en(this,"complete"),en(this,"abort"),Mi(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Mi(this,!0)),ot.Z.N.call(this)},r.Ca=function(){this.u||(this.B||this.v||this.j?Fa(this):this.Xa())},r.Xa=function(){Fa(this)};function Fa(f){if(f.h&&typeof o<"u"){if(f.v&&Vr(f)==4)setTimeout(f.Ca.bind(f),0);else if(en(f,"readystatechange"),Vr(f)==4){f.h=!1;try{const Y=f.ca();e:switch(Y){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var T;if(!(T=v)){var I;if(I=Y===0){let me=String(f.D).match(Kd)[1]||null;!me&&c.self&&c.self.location&&(me=c.self.location.protocol.slice(0,-1)),I=!ui.test(me?me.toLowerCase():"")}T=I}if(T)en(f,"complete"),en(f,"success");else{f.o=6;try{var z=Vr(f)>2?f.g.statusText:""}catch{z=""}f.l=z+" ["+f.ca()+"]",yu(f)}}finally{Mi(f)}}}}function Mi(f,v){if(f.g){f.m&&(clearTimeout(f.m),f.m=null);const T=f.g;f.g=null,v||en(f,"ready");try{T.onreadystatechange=null}catch{}}}r.isActive=function(){return!!this.g};function Vr(f){return f.g?f.g.readyState:0}r.ca=function(){try{return Vr(this)>2?this.g.status:-1}catch{return-1}},r.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},r.La=function(f){if(this.g){var v=this.g.responseText;return f&&v.indexOf(f)==0&&(v=v.substring(f.length)),gp(v)}};function fn(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.F){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function ji(f){const v={};f=(f.g&&Vr(f)>=2&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let I=0;I<f.length;I++){if(P(f[I]))continue;var T=$d(f[I]);const z=T[0];if(T=T[1],typeof T!="string")continue;T=T.trim();const Y=v[z]||[];v[z]=Y,Y.push(T)}ve(v,function(I){return I.join(", ")})}r.ya=function(){return this.o},r.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function hi(f,v,T){return T&&T.internalChannelParams&&T.internalChannelParams[f]||v}function Es(f){this.za=0,this.i=[],this.j=new kr,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=hi("failFast",!1,f),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=hi("baseRetryDelayMs",5e3,f),this.Za=hi("retryDelaySeedMs",1e4,f),this.Ta=hi("forwardChannelMaxRetries",2,f),this.va=hi("forwardChannelRequestTimeoutMs",2e4,f),this.ma=f&&f.xmlHttpFactory||void 0,this.Ua=f&&f.Rb||void 0,this.Aa=f&&f.useFetchStreams||!1,this.O=void 0,this.L=f&&f.supportsCrossDomainXhr||!1,this.M="",this.h=new au(f&&f.concurrentRequestLimit),this.Ba=new ws,this.S=f&&f.fastHandshake||!1,this.R=f&&f.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=f&&f.Pb||!1,f&&f.ua&&this.j.ua(),f&&f.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&f&&f.detectBufferingProxy||!1,this.ia=void 0,f&&f.longPollingTimeout&&f.longPollingTimeout>0&&(this.ia=f.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}r=Es.prototype,r.ka=8,r.I=1,r.connect=function(f,v,T,I){Ft(0),this.W=f,this.H=v||{},T&&I!==void 0&&(this.H.OSID=T,this.H.OAID=I),this.F=this.X,this.J=sf(this,null,this.W),di(this)};function _u(f){if(sl(f),f.I==3){var v=f.V++,T=$t(f.J);if(nt(T,"SID",f.M),nt(T,"RID",v),nt(T,"TYPE","terminate"),za(f,T),v=new Nr(f,f.j,v),v.M=2,v.A=Ma($t(T)),T=!1,c.navigator&&c.navigator.sendBeacon)try{T=c.navigator.sendBeacon(v.A.toString(),"")}catch{}!T&&c.Image&&(new Image().src=v.A,T=!0),T||(v.g=af(v.j,null),v.g.ea(v.A)),v.F=Date.now(),ri(v)}rf(f)}function Ts(f){f.g&&(wu(f),f.g.cancel(),f.g=null)}function sl(f){Ts(f),f.v&&(c.clearTimeout(f.v),f.v=null),ol(f),f.h.cancel(),f.m&&(typeof f.m=="number"&&c.clearTimeout(f.m),f.m=null)}function di(f){if(!ou(f.h)&&!f.m){f.m=!0;var v=f.Ea;ye||x(),he||(ye(),he=!0),R.add(v,f),f.D=0}}function al(f,v){return ai(f.h)>=f.h.j-(f.m?1:0)?!1:f.m?(f.i=v.G.concat(f.i),!0):f.I==1||f.I==2||f.D>=(f.Sa?0:f.Ta)?!1:(f.m=ei(m(f.Ea,f,v),nf(f,f.D)),f.D++,!0)}r.Ea=function(f){if(this.m)if(this.m=null,this.I==1){if(!f){this.V=Math.floor(Math.random()*1e5),f=this.V++;const z=new Nr(this,this.j,f);let Y=this.o;if(this.U&&(Y?(Y=V(Y),de(Y,this.U)):Y=this.U),this.u!==null||this.R||(z.J=Y,Y=null),this.S)e:{for(var v=0,T=0;T<this.i.length;T++){t:{var I=this.i[T];if("__data__"in I.map&&(I=I.map.__data__,typeof I=="string")){I=I.length;break t}I=void 0}if(I===void 0)break;if(v+=I,v>4096){v=T;break e}if(v===4096||T===this.i.length-1){v=T+1;break e}}v=1e3}else v=1e3;v=Xd(this,z,v),T=$t(this.J),nt(T,"RID",f),nt(T,"CVER",22),this.G&&nt(T,"X-HTTP-Session-Id",this.G),za(this,T),Y&&(this.R?v="headers="+Vi(gr(Y))+"&"+v:this.u&&Ua(T,this.u,Y)),lu(this.h,z),this.Ra&&nt(T,"TYPE","init"),this.S?(nt(T,"$req",v),nt(T,"SID","null"),z.U=!0,ni(z,T,null)):ni(z,T,v),this.I=2}}else this.I==3&&(f?vu(this,f):this.i.length==0||ou(this.h)||vu(this))};function vu(f,v){var T;v?T=v.l:T=f.V++;const I=$t(f.J);nt(I,"SID",f.M),nt(I,"RID",T),nt(I,"AID",f.K),za(f,I),f.u&&f.o&&Ua(I,f.u,f.o),T=new Nr(f,f.j,T,f.D+1),f.u===null&&(T.J=f.o),v&&(f.i=v.G.concat(f.i)),v=Xd(f,T,1e3),T.H=Math.round(f.va*.5)+Math.round(f.va*.5*Math.random()),lu(f.h,T),ni(T,I,v)}function za(f,v){f.H&&Z(f.H,function(T,I){nt(v,I,T)}),f.l&&Z({},function(T,I){nt(v,I,T)})}function Xd(f,v,T){T=Math.min(f.i.length,T);const I=f.l?m(f.l.Ka,f.l,f):null;e:{var z=f.i;let De=-1;for(;;){const Dt=["count="+T];De==-1?T>0?(De=z[0].g,Dt.push("ofs="+De)):De=0:Dt.push("ofs="+De);let Xe=!0;for(let vt=0;vt<T;vt++){var Y=z[vt].g;const pr=z[vt].map;if(Y-=De,Y<0)De=Math.max(0,z[vt].g-100),Xe=!1;else try{Y="req"+Y+"_"||"";try{var me=pr instanceof Map?pr:Object.entries(pr);for(const[mi,Mr]of me){let jr=Mr;h(Mr)&&(jr=gs(Mr)),Dt.push(Y+mi+"="+encodeURIComponent(jr))}}catch(mi){throw Dt.push(Y+"type="+encodeURIComponent("_badmap")),mi}}catch{I&&I(pr)}}if(Xe){me=Dt.join("&");break e}}me=void 0}return f=f.i.splice(0,T),v.G=f,me}function Zd(f){if(!f.g&&!f.v){f.Y=1;var v=f.Da;ye||x(),he||(ye(),he=!0),R.add(v,f),f.A=0}}function qa(f){return f.g||f.v||f.A>=3?!1:(f.Y++,f.v=ei(m(f.Da,f),nf(f,f.A)),f.A++,!0)}r.Da=function(){if(this.v=null,ef(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var f=4*this.T;this.j.info("BP detection timer enabled: "+f),this.B=ei(m(this.Wa,this),f)}},r.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Ft(10),Ts(this),ef(this))};function wu(f){f.B!=null&&(c.clearTimeout(f.B),f.B=null)}function ef(f){f.g=new Nr(f,f.j,"rpc",f.Y),f.u===null&&(f.g.J=f.o),f.g.P=0;var v=$t(f.na);nt(v,"RID","rpc"),nt(v,"SID",f.M),nt(v,"AID",f.K),nt(v,"CI",f.F?"0":"1"),!f.F&&f.ia&&nt(v,"TO",f.ia),nt(v,"TYPE","xmlhttp"),za(f,v),f.u&&f.o&&Ua(v,f.u,f.o),f.O&&(f.g.H=f.O);var T=f.g;f=f.ba,T.M=1,T.A=Ma($t(v)),T.u=null,T.R=!0,Xo(T,f)}r.Va=function(){this.C!=null&&(this.C=null,Ts(this),qa(this),Ft(19))};function ol(f){f.C!=null&&(c.clearTimeout(f.C),f.C=null)}function tf(f,v){var T=null;if(f.g==v){ol(f),wu(f),f.g=null;var I=2}else if(oi(f.h,v))T=v.G,cu(f.h,v),I=1;else return;if(f.I!=0){if(v.o)if(I==1){T=v.u?v.u.length:0,v=Date.now()-v.F;var z=f.D;I=Jo(),en(I,new Zr(I,T)),di(f)}else Zd(f);else if(z=v.m,z==3||z==0&&v.X>0||!(I==1&&al(f,v)||I==2&&qa(f)))switch(T&&T.length>0&&(v=f.h,v.i=v.i.concat(T)),z){case 1:fi(f,5);break;case 4:fi(f,10);break;case 3:fi(f,6);break;default:fi(f,2)}}}function nf(f,v){let T=f.Qa+Math.floor(Math.random()*f.Za);return f.isActive()||(T*=2),T*v}function fi(f,v){if(f.j.info("Error code "+v),v==2){var T=m(f.bb,f),I=f.Ua;const z=!I;I=new Jn(I||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||on(I,"https"),Ma(I),z?Pr(I.toString(),T):gu(I.toString(),T)}else Ft(2);f.I=0,f.l&&f.l.pa(v),rf(f),sl(f)}r.bb=function(f){f?(this.j.info("Successfully pinged google.com"),Ft(2)):(this.j.info("Failed to ping google.com"),Ft(1))};function rf(f){if(f.I=0,f.ja=[],f.l){const v=uu(f.h);(v.length!=0||f.i.length!=0)&&(C(f.ja,v),C(f.ja,f.i),f.h.i.length=0,S(f.i),f.i.length=0),f.l.oa()}}function sf(f,v,T){var I=T instanceof Jn?$t(T):new Jn(T);if(I.g!="")v&&(I.g=v+"."+I.g),ps(I,I.u);else{var z=c.location;I=z.protocol,v=v?v+"."+z.hostname:z.hostname,z=+z.port;const Y=new Jn(null);I&&on(Y,I),v&&(Y.g=v),z&&ps(Y,z),T&&(Y.h=T),I=Y}return T=f.G,v=f.wa,T&&v&&nt(I,T,v),nt(I,"VER",f.ka),za(f,I),I}function af(f,v,T){if(v&&!f.L)throw Error("Can't create secondary domain capable XhrIo object.");return v=f.Aa&&!f.ma?new ot(new ci({ab:T})):new ot(f.ma),v.Fa(f.L),v}r.isActive=function(){return!!this.l&&this.l.isActive(this)};function of(){}r=of.prototype,r.ra=function(){},r.qa=function(){},r.pa=function(){},r.oa=function(){},r.isActive=function(){return!0},r.Ka=function(){};function Ss(){}Ss.prototype.g=function(f,v){return new kn(f,v)};function kn(f,v){Bt.call(this),this.g=new Es(v),this.l=f,this.h=v&&v.messageUrlParams||null,f=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(f?f["X-WebChannel-Content-Type"]=v.messageContentType:f={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.sa&&(f?f["X-WebChannel-Client-Profile"]=v.sa:f={"X-WebChannel-Client-Profile":v.sa}),this.g.U=f,(f=v&&v.Qb)&&!P(f)&&(this.g.u=f),this.A=v&&v.supportsCrossDomainXhr||!1,this.v=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!P(v)&&(this.g.G=v,f=this.h,f!==null&&v in f&&(f=this.h,v in f&&delete f[v])),this.j=new Li(this)}_(kn,Bt),kn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},kn.prototype.close=function(){_u(this.g)},kn.prototype.o=function(f){var v=this.g;if(typeof f=="string"){var T={};T.__data__=f,f=T}else this.v&&(T={},T.__data__=gs(f),f=T);v.i.push(new qt(v.Ya++,f)),v.I==3&&di(v)},kn.prototype.N=function(){this.g.l=null,delete this.j,_u(this.g),delete this.g,kn.Z.N.call(this)};function lf(f){dn.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var v=f.__sm__;if(v){e:{for(const T in v){f=T;break e}f=void 0}(this.i=f)&&(f=this.i,v=v!==null&&f in v?v[f]:void 0),this.data=v}else this.data=f}_(lf,dn);function cf(){dr.call(this),this.status=1}_(cf,dr);function Li(f){this.g=f}_(Li,of),Li.prototype.ra=function(){en(this.g,"a")},Li.prototype.qa=function(f){en(this.g,new lf(f))},Li.prototype.pa=function(f){en(this.g,new cf)},Li.prototype.oa=function(){en(this.g,"b")},Ss.prototype.createWebChannel=Ss.prototype.g,kn.prototype.send=kn.prototype.o,kn.prototype.open=kn.prototype.m,kn.prototype.close=kn.prototype.close,BR=function(){return new Ss},UR=function(){return Jo()},LR=Pt,ov={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Da.NO_ERROR=0,Da.TIMEOUT=8,Da.HTTP_ERROR=6,Mm=Da,iu.COMPLETE="complete",jR=iu,Bd.EventType=Cr,Cr.OPEN="a",Cr.CLOSE="b",Cr.ERROR="c",Cr.MESSAGE="d",Bt.prototype.listen=Bt.prototype.J,yh=Bd,ot.prototype.listenOnce=ot.prototype.K,ot.prototype.getLastError=ot.prototype.Ha,ot.prototype.getLastErrorCode=ot.prototype.ya,ot.prototype.getStatus=ot.prototype.ca,ot.prototype.getResponseJson=ot.prototype.La,ot.prototype.getResponseText=ot.prototype.la,ot.prototype.send=ot.prototype.ea,ot.prototype.setWithCredentials=ot.prototype.Fa,MR=ot}).apply(typeof mm<"u"?mm:typeof self<"u"?self:typeof window<"u"?window:{});const lA="@firebase/firestore",cA="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}un.UNAUTHENTICATED=new un(null),un.GOOGLE_CREDENTIALS=new un("google-credentials-uid"),un.FIRST_PARTY=new un("first-party-uid"),un.MOCK_USER=new un("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zc="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fa=new Ig("@firebase/firestore");function Jl(){return fa.logLevel}function o4(r){fa.setLogLevel(r)}function ae(r,...e){if(fa.logLevel<=Fe.DEBUG){const t=e.map(O0);fa.debug(`Firestore (${zc}): ${r}`,...t)}}function jt(r,...e){if(fa.logLevel<=Fe.ERROR){const t=e.map(O0);fa.error(`Firestore (${zc}): ${r}`,...t)}}function Pi(r,...e){if(fa.logLevel<=Fe.WARN){const t=e.map(O0);fa.warn(`Firestore (${zc}): ${r}`,...t)}}function O0(r){if(typeof r=="string")return r;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(r)}catch{return r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _e(r,e,t){let n="Unexpected state";typeof e=="string"?n=e:t=e,FR(r,n,t)}function FR(r,e,t){let n=`FIRESTORE (${zc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${r.toString(16)})`;if(t!==void 0)try{n+=" CONTEXT: "+JSON.stringify(t)}catch{n+=" CONTEXT: "+t}throw jt(n),new Error(n)}function be(r,e,t,n){let s="Unexpected state";typeof t=="string"?s=t:n=t,r||FR(e,s,n)}function l4(r,e){r||_e(57014,e)}function pe(r,e){return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ie extends Vn{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wn{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zR{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class c4{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(un.UNAUTHENTICATED)))}shutdown(){}}class u4{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class h4{constructor(e){this.t=e,this.currentUser=un.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){be(this.o===void 0,42304);let n=this.i;const s=d=>this.i!==n?(n=this.i,t(d)):Promise.resolve();let o=new wn;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new wn,e.enqueueRetryable((()=>s(this.currentUser)))};const c=()=>{const d=o;e.enqueueRetryable((async()=>{await d.promise,await s(this.currentUser)}))},h=d=>{ae("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit((d=>h(d))),setTimeout((()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?h(d):(ae("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new wn)}}),0),c()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((n=>this.i!==e?(ae("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(be(typeof n.accessToken=="string",31837,{l:n}),new zR(n.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return be(e===null||typeof e=="string",2055,{h:e}),new un(e)}}class d4{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=un.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class f4{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new d4(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(un.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class uA{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class m4{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Et(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){be(this.o===void 0,3512);const n=o=>{o.error!=null&&ae("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const c=o.token!==this.m;return this.m=o.token,ae("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable((()=>n(o)))};const s=o=>{ae("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((o=>s(o))),setTimeout((()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?s(o):ae("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new uA(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(be(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new uA(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g4(r){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<r;n++)t[n]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P0{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const s=g4(40);for(let o=0;o<s.length;++o)n.length<20&&s[o]<t&&(n+=e.charAt(s[o]%62))}return n}}function Oe(r,e){return r<e?-1:r>e?1:0}function lv(r,e){const t=Math.min(r.length,e.length);for(let n=0;n<t;n++){const s=r.charAt(n),o=e.charAt(n);if(s!==o)return C_(s)===C_(o)?Oe(s,o):C_(s)?1:-1}return Oe(r.length,e.length)}const p4=55296,y4=57343;function C_(r){const e=r.charCodeAt(0);return e>=p4&&e<=y4}function pc(r,e,t){return r.length===e.length&&r.every(((n,s)=>t(n,e[s])))}function qR(r){return r+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hA="__name__";class vi{constructor(e,t,n){t===void 0?t=0:t>e.length&&_e(637,{offset:t,range:e.length}),n===void 0?n=e.length-t:n>e.length-t&&_e(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return vi.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof vi?e.forEach((n=>{t.push(n)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let s=0;s<n;s++){const o=vi.compareSegments(e.get(s),t.get(s));if(o!==0)return o}return Oe(e.length,t.length)}static compareSegments(e,t){const n=vi.isNumericId(e),s=vi.isNumericId(t);return n&&!s?-1:!n&&s?1:n&&s?vi.extractNumericId(e).compare(vi.extractNumericId(t)):lv(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return aa.fromString(e.substring(4,e.length-2))}}class ze extends vi{construct(e,t,n){return new ze(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new ie(Q.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((s=>s.length>0)))}return new ze(t)}static emptyPath(){return new ze([])}}const _4=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Tt extends vi{construct(e,t,n){return new Tt(e,t,n)}static isValidIdentifier(e){return _4.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Tt.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===hA}static keyField(){return new Tt([hA])}static fromServerFormat(e){const t=[];let n="",s=0;const o=()=>{if(n.length===0)throw new ie(Q.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let c=!1;for(;s<e.length;){const h=e[s];if(h==="\\"){if(s+1===e.length)throw new ie(Q.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const d=e[s+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new ie(Q.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=d,s+=2}else h==="`"?(c=!c,s++):h!=="."||c?(n+=h,s++):(o(),s++)}if(o(),c)throw new ie(Q.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Tt(t)}static emptyPath(){return new Tt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ge{constructor(e){this.path=e}static fromPath(e){return new ge(ze.fromString(e))}static fromName(e){return new ge(ze.fromString(e).popFirst(5))}static empty(){return new ge(ze.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ze.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ze.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ge(new ze(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D0(r,e,t){if(!t)throw new ie(Q.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function $R(r,e,t,n){if(e===!0&&n===!0)throw new ie(Q.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)}function dA(r){if(!ge.isDocumentKey(r))throw new ie(Q.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function fA(r){if(ge.isDocumentKey(r))throw new ie(Q.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${r} has ${r.length}.`)}function HR(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}function Lg(r){if(r===void 0)return"undefined";if(r===null)return"null";if(typeof r=="string")return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if(typeof r=="number"||typeof r=="boolean")return""+r;if(typeof r=="object"){if(r instanceof Array)return"an array";{const e=(function(n){return n.constructor?n.constructor.name:null})(r);return e?`a custom ${e} object`:"an object"}}return typeof r=="function"?"a function":_e(12329,{type:typeof r})}function Je(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new ie(Q.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Lg(r);throw new ie(Q.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}function GR(r,e){if(e<=0)throw new ie(Q.INVALID_ARGUMENT,`Function ${r}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xt(r,e){const t={typeString:r};return e&&(t.value=e),t}function wd(r,e){if(!HR(r))throw new ie(Q.INVALID_ARGUMENT,"JSON must be an object");let t;for(const n in e)if(e[n]){const s=e[n].typeString,o="value"in e[n]?{value:e[n].value}:void 0;if(!(n in r)){t=`JSON missing required field: '${n}'`;break}const c=r[n];if(s&&typeof c!==s){t=`JSON field '${n}' must be a ${s}.`;break}if(o!==void 0&&c!==o.value){t=`Expected '${n}' field to equal '${o.value}'`;break}}if(t)throw new ie(Q.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mA=-62135596800,gA=1e6;class tt{static now(){return tt.fromMillis(Date.now())}static fromDate(e){return tt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*gA);return new tt(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ie(Q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ie(Q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<mA)throw new ie(Q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ie(Q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/gA}_compareTo(e){return this.seconds===e.seconds?Oe(this.nanoseconds,e.nanoseconds):Oe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:tt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(wd(e,tt._jsonSchema))return new tt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-mA;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}tt._jsonSchemaVersion="firestore/timestamp/1.0",tt._jsonSchema={type:Xt("string",tt._jsonSchemaVersion),seconds:Xt("number"),nanoseconds:Xt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Se{static fromTimestamp(e){return new Se(e)}static min(){return new Se(new tt(0,0))}static max(){return new Se(new tt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yc=-1;class ng{constructor(e,t,n,s){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=s}}function cv(r){return r.fields.find((e=>e.kind===2))}function uo(r){return r.fields.filter((e=>e.kind!==2))}ng.UNKNOWN_ID=-1;class jm{constructor(e,t){this.fieldPath=e,this.kind=t}}class Wh{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Wh(0,hr.min())}}function KR(r,e){const t=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,s=Se.fromTimestamp(n===1e9?new tt(t+1,0):new tt(t,n));return new hr(s,ge.empty(),e)}function WR(r){return new hr(r.readTime,r.key,yc)}class hr{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new hr(Se.min(),ge.empty(),yc)}static max(){return new hr(Se.max(),ge.empty(),yc)}}function V0(r,e){let t=r.readTime.compareTo(e.readTime);return t!==0?t:(t=ge.comparator(r.documentKey,e.documentKey),t!==0?t:Oe(r.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class YR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ta(r){if(r.code!==Q.FAILED_PRECONDITION||r.message!==QR)throw r;ae("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&_e(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new F(((n,s)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(n,s)},this.catchCallback=o=>{this.wrapFailure(t,o).next(n,s)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof F?t:F.resolve(t)}catch(t){return F.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):F.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):F.reject(t)}static resolve(e){return new F(((t,n)=>{t(e)}))}static reject(e){return new F(((t,n)=>{n(e)}))}static waitFor(e){return new F(((t,n)=>{let s=0,o=0,c=!1;e.forEach((h=>{++s,h.next((()=>{++o,c&&o===s&&t()}),(d=>n(d)))})),c=!0,o===s&&t()}))}static or(e){let t=F.resolve(!1);for(const n of e)t=t.next((s=>s?F.resolve(s):n()));return t}static forEach(e,t){const n=[];return e.forEach(((s,o)=>{n.push(t.call(this,s,o))})),this.waitFor(n)}static mapArray(e,t){return new F(((n,s)=>{const o=e.length,c=new Array(o);let h=0;for(let d=0;d<o;d++){const m=d;t(e[m]).next((y=>{c[m]=y,++h,h===o&&n(c)}),(y=>s(y)))}}))}static doWhile(e,t){return new F(((n,s)=>{const o=()=>{e()===!0?t().next((()=>{o()}),s):n()};o()}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sr="SimpleDb";class Ug{static open(e,t,n,s){try{return new Ug(t,e.transaction(s,n))}catch(o){throw new Ch(t,o)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new wn,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new Ch(e,t.error)):this.S.resolve()},this.transaction.onerror=n=>{const s=M0(n.target.error);this.S.reject(new Ch(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(ae(sr,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new w4(t)}}class Ri{static delete(e){return ae(sr,"Removing database:",e),mo(r0().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!Fh())return!1;if(Ri.F())return!0;const e=It(),t=Ri.M(e),n=0<t&&t<10,s=JR(e),o=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||o)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}constructor(e,t,n){this.name=e,this.version=t,this.N=n,this.B=null,Ri.M(It())===12.2&&jt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(ae(sr,"Opening database:",this.name),this.db=await new Promise(((t,n)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=o=>{const c=o.target.result;t(c)},s.onblocked=()=>{n(new Ch(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=o=>{const c=o.target.error;c.name==="VersionError"?n(new ie(Q.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):c.name==="InvalidStateError"?n(new ie(Q.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+c)):n(new Ch(e,c))},s.onupgradeneeded=o=>{ae(sr,'Database "'+this.name+'" requires upgrade from version:',o.oldVersion);const c=o.target.result;this.N.k(c,s.transaction,o.oldVersion,this.version).next((()=>{ae(sr,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,s){const o=t==="readonly";let c=0;for(;;){++c;try{this.db=await this.L(e);const h=Ug.open(this.db,e,o?"readonly":"readwrite",n),d=s(h).next((m=>(h.C(),m))).catch((m=>(h.abort(m),F.reject(m)))).toPromise();return d.catch((()=>{})),await h.D,d}catch(h){const d=h,m=d.name!=="FirebaseError"&&c<3;if(ae(sr,"Transaction failed with error:",d.message,"Retrying:",m),this.close(),!m)return Promise.reject(d)}}}close(){this.db&&this.db.close(),this.db=void 0}}function JR(r){const e=r.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class v4{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return mo(this.U.delete())}}class Ch extends ie{constructor(e,t){super(Q.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Sa(r){return r.name==="IndexedDbTransactionError"}class w4{constructor(e){this.store=e}put(e,t){let n;return t!==void 0?(ae(sr,"PUT",this.store.name,e,t),n=this.store.put(t,e)):(ae(sr,"PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),mo(n)}add(e){return ae(sr,"ADD",this.store.name,e,e),mo(this.store.add(e))}get(e){return mo(this.store.get(e)).next((t=>(t===void 0&&(t=null),ae(sr,"GET",this.store.name,e,t),t)))}delete(e){return ae(sr,"DELETE",this.store.name,e),mo(this.store.delete(e))}count(){return ae(sr,"COUNT",this.store.name),mo(this.store.count())}J(e,t){const n=this.options(e,t),s=n.index?this.store.index(n.index):this.store;if(typeof s.getAll=="function"){const o=s.getAll(n.range);return new F(((c,h)=>{o.onerror=d=>{h(d.target.error)},o.onsuccess=d=>{c(d.target.result)}}))}{const o=this.cursor(n),c=[];return this.H(o,((h,d)=>{c.push(d)})).next((()=>c))}}Y(e,t){const n=this.store.getAll(e,t===null?void 0:t);return new F(((s,o)=>{n.onerror=c=>{o(c.target.error)},n.onsuccess=c=>{s(c.target.result)}}))}Z(e,t){ae(sr,"DELETE ALL",this.store.name);const n=this.options(e,t);n.X=!1;const s=this.cursor(n);return this.H(s,((o,c,h)=>h.delete()))}ee(e,t){let n;t?n=e:(n={},t=e);const s=this.cursor(n);return this.H(s,t)}te(e){const t=this.cursor({});return new F(((n,s)=>{t.onerror=o=>{const c=M0(o.target.error);s(c)},t.onsuccess=o=>{const c=o.target.result;c?e(c.primaryKey,c.value).next((h=>{h?c.continue():n()})):n()}}))}H(e,t){const n=[];return new F(((s,o)=>{e.onerror=c=>{o(c.target.error)},e.onsuccess=c=>{const h=c.target.result;if(!h)return void s();const d=new v4(h),m=t(h.primaryKey,h.value,d);if(m instanceof F){const y=m.catch((_=>(d.done(),F.reject(_))));n.push(y)}d.isDone?s():d.G===null?h.continue():h.continue(d.G)}})).next((()=>F.waitFor(n)))}options(e,t){let n;return e!==void 0&&(typeof e=="string"?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.X?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function mo(r){return new F(((e,t)=>{r.onsuccess=n=>{const s=n.target.result;e(s)},r.onerror=n=>{const s=M0(n.target.error);t(s)}}))}let pA=!1;function M0(r){const e=Ri.M(It());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(r.message.indexOf(t)>=0){const n=new ie("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return pA||(pA=!0,setTimeout((()=>{throw n}),0)),n}}return r}const kh="IndexBackfiller";class b4{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){ae(kh,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();ae(kh,`Documents written: ${t}`)}catch(t){Sa(t)?ae(kh,"Ignoring IndexedDB error during index backfill: ",t):await Ta(t)}await this.re(6e4)}))}}class E4{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const n=new Set;let s=t,o=!0;return F.doWhile((()=>o===!0&&s>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((c=>{if(c!==null&&!n.has(c))return ae(kh,`Processing collection: ${c}`),this.oe(e,c,s).next((h=>{s-=h,n.add(c)}));o=!1})))).next((()=>t-s))}oe(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((s=>this.localStore.localDocuments.getNextDocuments(e,t,s,n).next((o=>{const c=o.changes;return this.localStore.indexManager.updateIndexEntries(e,c).next((()=>this._e(s,o))).next((h=>(ae(kh,`Updating offset: ${h}`),this.localStore.indexManager.updateCollectionGroup(e,t,h)))).next((()=>c.size))}))))}_e(e,t){let n=e;return t.changes.forEach(((s,o)=>{const c=WR(o);V0(c,n)>0&&(n=c)})),new hr(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kn{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>t.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Kn.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oa=-1;function bd(r){return r==null}function Qh(r){return r===0&&1/r==-1/0}function XR(r){return typeof r=="number"&&Number.isInteger(r)&&!Qh(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rg="";function xn(r){let e="";for(let t=0;t<r.length;t++)e.length>0&&(e=yA(e)),e=T4(r.get(t),e);return yA(e)}function T4(r,e){let t=e;const n=r.length;for(let s=0;s<n;s++){const o=r.charAt(s);switch(o){case"\0":t+="";break;case rg:t+="";break;default:t+=o}}return t}function yA(r){return r+rg+""}function Ii(r){const e=r.length;if(be(e>=2,64408,{path:r}),e===2)return be(r.charAt(0)===rg&&r.charAt(1)==="",56145,{path:r}),ze.emptyPath();const t=e-2,n=[];let s="";for(let o=0;o<e;){const c=r.indexOf(rg,o);switch((c<0||c>t)&&_e(50515,{path:r}),r.charAt(c+1)){case"":const h=r.substring(o,c);let d;s.length===0?d=h:(s+=h,d=s,s=""),n.push(d);break;case"":s+=r.substring(o,c),s+="\0";break;case"":s+=r.substring(o,c+1);break;default:_e(61167,{path:r})}o=c+2}return new ze(n)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ho="remoteDocuments",Ed="owner",Ul="owner",Yh="mutationQueues",S4="userId",$r="mutations",_A="batchId",Eo="userMutationsIndex",vA=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lm(r,e){return[r,xn(e)]}function ZR(r,e,t){return[r,xn(e),t]}const A4={},_c="documentMutations",ig="remoteDocumentsV14",I4=["prefixPath","collectionGroup","readTime","documentId"],Um="documentKeyIndex",x4=["prefixPath","collectionGroup","documentId"],e1="collectionGroupIndex",R4=["collectionGroup","readTime","prefixPath","documentId"],Jh="remoteDocumentGlobal",uv="remoteDocumentGlobalKey",vc="targets",t1="queryTargetsIndex",C4=["canonicalId","targetId"],wc="targetDocuments",k4=["targetId","path"],j0="documentTargetsIndex",N4=["path","targetId"],sg="targetGlobalKey",Ro="targetGlobal",Xh="collectionParents",O4=["collectionId","parent"],bc="clientMetadata",P4="clientId",Bg="bundles",D4="bundleId",Fg="namedQueries",V4="name",L0="indexConfiguration",M4="indexId",hv="collectionGroupIndex",j4="collectionGroup",Nh="indexState",L4=["indexId","uid"],n1="sequenceNumberIndex",U4=["uid","sequenceNumber"],Oh="indexEntries",B4=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],r1="documentKeyIndex",F4=["indexId","uid","orderedDocumentKey"],zg="documentOverlays",z4=["userId","collectionPath","documentId"],dv="collectionPathOverlayIndex",q4=["userId","collectionPath","largestBatchId"],i1="collectionGroupOverlayIndex",$4=["userId","collectionGroup","largestBatchId"],U0="globals",H4="name",s1=[Yh,$r,_c,ho,vc,Ed,Ro,wc,bc,Jh,Xh,Bg,Fg],G4=[...s1,zg],a1=[Yh,$r,_c,ig,vc,Ed,Ro,wc,bc,Jh,Xh,Bg,Fg,zg],o1=a1,B0=[...o1,L0,Nh,Oh],K4=B0,l1=[...B0,U0],W4=l1;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fv extends YR{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function sn(r,e){const t=pe(r);return Ri.O(t.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wA(r){let e=0;for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function Aa(r,e){for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function c1(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{constructor(e,t){this.comparator=e,this.root=t||_n.EMPTY}insert(e,t){return new mt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,_n.BLACK,null,null))}remove(e){return new mt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,_n.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return t+n.left.size;s<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new gm(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new gm(this.root,e,this.comparator,!1)}getReverseIterator(){return new gm(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new gm(this.root,e,this.comparator,!0)}}class gm{constructor(e,t,n,s){this.isReverse=s,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?n(e.key,t):1,t&&s&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class _n{constructor(e,t,n,s,o){this.key=e,this.value=t,this.color=n??_n.RED,this.left=s??_n.EMPTY,this.right=o??_n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,s,o){return new _n(e??this.key,t??this.value,n??this.color,s??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let s=this;const o=n(e,s.key);return s=o<0?s.copy(null,null,null,s.left.insert(e,t,n),null):o===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return _n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return _n.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,_n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,_n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw _e(43730,{key:this.key,value:this.value});if(this.right.isRed())throw _e(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw _e(27949);return e+(this.isRed()?0:1)}}_n.EMPTY=null,_n.RED=!0,_n.BLACK=!1;_n.EMPTY=new class{constructor(){this.size=0}get key(){throw _e(57766)}get value(){throw _e(16141)}get color(){throw _e(16727)}get left(){throw _e(29726)}get right(){throw _e(36894)}copy(e,t,n,s,o){return this}insert(e,t,n){return new _n(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at{constructor(e){this.comparator=e,this.data=new mt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new bA(this.data.getIterator())}getIteratorFrom(e){return new bA(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((n=>{t=t.add(n)})),t}isEqual(e){if(!(e instanceof at)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,o=n.getNext().key;if(this.comparator(s,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new at(this.comparator);return t.data=e,t}}class bA{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Bl(r){return r.hasNext()?r.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wn{constructor(e){this.fields=e,e.sort(Tt.comparator)}static empty(){return new Wn([])}unionWith(e){let t=new at(Tt.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Wn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return pc(this.fields,e.fields,((t,n)=>t.isEqual(n)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u1 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q4(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(s){try{return atob(s)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new u1("Invalid base64 string: "+o):o}})(e);return new kt(t)}static fromUint8Array(e){const t=(function(s){let o="";for(let c=0;c<s.length;++c)o+=String.fromCharCode(s[c]);return o})(e);return new kt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const n=new Uint8Array(t.length);for(let s=0;s<t.length;s++)n[s]=t.charCodeAt(s);return n})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Oe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}kt.EMPTY_BYTE_STRING=new kt("");const Y4=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function as(r){if(be(!!r,39018),typeof r=="string"){let e=0;const t=Y4.exec(r);if(be(!!t,46558,{timestamp:r}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:bt(r.seconds),nanos:bt(r.nanos)}}function bt(r){return typeof r=="number"?r:typeof r=="string"?Number(r):0}function os(r){return typeof r=="string"?kt.fromBase64String(r):kt.fromUint8Array(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h1="server_timestamp",d1="__type__",f1="__previous_value__",m1="__local_write_time__";function qg(r){var t,n;return((n=(((t=r==null?void 0:r.mapValue)==null?void 0:t.fields)||{})[d1])==null?void 0:n.stringValue)===h1}function $g(r){const e=r.mapValue.fields[f1];return qg(e)?$g(e):e}function Zh(r){const e=as(r.mapValue.fields[m1].timestampValue);return new tt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J4{constructor(e,t,n,s,o,c,h,d,m,y){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=s,this.ssl=o,this.forceLongPolling=c,this.autoDetectLongPolling=h,this.longPollingOptions=d,this.useFetchStreams=m,this.isUsingEmulator=y}}const mv="(default)";class ma{constructor(e,t){this.projectId=e,this.database=t||mv}static empty(){return new ma("","")}get isDefaultDatabase(){return this.database===mv}isEqual(e){return e instanceof ma&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F0="__type__",g1="__max__",na={mapValue:{fields:{__type__:{stringValue:g1}}}},z0="__vector__",Ec="value",Bm={nullValue:"NULL_VALUE"};function ga(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?qg(r)?4:p1(r)?9007199254740991:Hg(r)?10:11:_e(28295,{value:r})}function Di(r,e){if(r===e)return!0;const t=ga(r);if(t!==ga(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return Zh(r).isEqual(Zh(e));case 3:return(function(s,o){if(typeof s.timestampValue=="string"&&typeof o.timestampValue=="string"&&s.timestampValue.length===o.timestampValue.length)return s.timestampValue===o.timestampValue;const c=as(s.timestampValue),h=as(o.timestampValue);return c.seconds===h.seconds&&c.nanos===h.nanos})(r,e);case 5:return r.stringValue===e.stringValue;case 6:return(function(s,o){return os(s.bytesValue).isEqual(os(o.bytesValue))})(r,e);case 7:return r.referenceValue===e.referenceValue;case 8:return(function(s,o){return bt(s.geoPointValue.latitude)===bt(o.geoPointValue.latitude)&&bt(s.geoPointValue.longitude)===bt(o.geoPointValue.longitude)})(r,e);case 2:return(function(s,o){if("integerValue"in s&&"integerValue"in o)return bt(s.integerValue)===bt(o.integerValue);if("doubleValue"in s&&"doubleValue"in o){const c=bt(s.doubleValue),h=bt(o.doubleValue);return c===h?Qh(c)===Qh(h):isNaN(c)&&isNaN(h)}return!1})(r,e);case 9:return pc(r.arrayValue.values||[],e.arrayValue.values||[],Di);case 10:case 11:return(function(s,o){const c=s.mapValue.fields||{},h=o.mapValue.fields||{};if(wA(c)!==wA(h))return!1;for(const d in c)if(c.hasOwnProperty(d)&&(h[d]===void 0||!Di(c[d],h[d])))return!1;return!0})(r,e);default:return _e(52216,{left:r})}}function ed(r,e){return(r.values||[]).find((t=>Di(t,e)))!==void 0}function pa(r,e){if(r===e)return 0;const t=ga(r),n=ga(e);if(t!==n)return Oe(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return Oe(r.booleanValue,e.booleanValue);case 2:return(function(o,c){const h=bt(o.integerValue||o.doubleValue),d=bt(c.integerValue||c.doubleValue);return h<d?-1:h>d?1:h===d?0:isNaN(h)?isNaN(d)?0:-1:1})(r,e);case 3:return EA(r.timestampValue,e.timestampValue);case 4:return EA(Zh(r),Zh(e));case 5:return lv(r.stringValue,e.stringValue);case 6:return(function(o,c){const h=os(o),d=os(c);return h.compareTo(d)})(r.bytesValue,e.bytesValue);case 7:return(function(o,c){const h=o.split("/"),d=c.split("/");for(let m=0;m<h.length&&m<d.length;m++){const y=Oe(h[m],d[m]);if(y!==0)return y}return Oe(h.length,d.length)})(r.referenceValue,e.referenceValue);case 8:return(function(o,c){const h=Oe(bt(o.latitude),bt(c.latitude));return h!==0?h:Oe(bt(o.longitude),bt(c.longitude))})(r.geoPointValue,e.geoPointValue);case 9:return TA(r.arrayValue,e.arrayValue);case 10:return(function(o,c){var E,S,C,k;const h=o.fields||{},d=c.fields||{},m=(E=h[Ec])==null?void 0:E.arrayValue,y=(S=d[Ec])==null?void 0:S.arrayValue,_=Oe(((C=m==null?void 0:m.values)==null?void 0:C.length)||0,((k=y==null?void 0:y.values)==null?void 0:k.length)||0);return _!==0?_:TA(m,y)})(r.mapValue,e.mapValue);case 11:return(function(o,c){if(o===na.mapValue&&c===na.mapValue)return 0;if(o===na.mapValue)return 1;if(c===na.mapValue)return-1;const h=o.fields||{},d=Object.keys(h),m=c.fields||{},y=Object.keys(m);d.sort(),y.sort();for(let _=0;_<d.length&&_<y.length;++_){const E=lv(d[_],y[_]);if(E!==0)return E;const S=pa(h[d[_]],m[y[_]]);if(S!==0)return S}return Oe(d.length,y.length)})(r.mapValue,e.mapValue);default:throw _e(23264,{he:t})}}function EA(r,e){if(typeof r=="string"&&typeof e=="string"&&r.length===e.length)return Oe(r,e);const t=as(r),n=as(e),s=Oe(t.seconds,n.seconds);return s!==0?s:Oe(t.nanos,n.nanos)}function TA(r,e){const t=r.values||[],n=e.values||[];for(let s=0;s<t.length&&s<n.length;++s){const o=pa(t[s],n[s]);if(o)return o}return Oe(t.length,n.length)}function Tc(r){return gv(r)}function gv(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?(function(t){const n=as(t);return`time(${n.seconds},${n.nanos})`})(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?(function(t){return os(t).toBase64()})(r.bytesValue):"referenceValue"in r?(function(t){return ge.fromName(t).toString()})(r.referenceValue):"geoPointValue"in r?(function(t){return`geo(${t.latitude},${t.longitude})`})(r.geoPointValue):"arrayValue"in r?(function(t){let n="[",s=!0;for(const o of t.values||[])s?s=!1:n+=",",n+=gv(o);return n+"]"})(r.arrayValue):"mapValue"in r?(function(t){const n=Object.keys(t.fields||{}).sort();let s="{",o=!0;for(const c of n)o?o=!1:s+=",",s+=`${c}:${gv(t.fields[c])}`;return s+"}"})(r.mapValue):_e(61005,{value:r})}function Fm(r){switch(ga(r)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=$g(r);return e?16+Fm(e):16;case 5:return 2*r.stringValue.length;case 6:return os(r.bytesValue).approximateByteSize();case 7:return r.referenceValue.length;case 9:return(function(n){return(n.values||[]).reduce(((s,o)=>s+Fm(o)),0)})(r.arrayValue);case 10:case 11:return(function(n){let s=0;return Aa(n.fields,((o,c)=>{s+=o.length+Fm(c)})),s})(r.mapValue);default:throw _e(13486,{value:r})}}function Oo(r,e){return{referenceValue:`projects/${r.projectId}/databases/${r.database}/documents/${e.path.canonicalString()}`}}function pv(r){return!!r&&"integerValue"in r}function td(r){return!!r&&"arrayValue"in r}function SA(r){return!!r&&"nullValue"in r}function AA(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function zm(r){return!!r&&"mapValue"in r}function Hg(r){var t,n;return((n=(((t=r==null?void 0:r.mapValue)==null?void 0:t.fields)||{})[F0])==null?void 0:n.stringValue)===z0}function Ph(r){if(r.geoPointValue)return{geoPointValue:{...r.geoPointValue}};if(r.timestampValue&&typeof r.timestampValue=="object")return{timestampValue:{...r.timestampValue}};if(r.mapValue){const e={mapValue:{fields:{}}};return Aa(r.mapValue.fields,((t,n)=>e.mapValue.fields[t]=Ph(n))),e}if(r.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Ph(r.arrayValue.values[t]);return e}return{...r}}function p1(r){return(((r.mapValue||{}).fields||{}).__type__||{}).stringValue===g1}const y1={mapValue:{fields:{[F0]:{stringValue:z0},[Ec]:{arrayValue:{}}}}};function X4(r){return"nullValue"in r?Bm:"booleanValue"in r?{booleanValue:!1}:"integerValue"in r||"doubleValue"in r?{doubleValue:NaN}:"timestampValue"in r?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in r?{stringValue:""}:"bytesValue"in r?{bytesValue:""}:"referenceValue"in r?Oo(ma.empty(),ge.empty()):"geoPointValue"in r?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in r?{arrayValue:{}}:"mapValue"in r?Hg(r)?y1:{mapValue:{}}:_e(35942,{value:r})}function Z4(r){return"nullValue"in r?{booleanValue:!1}:"booleanValue"in r?{doubleValue:NaN}:"integerValue"in r||"doubleValue"in r?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in r?{stringValue:""}:"stringValue"in r?{bytesValue:""}:"bytesValue"in r?Oo(ma.empty(),ge.empty()):"referenceValue"in r?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in r?{arrayValue:{}}:"arrayValue"in r?y1:"mapValue"in r?Hg(r)?{mapValue:{}}:na:_e(61959,{value:r})}function IA(r,e){const t=pa(r.value,e.value);return t!==0?t:r.inclusive&&!e.inclusive?-1:!r.inclusive&&e.inclusive?1:0}function xA(r,e){const t=pa(r.value,e.value);return t!==0?t:r.inclusive&&!e.inclusive?1:!r.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vn{constructor(e){this.value=e}static empty(){return new vn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!zm(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ph(t)}setAll(e){let t=Tt.emptyPath(),n={},s=[];e.forEach(((c,h)=>{if(!t.isImmediateParentOf(h)){const d=this.getFieldsMap(t);this.applyChanges(d,n,s),n={},s=[],t=h.popLast()}c?n[h.lastSegment()]=Ph(c):s.push(h.lastSegment())}));const o=this.getFieldsMap(t);this.applyChanges(o,n,s)}delete(e){const t=this.field(e.popLast());zm(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Di(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=t.mapValue.fields[e.get(n)];zm(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,n){Aa(t,((s,o)=>e[s]=o));for(const s of n)delete e[s]}clone(){return new vn(Ph(this.value))}}function _1(r){const e=[];return Aa(r.fields,((t,n)=>{const s=new Tt([t]);if(zm(n)){const o=_1(n.mapValue).fields;if(o.length===0)e.push(s);else for(const c of o)e.push(s.child(c))}else e.push(s)})),new Wn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yt{constructor(e,t,n,s,o,c,h){this.key=e,this.documentType=t,this.version=n,this.readTime=s,this.createTime=o,this.data=c,this.documentState=h}static newInvalidDocument(e){return new yt(e,0,Se.min(),Se.min(),Se.min(),vn.empty(),0)}static newFoundDocument(e,t,n,s){return new yt(e,1,t,Se.min(),n,s,0)}static newNoDocument(e,t){return new yt(e,2,t,Se.min(),Se.min(),vn.empty(),0)}static newUnknownDocument(e,t){return new yt(e,3,t,Se.min(),Se.min(),vn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Se.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=vn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=vn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Se.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof yt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new yt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ya{constructor(e,t){this.position=e,this.inclusive=t}}function RA(r,e,t){let n=0;for(let s=0;s<r.position.length;s++){const o=e[s],c=r.position[s];if(o.field.isKeyField()?n=ge.comparator(ge.fromName(c.referenceValue),t.key):n=pa(c,t.data.field(o.field)),o.dir==="desc"&&(n*=-1),n!==0)break}return n}function CA(r,e){if(r===null)return e===null;if(e===null||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!Di(r.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nd{constructor(e,t="asc"){this.field=e,this.dir=t}}function eL(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v1{}class He extends v1{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new tL(e,t,n):t==="array-contains"?new iL(e,n):t==="in"?new A1(e,n):t==="not-in"?new sL(e,n):t==="array-contains-any"?new aL(e,n):new He(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new nL(e,n):new rL(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(pa(t,this.value)):t!==null&&ga(this.value)===ga(t)&&this.matchesComparison(pa(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return _e(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class st extends v1{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new st(e,t)}matches(e){return Sc(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Sc(r){return r.op==="and"}function yv(r){return r.op==="or"}function q0(r){return w1(r)&&Sc(r)}function w1(r){for(const e of r.filters)if(e instanceof st)return!1;return!0}function _v(r){if(r instanceof He)return r.field.canonicalString()+r.op.toString()+Tc(r.value);if(q0(r))return r.filters.map((e=>_v(e))).join(",");{const e=r.filters.map((t=>_v(t))).join(",");return`${r.op}(${e})`}}function b1(r,e){return r instanceof He?(function(n,s){return s instanceof He&&n.op===s.op&&n.field.isEqual(s.field)&&Di(n.value,s.value)})(r,e):r instanceof st?(function(n,s){return s instanceof st&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce(((o,c,h)=>o&&b1(c,s.filters[h])),!0):!1})(r,e):void _e(19439)}function E1(r,e){const t=r.filters.concat(e);return st.create(t,r.op)}function T1(r){return r instanceof He?(function(t){return`${t.field.canonicalString()} ${t.op} ${Tc(t.value)}`})(r):r instanceof st?(function(t){return t.op.toString()+" {"+t.getFilters().map(T1).join(" ,")+"}"})(r):"Filter"}class tL extends He{constructor(e,t,n){super(e,t,n),this.key=ge.fromName(n.referenceValue)}matches(e){const t=ge.comparator(e.key,this.key);return this.matchesComparison(t)}}class nL extends He{constructor(e,t){super(e,"in",t),this.keys=S1("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class rL extends He{constructor(e,t){super(e,"not-in",t),this.keys=S1("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function S1(r,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((n=>ge.fromName(n.referenceValue)))}class iL extends He{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return td(t)&&ed(t.arrayValue,this.value)}}class A1 extends He{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&ed(this.value.arrayValue,t)}}class sL extends He{constructor(e,t){super(e,"not-in",t)}matches(e){if(ed(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!ed(this.value.arrayValue,t)}}class aL extends He{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!td(t)||!t.arrayValue.values)&&t.arrayValue.values.some((n=>ed(this.value.arrayValue,n)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oL{constructor(e,t=null,n=[],s=[],o=null,c=null,h=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=s,this.limit=o,this.startAt=c,this.endAt=h,this.Te=null}}function vv(r,e=null,t=[],n=[],s=null,o=null,c=null){return new oL(r,e,t,n,s,o,c)}function Po(r){const e=pe(r);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((n=>_v(n))).join(","),t+="|ob:",t+=e.orderBy.map((n=>(function(o){return o.field.canonicalString()+o.dir})(n))).join(","),bd(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((n=>Tc(n))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((n=>Tc(n))).join(",")),e.Te=t}return e.Te}function Td(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!eL(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!b1(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!CA(r.startAt,e.startAt)&&CA(r.endAt,e.endAt)}function ag(r){return ge.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}function og(r,e){return r.filters.filter((t=>t instanceof He&&t.field.isEqual(e)))}function kA(r,e,t){let n=Bm,s=!0;for(const o of og(r,e)){let c=Bm,h=!0;switch(o.op){case"<":case"<=":c=X4(o.value);break;case"==":case"in":case">=":c=o.value;break;case">":c=o.value,h=!1;break;case"!=":case"not-in":c=Bm}IA({value:n,inclusive:s},{value:c,inclusive:h})<0&&(n=c,s=h)}if(t!==null){for(let o=0;o<r.orderBy.length;++o)if(r.orderBy[o].field.isEqual(e)){const c=t.position[o];IA({value:n,inclusive:s},{value:c,inclusive:t.inclusive})<0&&(n=c,s=t.inclusive);break}}return{value:n,inclusive:s}}function NA(r,e,t){let n=na,s=!0;for(const o of og(r,e)){let c=na,h=!0;switch(o.op){case">=":case">":c=Z4(o.value),h=!1;break;case"==":case"in":case"<=":c=o.value;break;case"<":c=o.value,h=!1;break;case"!=":case"not-in":c=na}xA({value:n,inclusive:s},{value:c,inclusive:h})>0&&(n=c,s=h)}if(t!==null){for(let o=0;o<r.orderBy.length;++o)if(r.orderBy[o].field.isEqual(e)){const c=t.position[o];xA({value:n,inclusive:s},{value:c,inclusive:t.inclusive})>0&&(n=c,s=t.inclusive);break}}return{value:n,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class us{constructor(e,t=null,n=[],s=[],o=null,c="F",h=null,d=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=s,this.limit=o,this.limitType=c,this.startAt=h,this.endAt=d,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function I1(r,e,t,n,s,o,c,h){return new us(r,e,t,n,s,o,c,h)}function qc(r){return new us(r)}function OA(r){return r.filters.length===0&&r.limit===null&&r.startAt==null&&r.endAt==null&&(r.explicitOrderBy.length===0||r.explicitOrderBy.length===1&&r.explicitOrderBy[0].field.isKeyField())}function $0(r){return r.collectionGroup!==null}function cc(r){const e=pe(r);if(e.Ie===null){e.Ie=[];const t=new Set;for(const o of e.explicitOrderBy)e.Ie.push(o),t.add(o.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let h=new at(Tt.comparator);return c.filters.forEach((d=>{d.getFlattenedFilters().forEach((m=>{m.isInequality()&&(h=h.add(m.field))}))})),h})(e).forEach((o=>{t.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new nd(o,n))})),t.has(Tt.keyField().canonicalString())||e.Ie.push(new nd(Tt.keyField(),n))}return e.Ie}function Mn(r){const e=pe(r);return e.Ee||(e.Ee=lL(e,cc(r))),e.Ee}function lL(r,e){if(r.limitType==="F")return vv(r.path,r.collectionGroup,e,r.filters,r.limit,r.startAt,r.endAt);{e=e.map((s=>{const o=s.dir==="desc"?"asc":"desc";return new nd(s.field,o)}));const t=r.endAt?new ya(r.endAt.position,r.endAt.inclusive):null,n=r.startAt?new ya(r.startAt.position,r.startAt.inclusive):null;return vv(r.path,r.collectionGroup,e,r.filters,r.limit,t,n)}}function wv(r,e){const t=r.filters.concat([e]);return new us(r.path,r.collectionGroup,r.explicitOrderBy.slice(),t,r.limit,r.limitType,r.startAt,r.endAt)}function lg(r,e,t){return new us(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function Sd(r,e){return Td(Mn(r),Mn(e))&&r.limitType===e.limitType}function x1(r){return`${Po(Mn(r))}|lt:${r.limitType}`}function Xl(r){return`Query(target=${(function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map((s=>T1(s))).join(", ")}]`),bd(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map((s=>(function(c){return`${c.field.canonicalString()} (${c.dir})`})(s))).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map((s=>Tc(s))).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map((s=>Tc(s))).join(",")),`Target(${n})`})(Mn(r))}; limitType=${r.limitType})`}function Ad(r,e){return e.isFoundDocument()&&(function(n,s){const o=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(o):ge.isDocumentKey(n.path)?n.path.isEqual(o):n.path.isImmediateParentOf(o)})(r,e)&&(function(n,s){for(const o of cc(n))if(!o.field.isKeyField()&&s.data.field(o.field)===null)return!1;return!0})(r,e)&&(function(n,s){for(const o of n.filters)if(!o.matches(s))return!1;return!0})(r,e)&&(function(n,s){return!(n.startAt&&!(function(c,h,d){const m=RA(c,h,d);return c.inclusive?m<=0:m<0})(n.startAt,cc(n),s)||n.endAt&&!(function(c,h,d){const m=RA(c,h,d);return c.inclusive?m>=0:m>0})(n.endAt,cc(n),s))})(r,e)}function R1(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}function C1(r){return(e,t)=>{let n=!1;for(const s of cc(r)){const o=cL(s,e,t);if(o!==0)return o;n=n||s.field.isKeyField()}return 0}}function cL(r,e,t){const n=r.field.isKeyField()?ge.comparator(e.key,t.key):(function(o,c,h){const d=c.data.field(o),m=h.data.field(o);return d!==null&&m!==null?pa(d,m):_e(42886)})(r.field,e,t);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return _e(19790,{direction:r.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hs{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[s,o]of n)if(this.equalsFn(s,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let o=0;o<s.length;o++)if(this.equalsFn(s[o][0],e))return void(s[o]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return n.length===1?delete this.inner[t]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Aa(this.inner,((t,n)=>{for(const[s,o]of n)e(s,o)}))}isEmpty(){return c1(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uL=new mt(ge.comparator);function Qn(){return uL}const k1=new mt(ge.comparator);function _h(...r){let e=k1;for(const t of r)e=e.insert(t.key,t);return e}function N1(r){let e=k1;return r.forEach(((t,n)=>e=e.insert(t,n.overlayedDocument))),e}function xi(){return Dh()}function O1(){return Dh()}function Dh(){return new hs((r=>r.toString()),((r,e)=>r.isEqual(e)))}const hL=new mt(ge.comparator),dL=new at(ge.comparator);function Me(...r){let e=dL;for(const t of r)e=e.add(t);return e}const fL=new at(Oe);function H0(){return fL}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G0(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Qh(e)?"-0":e}}function P1(r){return{integerValue:""+r}}function D1(r,e){return XR(e)?P1(e):G0(r,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gg{constructor(){this._=void 0}}function mL(r,e,t){return r instanceof Ac?(function(s,o){const c={fields:{[d1]:{stringValue:h1},[m1]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return o&&qg(o)&&(o=$g(o)),o&&(c.fields[f1]=o),{mapValue:c}})(t,e):r instanceof Do?M1(r,e):r instanceof Vo?j1(r,e):(function(s,o){const c=V1(s,o),h=PA(c)+PA(s.Ae);return pv(c)&&pv(s.Ae)?P1(h):G0(s.serializer,h)})(r,e)}function gL(r,e,t){return r instanceof Do?M1(r,e):r instanceof Vo?j1(r,e):t}function V1(r,e){return r instanceof Ic?(function(n){return pv(n)||(function(o){return!!o&&"doubleValue"in o})(n)})(e)?e:{integerValue:0}:null}class Ac extends Gg{}class Do extends Gg{constructor(e){super(),this.elements=e}}function M1(r,e){const t=L1(e);for(const n of r.elements)t.some((s=>Di(s,n)))||t.push(n);return{arrayValue:{values:t}}}class Vo extends Gg{constructor(e){super(),this.elements=e}}function j1(r,e){let t=L1(e);for(const n of r.elements)t=t.filter((s=>!Di(s,n)));return{arrayValue:{values:t}}}class Ic extends Gg{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function PA(r){return bt(r.integerValue||r.doubleValue)}function L1(r){return td(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Id{constructor(e,t){this.field=e,this.transform=t}}function pL(r,e){return r.field.isEqual(e.field)&&(function(n,s){return n instanceof Do&&s instanceof Do||n instanceof Vo&&s instanceof Vo?pc(n.elements,s.elements,Di):n instanceof Ic&&s instanceof Ic?Di(n.Ae,s.Ae):n instanceof Ac&&s instanceof Ac})(r.transform,e.transform)}class yL{constructor(e,t){this.version=e,this.transformResults=t}}class St{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new St}static exists(e){return new St(void 0,e)}static updateTime(e){return new St(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function qm(r,e){return r.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(r.updateTime):r.exists===void 0||r.exists===e.isFoundDocument()}class Kg{}function U1(r,e){if(!r.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return r.isNoDocument()?new Hc(r.key,St.none()):new $c(r.key,r.data,St.none());{const t=r.data,n=vn.empty();let s=new at(Tt.comparator);for(let o of e.fields)if(!s.has(o)){let c=t.field(o);c===null&&o.length>1&&(o=o.popLast(),c=t.field(o)),c===null?n.delete(o):n.set(o,c),s=s.add(o)}return new ds(r.key,n,new Wn(s.toArray()),St.none())}}function _L(r,e,t){r instanceof $c?(function(s,o,c){const h=s.value.clone(),d=VA(s.fieldTransforms,o,c.transformResults);h.setAll(d),o.convertToFoundDocument(c.version,h).setHasCommittedMutations()})(r,e,t):r instanceof ds?(function(s,o,c){if(!qm(s.precondition,o))return void o.convertToUnknownDocument(c.version);const h=VA(s.fieldTransforms,o,c.transformResults),d=o.data;d.setAll(B1(s)),d.setAll(h),o.convertToFoundDocument(c.version,d).setHasCommittedMutations()})(r,e,t):(function(s,o,c){o.convertToNoDocument(c.version).setHasCommittedMutations()})(0,e,t)}function Vh(r,e,t,n){return r instanceof $c?(function(o,c,h,d){if(!qm(o.precondition,c))return h;const m=o.value.clone(),y=MA(o.fieldTransforms,d,c);return m.setAll(y),c.convertToFoundDocument(c.version,m).setHasLocalMutations(),null})(r,e,t,n):r instanceof ds?(function(o,c,h,d){if(!qm(o.precondition,c))return h;const m=MA(o.fieldTransforms,d,c),y=c.data;return y.setAll(B1(o)),y.setAll(m),c.convertToFoundDocument(c.version,y).setHasLocalMutations(),h===null?null:h.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map((_=>_.field)))})(r,e,t,n):(function(o,c,h){return qm(o.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):h})(r,e,t)}function vL(r,e){let t=null;for(const n of r.fieldTransforms){const s=e.data.field(n.field),o=V1(n.transform,s||null);o!=null&&(t===null&&(t=vn.empty()),t.set(n.field,o))}return t||null}function DA(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&!!(function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&pc(n,s,((o,c)=>pL(o,c)))})(r.fieldTransforms,e.fieldTransforms)&&(r.type===0?r.value.isEqual(e.value):r.type!==1||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask))}class $c extends Kg{constructor(e,t,n,s=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class ds extends Kg{constructor(e,t,n,s,o=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=s,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function B1(r){const e=new Map;return r.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const n=r.data.field(t);e.set(t,n)}})),e}function VA(r,e,t){const n=new Map;be(r.length===t.length,32656,{Re:t.length,Ve:r.length});for(let s=0;s<t.length;s++){const o=r[s],c=o.transform,h=e.data.field(o.field);n.set(o.field,gL(c,h,t[s]))}return n}function MA(r,e,t){const n=new Map;for(const s of r){const o=s.transform,c=t.data.field(s.field);n.set(s.field,mL(o,c,e))}return n}class Hc extends Kg{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class K0 extends Kg{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W0{constructor(e,t,n,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const o=this.mutations[s];o.key.isEqual(e.key)&&_L(o,e,n[s])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Vh(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Vh(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=O1();return this.mutations.forEach((s=>{const o=e.get(s.key),c=o.overlayedDocument;let h=this.applyToLocalView(c,o.mutatedFields);h=t.has(s.key)?null:h;const d=U1(c,h);d!==null&&n.set(s.key,d),c.isValidDocument()||c.convertToNoDocument(Se.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Me())}isEqual(e){return this.batchId===e.batchId&&pc(this.mutations,e.mutations,((t,n)=>DA(t,n)))&&pc(this.baseMutations,e.baseMutations,((t,n)=>DA(t,n)))}}class Q0{constructor(e,t,n,s){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=s}static from(e,t,n){be(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let s=(function(){return hL})();const o=e.mutations;for(let c=0;c<o.length;c++)s=s.insert(o[c].key,n[c].version);return new Q0(e,t,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y0{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wL{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Qt,Ke;function F1(r){switch(r){case Q.OK:return _e(64938);case Q.CANCELLED:case Q.UNKNOWN:case Q.DEADLINE_EXCEEDED:case Q.RESOURCE_EXHAUSTED:case Q.INTERNAL:case Q.UNAVAILABLE:case Q.UNAUTHENTICATED:return!1;case Q.INVALID_ARGUMENT:case Q.NOT_FOUND:case Q.ALREADY_EXISTS:case Q.PERMISSION_DENIED:case Q.FAILED_PRECONDITION:case Q.ABORTED:case Q.OUT_OF_RANGE:case Q.UNIMPLEMENTED:case Q.DATA_LOSS:return!0;default:return _e(15467,{code:r})}}function z1(r){if(r===void 0)return jt("GRPC error has no .code"),Q.UNKNOWN;switch(r){case Qt.OK:return Q.OK;case Qt.CANCELLED:return Q.CANCELLED;case Qt.UNKNOWN:return Q.UNKNOWN;case Qt.DEADLINE_EXCEEDED:return Q.DEADLINE_EXCEEDED;case Qt.RESOURCE_EXHAUSTED:return Q.RESOURCE_EXHAUSTED;case Qt.INTERNAL:return Q.INTERNAL;case Qt.UNAVAILABLE:return Q.UNAVAILABLE;case Qt.UNAUTHENTICATED:return Q.UNAUTHENTICATED;case Qt.INVALID_ARGUMENT:return Q.INVALID_ARGUMENT;case Qt.NOT_FOUND:return Q.NOT_FOUND;case Qt.ALREADY_EXISTS:return Q.ALREADY_EXISTS;case Qt.PERMISSION_DENIED:return Q.PERMISSION_DENIED;case Qt.FAILED_PRECONDITION:return Q.FAILED_PRECONDITION;case Qt.ABORTED:return Q.ABORTED;case Qt.OUT_OF_RANGE:return Q.OUT_OF_RANGE;case Qt.UNIMPLEMENTED:return Q.UNIMPLEMENTED;case Qt.DATA_LOSS:return Q.DATA_LOSS;default:return _e(39323,{code:r})}}(Ke=Qt||(Qt={}))[Ke.OK=0]="OK",Ke[Ke.CANCELLED=1]="CANCELLED",Ke[Ke.UNKNOWN=2]="UNKNOWN",Ke[Ke.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ke[Ke.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ke[Ke.NOT_FOUND=5]="NOT_FOUND",Ke[Ke.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ke[Ke.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ke[Ke.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ke[Ke.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ke[Ke.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ke[Ke.ABORTED=10]="ABORTED",Ke[Ke.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ke[Ke.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ke[Ke.INTERNAL=13]="INTERNAL",Ke[Ke.UNAVAILABLE=14]="UNAVAILABLE",Ke[Ke.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q1(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bL=new aa([4294967295,4294967295],0);function jA(r){const e=q1().encode(r),t=new VR;return t.update(e),new Uint8Array(t.digest())}function LA(r){const e=new DataView(r.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),s=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new aa([t,n],0),new aa([s,o],0)]}class J0{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new vh(`Invalid padding: ${t}`);if(n<0)throw new vh(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new vh(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new vh(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=aa.fromNumber(this.ge)}ye(e,t,n){let s=e.add(t.multiply(aa.fromNumber(n)));return s.compare(bL)===1&&(s=new aa([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=jA(e),[n,s]=LA(t);for(let o=0;o<this.hashCount;o++){const c=this.ye(n,s,o);if(!this.we(c))return!1}return!0}static create(e,t,n){const s=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),c=new J0(o,s,t);return n.forEach((h=>c.insert(h))),c}insert(e){if(this.ge===0)return;const t=jA(e),[n,s]=LA(t);for(let o=0;o<this.hashCount;o++){const c=this.ye(n,s,o);this.Se(c)}}Se(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class vh extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xd{constructor(e,t,n,s,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const s=new Map;return s.set(e,Rd.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new xd(Se.min(),s,new mt(Oe),Qn(),Me())}}class Rd{constructor(e,t,n,s,o){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Rd(n,t,Me(),Me(),Me())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $m{constructor(e,t,n,s){this.be=e,this.removedTargetIds=t,this.key=n,this.De=s}}class $1{constructor(e,t){this.targetId=e,this.Ce=t}}class H1{constructor(e,t,n=kt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=s}}class UA{constructor(){this.ve=0,this.Fe=BA(),this.Me=kt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Me(),t=Me(),n=Me();return this.Fe.forEach(((s,o)=>{switch(o){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:n=n.add(s);break;default:_e(38017,{changeType:o})}})),new Rd(this.Me,this.xe,e,t,n)}qe(){this.Oe=!1,this.Fe=BA()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,be(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class EL{constructor(e){this.Ge=e,this.ze=new Map,this.je=Qn(),this.Je=pm(),this.He=pm(),this.Ye=new mt(Oe)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:_e(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((n,s)=>{this.rt(s)&&t(s)}))}st(e){const t=e.targetId,n=e.Ce.count,s=this.ot(t);if(s){const o=s.target;if(ag(o))if(n===0){const c=new ge(o.path);this.et(t,c,yt.newNoDocument(c,Se.min()))}else be(n===1,20013,{expectedCount:n});else{const c=this._t(t);if(c!==n){const h=this.ut(e),d=h?this.ct(h,e,c):1;if(d!==0){this.it(t);const m=d===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,m)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:o=0}=t;let c,h;try{c=os(n).toUint8Array()}catch(d){if(d instanceof u1)return Pi("Decoding the base64 bloom filter in existence filter failed ("+d.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw d}try{h=new J0(c,s,o)}catch(d){return Pi(d instanceof vh?"BloomFilter error: ":"Applying bloom filter failed: ",d),null}return h.ge===0?null:h}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let s=0;return n.forEach((o=>{const c=this.Ge.ht(),h=`projects/${c.projectId}/databases/${c.database}/documents/${o.path.canonicalString()}`;e.mightContain(h)||(this.et(t,o,null),s++)})),s}Tt(e){const t=new Map;this.ze.forEach(((o,c)=>{const h=this.ot(c);if(h){if(o.current&&ag(h.target)){const d=new ge(h.target.path);this.It(d).has(c)||this.Et(c,d)||this.et(c,d,yt.newNoDocument(d,e))}o.Be&&(t.set(c,o.ke()),o.qe())}}));let n=Me();this.He.forEach(((o,c)=>{let h=!0;c.forEachWhile((d=>{const m=this.ot(d);return!m||m.purpose==="TargetPurposeLimboResolution"||(h=!1,!1)})),h&&(n=n.add(o))})),this.je.forEach(((o,c)=>c.setReadTime(e)));const s=new xd(e,t,this.Ye,this.je,n);return this.je=Qn(),this.Je=pm(),this.He=pm(),this.Ye=new mt(Oe),s}Xe(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,n),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,t)?s.Qe(t,1):s.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new UA,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new at(Oe),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new at(Oe),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||ae("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new UA),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function pm(){return new mt(ge.comparator)}function BA(){return new mt(ge.comparator)}const TL={asc:"ASCENDING",desc:"DESCENDING"},SL={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},AL={and:"AND",or:"OR"};class IL{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function bv(r,e){return r.useProto3Json||bd(e)?e:{value:e}}function xc(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function G1(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function xL(r,e){return xc(r,e.toTimestamp())}function Lt(r){return be(!!r,49232),Se.fromTimestamp((function(t){const n=as(t);return new tt(n.seconds,n.nanos)})(r))}function X0(r,e){return Ev(r,e).canonicalString()}function Ev(r,e){const t=(function(s){return new ze(["projects",s.projectId,"databases",s.database])})(r).child("documents");return e===void 0?t:t.child(e)}function K1(r){const e=ze.fromString(r);return be(rC(e),10190,{key:e.toString()}),e}function rd(r,e){return X0(r.databaseId,e.path)}function Ci(r,e){const t=K1(e);if(t.get(1)!==r.databaseId.projectId)throw new ie(Q.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+r.databaseId.projectId);if(t.get(3)!==r.databaseId.database)throw new ie(Q.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+r.databaseId.database);return new ge(Y1(t))}function W1(r,e){return X0(r.databaseId,e)}function Q1(r){const e=K1(r);return e.length===4?ze.emptyPath():Y1(e)}function Tv(r){return new ze(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function Y1(r){return be(r.length>4&&r.get(4)==="documents",29091,{key:r.toString()}),r.popFirst(5)}function FA(r,e,t){return{name:rd(r,e),fields:t.value.mapValue.fields}}function J1(r,e,t){const n=Ci(r,e.name),s=Lt(e.updateTime),o=e.createTime?Lt(e.createTime):Se.min(),c=new vn({mapValue:{fields:e.fields}}),h=yt.newFoundDocument(n,s,o,c);return t&&h.setHasCommittedMutations(),t?h.setHasCommittedMutations():h}function RL(r,e){return"found"in e?(function(n,s){be(!!s.found,43571),s.found.name,s.found.updateTime;const o=Ci(n,s.found.name),c=Lt(s.found.updateTime),h=s.found.createTime?Lt(s.found.createTime):Se.min(),d=new vn({mapValue:{fields:s.found.fields}});return yt.newFoundDocument(o,c,h,d)})(r,e):"missing"in e?(function(n,s){be(!!s.missing,3894),be(!!s.readTime,22933);const o=Ci(n,s.missing),c=Lt(s.readTime);return yt.newNoDocument(o,c)})(r,e):_e(7234,{result:e})}function CL(r,e){let t;if("targetChange"in e){e.targetChange;const n=(function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:_e(39313,{state:m})})(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],o=(function(m,y){return m.useProto3Json?(be(y===void 0||typeof y=="string",58123),kt.fromBase64String(y||"")):(be(y===void 0||y instanceof Buffer||y instanceof Uint8Array,16193),kt.fromUint8Array(y||new Uint8Array))})(r,e.targetChange.resumeToken),c=e.targetChange.cause,h=c&&(function(m){const y=m.code===void 0?Q.UNKNOWN:z1(m.code);return new ie(y,m.message||"")})(c);t=new H1(n,s,o,h||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const s=Ci(r,n.document.name),o=Lt(n.document.updateTime),c=n.document.createTime?Lt(n.document.createTime):Se.min(),h=new vn({mapValue:{fields:n.document.fields}}),d=yt.newFoundDocument(s,o,c,h),m=n.targetIds||[],y=n.removedTargetIds||[];t=new $m(m,y,d.key,d)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const s=Ci(r,n.document),o=n.readTime?Lt(n.readTime):Se.min(),c=yt.newNoDocument(s,o),h=n.removedTargetIds||[];t=new $m([],h,c.key,c)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const s=Ci(r,n.document),o=n.removedTargetIds||[];t=new $m([],o,s,null)}else{if(!("filter"in e))return _e(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:s=0,unchangedNames:o}=n,c=new wL(s,o),h=n.targetId;t=new $1(h,c)}}return t}function id(r,e){let t;if(e instanceof $c)t={update:FA(r,e.key,e.value)};else if(e instanceof Hc)t={delete:rd(r,e.key)};else if(e instanceof ds)t={update:FA(r,e.key,e.data),updateMask:VL(e.fieldMask)};else{if(!(e instanceof K0))return _e(16599,{Vt:e.type});t={verify:rd(r,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((n=>(function(o,c){const h=c.transform;if(h instanceof Ac)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(h instanceof Do)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:h.elements}};if(h instanceof Vo)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:h.elements}};if(h instanceof Ic)return{fieldPath:c.field.canonicalString(),increment:h.Ae};throw _e(20930,{transform:c.transform})})(0,n)))),e.precondition.isNone||(t.currentDocument=(function(s,o){return o.updateTime!==void 0?{updateTime:xL(s,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:_e(27497)})(r,e.precondition)),t}function Sv(r,e){const t=e.currentDocument?(function(o){return o.updateTime!==void 0?St.updateTime(Lt(o.updateTime)):o.exists!==void 0?St.exists(o.exists):St.none()})(e.currentDocument):St.none(),n=e.updateTransforms?e.updateTransforms.map((s=>(function(c,h){let d=null;if("setToServerValue"in h)be(h.setToServerValue==="REQUEST_TIME",16630,{proto:h}),d=new Ac;else if("appendMissingElements"in h){const y=h.appendMissingElements.values||[];d=new Do(y)}else if("removeAllFromArray"in h){const y=h.removeAllFromArray.values||[];d=new Vo(y)}else"increment"in h?d=new Ic(c,h.increment):_e(16584,{proto:h});const m=Tt.fromServerFormat(h.fieldPath);return new Id(m,d)})(r,s))):[];if(e.update){e.update.name;const s=Ci(r,e.update.name),o=new vn({mapValue:{fields:e.update.fields}});if(e.updateMask){const c=(function(d){const m=d.fieldPaths||[];return new Wn(m.map((y=>Tt.fromServerFormat(y))))})(e.updateMask);return new ds(s,o,c,t,n)}return new $c(s,o,t,n)}if(e.delete){const s=Ci(r,e.delete);return new Hc(s,t)}if(e.verify){const s=Ci(r,e.verify);return new K0(s,t)}return _e(1463,{proto:e})}function kL(r,e){return r&&r.length>0?(be(e!==void 0,14353),r.map((t=>(function(s,o){let c=s.updateTime?Lt(s.updateTime):Lt(o);return c.isEqual(Se.min())&&(c=Lt(o)),new yL(c,s.transformResults||[])})(t,e)))):[]}function X1(r,e){return{documents:[W1(r,e.path)]}}function Z1(r,e){const t={structuredQuery:{}},n=e.path;let s;e.collectionGroup!==null?(s=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=W1(r,s);const o=(function(m){if(m.length!==0)return nC(st.create(m,"and"))})(e.filters);o&&(t.structuredQuery.where=o);const c=(function(m){if(m.length!==0)return m.map((y=>(function(E){return{field:Zl(E.field),direction:OL(E.dir)}})(y)))})(e.orderBy);c&&(t.structuredQuery.orderBy=c);const h=bv(r,e.limit);return h!==null&&(t.structuredQuery.limit=h),e.startAt&&(t.structuredQuery.startAt=(function(m){return{before:m.inclusive,values:m.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(m){return{before:!m.inclusive,values:m.position}})(e.endAt)),{ft:t,parent:s}}function eC(r){let e=Q1(r.parent);const t=r.structuredQuery,n=t.from?t.from.length:0;let s=null;if(n>0){be(n===1,65062);const y=t.from[0];y.allDescendants?s=y.collectionId:e=e.child(y.collectionId)}let o=[];t.where&&(o=(function(_){const E=tC(_);return E instanceof st&&q0(E)?E.getFilters():[E]})(t.where));let c=[];t.orderBy&&(c=(function(_){return _.map((E=>(function(C){return new nd(ec(C.field),(function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(C.direction))})(E)))})(t.orderBy));let h=null;t.limit&&(h=(function(_){let E;return E=typeof _=="object"?_.value:_,bd(E)?null:E})(t.limit));let d=null;t.startAt&&(d=(function(_){const E=!!_.before,S=_.values||[];return new ya(S,E)})(t.startAt));let m=null;return t.endAt&&(m=(function(_){const E=!_.before,S=_.values||[];return new ya(S,E)})(t.endAt)),I1(e,s,c,o,h,"F",d,m)}function NL(r,e){const t=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return _e(28987,{purpose:s})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function tC(r){return r.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=ec(t.unaryFilter.field);return He.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=ec(t.unaryFilter.field);return He.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=ec(t.unaryFilter.field);return He.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=ec(t.unaryFilter.field);return He.create(c,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return _e(61313);default:return _e(60726)}})(r):r.fieldFilter!==void 0?(function(t){return He.create(ec(t.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return _e(58110);default:return _e(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(r):r.compositeFilter!==void 0?(function(t){return st.create(t.compositeFilter.filters.map((n=>tC(n))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return _e(1026)}})(t.compositeFilter.op))})(r):_e(30097,{filter:r})}function OL(r){return TL[r]}function PL(r){return SL[r]}function DL(r){return AL[r]}function Zl(r){return{fieldPath:r.canonicalString()}}function ec(r){return Tt.fromServerFormat(r.fieldPath)}function nC(r){return r instanceof He?(function(t){if(t.op==="=="){if(AA(t.value))return{unaryFilter:{field:Zl(t.field),op:"IS_NAN"}};if(SA(t.value))return{unaryFilter:{field:Zl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(AA(t.value))return{unaryFilter:{field:Zl(t.field),op:"IS_NOT_NAN"}};if(SA(t.value))return{unaryFilter:{field:Zl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Zl(t.field),op:PL(t.op),value:t.value}}})(r):r instanceof st?(function(t){const n=t.getFilters().map((s=>nC(s)));return n.length===1?n[0]:{compositeFilter:{op:DL(t.op),filters:n}}})(r):_e(54877,{filter:r})}function VL(r){const e=[];return r.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function rC(r){return r.length>=4&&r.get(0)==="projects"&&r.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ns{constructor(e,t,n,s,o=Se.min(),c=Se.min(),h=kt.EMPTY_BYTE_STRING,d=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=h,this.expectedCount=d}withSequenceNumber(e){return new ns(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ns(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ns(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ns(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iC{constructor(e){this.yt=e}}function ML(r,e){let t;if(e.document)t=J1(r.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const n=ge.fromSegments(e.noDocument.path),s=jo(e.noDocument.readTime);t=yt.newNoDocument(n,s),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return _e(56709);{const n=ge.fromSegments(e.unknownDocument.path),s=jo(e.unknownDocument.version);t=yt.newUnknownDocument(n,s)}}return e.readTime&&t.setReadTime((function(s){const o=new tt(s[0],s[1]);return Se.fromTimestamp(o)})(e.readTime)),t}function zA(r,e){const t=e.key,n={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:cg(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document=(function(o,c){return{name:rd(o,c.key),fields:c.data.value.mapValue.fields,updateTime:xc(o,c.version.toTimestamp()),createTime:xc(o,c.createTime.toTimestamp())}})(r.yt,e);else if(e.isNoDocument())n.noDocument={path:t.path.toArray(),readTime:Mo(e.version)};else{if(!e.isUnknownDocument())return _e(57904,{document:e});n.unknownDocument={path:t.path.toArray(),version:Mo(e.version)}}return n}function cg(r){const e=r.toTimestamp();return[e.seconds,e.nanoseconds]}function Mo(r){const e=r.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function jo(r){const e=new tt(r.seconds,r.nanoseconds);return Se.fromTimestamp(e)}function go(r,e){const t=(e.baseMutations||[]).map((o=>Sv(r.yt,o)));for(let o=0;o<e.mutations.length-1;++o){const c=e.mutations[o];if(o+1<e.mutations.length&&e.mutations[o+1].transform!==void 0){const h=e.mutations[o+1];c.updateTransforms=h.transform.fieldTransforms,e.mutations.splice(o+1,1),++o}}const n=e.mutations.map((o=>Sv(r.yt,o))),s=tt.fromMillis(e.localWriteTimeMs);return new W0(e.batchId,s,t,n)}function wh(r){const e=jo(r.readTime),t=r.lastLimboFreeSnapshotVersion!==void 0?jo(r.lastLimboFreeSnapshotVersion):Se.min();let n;return n=(function(o){return o.documents!==void 0})(r.query)?(function(o){const c=o.documents.length;return be(c===1,1966,{count:c}),Mn(qc(Q1(o.documents[0])))})(r.query):(function(o){return Mn(eC(o))})(r.query),new ns(n,r.targetId,"TargetPurposeListen",r.lastListenSequenceNumber,e,t,kt.fromBase64String(r.resumeToken))}function sC(r,e){const t=Mo(e.snapshotVersion),n=Mo(e.lastLimboFreeSnapshotVersion);let s;s=ag(e.target)?X1(r.yt,e.target):Z1(r.yt,e.target).ft;const o=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Po(e.target),readTime:t,resumeToken:o,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:s}}function Z0(r){const e=eC({parent:r.parent,structuredQuery:r.structuredQuery});return r.limitType==="LAST"?lg(e,e.limit,"L"):e}function k_(r,e){return new Y0(e.largestBatchId,Sv(r.yt,e.overlayMutation))}function qA(r,e){const t=e.path.lastSegment();return[r,xn(e.path.popLast()),t]}function $A(r,e,t,n){return{indexId:r,uid:e,sequenceNumber:t,readTime:Mo(n.readTime),documentKey:xn(n.documentKey.path),largestBatchId:n.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jL{getBundleMetadata(e,t){return HA(e).get(t).next((n=>{if(n)return(function(o){return{id:o.bundleId,createTime:jo(o.createTime),version:o.version}})(n)}))}saveBundleMetadata(e,t){return HA(e).put((function(s){return{bundleId:s.id,createTime:Mo(Lt(s.createTime)),version:s.version}})(t))}getNamedQuery(e,t){return GA(e).get(t).next((n=>{if(n)return(function(o){return{name:o.name,query:Z0(o.bundledQuery),readTime:jo(o.readTime)}})(n)}))}saveNamedQuery(e,t){return GA(e).put((function(s){return{name:s.name,readTime:Mo(Lt(s.readTime)),bundledQuery:s.bundledQuery}})(t))}}function HA(r){return sn(r,Bg)}function GA(r){return sn(r,Fg)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wg{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const n=t.uid||"";return new Wg(e,n)}getOverlay(e,t){return ch(e).get(qA(this.userId,t)).next((n=>n?k_(this.serializer,n):null))}getOverlays(e,t){const n=xi();return F.forEach(t,(s=>this.getOverlay(e,s).next((o=>{o!==null&&n.set(s,o)})))).next((()=>n))}saveOverlays(e,t,n){const s=[];return n.forEach(((o,c)=>{const h=new Y0(t,c);s.push(this.St(e,h))})),F.waitFor(s)}removeOverlaysForBatchId(e,t,n){const s=new Set;t.forEach((c=>s.add(xn(c.getCollectionPath()))));const o=[];return s.forEach((c=>{const h=IDBKeyRange.bound([this.userId,c,n],[this.userId,c,n+1],!1,!0);o.push(ch(e).Z(dv,h))})),F.waitFor(o)}getOverlaysForCollection(e,t,n){const s=xi(),o=xn(t),c=IDBKeyRange.bound([this.userId,o,n],[this.userId,o,Number.POSITIVE_INFINITY],!0);return ch(e).J(dv,c).next((h=>{for(const d of h){const m=k_(this.serializer,d);s.set(m.getKey(),m)}return s}))}getOverlaysForCollectionGroup(e,t,n,s){const o=xi();let c;const h=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return ch(e).ee({index:i1,range:h},((d,m,y)=>{const _=k_(this.serializer,m);o.size()<s||_.largestBatchId===c?(o.set(_.getKey(),_),c=_.largestBatchId):y.done()})).next((()=>o))}St(e,t){return ch(e).put((function(s,o,c){const[h,d,m]=qA(o,c.mutation.key);return{userId:o,collectionPath:d,documentId:m,collectionGroup:c.mutation.key.getCollectionGroup(),largestBatchId:c.largestBatchId,overlayMutation:id(s.yt,c.mutation)}})(this.serializer,this.userId,t))}}function ch(r){return sn(r,zg)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LL{bt(e){return sn(e,U0)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const n=t==null?void 0:t.value;return n?kt.fromUint8Array(n):kt.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class po{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(bt(e.integerValue));else if("doubleValue"in e){const n=bt(e.doubleValue);isNaN(n)?this.Ft(t,13):(this.Ft(t,15),Qh(n)?t.Mt(0):t.Mt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Ft(t,20),typeof n=="string"&&(n=as(n)),t.xt(`${n.seconds||""}`),t.Mt(n.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(os(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Ft(t,45),t.Mt(n.latitude||0),t.Mt(n.longitude||0)}else"mapValue"in e?p1(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):Hg(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):_e(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const n=e.fields||{};this.Ft(t,55);for(const s of Object.keys(n))this.Ot(s,t),this.Ct(n[s],t)}kt(e,t){var c,h;const n=e.fields||{};this.Ft(t,53);const s=Ec,o=((h=(c=n[s].arrayValue)==null?void 0:c.values)==null?void 0:h.length)||0;this.Ft(t,15),t.Mt(bt(o)),this.Ot(s,t),this.Ct(n[s],t)}Qt(e,t){const n=e.values||[];this.Ft(t,50);for(const s of n)this.Ct(s,t)}Lt(e,t){this.Ft(t,37),ge.fromName(e).path.forEach((n=>{this.Ft(t,60),this.Ut(n,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}po.Kt=new po;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fl=255;function UL(r){if(r===0)return 8;let e=0;return r>>4||(e+=4,r<<=4),r>>6||(e+=2,r<<=2),r>>7||(e+=1),e}function KA(r){const e=64-(function(n){let s=0;for(let o=0;o<8;++o){const c=UL(255&n[o]);if(s+=c,c!==8)break}return s})(r);return Math.ceil(e/8)}class BL{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Gt(n.value),n=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Jt(n.value),n=t.next();this.Ht()}Yt(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.Gt(n);else if(n<2048)this.Gt(960|n>>>6),this.Gt(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|n>>>12),this.Gt(128|63&n>>>6),this.Gt(128|63&n);else{const s=t.codePointAt(0);this.Gt(240|s>>>18),this.Gt(128|63&s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s)}}this.zt()}Zt(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.Jt(n);else if(n<2048)this.Jt(960|n>>>6),this.Jt(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|n>>>12),this.Jt(128|63&n>>>6),this.Jt(128|63&n);else{const s=t.codePointAt(0);this.Jt(240|s>>>18),this.Jt(128|63&s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s)}}this.Ht()}Xt(e){const t=this.en(e),n=KA(t);this.tn(1+n),this.buffer[this.position++]=255&n;for(let s=t.length-n;s<t.length;++s)this.buffer[this.position++]=255&t[s]}nn(e){const t=this.en(e),n=KA(t);this.tn(1+n),this.buffer[this.position++]=~(255&n);for(let s=t.length-n;s<t.length;++s)this.buffer[this.position++]=~(255&t[s])}rn(){this.sn(Fl),this.sn(255)}_n(){this.an(Fl),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(o){const c=new DataView(new ArrayBuffer(8));return c.setFloat64(0,o,!1),new Uint8Array(c.buffer)})(e),n=!!(128&t[0]);t[0]^=n?255:128;for(let s=1;s<t.length;++s)t[s]^=n?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Fl?(this.sn(Fl),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Fl?(this.an(Fl),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const s=new Uint8Array(n);s.set(this.buffer),this.buffer=s}}class FL{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class zL{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class uh{constructor(){this.cn=new BL,this.ln=new FL(this.cn),this.hn=new zL(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yo{constructor(e,t,n,s){this.Tn=e,this.In=t,this.En=n,this.dn=s}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,n=new Uint8Array(t);return n.set(this.dn,0),t!==e?n.set([0],this.dn.length):++n[n.length-1],new yo(this.Tn,this.In,this.En,n)}Rn(e,t,n){return{indexId:this.Tn,uid:e,arrayValue:Hm(this.En),directionalValue:Hm(this.dn),orderedDocumentKey:Hm(t),documentKey:n.path.toArray()}}Vn(e,t,n){const s=this.Rn(e,t,n);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function Ws(r,e){let t=r.Tn-e.Tn;return t!==0?t:(t=WA(r.En,e.En),t!==0?t:(t=WA(r.dn,e.dn),t!==0?t:ge.comparator(r.In,e.In)))}function WA(r,e){for(let t=0;t<r.length&&t<e.length;++t){const n=r[t]-e[t];if(n!==0)return n}return r.length-e.length}function Hm(r){return Ex()?(function(t){let n="";for(let s=0;s<t.length;s++)n+=String.fromCharCode(t[s]);return n})(r):r}function QA(r){return typeof r!="string"?r:(function(t){const n=new Uint8Array(t.length);for(let s=0;s<t.length;s++)n[s]=t.charCodeAt(s);return n})(r)}class YA{constructor(e){this.mn=new at(((t,n)=>Tt.comparator(t.field,n.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const n=t;n.isInequality()?this.mn=this.mn.add(n):this.gn.push(n)}}get pn(){return this.mn.size>1}yn(e){if(be(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=cv(e);if(t!==void 0&&!this.wn(t))return!1;const n=uo(e);let s=new Set,o=0,c=0;for(;o<n.length&&this.wn(n[o]);++o)s=s.add(n[o].fieldPath.canonicalString());if(o===n.length)return!0;if(this.mn.size>0){const h=this.mn.getIterator().getNext();if(!s.has(h.field.canonicalString())){const d=n[o];if(!this.Sn(h,d)||!this.bn(this.fn[c++],d))return!1}++o}for(;o<n.length;++o){const h=n[o];if(c>=this.fn.length||!this.bn(this.fn[c++],h))return!1}return!0}Dn(){if(this.pn)return null;let e=new at(Tt.comparator);const t=[];for(const n of this.gn)if(!n.field.isKeyField())if(n.op==="array-contains"||n.op==="array-contains-any")t.push(new jm(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new jm(n.field,0))}for(const n of this.fn)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new jm(n.field,n.dir==="asc"?0:1)));return new ng(ng.UNKNOWN_ID,this.collectionId,t,Wh.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const n=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===n}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aC(r){var t,n;if(be(r instanceof He||r instanceof st,20012),r instanceof He){if(r instanceof A1){const s=((n=(t=r.value.arrayValue)==null?void 0:t.values)==null?void 0:n.map((o=>He.create(r.field,"==",o))))||[];return st.create(s,"or")}return r}const e=r.filters.map((s=>aC(s)));return st.create(e,r.op)}function qL(r){if(r.getFilters().length===0)return[];const e=xv(aC(r));return be(oC(e),7391),Av(e)||Iv(e)?[e]:e.getFilters()}function Av(r){return r instanceof He}function Iv(r){return r instanceof st&&q0(r)}function oC(r){return Av(r)||Iv(r)||(function(t){if(t instanceof st&&yv(t)){for(const n of t.getFilters())if(!Av(n)&&!Iv(n))return!1;return!0}return!1})(r)}function xv(r){if(be(r instanceof He||r instanceof st,34018),r instanceof He)return r;if(r.filters.length===1)return xv(r.filters[0]);const e=r.filters.map((n=>xv(n)));let t=st.create(e,r.op);return t=ug(t),oC(t)?t:(be(t instanceof st,64498),be(Sc(t),40251),be(t.filters.length>1,57927),t.filters.reduce(((n,s)=>ew(n,s))))}function ew(r,e){let t;return be(r instanceof He||r instanceof st,38388),be(e instanceof He||e instanceof st,25473),t=r instanceof He?e instanceof He?(function(s,o){return st.create([s,o],"and")})(r,e):JA(r,e):e instanceof He?JA(e,r):(function(s,o){if(be(s.filters.length>0&&o.filters.length>0,48005),Sc(s)&&Sc(o))return E1(s,o.getFilters());const c=yv(s)?s:o,h=yv(s)?o:s,d=c.filters.map((m=>ew(m,h)));return st.create(d,"or")})(r,e),ug(t)}function JA(r,e){if(Sc(e))return E1(e,r.getFilters());{const t=e.filters.map((n=>ew(r,n)));return st.create(t,"or")}}function ug(r){if(be(r instanceof He||r instanceof st,11850),r instanceof He)return r;const e=r.getFilters();if(e.length===1)return ug(e[0]);if(w1(r))return r;const t=e.map((s=>ug(s))),n=[];return t.forEach((s=>{s instanceof He?n.push(s):s instanceof st&&(s.op===r.op?n.push(...s.filters):n.push(s))})),n.length===1?n[0]:st.create(n,r.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $L{constructor(){this.Cn=new tw}addToCollectionParentIndex(e,t){return this.Cn.add(t),F.resolve()}getCollectionParents(e,t){return F.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return F.resolve()}deleteFieldIndex(e,t){return F.resolve()}deleteAllFieldIndexes(e){return F.resolve()}createTargetIndexes(e,t){return F.resolve()}getDocumentsMatchingTarget(e,t){return F.resolve(null)}getIndexType(e,t){return F.resolve(0)}getFieldIndexes(e,t){return F.resolve([])}getNextCollectionGroupToUpdate(e){return F.resolve(null)}getMinOffset(e,t){return F.resolve(hr.min())}getMinOffsetFromCollectionGroup(e,t){return F.resolve(hr.min())}updateCollectionGroup(e,t,n){return F.resolve()}updateIndexEntries(e,t){return F.resolve()}}class tw{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),s=this.index[t]||new at(ze.comparator),o=!s.has(n);return this.index[t]=s.add(n),o}has(e){const t=e.lastSegment(),n=e.popLast(),s=this.index[t];return s&&s.has(n)}getEntries(e){return(this.index[e]||new at(ze.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XA="IndexedDbIndexManager",ym=new Uint8Array(0);class HL{constructor(e,t){this.databaseId=t,this.vn=new tw,this.Fn=new hs((n=>Po(n)),((n,s)=>Td(n,s))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const n=t.lastSegment(),s=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const o={collectionId:n,parent:xn(s)};return ZA(e).put(o)}return F.resolve()}getCollectionParents(e,t){const n=[],s=IDBKeyRange.bound([t,""],[qR(t),""],!1,!0);return ZA(e).J(s).next((o=>{for(const c of o){if(c.collectionId!==t)break;n.push(Ii(c.parent))}return n}))}addFieldIndex(e,t){const n=hh(e),s=(function(h){return{indexId:h.indexId,collectionGroup:h.collectionGroup,fields:h.fields.map((d=>[d.fieldPath.canonicalString(),d.kind]))}})(t);delete s.indexId;const o=n.add(s);if(t.indexState){const c=ql(e);return o.next((h=>{c.put($A(h,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return o.next()}deleteFieldIndex(e,t){const n=hh(e),s=ql(e),o=zl(e);return n.delete(t.indexId).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>o.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=hh(e),n=zl(e),s=ql(e);return t.Z().next((()=>n.Z())).next((()=>s.Z()))}createTargetIndexes(e,t){return F.forEach(this.Mn(t),(n=>this.getIndexType(e,n).next((s=>{if(s===0||s===1){const o=new YA(n).Dn();if(o!=null)return this.addFieldIndex(e,o)}}))))}getDocumentsMatchingTarget(e,t){const n=zl(e);let s=!0;const o=new Map;return F.forEach(this.Mn(t),(c=>this.xn(e,c).next((h=>{s&&(s=!!h),o.set(c,h)})))).next((()=>{if(s){let c=Me();const h=[];return F.forEach(o,((d,m)=>{ae(XA,`Using index ${(function(K){return`id=${K.indexId}|cg=${K.collectionGroup}|f=${K.fields.map((se=>`${se.fieldPath}:${se.kind}`)).join(",")}`})(d)} to execute ${Po(t)}`);const y=(function(K,se){const ye=cv(se);if(ye===void 0)return null;for(const he of og(K,ye.fieldPath))switch(he.op){case"array-contains-any":return he.value.arrayValue.values||[];case"array-contains":return[he.value]}return null})(m,d),_=(function(K,se){const ye=new Map;for(const he of uo(se))for(const R of og(K,he.fieldPath))switch(R.op){case"==":case"in":ye.set(he.fieldPath.canonicalString(),R.value);break;case"not-in":case"!=":return ye.set(he.fieldPath.canonicalString(),R.value),Array.from(ye.values())}return null})(m,d),E=(function(K,se){const ye=[];let he=!0;for(const R of uo(se)){const x=R.kind===0?kA(K,R.fieldPath,K.startAt):NA(K,R.fieldPath,K.startAt);ye.push(x.value),he&&(he=x.inclusive)}return new ya(ye,he)})(m,d),S=(function(K,se){const ye=[];let he=!0;for(const R of uo(se)){const x=R.kind===0?NA(K,R.fieldPath,K.endAt):kA(K,R.fieldPath,K.endAt);ye.push(x.value),he&&(he=x.inclusive)}return new ya(ye,he)})(m,d),C=this.On(d,m,E),k=this.On(d,m,S),N=this.Nn(d,m,_),G=this.Bn(d.indexId,y,C,E.inclusive,k,S.inclusive,N);return F.forEach(G,(J=>n.Y(J,t.limit).next((K=>{K.forEach((se=>{const ye=ge.fromSegments(se.documentKey);c.has(ye)||(c=c.add(ye),h.push(ye))}))}))))})).next((()=>h))}return F.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=qL(st.create(e.filters,"and")).map((n=>vv(e.path,e.collectionGroup,e.orderBy,n.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,n,s,o,c,h){const d=(t!=null?t.length:1)*Math.max(n.length,o.length),m=d/(t!=null?t.length:1),y=[];for(let _=0;_<d;++_){const E=t?this.Ln(t[_/m]):ym,S=this.kn(e,E,n[_%m],s),C=this.qn(e,E,o[_%m],c),k=h.map((N=>this.kn(e,E,N,!0)));y.push(...this.createRange(S,C,k))}return y}kn(e,t,n,s){const o=new yo(e,ge.empty(),t,n);return s?o:o.An()}qn(e,t,n,s){const o=new yo(e,ge.empty(),t,n);return s?o.An():o}xn(e,t){const n=new YA(t),s=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,s).next((o=>{let c=null;for(const h of o)n.yn(h)&&(!c||h.fields.length>c.fields.length)&&(c=h);return c}))}getIndexType(e,t){let n=2;const s=this.Mn(t);return F.forEach(s,(o=>this.xn(e,o).next((c=>{c?n!==0&&c.fields.length<(function(d){let m=new at(Tt.comparator),y=!1;for(const _ of d.filters)for(const E of _.getFlattenedFilters())E.field.isKeyField()||(E.op==="array-contains"||E.op==="array-contains-any"?y=!0:m=m.add(E.field));for(const _ of d.orderBy)_.field.isKeyField()||(m=m.add(_.field));return m.size+(y?1:0)})(o)&&(n=1):n=0})))).next((()=>(function(c){return c.limit!==null})(t)&&s.length>1&&n===2?1:n))}Qn(e,t){const n=new uh;for(const s of uo(e)){const o=t.data.field(s.fieldPath);if(o==null)return null;const c=n.Pn(s.kind);po.Kt.Dt(o,c)}return n.un()}Ln(e){const t=new uh;return po.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const n=new uh;return po.Kt.Dt(Oo(this.databaseId,t),n.Pn((function(o){const c=uo(o);return c.length===0?0:c[c.length-1].kind})(e))),n.un()}Nn(e,t,n){if(n===null)return[];let s=[];s.push(new uh);let o=0;for(const c of uo(e)){const h=n[o++];for(const d of s)if(this.Un(t,c.fieldPath)&&td(h))s=this.Kn(s,c,h);else{const m=d.Pn(c.kind);po.Kt.Dt(h,m)}}return this.Wn(s)}On(e,t,n){return this.Nn(e,t,n.position)}Wn(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].un();return t}Kn(e,t,n){const s=[...e],o=[];for(const c of n.arrayValue.values||[])for(const h of s){const d=new uh;d.seed(h.un()),po.Kt.Dt(c,d.Pn(t.kind)),o.push(d)}return o}Un(e,t){return!!e.filters.find((n=>n instanceof He&&n.field.isEqual(t)&&(n.op==="in"||n.op==="not-in")))}getFieldIndexes(e,t){const n=hh(e),s=ql(e);return(t?n.J(hv,IDBKeyRange.bound(t,t)):n.J()).next((o=>{const c=[];return F.forEach(o,(h=>s.get([h.indexId,this.uid]).next((d=>{c.push((function(y,_){const E=_?new Wh(_.sequenceNumber,new hr(jo(_.readTime),new ge(Ii(_.documentKey)),_.largestBatchId)):Wh.empty(),S=y.fields.map((([C,k])=>new jm(Tt.fromServerFormat(C),k)));return new ng(y.indexId,y.collectionGroup,S,E)})(h,d))})))).next((()=>c))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((n,s)=>{const o=n.indexState.sequenceNumber-s.indexState.sequenceNumber;return o!==0?o:Oe(n.collectionGroup,s.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,n){const s=hh(e),o=ql(e);return this.Gn(e).next((c=>s.J(hv,IDBKeyRange.bound(t,t)).next((h=>F.forEach(h,(d=>o.put($A(d.indexId,this.uid,c,n))))))))}updateIndexEntries(e,t){const n=new Map;return F.forEach(t,((s,o)=>{const c=n.get(s.collectionGroup);return(c?F.resolve(c):this.getFieldIndexes(e,s.collectionGroup)).next((h=>(n.set(s.collectionGroup,h),F.forEach(h,(d=>this.zn(e,s,d).next((m=>{const y=this.jn(o,d);return m.isEqual(y)?F.resolve():this.Jn(e,o,d,m,y)})))))))}))}Hn(e,t,n,s){return zl(e).put(s.Rn(this.uid,this.$n(n,t.key),t.key))}Yn(e,t,n,s){return zl(e).delete(s.Vn(this.uid,this.$n(n,t.key),t.key))}zn(e,t,n){const s=zl(e);let o=new at(Ws);return s.ee({index:r1,range:IDBKeyRange.only([n.indexId,this.uid,Hm(this.$n(n,t))])},((c,h)=>{o=o.add(new yo(n.indexId,t,QA(h.arrayValue),QA(h.directionalValue)))})).next((()=>o))}jn(e,t){let n=new at(Ws);const s=this.Qn(t,e);if(s==null)return n;const o=cv(t);if(o!=null){const c=e.data.field(o.fieldPath);if(td(c))for(const h of c.arrayValue.values||[])n=n.add(new yo(t.indexId,e.key,this.Ln(h),s))}else n=n.add(new yo(t.indexId,e.key,ym,s));return n}Jn(e,t,n,s,o){ae(XA,"Updating index entries for document '%s'",t.key);const c=[];return(function(d,m,y,_,E){const S=d.getIterator(),C=m.getIterator();let k=Bl(S),N=Bl(C);for(;k||N;){let G=!1,J=!1;if(k&&N){const K=y(k,N);K<0?J=!0:K>0&&(G=!0)}else k!=null?J=!0:G=!0;G?(_(N),N=Bl(C)):J?(E(k),k=Bl(S)):(k=Bl(S),N=Bl(C))}})(s,o,Ws,(h=>{c.push(this.Hn(e,t,n,h))}),(h=>{c.push(this.Yn(e,t,n,h))})),F.waitFor(c)}Gn(e){let t=1;return ql(e).ee({index:n1,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((n,s,o)=>{o.done(),t=s.sequenceNumber+1})).next((()=>t))}createRange(e,t,n){n=n.sort(((c,h)=>Ws(c,h))).filter(((c,h,d)=>!h||Ws(c,d[h-1])!==0));const s=[];s.push(e);for(const c of n){const h=Ws(c,e),d=Ws(c,t);if(h===0)s[0]=e.An();else if(h>0&&d<0)s.push(c),s.push(c.An());else if(d>0)break}s.push(t);const o=[];for(let c=0;c<s.length;c+=2){if(this.Zn(s[c],s[c+1]))return[];const h=s[c].Vn(this.uid,ym,ge.empty()),d=s[c+1].Vn(this.uid,ym,ge.empty());o.push(IDBKeyRange.bound(h,d))}return o}Zn(e,t){return Ws(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(eI)}getMinOffset(e,t){return F.mapArray(this.Mn(t),(n=>this.xn(e,n).next((s=>s||_e(44426))))).next(eI)}}function ZA(r){return sn(r,Xh)}function zl(r){return sn(r,Oh)}function hh(r){return sn(r,L0)}function ql(r){return sn(r,Nh)}function eI(r){be(r.length!==0,28825);let e=r[0].indexState.offset,t=e.largestBatchId;for(let n=1;n<r.length;n++){const s=r[n].indexState.offset;V0(s,e)<0&&(e=s),t<s.largestBatchId&&(t=s.largestBatchId)}return new hr(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tI={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},lC=41943040;class An{static withCacheSize(e){return new An(e,An.DEFAULT_COLLECTION_PERCENTILE,An.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cC(r,e,t){const n=r.store($r),s=r.store(_c),o=[],c=IDBKeyRange.only(t.batchId);let h=0;const d=n.ee({range:c},((y,_,E)=>(h++,E.delete())));o.push(d.next((()=>{be(h===1,47070,{batchId:t.batchId})})));const m=[];for(const y of t.mutations){const _=ZR(e,y.key.path,t.batchId);o.push(s.delete(_)),m.push(y.key)}return F.waitFor(o).next((()=>m))}function hg(r){if(!r)return 0;let e;if(r.document)e=r.document;else if(r.unknownDocument)e=r.unknownDocument;else{if(!r.noDocument)throw _e(14731);e=r.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */An.DEFAULT_COLLECTION_PERCENTILE=10,An.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,An.DEFAULT=new An(lC,An.DEFAULT_COLLECTION_PERCENTILE,An.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),An.DISABLED=new An(-1,0,0);class Qg{constructor(e,t,n,s){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=s,this.Xn={}}static wt(e,t,n,s){be(e.uid!=="",64387);const o=e.isAuthenticated()?e.uid:"";return new Qg(o,t,n,s)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Qs(e).ee({index:Eo,range:n},((s,o,c)=>{t=!1,c.done()})).next((()=>t))}addMutationBatch(e,t,n,s){const o=tc(e),c=Qs(e);return c.add({}).next((h=>{be(typeof h=="number",49019);const d=new W0(h,t,n,s),m=(function(S,C,k){const N=k.baseMutations.map((J=>id(S.yt,J))),G=k.mutations.map((J=>id(S.yt,J)));return{userId:C,batchId:k.batchId,localWriteTimeMs:k.localWriteTime.toMillis(),baseMutations:N,mutations:G}})(this.serializer,this.userId,d),y=[];let _=new at(((E,S)=>Oe(E.canonicalString(),S.canonicalString())));for(const E of s){const S=ZR(this.userId,E.key.path,h);_=_.add(E.key.path.popLast()),y.push(c.put(m)),y.push(o.put(S,A4))}return _.forEach((E=>{y.push(this.indexManager.addToCollectionParentIndex(e,E))})),e.addOnCommittedListener((()=>{this.Xn[h]=d.keys()})),F.waitFor(y).next((()=>d))}))}lookupMutationBatch(e,t){return Qs(e).get(t).next((n=>n?(be(n.userId===this.userId,48,"Unexpected user for mutation batch",{userId:n.userId,batchId:t}),go(this.serializer,n)):null))}er(e,t){return this.Xn[t]?F.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((n=>{if(n){const s=n.keys();return this.Xn[t]=s,s}return null}))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,s=IDBKeyRange.lowerBound([this.userId,n]);let o=null;return Qs(e).ee({index:Eo,range:s},((c,h,d)=>{h.userId===this.userId&&(be(h.batchId>=n,47524,{tr:n}),o=go(this.serializer,h)),d.done()})).next((()=>o))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=oa;return Qs(e).ee({index:Eo,range:t,reverse:!0},((s,o,c)=>{n=o.batchId,c.done()})).next((()=>n))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,oa],[this.userId,Number.POSITIVE_INFINITY]);return Qs(e).J(Eo,t).next((n=>n.map((s=>go(this.serializer,s)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=Lm(this.userId,t.path),s=IDBKeyRange.lowerBound(n),o=[];return tc(e).ee({range:s},((c,h,d)=>{const[m,y,_]=c,E=Ii(y);if(m===this.userId&&t.path.isEqual(E))return Qs(e).get(_).next((S=>{if(!S)throw _e(61480,{nr:c,batchId:_});be(S.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:S.userId,batchId:_}),o.push(go(this.serializer,S))}));d.done()})).next((()=>o))}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new at(Oe);const s=[];return t.forEach((o=>{const c=Lm(this.userId,o.path),h=IDBKeyRange.lowerBound(c),d=tc(e).ee({range:h},((m,y,_)=>{const[E,S,C]=m,k=Ii(S);E===this.userId&&o.path.isEqual(k)?n=n.add(C):_.done()}));s.push(d)})),F.waitFor(s).next((()=>this.rr(e,n)))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,s=n.length+1,o=Lm(this.userId,n),c=IDBKeyRange.lowerBound(o);let h=new at(Oe);return tc(e).ee({range:c},((d,m,y)=>{const[_,E,S]=d,C=Ii(E);_===this.userId&&n.isPrefixOf(C)?C.length===s&&(h=h.add(S)):y.done()})).next((()=>this.rr(e,h)))}rr(e,t){const n=[],s=[];return t.forEach((o=>{s.push(Qs(e).get(o).next((c=>{if(c===null)throw _e(35274,{batchId:o});be(c.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:c.userId,batchId:o}),n.push(go(this.serializer,c))})))})),F.waitFor(s).next((()=>n))}removeMutationBatch(e,t){return cC(e.le,this.userId,t).next((n=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),F.forEach(n,(s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return F.resolve();const n=IDBKeyRange.lowerBound((function(c){return[c]})(this.userId)),s=[];return tc(e).ee({range:n},((o,c,h)=>{if(o[0]===this.userId){const d=Ii(o[1]);s.push(d)}else h.done()})).next((()=>{be(s.length===0,56720,{sr:s.map((o=>o.canonicalString()))})}))}))}containsKey(e,t){return uC(e,this.userId,t)}_r(e){return hC(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:oa,lastStreamToken:""}))}}function uC(r,e,t){const n=Lm(e,t.path),s=n[1],o=IDBKeyRange.lowerBound(n);let c=!1;return tc(r).ee({range:o,X:!0},((h,d,m)=>{const[y,_,E]=h;y===e&&_===s&&(c=!0),m.done()})).next((()=>c))}function Qs(r){return sn(r,$r)}function tc(r){return sn(r,_c)}function hC(r){return sn(r,Yh)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lo{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Lo(0)}static cr(){return new Lo(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GL{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const n=new Lo(t.highestTargetId);return t.highestTargetId=n.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Se.fromTimestamp(new tt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,n){return this.lr(e).next((s=>(s.highestListenSequenceNumber=t,n&&(s.lastRemoteSnapshotVersion=n.toTimestamp()),t>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=t),this.hr(e,s))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((n=>(n.targetCount+=1,this.Tr(t,n),this.hr(e,n))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>$l(e).delete(t.targetId))).next((()=>this.lr(e))).next((n=>(be(n.targetCount>0,8065),n.targetCount-=1,this.hr(e,n))))}removeTargets(e,t,n){let s=0;const o=[];return $l(e).ee(((c,h)=>{const d=wh(h);d.sequenceNumber<=t&&n.get(d.targetId)===null&&(s++,o.push(this.removeTargetData(e,d)))})).next((()=>F.waitFor(o))).next((()=>s))}forEachTarget(e,t){return $l(e).ee(((n,s)=>{const o=wh(s);t(o)}))}lr(e){return nI(e).get(sg).next((t=>(be(t!==null,2888),t)))}hr(e,t){return nI(e).put(sg,t)}Pr(e,t){return $l(e).put(sC(this.serializer,t))}Tr(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const n=Po(t),s=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let o=null;return $l(e).ee({range:s,index:t1},((c,h,d)=>{const m=wh(h);Td(t,m.target)&&(o=m,d.done())})).next((()=>o))}addMatchingKeys(e,t,n){const s=[],o=Zs(e);return t.forEach((c=>{const h=xn(c.path);s.push(o.put({targetId:n,path:h})),s.push(this.referenceDelegate.addReference(e,n,c))})),F.waitFor(s)}removeMatchingKeys(e,t,n){const s=Zs(e);return F.forEach(t,(o=>{const c=xn(o.path);return F.waitFor([s.delete([n,c]),this.referenceDelegate.removeReference(e,n,o)])}))}removeMatchingKeysForTargetId(e,t){const n=Zs(e),s=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(s)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),s=Zs(e);let o=Me();return s.ee({range:n,X:!0},((c,h,d)=>{const m=Ii(c[1]),y=new ge(m);o=o.add(y)})).next((()=>o))}containsKey(e,t){const n=xn(t.path),s=IDBKeyRange.bound([n],[qR(n)],!1,!0);let o=0;return Zs(e).ee({index:j0,X:!0,range:s},(([c,h],d,m)=>{c!==0&&(o++,m.done())})).next((()=>o>0))}At(e,t){return $l(e).get(t).next((n=>n?wh(n):null))}}function $l(r){return sn(r,vc)}function nI(r){return sn(r,Ro)}function Zs(r){return sn(r,wc)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rI="LruGarbageCollector",KL=1048576;function iI([r,e],[t,n]){const s=Oe(r,t);return s===0?Oe(e,n):s}class WL{constructor(e){this.Ir=e,this.buffer=new at(iI),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();iI(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class dC{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ae(rI,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Sa(t)?ae(rI,"Ignoring IndexedDB error during garbage collection: ",t):await Ta(t)}await this.Vr(3e5)}))}}class QL{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((n=>Math.floor(t/100*n)))}nthSequenceNumber(e,t){if(t===0)return F.resolve(Kn.ce);const n=new WL(t);return this.mr.forEachTarget(e,(s=>n.Ar(s.sequenceNumber))).next((()=>this.mr.pr(e,(s=>n.Ar(s))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.mr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ae("LruGarbageCollector","Garbage collection skipped; disabled"),F.resolve(tI)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(ae("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),tI):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let n,s,o,c,h,d,m;const y=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((_=>(_>this.params.maximumSequenceNumbersToCollect?(ae("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${_}`),s=this.params.maximumSequenceNumbersToCollect):s=_,c=Date.now(),this.nthSequenceNumber(e,s)))).next((_=>(n=_,h=Date.now(),this.removeTargets(e,n,t)))).next((_=>(o=_,d=Date.now(),this.removeOrphanedDocuments(e,n)))).next((_=>(m=Date.now(),Jl()<=Fe.DEBUG&&ae("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-y}ms
	Determined least recently used ${s} in `+(h-c)+`ms
	Removed ${o} targets in `+(d-h)+`ms
	Removed ${_} documents in `+(m-d)+`ms
Total Duration: ${m-y}ms`),F.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:o,documentsRemoved:_}))))}}function fC(r,e){return new QL(r,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YL{constructor(e,t){this.db=e,this.garbageCollector=fC(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((n=>t.next((s=>n+s))))}wr(e){let t=0;return this.pr(e,(n=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((n,s)=>t(s)))}addReference(e,t,n){return _m(e,n)}removeReference(e,t,n){return _m(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return _m(e,t)}br(e,t){return(function(s,o){let c=!1;return hC(s).te((h=>uC(s,h,o).next((d=>(d&&(c=!0),F.resolve(!d)))))).next((()=>c))})(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let o=0;return this.Sr(e,((c,h)=>{if(h<=t){const d=this.br(e,c).next((m=>{if(!m)return o++,n.getEntry(e,c).next((()=>(n.removeEntry(c,Se.min()),Zs(e).delete((function(_){return[0,xn(_.path)]})(c)))))}));s.push(d)}})).next((()=>F.waitFor(s))).next((()=>n.apply(e))).next((()=>o))}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return _m(e,t)}Sr(e,t){const n=Zs(e);let s,o=Kn.ce;return n.ee({index:j0},(([c,h],{path:d,sequenceNumber:m})=>{c===0?(o!==Kn.ce&&t(new ge(Ii(s)),o),o=m,s=d):o=Kn.ce})).next((()=>{o!==Kn.ce&&t(new ge(Ii(s)),o)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function _m(r,e){return Zs(r).put((function(n,s){return{targetId:0,path:xn(n.path),sequenceNumber:s}})(e,r.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mC{constructor(){this.changes=new hs((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,yt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?F.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JL{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return ao(e).put(n)}removeEntry(e,t,n){return ao(e).delete((function(o,c){const h=o.path.toArray();return[h.slice(0,h.length-2),h[h.length-2],cg(c),h[h.length-1]]})(t,n))}updateMetadata(e,t){return this.getMetadata(e).next((n=>(n.byteSize+=t,this.Dr(e,n))))}getEntry(e,t){let n=yt.newInvalidDocument(t);return ao(e).ee({index:Um,range:IDBKeyRange.only(dh(t))},((s,o)=>{n=this.Cr(t,o)})).next((()=>n))}vr(e,t){let n={size:0,document:yt.newInvalidDocument(t)};return ao(e).ee({index:Um,range:IDBKeyRange.only(dh(t))},((s,o)=>{n={document:this.Cr(t,o),size:hg(o)}})).next((()=>n))}getEntries(e,t){let n=Qn();return this.Fr(e,t,((s,o)=>{const c=this.Cr(s,o);n=n.insert(s,c)})).next((()=>n))}Mr(e,t){let n=Qn(),s=new mt(ge.comparator);return this.Fr(e,t,((o,c)=>{const h=this.Cr(o,c);n=n.insert(o,h),s=s.insert(o,hg(c))})).next((()=>({documents:n,Or:s})))}Fr(e,t,n){if(t.isEmpty())return F.resolve();let s=new at(oI);t.forEach((d=>s=s.add(d)));const o=IDBKeyRange.bound(dh(s.first()),dh(s.last())),c=s.getIterator();let h=c.getNext();return ao(e).ee({index:Um,range:o},((d,m,y)=>{const _=ge.fromSegments([...m.prefixPath,m.collectionGroup,m.documentId]);for(;h&&oI(h,_)<0;)n(h,null),h=c.getNext();h&&h.isEqual(_)&&(n(h,m),h=c.hasNext()?c.getNext():null),h?y.j(dh(h)):y.done()})).next((()=>{for(;h;)n(h,null),h=c.hasNext()?c.getNext():null}))}getDocumentsMatchingQuery(e,t,n,s,o){const c=t.path,h=[c.popLast().toArray(),c.lastSegment(),cg(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],d=[c.popLast().toArray(),c.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return ao(e).J(IDBKeyRange.bound(h,d,!0)).next((m=>{o==null||o.incrementDocumentReadCount(m.length);let y=Qn();for(const _ of m){const E=this.Cr(ge.fromSegments(_.prefixPath.concat(_.collectionGroup,_.documentId)),_);E.isFoundDocument()&&(Ad(t,E)||s.has(E.key))&&(y=y.insert(E.key,E))}return y}))}getAllFromCollectionGroup(e,t,n,s){let o=Qn();const c=aI(t,n),h=aI(t,hr.max());return ao(e).ee({index:e1,range:IDBKeyRange.bound(c,h,!0)},((d,m,y)=>{const _=this.Cr(ge.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);o=o.insert(_.key,_),o.size===s&&y.done()})).next((()=>o))}newChangeBuffer(e){return new XL(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return sI(e).get(uv).next((t=>(be(!!t,20021),t)))}Dr(e,t){return sI(e).put(uv,t)}Cr(e,t){if(t){const n=ML(this.serializer,t);if(!(n.isNoDocument()&&n.version.isEqual(Se.min())))return n}return yt.newInvalidDocument(e)}}function gC(r){return new JL(r)}class XL extends mC{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new hs((n=>n.toString()),((n,s)=>n.isEqual(s)))}applyChanges(e){const t=[];let n=0,s=new at(((o,c)=>Oe(o.canonicalString(),c.canonicalString())));return this.changes.forEach(((o,c)=>{const h=this.Br.get(o);if(t.push(this.Nr.removeEntry(e,o,h.readTime)),c.isValidDocument()){const d=zA(this.Nr.serializer,c);s=s.add(o.path.popLast());const m=hg(d);n+=m-h.size,t.push(this.Nr.addEntry(e,o,d))}else if(n-=h.size,this.trackRemovals){const d=zA(this.Nr.serializer,c.convertToNoDocument(Se.min()));t.push(this.Nr.addEntry(e,o,d))}})),s.forEach((o=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,o))})),t.push(this.Nr.updateMetadata(e,n)),F.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((n=>(this.Br.set(t,{size:n.size,readTime:n.document.readTime}),n.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:n,Or:s})=>(s.forEach(((o,c)=>{this.Br.set(o,{size:c,readTime:n.get(o).readTime})})),n)))}}function sI(r){return sn(r,Jh)}function ao(r){return sn(r,ig)}function dh(r){const e=r.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function aI(r,e){const t=e.documentKey.path.toArray();return[r,cg(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function oI(r,e){const t=r.path.toArray(),n=e.path.toArray();let s=0;for(let o=0;o<t.length-2&&o<n.length-2;++o)if(s=Oe(t[o],n[o]),s)return s;return s=Oe(t.length,n.length),s||(s=Oe(t[t.length-2],n[n.length-2]),s||Oe(t[t.length-1],n[n.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZL{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pC{constructor(e,t,n,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((s=>(n=s,this.remoteDocumentCache.getEntry(e,t)))).next((s=>(n!==null&&Vh(n.mutation,s,Wn.empty(),tt.now()),s)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((n=>this.getLocalViewOfDocuments(e,n,Me()).next((()=>n))))}getLocalViewOfDocuments(e,t,n=Me()){const s=xi();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,n).next((o=>{let c=_h();return o.forEach(((h,d)=>{c=c.insert(h,d.overlayedDocument)})),c}))))}getOverlayedDocuments(e,t){const n=xi();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,Me())))}populateOverlays(e,t,n){const s=[];return n.forEach((o=>{t.has(o)||s.push(o)})),this.documentOverlayCache.getOverlays(e,s).next((o=>{o.forEach(((c,h)=>{t.set(c,h)}))}))}computeViews(e,t,n,s){let o=Qn();const c=Dh(),h=(function(){return Dh()})();return t.forEach(((d,m)=>{const y=n.get(m.key);s.has(m.key)&&(y===void 0||y.mutation instanceof ds)?o=o.insert(m.key,m):y!==void 0?(c.set(m.key,y.mutation.getFieldMask()),Vh(y.mutation,m,y.mutation.getFieldMask(),tt.now())):c.set(m.key,Wn.empty())})),this.recalculateAndSaveOverlays(e,o).next((d=>(d.forEach(((m,y)=>c.set(m,y))),t.forEach(((m,y)=>h.set(m,new ZL(y,c.get(m)??null)))),h)))}recalculateAndSaveOverlays(e,t){const n=Dh();let s=new mt(((c,h)=>c-h)),o=Me();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((c=>{for(const h of c)h.keys().forEach((d=>{const m=t.get(d);if(m===null)return;let y=n.get(d)||Wn.empty();y=h.applyToLocalView(m,y),n.set(d,y);const _=(s.get(h.batchId)||Me()).add(d);s=s.insert(h.batchId,_)}))})).next((()=>{const c=[],h=s.getReverseIterator();for(;h.hasNext();){const d=h.getNext(),m=d.key,y=d.value,_=O1();y.forEach((E=>{if(!o.has(E)){const S=U1(t.get(E),n.get(E));S!==null&&_.set(E,S),o=o.add(E)}})),c.push(this.documentOverlayCache.saveOverlays(e,m,_))}return F.waitFor(c)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((n=>this.recalculateAndSaveOverlays(e,n)))}getDocumentsMatchingQuery(e,t,n,s){return(function(c){return ge.isDocumentKey(c.path)&&c.collectionGroup===null&&c.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):$0(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,s):this.getDocumentsMatchingCollectionQuery(e,t,n,s)}getNextDocuments(e,t,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,s).next((o=>{const c=s-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,s-o.size):F.resolve(xi());let h=yc,d=o;return c.next((m=>F.forEach(m,((y,_)=>(h<_.largestBatchId&&(h=_.largestBatchId),o.get(y)?F.resolve():this.remoteDocumentCache.getEntry(e,y).next((E=>{d=d.insert(y,E)}))))).next((()=>this.populateOverlays(e,m,o))).next((()=>this.computeViews(e,d,m,Me()))).next((y=>({batchId:h,changes:N1(y)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ge(t)).next((n=>{let s=_h();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,s){const o=t.collectionGroup;let c=_h();return this.indexManager.getCollectionParents(e,o).next((h=>F.forEach(h,(d=>{const m=(function(_,E){return new us(E,null,_.explicitOrderBy.slice(),_.filters.slice(),_.limit,_.limitType,_.startAt,_.endAt)})(t,d.child(o));return this.getDocumentsMatchingCollectionQuery(e,m,n,s).next((y=>{y.forEach(((_,E)=>{c=c.insert(_,E)}))}))})).next((()=>c))))}getDocumentsMatchingCollectionQuery(e,t,n,s){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((c=>(o=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,o,s)))).next((c=>{o.forEach(((d,m)=>{const y=m.getKey();c.get(y)===null&&(c=c.insert(y,yt.newInvalidDocument(y)))}));let h=_h();return c.forEach(((d,m)=>{const y=o.get(d);y!==void 0&&Vh(y.mutation,m,Wn.empty(),tt.now()),Ad(t,m)&&(h=h.insert(d,m))})),h}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eU{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return F.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(s){return{id:s.id,version:s.version,createTime:Lt(s.createTime)}})(t)),F.resolve()}getNamedQuery(e,t){return F.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(s){return{name:s.name,query:Z0(s.bundledQuery),readTime:Lt(s.readTime)}})(t)),F.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tU{constructor(){this.overlays=new mt(ge.comparator),this.qr=new Map}getOverlay(e,t){return F.resolve(this.overlays.get(t))}getOverlays(e,t){const n=xi();return F.forEach(t,(s=>this.getOverlay(e,s).next((o=>{o!==null&&n.set(s,o)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((s,o)=>{this.St(e,t,o)})),F.resolve()}removeOverlaysForBatchId(e,t,n){const s=this.qr.get(n);return s!==void 0&&(s.forEach((o=>this.overlays=this.overlays.remove(o))),this.qr.delete(n)),F.resolve()}getOverlaysForCollection(e,t,n){const s=xi(),o=t.length+1,c=new ge(t.child("")),h=this.overlays.getIteratorFrom(c);for(;h.hasNext();){const d=h.getNext().value,m=d.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===o&&d.largestBatchId>n&&s.set(d.getKey(),d)}return F.resolve(s)}getOverlaysForCollectionGroup(e,t,n,s){let o=new mt(((m,y)=>m-y));const c=this.overlays.getIterator();for(;c.hasNext();){const m=c.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>n){let y=o.get(m.largestBatchId);y===null&&(y=xi(),o=o.insert(m.largestBatchId,y)),y.set(m.getKey(),m)}}const h=xi(),d=o.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach(((m,y)=>h.set(m,y))),!(h.size()>=s)););return F.resolve(h)}St(e,t,n){const s=this.overlays.get(n.key);if(s!==null){const c=this.qr.get(s.largestBatchId).delete(n.key);this.qr.set(s.largestBatchId,c)}this.overlays=this.overlays.insert(n.key,new Y0(t,n));let o=this.qr.get(t);o===void 0&&(o=Me(),this.qr.set(t,o)),this.qr.set(t,o.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nU{constructor(){this.sessionToken=kt.EMPTY_BYTE_STRING}getSessionToken(e){return F.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,F.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nw{constructor(){this.Qr=new at(cn.$r),this.Ur=new at(cn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const n=new cn(e,t);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,t){e.forEach((n=>this.addReference(n,t)))}removeReference(e,t){this.Gr(new cn(e,t))}zr(e,t){e.forEach((n=>this.removeReference(n,t)))}jr(e){const t=new ge(new ze([])),n=new cn(t,e),s=new cn(t,e+1),o=[];return this.Ur.forEachInRange([n,s],(c=>{this.Gr(c),o.push(c.key)})),o}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new ge(new ze([])),n=new cn(t,e),s=new cn(t,e+1);let o=Me();return this.Ur.forEachInRange([n,s],(c=>{o=o.add(c.key)})),o}containsKey(e){const t=new cn(e,0),n=this.Qr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class cn{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return ge.comparator(e.key,t.key)||Oe(e.Yr,t.Yr)}static Kr(e,t){return Oe(e.Yr,t.Yr)||ge.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rU{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new at(cn.$r)}checkEmpty(e){return F.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,s){const o=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new W0(o,t,n,s);this.mutationQueue.push(c);for(const h of s)this.Zr=this.Zr.add(new cn(h.key,o)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast());return F.resolve(c)}lookupMutationBatch(e,t){return F.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,s=this.ei(n),o=s<0?0:s;return F.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return F.resolve(this.mutationQueue.length===0?oa:this.tr-1)}getAllMutationBatches(e){return F.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new cn(t,0),s=new cn(t,Number.POSITIVE_INFINITY),o=[];return this.Zr.forEachInRange([n,s],(c=>{const h=this.Xr(c.Yr);o.push(h)})),F.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new at(Oe);return t.forEach((s=>{const o=new cn(s,0),c=new cn(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([o,c],(h=>{n=n.add(h.Yr)}))})),F.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,s=n.length+1;let o=n;ge.isDocumentKey(o)||(o=o.child(""));const c=new cn(new ge(o),0);let h=new at(Oe);return this.Zr.forEachWhile((d=>{const m=d.key.path;return!!n.isPrefixOf(m)&&(m.length===s&&(h=h.add(d.Yr)),!0)}),c),F.resolve(this.ti(h))}ti(e){const t=[];return e.forEach((n=>{const s=this.Xr(n);s!==null&&t.push(s)})),t}removeMutationBatch(e,t){be(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return F.forEach(t.mutations,(s=>{const o=new cn(s.key,t.batchId);return n=n.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.Zr=n}))}ir(e){}containsKey(e,t){const n=new cn(t,0),s=this.Zr.firstAfterOrEqual(n);return F.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,F.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iU{constructor(e){this.ri=e,this.docs=(function(){return new mt(ge.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,s=this.docs.get(n),o=s?s.size:0,c=this.ri(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:c}),this.size+=c-o,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return F.resolve(n?n.document.mutableCopy():yt.newInvalidDocument(t))}getEntries(e,t){let n=Qn();return t.forEach((s=>{const o=this.docs.get(s);n=n.insert(s,o?o.document.mutableCopy():yt.newInvalidDocument(s))})),F.resolve(n)}getDocumentsMatchingQuery(e,t,n,s){let o=Qn();const c=t.path,h=new ge(c.child("__id-9223372036854775808__")),d=this.docs.getIteratorFrom(h);for(;d.hasNext();){const{key:m,value:{document:y}}=d.getNext();if(!c.isPrefixOf(m.path))break;m.path.length>c.length+1||V0(WR(y),n)<=0||(s.has(y.key)||Ad(t,y))&&(o=o.insert(y.key,y.mutableCopy()))}return F.resolve(o)}getAllFromCollectionGroup(e,t,n,s){_e(9500)}ii(e,t){return F.forEach(this.docs,(n=>t(n)))}newChangeBuffer(e){return new sU(this)}getSize(e){return F.resolve(this.size)}}class sU extends mC{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((n,s)=>{s.isValidDocument()?t.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(n)})),F.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aU{constructor(e){this.persistence=e,this.si=new hs((t=>Po(t)),Td),this.lastRemoteSnapshotVersion=Se.min(),this.highestTargetId=0,this.oi=0,this._i=new nw,this.targetCount=0,this.ai=Lo.ur()}forEachTarget(e,t){return this.si.forEach(((n,s)=>t(s))),F.resolve()}getLastRemoteSnapshotVersion(e){return F.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return F.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),F.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.oi&&(this.oi=t),F.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Lo(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,F.resolve()}updateTargetData(e,t){return this.Pr(t),F.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,F.resolve()}removeTargets(e,t,n){let s=0;const o=[];return this.si.forEach(((c,h)=>{h.sequenceNumber<=t&&n.get(h.targetId)===null&&(this.si.delete(c),o.push(this.removeMatchingKeysForTargetId(e,h.targetId)),s++)})),F.waitFor(o).next((()=>s))}getTargetCount(e){return F.resolve(this.targetCount)}getTargetData(e,t){const n=this.si.get(t)||null;return F.resolve(n)}addMatchingKeys(e,t,n){return this._i.Wr(t,n),F.resolve()}removeMatchingKeys(e,t,n){this._i.zr(t,n);const s=this.persistence.referenceDelegate,o=[];return s&&t.forEach((c=>{o.push(s.markPotentiallyOrphaned(e,c))})),F.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),F.resolve()}getMatchingKeysForTargetId(e,t){const n=this._i.Hr(t);return F.resolve(n)}containsKey(e,t){return F.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rw{constructor(e,t){this.ui={},this.overlays={},this.ci=new Kn(0),this.li=!1,this.li=!0,this.hi=new nU,this.referenceDelegate=e(this),this.Pi=new aU(this),this.indexManager=new $L,this.remoteDocumentCache=(function(s){return new iU(s)})((n=>this.referenceDelegate.Ti(n))),this.serializer=new iC(t),this.Ii=new eU(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new tU,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ui[e.toKey()];return n||(n=new rU(t,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,n){ae("MemoryPersistence","Starting transaction:",e);const s=new oU(this.ci.next());return this.referenceDelegate.Ei(),n(s).next((o=>this.referenceDelegate.di(s).next((()=>o)))).toPromise().then((o=>(s.raiseOnCommittedEvent(),o)))}Ai(e,t){return F.or(Object.values(this.ui).map((n=>()=>n.containsKey(e,t))))}}class oU extends YR{constructor(e){super(),this.currentSequenceNumber=e}}class Yg{constructor(e){this.persistence=e,this.Ri=new nw,this.Vi=null}static mi(e){return new Yg(e)}get fi(){if(this.Vi)return this.Vi;throw _e(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.fi.delete(n.toString()),F.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.fi.add(n.toString()),F.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),F.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((s=>this.fi.add(s.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((s=>{s.forEach((o=>this.fi.add(o.toString())))})).next((()=>n.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return F.forEach(this.fi,(n=>{const s=ge.fromPath(n);return this.gi(e,s).next((o=>{o||t.removeEntry(s,Se.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((n=>{n?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return F.or([()=>F.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class dg{constructor(e,t){this.persistence=e,this.pi=new hs((n=>xn(n.path)),((n,s)=>n.isEqual(s))),this.garbageCollector=fC(this,t)}static mi(e,t){return new dg(e,t)}Ei(){}di(e){return F.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((n=>t.next((s=>n+s))))}wr(e){let t=0;return this.pr(e,(n=>{t++})).next((()=>t))}pr(e,t){return F.forEach(this.pi,((n,s)=>this.br(e,n,s).next((o=>o?F.resolve():t(s)))))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const s=this.persistence.getRemoteDocumentCache(),o=s.newChangeBuffer();return s.ii(e,(c=>this.br(e,c,t).next((h=>{h||(n++,o.removeEntry(c,Se.min()))})))).next((()=>o.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),F.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),F.resolve()}removeReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),F.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),F.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Fm(e.data.value)),t}br(e,t,n){return F.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.pi.get(t);return F.resolve(s!==void 0&&s>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lU{constructor(e){this.serializer=e}k(e,t,n,s){const o=new Ug("createOrUpgrade",t);n<1&&s>=1&&((function(d){d.createObjectStore(Ed)})(e),(function(d){d.createObjectStore(Yh,{keyPath:S4}),d.createObjectStore($r,{keyPath:_A,autoIncrement:!0}).createIndex(Eo,vA,{unique:!0}),d.createObjectStore(_c)})(e),lI(e),(function(d){d.createObjectStore(ho)})(e));let c=F.resolve();return n<3&&s>=3&&(n!==0&&((function(d){d.deleteObjectStore(wc),d.deleteObjectStore(vc),d.deleteObjectStore(Ro)})(e),lI(e)),c=c.next((()=>(function(d){const m=d.store(Ro),y={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Se.min().toTimestamp(),targetCount:0};return m.put(sg,y)})(o)))),n<4&&s>=4&&(n!==0&&(c=c.next((()=>(function(d,m){return m.store($r).J().next((_=>{d.deleteObjectStore($r),d.createObjectStore($r,{keyPath:_A,autoIncrement:!0}).createIndex(Eo,vA,{unique:!0});const E=m.store($r),S=_.map((C=>E.put(C)));return F.waitFor(S)}))})(e,o)))),c=c.next((()=>{(function(d){d.createObjectStore(bc,{keyPath:P4})})(e)}))),n<5&&s>=5&&(c=c.next((()=>this.yi(o)))),n<6&&s>=6&&(c=c.next((()=>((function(d){d.createObjectStore(Jh)})(e),this.wi(o))))),n<7&&s>=7&&(c=c.next((()=>this.Si(o)))),n<8&&s>=8&&(c=c.next((()=>this.bi(e,o)))),n<9&&s>=9&&(c=c.next((()=>{(function(d){d.objectStoreNames.contains("remoteDocumentChanges")&&d.deleteObjectStore("remoteDocumentChanges")})(e)}))),n<10&&s>=10&&(c=c.next((()=>this.Di(o)))),n<11&&s>=11&&(c=c.next((()=>{(function(d){d.createObjectStore(Bg,{keyPath:D4})})(e),(function(d){d.createObjectStore(Fg,{keyPath:V4})})(e)}))),n<12&&s>=12&&(c=c.next((()=>{(function(d){const m=d.createObjectStore(zg,{keyPath:z4});m.createIndex(dv,q4,{unique:!1}),m.createIndex(i1,$4,{unique:!1})})(e)}))),n<13&&s>=13&&(c=c.next((()=>(function(d){const m=d.createObjectStore(ig,{keyPath:I4});m.createIndex(Um,x4),m.createIndex(e1,R4)})(e))).next((()=>this.Ci(e,o))).next((()=>e.deleteObjectStore(ho)))),n<14&&s>=14&&(c=c.next((()=>this.Fi(e,o)))),n<15&&s>=15&&(c=c.next((()=>(function(d){d.createObjectStore(L0,{keyPath:M4,autoIncrement:!0}).createIndex(hv,j4,{unique:!1}),d.createObjectStore(Nh,{keyPath:L4}).createIndex(n1,U4,{unique:!1}),d.createObjectStore(Oh,{keyPath:B4}).createIndex(r1,F4,{unique:!1})})(e)))),n<16&&s>=16&&(c=c.next((()=>{t.objectStore(Nh).clear()})).next((()=>{t.objectStore(Oh).clear()}))),n<17&&s>=17&&(c=c.next((()=>{(function(d){d.createObjectStore(U0,{keyPath:H4})})(e)}))),n<18&&s>=18&&Ex()&&(c=c.next((()=>{t.objectStore(Nh).clear()})).next((()=>{t.objectStore(Oh).clear()}))),c}wi(e){let t=0;return e.store(ho).ee(((n,s)=>{t+=hg(s)})).next((()=>{const n={byteSize:t};return e.store(Jh).put(uv,n)}))}yi(e){const t=e.store(Yh),n=e.store($r);return t.J().next((s=>F.forEach(s,(o=>{const c=IDBKeyRange.bound([o.userId,oa],[o.userId,o.lastAcknowledgedBatchId]);return n.J(Eo,c).next((h=>F.forEach(h,(d=>{be(d.userId===o.userId,18650,"Cannot process batch from unexpected user",{batchId:d.batchId});const m=go(this.serializer,d);return cC(e,o.userId,m).next((()=>{}))}))))}))))}Si(e){const t=e.store(wc),n=e.store(ho);return e.store(Ro).get(sg).next((s=>{const o=[];return n.ee(((c,h)=>{const d=new ze(c),m=(function(_){return[0,xn(_)]})(d);o.push(t.get(m).next((y=>y?F.resolve():(_=>t.put({targetId:0,path:xn(_),sequenceNumber:s.highestListenSequenceNumber}))(d))))})).next((()=>F.waitFor(o)))}))}bi(e,t){e.createObjectStore(Xh,{keyPath:O4});const n=t.store(Xh),s=new tw,o=c=>{if(s.add(c)){const h=c.lastSegment(),d=c.popLast();return n.put({collectionId:h,parent:xn(d)})}};return t.store(ho).ee({X:!0},((c,h)=>{const d=new ze(c);return o(d.popLast())})).next((()=>t.store(_c).ee({X:!0},(([c,h,d],m)=>{const y=Ii(h);return o(y.popLast())}))))}Di(e){const t=e.store(vc);return t.ee(((n,s)=>{const o=wh(s),c=sC(this.serializer,o);return t.put(c)}))}Ci(e,t){const n=t.store(ho),s=[];return n.ee(((o,c)=>{const h=t.store(ig),d=(function(_){return _.document?new ge(ze.fromString(_.document.name).popFirst(5)):_.noDocument?ge.fromSegments(_.noDocument.path):_.unknownDocument?ge.fromSegments(_.unknownDocument.path):_e(36783)})(c).path.toArray(),m={prefixPath:d.slice(0,d.length-2),collectionGroup:d[d.length-2],documentId:d[d.length-1],readTime:c.readTime||[0,0],unknownDocument:c.unknownDocument,noDocument:c.noDocument,document:c.document,hasCommittedMutations:!!c.hasCommittedMutations};s.push(h.put(m))})).next((()=>F.waitFor(s)))}Fi(e,t){const n=t.store($r),s=gC(this.serializer),o=new rw(Yg.mi,this.serializer.yt);return n.J().next((c=>{const h=new Map;return c.forEach((d=>{let m=h.get(d.userId)??Me();go(this.serializer,d).keys().forEach((y=>m=m.add(y))),h.set(d.userId,m)})),F.forEach(h,((d,m)=>{const y=new un(m),_=Wg.wt(this.serializer,y),E=o.getIndexManager(y),S=Qg.wt(y,this.serializer,E,o.referenceDelegate);return new pC(s,S,_,E).recalculateAndSaveOverlaysForDocumentKeys(new fv(t,Kn.ce),d).next()}))}))}}function lI(r){r.createObjectStore(wc,{keyPath:k4}).createIndex(j0,N4,{unique:!0}),r.createObjectStore(vc,{keyPath:"targetId"}).createIndex(t1,C4,{unique:!0}),r.createObjectStore(Ro)}const Ys="IndexedDbPersistence",N_=18e5,O_=5e3,P_="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",yC="main";class iw{constructor(e,t,n,s,o,c,h,d,m,y,_=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.Mi=o,this.window=c,this.document=h,this.xi=m,this.Oi=y,this.Ni=_,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=E=>Promise.resolve(),!iw.v())throw new ie(Q.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new YL(this,s),this.$i=t+yC,this.serializer=new iC(d),this.Ui=new Ri(this.$i,this.Ni,new lU(this.serializer)),this.hi=new LL,this.Pi=new GL(this.referenceDelegate,this.serializer),this.remoteDocumentCache=gC(this.serializer),this.Ii=new jL,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,y===!1&&jt(Ys,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ie(Q.FAILED_PRECONDITION,P_);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new Kn(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>vm(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(Sa(e))return ae(Ys,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ae(Ys,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return fh(e).get(Ul).next((t=>F.resolve(this.es(t))))}ts(e){return vm(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,N_)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const n=sn(t,bc);return n.J().next((s=>{const o=this.ss(s,N_),c=s.filter((h=>o.indexOf(h)===-1));return F.forEach(c,(h=>n.delete(h.clientId))).next((()=>c))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?F.resolve(!0):fh(e).get(Ul).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,O_)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new ie(Q.FAILED_PRECONDITION,P_);return!1}}return!(!this.networkEnabled||!this.inForeground)||vm(e).J().next((n=>this.ss(n,O_).find((s=>{if(this.clientId!==s.clientId){const o=!this.networkEnabled&&s.networkEnabled,c=!this.inForeground&&s.inForeground,h=this.networkEnabled===s.networkEnabled;if(o||c&&h)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&ae(Ys,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Ed,bc],(e=>{const t=new fv(e,Kn.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((n=>this.rs(n.updateTimeMs,t)&&!this.us(n.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>vm(e).J().next((t=>this.ss(t,N_).map((n=>n.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return Qg.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new HL(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return Wg.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,n){ae(Ys,"Starting transaction:",e);const s=t==="readonly"?"readonly":"readwrite",o=(function(d){return d===18?W4:d===17?l1:d===16?K4:d===15?B0:d===14?o1:d===13?a1:d===12?G4:d===11?s1:void _e(60245)})(this.Ni);let c;return this.Ui.runTransaction(e,s,o,(h=>(c=new fv(h,this.ci?this.ci.next():Kn.ce),t==="readwrite-primary"?this.Hi(c).next((d=>!!d||this.Yi(c))).next((d=>{if(!d)throw jt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new ie(Q.FAILED_PRECONDITION,QR);return n(c)})).next((d=>this.Xi(c).next((()=>d)))):this.Is(c).next((()=>n(c)))))).then((h=>(c.raiseOnCommittedEvent(),h)))}Is(e){return fh(e).get(Ul).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,O_)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new ie(Q.FAILED_PRECONDITION,P_)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return fh(e).put(Ul,t)}static v(){return Ri.v()}Zi(e){const t=fh(e);return t.get(Ul).next((n=>this.es(n)?(ae(Ys,"Releasing primary lease."),t.delete(Ul)):F.resolve()))}rs(e,t){const n=Date.now();return!(e<n-t)&&(!(e>n)||(jt(`Detected an update time that is in the future: ${e} > ${n}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const t=/(?:Version|Mobile)\/1[456]/;bx()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var t;try{const n=((t=this.Ki)==null?void 0:t.getItem(this._s(e)))!==null;return ae(Ys,`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return jt(Ys,"Failed to get zombied client id.",n),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){jt("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function fh(r){return sn(r,Ed)}function vm(r){return sn(r,bc)}function sw(r,e){let t=r.projectId;return r.isDefaultDatabase||(t+="."+r.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aw{constructor(e,t,n,s){this.targetId=e,this.fromCache=t,this.Es=n,this.ds=s}static As(e,t){let n=Me(),s=Me();for(const o of t.docChanges)switch(o.type){case 0:n=n.add(o.doc.key);break;case 1:s=s.add(o.doc.key)}return new aw(e,t.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cU{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _C{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return bx()?8:JR(It())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,s){const o={result:null};return this.ys(e,t).next((c=>{o.result=c})).next((()=>{if(!o.result)return this.ws(e,t,s,n).next((c=>{o.result=c}))})).next((()=>{if(o.result)return;const c=new cU;return this.Ss(e,t,c).next((h=>{if(o.result=h,this.Vs)return this.bs(e,t,c,h.size)}))})).next((()=>o.result))}bs(e,t,n,s){return n.documentReadCount<this.fs?(Jl()<=Fe.DEBUG&&ae("QueryEngine","SDK will not create cache indexes for query:",Xl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),F.resolve()):(Jl()<=Fe.DEBUG&&ae("QueryEngine","Query:",Xl(t),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.gs*s?(Jl()<=Fe.DEBUG&&ae("QueryEngine","The SDK decides to create cache indexes for query:",Xl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Mn(t))):F.resolve())}ys(e,t){if(OA(t))return F.resolve(null);let n=Mn(t);return this.indexManager.getIndexType(e,n).next((s=>s===0?null:(t.limit!==null&&s===1&&(t=lg(t,null,"F"),n=Mn(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((o=>{const c=Me(...o);return this.ps.getDocuments(e,c).next((h=>this.indexManager.getMinOffset(e,n).next((d=>{const m=this.Ds(t,h);return this.Cs(t,m,c,d.readTime)?this.ys(e,lg(t,null,"F")):this.vs(e,m,t,d)}))))})))))}ws(e,t,n,s){return OA(t)||s.isEqual(Se.min())?F.resolve(null):this.ps.getDocuments(e,n).next((o=>{const c=this.Ds(t,o);return this.Cs(t,c,n,s)?F.resolve(null):(Jl()<=Fe.DEBUG&&ae("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Xl(t)),this.vs(e,c,t,KR(s,yc)).next((h=>h)))}))}Ds(e,t){let n=new at(C1(e));return t.forEach(((s,o)=>{Ad(e,o)&&(n=n.add(o))})),n}Cs(e,t,n,s){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(s)>0)}Ss(e,t,n){return Jl()<=Fe.DEBUG&&ae("QueryEngine","Using full collection scan to execute query:",Xl(t)),this.ps.getDocumentsMatchingQuery(e,t,hr.min(),n)}vs(e,t,n,s){return this.ps.getDocumentsMatchingQuery(e,n,s).next((o=>(t.forEach((c=>{o=o.insert(c.key,c)})),o)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ow="LocalStore",uU=3e8;class hU{constructor(e,t,n,s){this.persistence=e,this.Fs=t,this.serializer=s,this.Ms=new mt(Oe),this.xs=new hs((o=>Po(o)),Td),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new pC(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function vC(r,e,t,n){return new hU(r,e,t,n)}async function wC(r,e){const t=pe(r);return await t.persistence.runTransaction("Handle user change","readonly",(n=>{let s;return t.mutationQueue.getAllMutationBatches(n).next((o=>(s=o,t.Bs(e),t.mutationQueue.getAllMutationBatches(n)))).next((o=>{const c=[],h=[];let d=Me();for(const m of s){c.push(m.batchId);for(const y of m.mutations)d=d.add(y.key)}for(const m of o){h.push(m.batchId);for(const y of m.mutations)d=d.add(y.key)}return t.localDocuments.getDocuments(n,d).next((m=>({Ls:m,removedBatchIds:c,addedBatchIds:h})))}))}))}function dU(r,e){const t=pe(r);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(n=>{const s=e.batch.keys(),o=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(h,d,m,y){const _=m.batch,E=_.keys();let S=F.resolve();return E.forEach((C=>{S=S.next((()=>y.getEntry(d,C))).next((k=>{const N=m.docVersions.get(C);be(N!==null,48541),k.version.compareTo(N)<0&&(_.applyToRemoteDocument(k,m),k.isValidDocument()&&(k.setReadTime(m.commitVersion),y.addEntry(k)))}))})),S.next((()=>h.mutationQueue.removeMutationBatch(d,_)))})(t,n,e,o).next((()=>o.apply(n))).next((()=>t.mutationQueue.performConsistencyCheck(n))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(n,s,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,(function(h){let d=Me();for(let m=0;m<h.mutationResults.length;++m)h.mutationResults[m].transformResults.length>0&&(d=d.add(h.batch.mutations[m].key));return d})(e)))).next((()=>t.localDocuments.getDocuments(n,s)))}))}function bC(r){const e=pe(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function fU(r,e){const t=pe(r),n=e.snapshotVersion;let s=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(o=>{const c=t.Ns.newChangeBuffer({trackRemovals:!0});s=t.Ms;const h=[];e.targetChanges.forEach(((y,_)=>{const E=s.get(_);if(!E)return;h.push(t.Pi.removeMatchingKeys(o,y.removedDocuments,_).next((()=>t.Pi.addMatchingKeys(o,y.addedDocuments,_))));let S=E.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(_)!==null?S=S.withResumeToken(kt.EMPTY_BYTE_STRING,Se.min()).withLastLimboFreeSnapshotVersion(Se.min()):y.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(y.resumeToken,n)),s=s.insert(_,S),(function(k,N,G){return k.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-k.snapshotVersion.toMicroseconds()>=uU?!0:G.addedDocuments.size+G.modifiedDocuments.size+G.removedDocuments.size>0})(E,S,y)&&h.push(t.Pi.updateTargetData(o,S))}));let d=Qn(),m=Me();if(e.documentUpdates.forEach((y=>{e.resolvedLimboDocuments.has(y)&&h.push(t.persistence.referenceDelegate.updateLimboDocument(o,y))})),h.push(EC(o,c,e.documentUpdates).next((y=>{d=y.ks,m=y.qs}))),!n.isEqual(Se.min())){const y=t.Pi.getLastRemoteSnapshotVersion(o).next((_=>t.Pi.setTargetsMetadata(o,o.currentSequenceNumber,n)));h.push(y)}return F.waitFor(h).next((()=>c.apply(o))).next((()=>t.localDocuments.getLocalViewOfDocuments(o,d,m))).next((()=>d))})).then((o=>(t.Ms=s,o)))}function EC(r,e,t){let n=Me(),s=Me();return t.forEach((o=>n=n.add(o))),e.getEntries(r,n).next((o=>{let c=Qn();return t.forEach(((h,d)=>{const m=o.get(h);d.isFoundDocument()!==m.isFoundDocument()&&(s=s.add(h)),d.isNoDocument()&&d.version.isEqual(Se.min())?(e.removeEntry(h,d.readTime),c=c.insert(h,d)):!m.isValidDocument()||d.version.compareTo(m.version)>0||d.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(d),c=c.insert(h,d)):ae(ow,"Ignoring outdated watch update for ",h,". Current version:",m.version," Watch version:",d.version)})),{ks:c,qs:s}}))}function mU(r,e){const t=pe(r);return t.persistence.runTransaction("Get next mutation batch","readonly",(n=>(e===void 0&&(e=oa),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e))))}function Rc(r,e){const t=pe(r);return t.persistence.runTransaction("Allocate target","readwrite",(n=>{let s;return t.Pi.getTargetData(n,e).next((o=>o?(s=o,F.resolve(s)):t.Pi.allocateTargetId(n).next((c=>(s=new ns(e,c,"TargetPurposeListen",n.currentSequenceNumber),t.Pi.addTargetData(n,s).next((()=>s)))))))})).then((n=>{const s=t.Ms.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(n.targetId,n),t.xs.set(e,n.targetId)),n}))}async function Cc(r,e,t){const n=pe(r),s=n.Ms.get(e),o=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",o,(c=>n.persistence.referenceDelegate.removeTarget(c,s)))}catch(c){if(!Sa(c))throw c;ae(ow,`Failed to update sequence numbers for target ${e}: ${c}`)}n.Ms=n.Ms.remove(e),n.xs.delete(s.target)}function fg(r,e,t){const n=pe(r);let s=Se.min(),o=Me();return n.persistence.runTransaction("Execute query","readwrite",(c=>(function(d,m,y){const _=pe(d),E=_.xs.get(y);return E!==void 0?F.resolve(_.Ms.get(E)):_.Pi.getTargetData(m,y)})(n,c,Mn(e)).next((h=>{if(h)return s=h.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(c,h.targetId).next((d=>{o=d}))})).next((()=>n.Fs.getDocumentsMatchingQuery(c,e,t?s:Se.min(),t?o:Me()))).next((h=>(AC(n,R1(e),h),{documents:h,Qs:o})))))}function TC(r,e){const t=pe(r),n=pe(t.Pi),s=t.Ms.get(e);return s?Promise.resolve(s.target):t.persistence.runTransaction("Get target data","readonly",(o=>n.At(o,e).next((c=>c?c.target:null))))}function SC(r,e){const t=pe(r),n=t.Os.get(e)||Se.min();return t.persistence.runTransaction("Get new document changes","readonly",(s=>t.Ns.getAllFromCollectionGroup(s,e,KR(n,yc),Number.MAX_SAFE_INTEGER))).then((s=>(AC(t,e,s),s)))}function AC(r,e,t){let n=r.Os.get(e)||Se.min();t.forEach(((s,o)=>{o.readTime.compareTo(n)>0&&(n=o.readTime)})),r.Os.set(e,n)}async function gU(r,e,t,n){const s=pe(r);let o=Me(),c=Qn();for(const m of t){const y=e.$s(m.metadata.name);m.document&&(o=o.add(y));const _=e.Us(m);_.setReadTime(e.Ks(m.metadata.readTime)),c=c.insert(y,_)}const h=s.Ns.newChangeBuffer({trackRemovals:!0}),d=await Rc(s,(function(y){return Mn(qc(ze.fromString(`__bundle__/docs/${y}`)))})(n));return s.persistence.runTransaction("Apply bundle documents","readwrite",(m=>EC(m,h,c).next((y=>(h.apply(m),y))).next((y=>s.Pi.removeMatchingKeysForTargetId(m,d.targetId).next((()=>s.Pi.addMatchingKeys(m,o,d.targetId))).next((()=>s.localDocuments.getLocalViewOfDocuments(m,y.ks,y.qs))).next((()=>y.ks))))))}async function pU(r,e,t=Me()){const n=await Rc(r,Mn(Z0(e.bundledQuery))),s=pe(r);return s.persistence.runTransaction("Save named query","readwrite",(o=>{const c=Lt(e.readTime);if(n.snapshotVersion.compareTo(c)>=0)return s.Ii.saveNamedQuery(o,e);const h=n.withResumeToken(kt.EMPTY_BYTE_STRING,c);return s.Ms=s.Ms.insert(h.targetId,h),s.Pi.updateTargetData(o,h).next((()=>s.Pi.removeMatchingKeysForTargetId(o,n.targetId))).next((()=>s.Pi.addMatchingKeys(o,t,n.targetId))).next((()=>s.Ii.saveNamedQuery(o,e)))}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IC="firestore_clients";function cI(r,e){return`${IC}_${r}_${e}`}const xC="firestore_mutations";function uI(r,e,t){let n=`${xC}_${r}_${t}`;return e.isAuthenticated()&&(n+=`_${e.uid}`),n}const RC="firestore_targets";function D_(r,e){return`${RC}_${r}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wi="SharedClientState";class mg{constructor(e,t,n,s){this.user=e,this.batchId=t,this.state=n,this.error=s}static Ws(e,t,n){const s=JSON.parse(n);let o,c=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return c&&s.error&&(c=typeof s.error.message=="string"&&typeof s.error.code=="string",c&&(o=new ie(s.error.code,s.error.message))),c?new mg(e,t,s.state,o):(jt(wi,`Failed to parse mutation state for ID '${t}': ${n}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Mh{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static Ws(e,t){const n=JSON.parse(t);let s,o=typeof n=="object"&&["not-current","current","rejected"].indexOf(n.state)!==-1&&(n.error===void 0||typeof n.error=="object");return o&&n.error&&(o=typeof n.error.message=="string"&&typeof n.error.code=="string",o&&(s=new ie(n.error.code,n.error.message))),o?new Mh(e,n.state,s):(jt(wi,`Failed to parse target state for ID '${e}': ${t}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class gg{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ws(e,t){const n=JSON.parse(t);let s=typeof n=="object"&&n.activeTargetIds instanceof Array,o=H0();for(let c=0;s&&c<n.activeTargetIds.length;++c)s=XR(n.activeTargetIds[c]),o=o.add(n.activeTargetIds[c]);return s?new gg(e,o):(jt(wi,`Failed to parse client data for instance '${e}': ${t}`),null)}}class lw{constructor(e,t){this.clientId=e,this.onlineState=t}static Ws(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new lw(t.clientId,t.onlineState):(jt(wi,`Failed to parse online state: ${e}`),null)}}class Rv{constructor(){this.activeTargetIds=H0()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class V_{constructor(e,t,n,s,o){this.window=e,this.Mi=t,this.persistenceKey=n,this.Js=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Hs=this.Ys.bind(this),this.Zs=new mt(Oe),this.started=!1,this.Xs=[];const c=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.eo=cI(this.persistenceKey,this.Js),this.no=(function(d){return`firestore_sequence_number_${d}`})(this.persistenceKey),this.Zs=this.Zs.insert(this.Js,new Rv),this.ro=new RegExp(`^${IC}_${c}_([^_]*)$`),this.io=new RegExp(`^${xC}_${c}_(\\d+)(?:_(.*))?$`),this.so=new RegExp(`^${RC}_${c}_(\\d+)$`),this.oo=(function(d){return`firestore_online_state_${d}`})(this.persistenceKey),this._o=(function(d){return`firestore_bundle_loaded_v2_${d}`})(this.persistenceKey),this.window.addEventListener("storage",this.Hs)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Ts();for(const n of e){if(n===this.Js)continue;const s=this.getItem(cI(this.persistenceKey,n));if(s){const o=gg.Ws(n,s);o&&(this.Zs=this.Zs.insert(o.clientId,o))}}this.ao();const t=this.storage.getItem(this.oo);if(t){const n=this.uo(t);n&&this.co(n)}for(const n of this.Xs)this.Ys(n);this.Xs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.no,JSON.stringify(e))}getAllActiveQueryTargets(){return this.lo(this.Zs)}isActiveQueryTarget(e){let t=!1;return this.Zs.forEach(((n,s)=>{s.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.ho(e,"pending")}updateMutationState(e,t,n){this.ho(e,t,n),this.Po(e)}addLocalQueryTarget(e,t=!0){let n="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(D_(this.persistenceKey,e));if(s){const o=Mh.Ws(e,s);o&&(n=o.state)}}return t&&this.To.zs(e),this.ao(),n}removeLocalQueryTarget(e){this.To.js(e),this.ao()}isLocalQueryTarget(e){return this.To.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(D_(this.persistenceKey,e))}updateQueryState(e,t,n){this.Io(e,t,n)}handleUserChange(e,t,n){t.forEach((s=>{this.Po(s)})),this.currentUser=e,n.forEach((s=>{this.addPendingMutation(s)}))}setOnlineState(e){this.Eo(e)}notifyBundleLoaded(e){this.Ao(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Hs),this.removeItem(this.eo),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return ae(wi,"READ",e,t),t}setItem(e,t){ae(wi,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){ae(wi,"REMOVE",e),this.storage.removeItem(e)}Ys(e){const t=e;if(t.storageArea===this.storage){if(ae(wi,"EVENT",t.key,t.newValue),t.key===this.eo)return void jt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Mi.enqueueRetryable((async()=>{if(this.started){if(t.key!==null){if(this.ro.test(t.key)){if(t.newValue==null){const n=this.Ro(t.key);return this.Vo(n,null)}{const n=this.mo(t.key,t.newValue);if(n)return this.Vo(n.clientId,n)}}else if(this.io.test(t.key)){if(t.newValue!==null){const n=this.fo(t.key,t.newValue);if(n)return this.po(n)}}else if(this.so.test(t.key)){if(t.newValue!==null){const n=this.yo(t.key,t.newValue);if(n)return this.wo(n)}}else if(t.key===this.oo){if(t.newValue!==null){const n=this.uo(t.newValue);if(n)return this.co(n)}}else if(t.key===this.no){const n=(function(o){let c=Kn.ce;if(o!=null)try{const h=JSON.parse(o);be(typeof h=="number",30636,{So:o}),c=h}catch(h){jt(wi,"Failed to read sequence number from WebStorage",h)}return c})(t.newValue);n!==Kn.ce&&this.sequenceNumberHandler(n)}else if(t.key===this._o){const n=this.bo(t.newValue);await Promise.all(n.map((s=>this.syncEngine.Do(s))))}}}else this.Xs.push(t)}))}}get To(){return this.Zs.get(this.Js)}ao(){this.setItem(this.eo,this.To.Gs())}ho(e,t,n){const s=new mg(this.currentUser,e,t,n),o=uI(this.persistenceKey,this.currentUser,e);this.setItem(o,s.Gs())}Po(e){const t=uI(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Eo(e){const t={clientId:this.Js,onlineState:e};this.storage.setItem(this.oo,JSON.stringify(t))}Io(e,t,n){const s=D_(this.persistenceKey,e),o=new Mh(e,t,n);this.setItem(s,o.Gs())}Ao(e){const t=JSON.stringify(Array.from(e));this.setItem(this._o,t)}Ro(e){const t=this.ro.exec(e);return t?t[1]:null}mo(e,t){const n=this.Ro(e);return gg.Ws(n,t)}fo(e,t){const n=this.io.exec(e),s=Number(n[1]),o=n[2]!==void 0?n[2]:null;return mg.Ws(new un(o),s,t)}yo(e,t){const n=this.so.exec(e),s=Number(n[1]);return Mh.Ws(s,t)}uo(e){return lw.Ws(e)}bo(e){return JSON.parse(e)}async po(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Co(e.batchId,e.state,e.error);ae(wi,`Ignoring mutation for non-active user ${e.user.uid}`)}wo(e){return this.syncEngine.vo(e.targetId,e.state,e.error)}Vo(e,t){const n=t?this.Zs.insert(e,t):this.Zs.remove(e),s=this.lo(this.Zs),o=this.lo(n),c=[],h=[];return o.forEach((d=>{s.has(d)||c.push(d)})),s.forEach((d=>{o.has(d)||h.push(d)})),this.syncEngine.Fo(c,h).then((()=>{this.Zs=n}))}co(e){this.Zs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}lo(e){let t=H0();return e.forEach(((n,s)=>{t=t.unionWith(s.activeTargetIds)})),t}}class CC{constructor(){this.Mo=new Rv,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,n){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Rv,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yU{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hI="ConnectivityMonitor";class dI{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ae(hI,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ae(hI,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wm=null;function Cv(){return wm===null?wm=(function(){return 268435456+Math.round(2147483648*Math.random())})():wm++,"0x"+wm.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M_="RestConnection",_U={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class vU{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${n}/databases/${s}`,this.Wo=this.databaseId.database===mv?`project_id=${n}`:`project_id=${n}&database_id=${s}`}Go(e,t,n,s,o){const c=Cv(),h=this.zo(e,t.toUriEncodedString());ae(M_,`Sending RPC '${e}' ${c}:`,h,n);const d={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(d,s,o);const{host:m}=new URL(h),y=jc(m);return this.Jo(e,h,d,n,y).then((_=>(ae(M_,`Received RPC '${e}' ${c}: `,_),_)),(_=>{throw Pi(M_,`RPC '${e}' ${c} failed with error: `,_,"url: ",h,"request:",n),_}))}Ho(e,t,n,s,o,c){return this.Go(e,t,n,s,o)}jo(e,t,n){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+zc})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((s,o)=>e[o]=s)),n&&n.headers.forEach(((s,o)=>e[o]=s))}zo(e,t){const n=_U[e];return`${this.Uo}/v1/${t}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wU{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tn="WebChannelConnection";class bU extends vU{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,s,o){const c=Cv();return new Promise(((h,d)=>{const m=new MR;m.setWithCredentials(!0),m.listenOnce(jR.COMPLETE,(()=>{try{switch(m.getLastErrorCode()){case Mm.NO_ERROR:const _=m.getResponseJson();ae(Tn,`XHR for RPC '${e}' ${c} received:`,JSON.stringify(_)),h(_);break;case Mm.TIMEOUT:ae(Tn,`RPC '${e}' ${c} timed out`),d(new ie(Q.DEADLINE_EXCEEDED,"Request time out"));break;case Mm.HTTP_ERROR:const E=m.getStatus();if(ae(Tn,`RPC '${e}' ${c} failed with status:`,E,"response text:",m.getResponseText()),E>0){let S=m.getResponseJson();Array.isArray(S)&&(S=S[0]);const C=S==null?void 0:S.error;if(C&&C.status&&C.message){const k=(function(G){const J=G.toLowerCase().replace(/_/g,"-");return Object.values(Q).indexOf(J)>=0?J:Q.UNKNOWN})(C.status);d(new ie(k,C.message))}else d(new ie(Q.UNKNOWN,"Server responded with status "+m.getStatus()))}else d(new ie(Q.UNAVAILABLE,"Connection failed."));break;default:_e(9055,{l_:e,streamId:c,h_:m.getLastErrorCode(),P_:m.getLastError()})}}finally{ae(Tn,`RPC '${e}' ${c} completed.`)}}));const y=JSON.stringify(s);ae(Tn,`RPC '${e}' ${c} sending request:`,s),m.send(t,"POST",y,n,15)}))}T_(e,t,n){const s=Cv(),o=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=BR(),h=UR(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(d.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(d.useFetchStreams=!0),this.jo(d.initMessageHeaders,t,n),d.encodeInitMessageHeaders=!0;const y=o.join("");ae(Tn,`Creating RPC '${e}' stream ${s}: ${y}`,d);const _=c.createWebChannel(y,d);this.I_(_);let E=!1,S=!1;const C=new wU({Yo:N=>{S?ae(Tn,`Not sending because RPC '${e}' stream ${s} is closed:`,N):(E||(ae(Tn,`Opening RPC '${e}' stream ${s} transport.`),_.open(),E=!0),ae(Tn,`RPC '${e}' stream ${s} sending:`,N),_.send(N))},Zo:()=>_.close()}),k=(N,G,J)=>{N.listen(G,(K=>{try{J(K)}catch(se){setTimeout((()=>{throw se}),0)}}))};return k(_,yh.EventType.OPEN,(()=>{S||(ae(Tn,`RPC '${e}' stream ${s} transport opened.`),C.o_())})),k(_,yh.EventType.CLOSE,(()=>{S||(S=!0,ae(Tn,`RPC '${e}' stream ${s} transport closed`),C.a_(),this.E_(_))})),k(_,yh.EventType.ERROR,(N=>{S||(S=!0,Pi(Tn,`RPC '${e}' stream ${s} transport errored. Name:`,N.name,"Message:",N.message),C.a_(new ie(Q.UNAVAILABLE,"The operation could not be completed")))})),k(_,yh.EventType.MESSAGE,(N=>{var G;if(!S){const J=N.data[0];be(!!J,16349);const K=J,se=(K==null?void 0:K.error)||((G=K[0])==null?void 0:G.error);if(se){ae(Tn,`RPC '${e}' stream ${s} received error:`,se);const ye=se.status;let he=(function(O){const L=Qt[O];if(L!==void 0)return z1(L)})(ye),R=se.message;he===void 0&&(he=Q.INTERNAL,R="Unknown error status: "+ye+" with message "+se.message),S=!0,C.a_(new ie(he,R)),_.close()}else ae(Tn,`RPC '${e}' stream ${s} received:`,J),C.u_(J)}})),k(h,LR.STAT_EVENT,(N=>{N.stat===ov.PROXY?ae(Tn,`RPC '${e}' stream ${s} detected buffering proxy`):N.stat===ov.NOPROXY&&ae(Tn,`RPC '${e}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{C.__()}),0),C}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kC(){return typeof window<"u"?window:null}function Gm(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cd(r){return new IL(r,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cw{constructor(e,t,n=1e3,s=1.5,o=6e4){this.Mi=e,this.timerId=t,this.d_=n,this.A_=s,this.R_=o,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),s=Math.max(0,t-n);s>0&&ae("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fI="PersistentStream";class NC{constructor(e,t,n,s,o,c,h,d){this.Mi=e,this.S_=n,this.b_=s,this.connection=o,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=h,this.listener=d,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new cw(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===Q.RESOURCE_EXHAUSTED?(jt(t.toString()),jt("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Q.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([n,s])=>{this.D_===t&&this.G_(n,s)}),(n=>{e((()=>{const s=new ie(Q.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(s)}))}))}G_(e,t){const n=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{n((()=>this.listener.Xo()))})),this.stream.t_((()=>{n((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((s=>{n((()=>this.z_(s)))})),this.stream.onMessage((s=>{n((()=>++this.F_==1?this.J_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return ae(fI,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(ae(fI,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class EU extends NC{constructor(e,t,n,s,o,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,s,c),this.serializer=o}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=CL(this.serializer,e),n=(function(o){if(!("targetChange"in o))return Se.min();const c=o.targetChange;return c.targetIds&&c.targetIds.length?Se.min():c.readTime?Lt(c.readTime):Se.min()})(e);return this.listener.H_(t,n)}Y_(e){const t={};t.database=Tv(this.serializer),t.addTarget=(function(o,c){let h;const d=c.target;if(h=ag(d)?{documents:X1(o,d)}:{query:Z1(o,d).ft},h.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){h.resumeToken=G1(o,c.resumeToken);const m=bv(o,c.expectedCount);m!==null&&(h.expectedCount=m)}else if(c.snapshotVersion.compareTo(Se.min())>0){h.readTime=xc(o,c.snapshotVersion.toTimestamp());const m=bv(o,c.expectedCount);m!==null&&(h.expectedCount=m)}return h})(this.serializer,e);const n=NL(this.serializer,e);n&&(t.labels=n),this.q_(t)}Z_(e){const t={};t.database=Tv(this.serializer),t.removeTarget=e,this.q_(t)}}class TU extends NC{constructor(e,t,n,s,o,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,s,c),this.serializer=o}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return be(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,be(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){be(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=kL(e.writeResults,e.commitTime),n=Lt(e.commitTime);return this.listener.na(n,t)}ra(){const e={};e.database=Tv(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((n=>id(this.serializer,n)))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SU{}class AU extends SU{constructor(e,t,n,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new ie(Q.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,n,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,c])=>this.connection.Go(e,Ev(t,n),s,o,c))).catch((o=>{throw o.name==="FirebaseError"?(o.code===Q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ie(Q.UNKNOWN,o.toString())}))}Ho(e,t,n,s,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,h])=>this.connection.Ho(e,Ev(t,n),s,c,h,o))).catch((c=>{throw c.name==="FirebaseError"?(c.code===Q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new ie(Q.UNKNOWN,c.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class IU{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(jt(t),this.aa=!1):ae("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uo="RemoteStore";class xU{constructor(e,t,n,s,o){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=o,this.Aa.Oo((c=>{n.enqueueAndForget((async()=>{Ia(this)&&(ae(Uo,"Restarting streams for network reachability change."),await(async function(d){const m=pe(d);m.Ea.add(4),await Gc(m),m.Ra.set("Unknown"),m.Ea.delete(4),await kd(m)})(this))}))})),this.Ra=new IU(n,s)}}async function kd(r){if(Ia(r))for(const e of r.da)await e(!0)}async function Gc(r){for(const e of r.da)await e(!1)}function Jg(r,e){const t=pe(r);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),dw(t)?hw(t):Wc(t).O_()&&uw(t,e))}function kc(r,e){const t=pe(r),n=Wc(t);t.Ia.delete(e),n.O_()&&OC(t,e),t.Ia.size===0&&(n.O_()?n.L_():Ia(t)&&t.Ra.set("Unknown"))}function uw(r,e){if(r.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Se.min())>0){const t=r.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Wc(r).Y_(e)}function OC(r,e){r.Va.Ue(e),Wc(r).Z_(e)}function hw(r){r.Va=new EL({getRemoteKeysForTarget:e=>r.remoteSyncer.getRemoteKeysForTarget(e),At:e=>r.Ia.get(e)||null,ht:()=>r.datastore.serializer.databaseId}),Wc(r).start(),r.Ra.ua()}function dw(r){return Ia(r)&&!Wc(r).x_()&&r.Ia.size>0}function Ia(r){return pe(r).Ea.size===0}function PC(r){r.Va=void 0}async function RU(r){r.Ra.set("Online")}async function CU(r){r.Ia.forEach(((e,t)=>{uw(r,e)}))}async function kU(r,e){PC(r),dw(r)?(r.Ra.ha(e),hw(r)):r.Ra.set("Unknown")}async function NU(r,e,t){if(r.Ra.set("Online"),e instanceof H1&&e.state===2&&e.cause)try{await(async function(s,o){const c=o.cause;for(const h of o.targetIds)s.Ia.has(h)&&(await s.remoteSyncer.rejectListen(h,c),s.Ia.delete(h),s.Va.removeTarget(h))})(r,e)}catch(n){ae(Uo,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await pg(r,n)}else if(e instanceof $m?r.Va.Ze(e):e instanceof $1?r.Va.st(e):r.Va.tt(e),!t.isEqual(Se.min()))try{const n=await bC(r.localStore);t.compareTo(n)>=0&&await(function(o,c){const h=o.Va.Tt(c);return h.targetChanges.forEach(((d,m)=>{if(d.resumeToken.approximateByteSize()>0){const y=o.Ia.get(m);y&&o.Ia.set(m,y.withResumeToken(d.resumeToken,c))}})),h.targetMismatches.forEach(((d,m)=>{const y=o.Ia.get(d);if(!y)return;o.Ia.set(d,y.withResumeToken(kt.EMPTY_BYTE_STRING,y.snapshotVersion)),OC(o,d);const _=new ns(y.target,d,m,y.sequenceNumber);uw(o,_)})),o.remoteSyncer.applyRemoteEvent(h)})(r,t)}catch(n){ae(Uo,"Failed to raise snapshot:",n),await pg(r,n)}}async function pg(r,e,t){if(!Sa(e))throw e;r.Ea.add(1),await Gc(r),r.Ra.set("Offline"),t||(t=()=>bC(r.localStore)),r.asyncQueue.enqueueRetryable((async()=>{ae(Uo,"Retrying IndexedDB access"),await t(),r.Ea.delete(1),await kd(r)}))}function DC(r,e){return e().catch((t=>pg(r,t,e)))}async function Kc(r){const e=pe(r),t=_a(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:oa;for(;OU(e);)try{const s=await mU(e.localStore,n);if(s===null){e.Ta.length===0&&t.L_();break}n=s.batchId,PU(e,s)}catch(s){await pg(e,s)}VC(e)&&MC(e)}function OU(r){return Ia(r)&&r.Ta.length<10}function PU(r,e){r.Ta.push(e);const t=_a(r);t.O_()&&t.X_&&t.ea(e.mutations)}function VC(r){return Ia(r)&&!_a(r).x_()&&r.Ta.length>0}function MC(r){_a(r).start()}async function DU(r){_a(r).ra()}async function VU(r){const e=_a(r);for(const t of r.Ta)e.ea(t.mutations)}async function MU(r,e,t){const n=r.Ta.shift(),s=Q0.from(n,e,t);await DC(r,(()=>r.remoteSyncer.applySuccessfulWrite(s))),await Kc(r)}async function jU(r,e){e&&_a(r).X_&&await(async function(n,s){if((function(c){return F1(c)&&c!==Q.ABORTED})(s.code)){const o=n.Ta.shift();_a(n).B_(),await DC(n,(()=>n.remoteSyncer.rejectFailedWrite(o.batchId,s))),await Kc(n)}})(r,e),VC(r)&&MC(r)}async function mI(r,e){const t=pe(r);t.asyncQueue.verifyOperationInProgress(),ae(Uo,"RemoteStore received new credentials");const n=Ia(t);t.Ea.add(3),await Gc(t),n&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await kd(t)}async function kv(r,e){const t=pe(r);e?(t.Ea.delete(2),await kd(t)):e||(t.Ea.add(2),await Gc(t),t.Ra.set("Unknown"))}function Wc(r){return r.ma||(r.ma=(function(t,n,s){const o=pe(t);return o.sa(),new EU(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,s)})(r.datastore,r.asyncQueue,{Xo:RU.bind(null,r),t_:CU.bind(null,r),r_:kU.bind(null,r),H_:NU.bind(null,r)}),r.da.push((async e=>{e?(r.ma.B_(),dw(r)?hw(r):r.Ra.set("Unknown")):(await r.ma.stop(),PC(r))}))),r.ma}function _a(r){return r.fa||(r.fa=(function(t,n,s){const o=pe(t);return o.sa(),new TU(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,s)})(r.datastore,r.asyncQueue,{Xo:()=>Promise.resolve(),t_:DU.bind(null,r),r_:jU.bind(null,r),ta:VU.bind(null,r),na:MU.bind(null,r)}),r.da.push((async e=>{e?(r.fa.B_(),await Kc(r)):(await r.fa.stop(),r.Ta.length>0&&(ae(Uo,`Stopping write stream with ${r.Ta.length} pending writes`),r.Ta=[]))}))),r.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fw{constructor(e,t,n,s,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=s,this.removalCallback=o,this.deferred=new wn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((c=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,s,o){const c=Date.now()+n,h=new fw(e,t,c,s,o);return h.start(n),h}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ie(Q.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Qc(r,e){if(jt("AsyncQueue",`${e}: ${r}`),Sa(r))return new ie(Q.UNAVAILABLE,`${e}: ${r}`);throw r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uc{static emptySet(e){return new uc(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||ge.comparator(t.key,n.key):(t,n)=>ge.comparator(t.key,n.key),this.keyedMap=_h(),this.sortedSet=new mt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof uc)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,o=n.getNext().key;if(!s.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new uc;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gI{constructor(){this.ga=new mt(ge.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(t,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(t):e.type===1&&n.type===2?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):_e(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,n)=>{e.push(n)})),e}}class Nc{constructor(e,t,n,s,o,c,h,d,m){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=o,this.fromCache=c,this.syncStateChanged=h,this.excludesMetadataChanges=d,this.hasCachedResults=m}static fromInitialDocuments(e,t,n,s,o){const c=[];return t.forEach((h=>{c.push({type:0,doc:h})})),new Nc(e,t,uc.emptySet(t),c,n,s,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Sd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==n[s].type||!t[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LU{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class UU{constructor(){this.queries=pI(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,n){const s=pe(t),o=s.queries;s.queries=pI(),o.forEach(((c,h)=>{for(const d of h.Sa)d.onError(n)}))})(this,new ie(Q.ABORTED,"Firestore shutting down"))}}function pI(){return new hs((r=>x1(r)),Sd)}async function mw(r,e){const t=pe(r);let n=3;const s=e.query;let o=t.queries.get(s);o?!o.ba()&&e.Da()&&(n=2):(o=new LU,n=e.Da()?0:1);try{switch(n){case 0:o.wa=await t.onListen(s,!0);break;case 1:o.wa=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(c){const h=Qc(c,`Initialization of query '${Xl(e.query)}' failed`);return void e.onError(h)}t.queries.set(s,o),o.Sa.push(e),e.va(t.onlineState),o.wa&&e.Fa(o.wa)&&pw(t)}async function gw(r,e){const t=pe(r),n=e.query;let s=3;const o=t.queries.get(n);if(o){const c=o.Sa.indexOf(e);c>=0&&(o.Sa.splice(c,1),o.Sa.length===0?s=e.Da()?0:1:!o.ba()&&e.Da()&&(s=2))}switch(s){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function BU(r,e){const t=pe(r);let n=!1;for(const s of e){const o=s.query,c=t.queries.get(o);if(c){for(const h of c.Sa)h.Fa(s)&&(n=!0);c.wa=s}}n&&pw(t)}function FU(r,e,t){const n=pe(r),s=n.queries.get(e);if(s)for(const o of s.Sa)o.onError(t);n.queries.delete(e)}function pw(r){r.Ca.forEach((e=>{e.next()}))}var Nv,yI;(yI=Nv||(Nv={})).Ma="default",yI.Cache="cache";class yw{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const s of e.docChanges)s.type!==3&&n.push(s);e=new Nc(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const n=t!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Nc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Nv.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zU{constructor(e,t){this.Qa=e,this.byteLength=t}$a(){return"metadata"in this.Qa}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _I{constructor(e){this.serializer=e}$s(e){return Ci(this.serializer,e)}Us(e){return e.metadata.exists?J1(this.serializer,e.document,!1):yt.newNoDocument(this.$s(e.metadata.name),this.Ks(e.metadata.readTime))}Ks(e){return Lt(e)}}class qU{constructor(e,t){this.Ua=e,this.serializer=t,this.Ka=[],this.Wa=[],this.collectionGroups=new Set,this.progress=jC(e)}get queries(){return this.Ka}get documents(){return this.Wa}Ga(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Qa.namedQuery)this.Ka.push(e.Qa.namedQuery);else if(e.Qa.documentMetadata){this.Wa.push({metadata:e.Qa.documentMetadata}),e.Qa.documentMetadata.exists||++t;const n=ze.fromString(e.Qa.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.Qa.document&&(this.Wa[this.Wa.length-1].document=e.Qa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,{...this.progress}):null}za(e){const t=new Map,n=new _I(this.serializer);for(const s of e)if(s.metadata.queries){const o=n.$s(s.metadata.name);for(const c of s.metadata.queries){const h=(t.get(c)||Me()).add(o);t.set(c,h)}}return t}async ja(e){const t=await gU(e,new _I(this.serializer),this.Wa,this.Ua.id),n=this.za(this.documents);for(const s of this.Ka)await pU(e,s,n.get(s.name));return this.progress.taskState="Success",{progress:this.progress,Ja:this.collectionGroups,Ha:t}}}function jC(r){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:r.totalDocuments,totalBytes:r.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LC{constructor(e){this.key=e}}class UC{constructor(e){this.key=e}}class BC{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Me(),this.mutatedKeys=Me(),this.eu=C1(e),this.tu=new uc(this.eu)}get nu(){return this.Ya}ru(e,t){const n=t?t.iu:new gI,s=t?t.tu:this.tu;let o=t?t.mutatedKeys:this.mutatedKeys,c=s,h=!1;const d=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,m=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(((y,_)=>{const E=s.get(y),S=Ad(this.query,_)?_:null,C=!!E&&this.mutatedKeys.has(E.key),k=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations);let N=!1;E&&S?E.data.isEqual(S.data)?C!==k&&(n.track({type:3,doc:S}),N=!0):this.su(E,S)||(n.track({type:2,doc:S}),N=!0,(d&&this.eu(S,d)>0||m&&this.eu(S,m)<0)&&(h=!0)):!E&&S?(n.track({type:0,doc:S}),N=!0):E&&!S&&(n.track({type:1,doc:E}),N=!0,(d||m)&&(h=!0)),N&&(S?(c=c.add(S),o=k?o.add(y):o.delete(y)):(c=c.delete(y),o=o.delete(y)))})),this.query.limit!==null)for(;c.size>this.query.limit;){const y=this.query.limitType==="F"?c.last():c.first();c=c.delete(y.key),o=o.delete(y.key),n.track({type:1,doc:y})}return{tu:c,iu:n,Cs:h,mutatedKeys:o}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,s){const o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const c=e.iu.ya();c.sort(((y,_)=>(function(S,C){const k=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return _e(20277,{Rt:N})}};return k(S)-k(C)})(y.type,_.type)||this.eu(y.doc,_.doc))),this.ou(n),s=s??!1;const h=t&&!s?this._u():[],d=this.Xa.size===0&&this.current&&!s?1:0,m=d!==this.Za;return this.Za=d,c.length!==0||m?{snapshot:new Nc(this.query,e.tu,o,c,e.mutatedKeys,d===0,m,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:h}:{au:h}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new gI,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Me(),this.tu.forEach((n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))}));const t=[];return e.forEach((n=>{this.Xa.has(n)||t.push(new UC(n))})),this.Xa.forEach((n=>{e.has(n)||t.push(new LC(n))})),t}cu(e){this.Ya=e.Qs,this.Xa=Me();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Nc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const xa="SyncEngine";class $U{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class HU{constructor(e){this.key=e,this.hu=!1}}class GU{constructor(e,t,n,s,o,c){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=s,this.currentUser=o,this.maxConcurrentLimboResolutions=c,this.Pu={},this.Tu=new hs((h=>x1(h)),Sd),this.Iu=new Map,this.Eu=new Set,this.du=new mt(ge.comparator),this.Au=new Map,this.Ru=new nw,this.Vu={},this.mu=new Map,this.fu=Lo.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function KU(r,e,t=!0){const n=Xg(r);let s;const o=n.Tu.get(e);return o?(n.sharedClientState.addLocalQueryTarget(o.targetId),s=o.view.lu()):s=await FC(n,e,t,!0),s}async function WU(r,e){const t=Xg(r);await FC(t,e,!0,!1)}async function FC(r,e,t,n){const s=await Rc(r.localStore,Mn(e)),o=s.targetId,c=r.sharedClientState.addLocalQueryTarget(o,t);let h;return n&&(h=await _w(r,e,o,c==="current",s.resumeToken)),r.isPrimaryClient&&t&&Jg(r.remoteStore,s),h}async function _w(r,e,t,n,s){r.pu=(_,E,S)=>(async function(k,N,G,J){let K=N.view.ru(G);K.Cs&&(K=await fg(k.localStore,N.query,!1).then((({documents:R})=>N.view.ru(R,K))));const se=J&&J.targetChanges.get(N.targetId),ye=J&&J.targetMismatches.get(N.targetId)!=null,he=N.view.applyChanges(K,k.isPrimaryClient,se,ye);return Ov(k,N.targetId,he.au),he.snapshot})(r,_,E,S);const o=await fg(r.localStore,e,!0),c=new BC(e,o.Qs),h=c.ru(o.documents),d=Rd.createSynthesizedTargetChangeForCurrentChange(t,n&&r.onlineState!=="Offline",s),m=c.applyChanges(h,r.isPrimaryClient,d);Ov(r,t,m.au);const y=new $U(e,t,c);return r.Tu.set(e,y),r.Iu.has(t)?r.Iu.get(t).push(e):r.Iu.set(t,[e]),m.snapshot}async function QU(r,e,t){const n=pe(r),s=n.Tu.get(e),o=n.Iu.get(s.targetId);if(o.length>1)return n.Iu.set(s.targetId,o.filter((c=>!Sd(c,e)))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await Cc(n.localStore,s.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(s.targetId),t&&kc(n.remoteStore,s.targetId),Oc(n,s.targetId)})).catch(Ta)):(Oc(n,s.targetId),await Cc(n.localStore,s.targetId,!0))}async function YU(r,e){const t=pe(r),n=t.Tu.get(e),s=t.Iu.get(n.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),kc(t.remoteStore,n.targetId))}async function JU(r,e,t){const n=Ew(r);try{const s=await(function(c,h){const d=pe(c),m=tt.now(),y=h.reduce(((S,C)=>S.add(C.key)),Me());let _,E;return d.persistence.runTransaction("Locally write mutations","readwrite",(S=>{let C=Qn(),k=Me();return d.Ns.getEntries(S,y).next((N=>{C=N,C.forEach(((G,J)=>{J.isValidDocument()||(k=k.add(G))}))})).next((()=>d.localDocuments.getOverlayedDocuments(S,C))).next((N=>{_=N;const G=[];for(const J of h){const K=vL(J,_.get(J.key).overlayedDocument);K!=null&&G.push(new ds(J.key,K,_1(K.value.mapValue),St.exists(!0)))}return d.mutationQueue.addMutationBatch(S,m,G,h)})).next((N=>{E=N;const G=N.applyToLocalDocumentSet(_,k);return d.documentOverlayCache.saveOverlays(S,N.batchId,G)}))})).then((()=>({batchId:E.batchId,changes:N1(_)})))})(n.localStore,e);n.sharedClientState.addPendingMutation(s.batchId),(function(c,h,d){let m=c.Vu[c.currentUser.toKey()];m||(m=new mt(Oe)),m=m.insert(h,d),c.Vu[c.currentUser.toKey()]=m})(n,s.batchId,t),await fs(n,s.changes),await Kc(n.remoteStore)}catch(s){const o=Qc(s,"Failed to persist write");t.reject(o)}}async function zC(r,e){const t=pe(r);try{const n=await fU(t.localStore,e);e.targetChanges.forEach(((s,o)=>{const c=t.Au.get(o);c&&(be(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?c.hu=!0:s.modifiedDocuments.size>0?be(c.hu,14607):s.removedDocuments.size>0&&(be(c.hu,42227),c.hu=!1))})),await fs(t,n,e)}catch(n){await Ta(n)}}function vI(r,e,t){const n=pe(r);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const s=[];n.Tu.forEach(((o,c)=>{const h=c.view.va(e);h.snapshot&&s.push(h.snapshot)})),(function(c,h){const d=pe(c);d.onlineState=h;let m=!1;d.queries.forEach(((y,_)=>{for(const E of _.Sa)E.va(h)&&(m=!0)})),m&&pw(d)})(n.eventManager,e),s.length&&n.Pu.H_(s),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function XU(r,e,t){const n=pe(r);n.sharedClientState.updateQueryState(e,"rejected",t);const s=n.Au.get(e),o=s&&s.key;if(o){let c=new mt(ge.comparator);c=c.insert(o,yt.newNoDocument(o,Se.min()));const h=Me().add(o),d=new xd(Se.min(),new Map,new mt(Oe),c,h);await zC(n,d),n.du=n.du.remove(o),n.Au.delete(e),bw(n)}else await Cc(n.localStore,e,!1).then((()=>Oc(n,e,t))).catch(Ta)}async function ZU(r,e){const t=pe(r),n=e.batch.batchId;try{const s=await dU(t.localStore,e);ww(t,n,null),vw(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await fs(t,s)}catch(s){await Ta(s)}}async function e6(r,e,t){const n=pe(r);try{const s=await(function(c,h){const d=pe(c);return d.persistence.runTransaction("Reject batch","readwrite-primary",(m=>{let y;return d.mutationQueue.lookupMutationBatch(m,h).next((_=>(be(_!==null,37113),y=_.keys(),d.mutationQueue.removeMutationBatch(m,_)))).next((()=>d.mutationQueue.performConsistencyCheck(m))).next((()=>d.documentOverlayCache.removeOverlaysForBatchId(m,y,h))).next((()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,y))).next((()=>d.localDocuments.getDocuments(m,y)))}))})(n.localStore,e);ww(n,e,t),vw(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await fs(n,s)}catch(s){await Ta(s)}}async function t6(r,e){const t=pe(r);Ia(t.remoteStore)||ae(xa,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const n=await(function(c){const h=pe(c);return h.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(d=>h.mutationQueue.getHighestUnacknowledgedBatchId(d)))})(t.localStore);if(n===oa)return void e.resolve();const s=t.mu.get(n)||[];s.push(e),t.mu.set(n,s)}catch(n){const s=Qc(n,"Initialization of waitForPendingWrites() operation failed");e.reject(s)}}function vw(r,e){(r.mu.get(e)||[]).forEach((t=>{t.resolve()})),r.mu.delete(e)}function ww(r,e,t){const n=pe(r);let s=n.Vu[n.currentUser.toKey()];if(s){const o=s.get(e);o&&(t?o.reject(t):o.resolve(),s=s.remove(e)),n.Vu[n.currentUser.toKey()]=s}}function Oc(r,e,t=null){r.sharedClientState.removeLocalQueryTarget(e);for(const n of r.Iu.get(e))r.Tu.delete(n),t&&r.Pu.yu(n,t);r.Iu.delete(e),r.isPrimaryClient&&r.Ru.jr(e).forEach((n=>{r.Ru.containsKey(n)||qC(r,n)}))}function qC(r,e){r.Eu.delete(e.path.canonicalString());const t=r.du.get(e);t!==null&&(kc(r.remoteStore,t),r.du=r.du.remove(e),r.Au.delete(t),bw(r))}function Ov(r,e,t){for(const n of t)n instanceof LC?(r.Ru.addReference(n.key,e),n6(r,n)):n instanceof UC?(ae(xa,"Document no longer in limbo: "+n.key),r.Ru.removeReference(n.key,e),r.Ru.containsKey(n.key)||qC(r,n.key)):_e(19791,{wu:n})}function n6(r,e){const t=e.key,n=t.path.canonicalString();r.du.get(t)||r.Eu.has(n)||(ae(xa,"New document in limbo: "+t),r.Eu.add(n),bw(r))}function bw(r){for(;r.Eu.size>0&&r.du.size<r.maxConcurrentLimboResolutions;){const e=r.Eu.values().next().value;r.Eu.delete(e);const t=new ge(ze.fromString(e)),n=r.fu.next();r.Au.set(n,new HU(t)),r.du=r.du.insert(t,n),Jg(r.remoteStore,new ns(Mn(qc(t.path)),n,"TargetPurposeLimboResolution",Kn.ce))}}async function fs(r,e,t){const n=pe(r),s=[],o=[],c=[];n.Tu.isEmpty()||(n.Tu.forEach(((h,d)=>{c.push(n.pu(d,e,t).then((m=>{var y;if((m||t)&&n.isPrimaryClient){const _=m?!m.fromCache:(y=t==null?void 0:t.targetChanges.get(d.targetId))==null?void 0:y.current;n.sharedClientState.updateQueryState(d.targetId,_?"current":"not-current")}if(m){s.push(m);const _=aw.As(d.targetId,m);o.push(_)}})))})),await Promise.all(c),n.Pu.H_(s),await(async function(d,m){const y=pe(d);try{await y.persistence.runTransaction("notifyLocalViewChanges","readwrite",(_=>F.forEach(m,(E=>F.forEach(E.Es,(S=>y.persistence.referenceDelegate.addReference(_,E.targetId,S))).next((()=>F.forEach(E.ds,(S=>y.persistence.referenceDelegate.removeReference(_,E.targetId,S)))))))))}catch(_){if(!Sa(_))throw _;ae(ow,"Failed to update sequence numbers: "+_)}for(const _ of m){const E=_.targetId;if(!_.fromCache){const S=y.Ms.get(E),C=S.snapshotVersion,k=S.withLastLimboFreeSnapshotVersion(C);y.Ms=y.Ms.insert(E,k)}}})(n.localStore,o))}async function r6(r,e){const t=pe(r);if(!t.currentUser.isEqual(e)){ae(xa,"User change. New user:",e.toKey());const n=await wC(t.localStore,e);t.currentUser=e,(function(o,c){o.mu.forEach((h=>{h.forEach((d=>{d.reject(new ie(Q.CANCELLED,c))}))})),o.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await fs(t,n.Ls)}}function i6(r,e){const t=pe(r),n=t.Au.get(e);if(n&&n.hu)return Me().add(n.key);{let s=Me();const o=t.Iu.get(e);if(!o)return s;for(const c of o){const h=t.Tu.get(c);s=s.unionWith(h.view.nu)}return s}}async function s6(r,e){const t=pe(r),n=await fg(t.localStore,e.query,!0),s=e.view.cu(n);return t.isPrimaryClient&&Ov(t,e.targetId,s.au),s}async function a6(r,e){const t=pe(r);return SC(t.localStore,e).then((n=>fs(t,n)))}async function o6(r,e,t,n){const s=pe(r),o=await(function(h,d){const m=pe(h),y=pe(m.mutationQueue);return m.persistence.runTransaction("Lookup mutation documents","readonly",(_=>y.er(_,d).next((E=>E?m.localDocuments.getDocuments(_,E):F.resolve(null)))))})(s.localStore,e);o!==null?(t==="pending"?await Kc(s.remoteStore):t==="acknowledged"||t==="rejected"?(ww(s,e,n||null),vw(s,e),(function(h,d){pe(pe(h).mutationQueue).ir(d)})(s.localStore,e)):_e(6720,"Unknown batchState",{Su:t}),await fs(s,o)):ae(xa,"Cannot apply mutation batch with id: "+e)}async function l6(r,e){const t=pe(r);if(Xg(t),Ew(t),e===!0&&t.gu!==!0){const n=t.sharedClientState.getAllActiveQueryTargets(),s=await wI(t,n.toArray());t.gu=!0,await kv(t.remoteStore,!0);for(const o of s)Jg(t.remoteStore,o)}else if(e===!1&&t.gu!==!1){const n=[];let s=Promise.resolve();t.Iu.forEach(((o,c)=>{t.sharedClientState.isLocalQueryTarget(c)?n.push(c):s=s.then((()=>(Oc(t,c),Cc(t.localStore,c,!0)))),kc(t.remoteStore,c)})),await s,await wI(t,n),(function(c){const h=pe(c);h.Au.forEach(((d,m)=>{kc(h.remoteStore,m)})),h.Ru.Jr(),h.Au=new Map,h.du=new mt(ge.comparator)})(t),t.gu=!1,await kv(t.remoteStore,!1)}}async function wI(r,e,t){const n=pe(r),s=[],o=[];for(const c of e){let h;const d=n.Iu.get(c);if(d&&d.length!==0){h=await Rc(n.localStore,Mn(d[0]));for(const m of d){const y=n.Tu.get(m),_=await s6(n,y);_.snapshot&&o.push(_.snapshot)}}else{const m=await TC(n.localStore,c);h=await Rc(n.localStore,m),await _w(n,$C(m),c,!1,h.resumeToken)}s.push(h)}return n.Pu.H_(o),s}function $C(r){return I1(r.path,r.collectionGroup,r.orderBy,r.filters,r.limit,"F",r.startAt,r.endAt)}function c6(r){return(function(t){return pe(pe(t).persistence).Ts()})(pe(r).localStore)}async function u6(r,e,t,n){const s=pe(r);if(s.gu)return void ae(xa,"Ignoring unexpected query state notification.");const o=s.Iu.get(e);if(o&&o.length>0)switch(t){case"current":case"not-current":{const c=await SC(s.localStore,R1(o[0])),h=xd.createSynthesizedRemoteEventForCurrentChange(e,t==="current",kt.EMPTY_BYTE_STRING);await fs(s,c,h);break}case"rejected":await Cc(s.localStore,e,!0),Oc(s,e,n);break;default:_e(64155,t)}}async function h6(r,e,t){const n=Xg(r);if(n.gu){for(const s of e){if(n.Iu.has(s)&&n.sharedClientState.isActiveQueryTarget(s)){ae(xa,"Adding an already active target "+s);continue}const o=await TC(n.localStore,s),c=await Rc(n.localStore,o);await _w(n,$C(o),c.targetId,!1,c.resumeToken),Jg(n.remoteStore,c)}for(const s of t)n.Iu.has(s)&&await Cc(n.localStore,s,!1).then((()=>{kc(n.remoteStore,s),Oc(n,s)})).catch(Ta)}}function Xg(r){const e=pe(r);return e.remoteStore.remoteSyncer.applyRemoteEvent=zC.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=i6.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=XU.bind(null,e),e.Pu.H_=BU.bind(null,e.eventManager),e.Pu.yu=FU.bind(null,e.eventManager),e}function Ew(r){const e=pe(r);return e.remoteStore.remoteSyncer.applySuccessfulWrite=ZU.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=e6.bind(null,e),e}function d6(r,e,t){const n=pe(r);(async function(o,c,h){try{const d=await c.getMetadata();if(await(function(S,C){const k=pe(S),N=Lt(C.createTime);return k.persistence.runTransaction("hasNewerBundle","readonly",(G=>k.Ii.getBundleMetadata(G,C.id))).then((G=>!!G&&G.createTime.compareTo(N)>=0))})(o.localStore,d))return await c.close(),h._completeWith((function(S){return{taskState:"Success",documentsLoaded:S.totalDocuments,bytesLoaded:S.totalBytes,totalDocuments:S.totalDocuments,totalBytes:S.totalBytes}})(d)),Promise.resolve(new Set);h._updateProgress(jC(d));const m=new qU(d,c.serializer);let y=await c.bu();for(;y;){const E=await m.Ga(y);E&&h._updateProgress(E),y=await c.bu()}const _=await m.ja(o.localStore);return await fs(o,_.Ha,void 0),await(function(S,C){const k=pe(S);return k.persistence.runTransaction("Save bundle","readwrite",(N=>k.Ii.saveBundleMetadata(N,C)))})(o.localStore,d),h._completeWith(_.progress),Promise.resolve(_.Ja)}catch(d){return Pi(xa,`Loading bundle failed with ${d}`),h._failWith(d),Promise.resolve(new Set)}})(n,e,t).then((s=>{n.sharedClientState.notifyBundleLoaded(s)}))}class sd{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Cd(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return vC(this.persistence,new _C,e.initialUser,this.serializer)}Cu(e){return new rw(Yg.mi,this.serializer)}Du(e){return new CC}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}sd.provider={build:()=>new sd};class f6 extends sd{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){be(this.persistence.referenceDelegate instanceof dg,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new dC(n,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?An.withCacheSize(this.cacheSizeBytes):An.DEFAULT;return new rw((n=>dg.mi(n,t)),this.serializer)}}class HC extends sd{constructor(e,t,n){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await Ew(this.xu.syncEngine),await Kc(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return vC(this.persistence,new _C,e.initialUser,this.serializer)}Fu(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new dC(n,e.asyncQueue,t)}Mu(e,t){const n=new E4(t,this.persistence);return new b4(e.asyncQueue,n)}Cu(e){const t=sw(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=this.cacheSizeBytes!==void 0?An.withCacheSize(this.cacheSizeBytes):An.DEFAULT;return new iw(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,kC(),Gm(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new CC}}class m6 extends HC{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xu.syncEngine;this.sharedClientState instanceof V_&&(this.sharedClientState.syncEngine={Co:o6.bind(null,t),vo:u6.bind(null,t),Fo:h6.bind(null,t),Ts:c6.bind(null,t),Do:a6.bind(null,t)},await this.sharedClientState.start()),await this.persistence.Ji((async n=>{await l6(this.xu.syncEngine,n),this.gcScheduler&&(n&&!this.gcScheduler.started?this.gcScheduler.start():n||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(n&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():n||this.indexBackfillerScheduler.stop())}))}Du(e){const t=kC();if(!V_.v(t))throw new ie(Q.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=sw(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new V_(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class ad{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>vI(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=r6.bind(null,this.syncEngine),await kv(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new UU})()}createDatastore(e){const t=Cd(e.databaseInfo.databaseId),n=(function(o){return new bU(o)})(e.databaseInfo);return(function(o,c,h,d){return new AU(o,c,h,d)})(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return(function(n,s,o,c,h){return new xU(n,s,o,c,h)})(this.localStore,this.datastore,e.asyncQueue,(t=>vI(this.syncEngine,t,0)),(function(){return dI.v()?new dI:new yU})())}createSyncEngine(e,t){return(function(s,o,c,h,d,m,y){const _=new GU(s,o,c,h,d,m);return y&&(_.gu=!0),_})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(s){const o=pe(s);ae(Uo,"RemoteStore shutting down."),o.Ea.add(5),await Gc(o),o.Aa.shutdown(),o.Ra.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}ad.provider={build:()=>new ad};function bI(r,e=10240){let t=0;return{async read(){if(t<r.byteLength){const n={value:r.slice(t,t+e),done:!1};return t+=e,n}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zg{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):jt("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g6{constructor(e,t){this.Bu=e,this.serializer=t,this.metadata=new wn,this.buffer=new Uint8Array,this.Lu=(function(){return new TextDecoder("utf-8")})(),this.ku().then((n=>{n&&n.$a()?this.metadata.resolve(n.Qa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(n==null?void 0:n.Qa)}`))}),(n=>this.metadata.reject(n)))}close(){return this.Bu.cancel()}async getMetadata(){return this.metadata.promise}async bu(){return await this.getMetadata(),this.ku()}async ku(){const e=await this.qu();if(e===null)return null;const t=this.Lu.decode(e),n=Number(t);isNaN(n)&&this.Qu(`length string (${t}) is not valid number`);const s=await this.$u(n);return new zU(JSON.parse(s),e.length+n)}Uu(){return this.buffer.findIndex((e=>e===123))}async qu(){for(;this.Uu()<0&&!await this.Ku(););if(this.buffer.length===0)return null;const e=this.Uu();e<0&&this.Qu("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async $u(e){for(;this.buffer.length<e;)await this.Ku()&&this.Qu("Reached the end of bundle when more is expected.");const t=this.Lu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}Qu(e){throw this.Bu.cancel(),new Error(`Invalid bundle format: ${e}`)}async Ku(){const e=await this.Bu.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p6{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new ie(Q.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await(async function(s,o){const c=pe(s),h={documents:o.map((_=>rd(c.serializer,_)))},d=await c.Ho("BatchGetDocuments",c.serializer.databaseId,ze.emptyPath(),h,o.length),m=new Map;d.forEach((_=>{const E=RL(c.serializer,_);m.set(E.key.toString(),E)}));const y=[];return o.forEach((_=>{const E=m.get(_.toString());be(!!E,55234,{key:_}),y.push(E)})),y})(this.datastore,e);return t.forEach((n=>this.recordVersion(n))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(n){this.lastTransactionError=n}this.writtenDocs.add(e.toString())}delete(e){this.write(new Hc(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((t,n)=>{const s=ge.fromPath(n);this.mutations.push(new K0(s,this.precondition(s)))})),await(async function(n,s){const o=pe(n),c={writes:s.map((h=>id(o.serializer,h)))};await o.Go("Commit",o.serializer.databaseId,ze.emptyPath(),c)})(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw _e(50498,{Gu:e.constructor.name});t=Se.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new ie(Q.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Se.min())?St.exists(!1):St.updateTime(t):St.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Se.min()))throw new ie(Q.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return St.updateTime(t)}return St.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y6{constructor(e,t,n,s,o){this.asyncQueue=e,this.datastore=t,this.options=n,this.updateFunction=s,this.deferred=o,this.zu=n.maxAttempts,this.M_=new cw(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Ju()}Ju(){this.M_.p_((async()=>{const e=new p6(this.datastore),t=this.Hu(e);t&&t.then((n=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(n)})).catch((s=>{this.Yu(s)}))))})).catch((n=>{this.Yu(n)}))}))}Hu(e){try{const t=this.updateFunction(e);return!bd(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Yu(e){this.zu>0&&this.Zu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget((()=>(this.Ju(),Promise.resolve())))):this.deferred.reject(e)}Zu(e){if((e==null?void 0:e.name)==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!F1(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const va="FirestoreClient";class _6{constructor(e,t,n,s,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=s,this.user=un.UNAUTHENTICATED,this.clientId=P0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(n,(async c=>{ae(va,"Received user=",c.uid),await this.authCredentialListener(c),this.user=c})),this.appCheckCredentials.start(n,(c=>(ae(va,"Received new app check token=",c),this.appCheckCredentialListener(c,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new wn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=Qc(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function j_(r,e){r.asyncQueue.verifyOperationInProgress(),ae(va,"Initializing OfflineComponentProvider");const t=r.configuration;await e.initialize(t);let n=t.initialUser;r.setCredentialChangeListener((async s=>{n.isEqual(s)||(await wC(e.localStore,s),n=s)})),e.persistence.setDatabaseDeletedListener((()=>r.terminate())),r._offlineComponents=e}async function EI(r,e){r.asyncQueue.verifyOperationInProgress();const t=await Tw(r);ae(va,"Initializing OnlineComponentProvider"),await e.initialize(t,r.configuration),r.setCredentialChangeListener((n=>mI(e.remoteStore,n))),r.setAppCheckTokenChangeListener(((n,s)=>mI(e.remoteStore,s))),r._onlineComponents=e}async function Tw(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){ae(va,"Using user provided OfflineComponentProvider");try{await j_(r,r._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(s){return s.name==="FirebaseError"?s.code===Q.FAILED_PRECONDITION||s.code===Q.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(t))throw t;Pi("Error using user provided cache. Falling back to memory cache: "+t),await j_(r,new sd)}}else ae(va,"Using default OfflineComponentProvider"),await j_(r,new f6(void 0));return r._offlineComponents}async function ep(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(ae(va,"Using user provided OnlineComponentProvider"),await EI(r,r._uninitializedComponentsProvider._online)):(ae(va,"Using default OnlineComponentProvider"),await EI(r,new ad))),r._onlineComponents}function GC(r){return Tw(r).then((e=>e.persistence))}function Sw(r){return Tw(r).then((e=>e.localStore))}function KC(r){return ep(r).then((e=>e.remoteStore))}function Aw(r){return ep(r).then((e=>e.syncEngine))}function v6(r){return ep(r).then((e=>e.datastore))}async function Pc(r){const e=await ep(r),t=e.eventManager;return t.onListen=KU.bind(null,e.syncEngine),t.onUnlisten=QU.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=WU.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=YU.bind(null,e.syncEngine),t}function w6(r){return r.asyncQueue.enqueue((async()=>{const e=await GC(r),t=await KC(r);return e.setNetworkEnabled(!0),(function(s){const o=pe(s);return o.Ea.delete(0),kd(o)})(t)}))}function b6(r){return r.asyncQueue.enqueue((async()=>{const e=await GC(r),t=await KC(r);return e.setNetworkEnabled(!1),(async function(s){const o=pe(s);o.Ea.add(0),await Gc(o),o.Ra.set("Offline")})(t)}))}function E6(r,e){const t=new wn;return r.asyncQueue.enqueueAndForget((async()=>(async function(s,o,c){try{const h=await(function(m,y){const _=pe(m);return _.persistence.runTransaction("read document","readonly",(E=>_.localDocuments.getDocument(E,y)))})(s,o);h.isFoundDocument()?c.resolve(h):h.isNoDocument()?c.resolve(null):c.reject(new ie(Q.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(h){const d=Qc(h,`Failed to get document '${o} from cache`);c.reject(d)}})(await Sw(r),e,t))),t.promise}function WC(r,e,t={}){const n=new wn;return r.asyncQueue.enqueueAndForget((async()=>(function(o,c,h,d,m){const y=new Zg({next:E=>{y.Nu(),c.enqueueAndForget((()=>gw(o,_)));const S=E.docs.has(h);!S&&E.fromCache?m.reject(new ie(Q.UNAVAILABLE,"Failed to get document because the client is offline.")):S&&E.fromCache&&d&&d.source==="server"?m.reject(new ie(Q.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(E)},error:E=>m.reject(E)}),_=new yw(qc(h.path),y,{includeMetadataChanges:!0,qa:!0});return mw(o,_)})(await Pc(r),r.asyncQueue,e,t,n))),n.promise}function T6(r,e){const t=new wn;return r.asyncQueue.enqueueAndForget((async()=>(async function(s,o,c){try{const h=await fg(s,o,!0),d=new BC(o,h.Qs),m=d.ru(h.documents),y=d.applyChanges(m,!1);c.resolve(y.snapshot)}catch(h){const d=Qc(h,`Failed to execute query '${o} against cache`);c.reject(d)}})(await Sw(r),e,t))),t.promise}function QC(r,e,t={}){const n=new wn;return r.asyncQueue.enqueueAndForget((async()=>(function(o,c,h,d,m){const y=new Zg({next:E=>{y.Nu(),c.enqueueAndForget((()=>gw(o,_))),E.fromCache&&d.source==="server"?m.reject(new ie(Q.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(E)},error:E=>m.reject(E)}),_=new yw(h,y,{includeMetadataChanges:!0,qa:!0});return mw(o,_)})(await Pc(r),r.asyncQueue,e,t,n))),n.promise}function S6(r,e){const t=new Zg(e);return r.asyncQueue.enqueueAndForget((async()=>(function(s,o){pe(s).Ca.add(o),o.next()})(await Pc(r),t))),()=>{t.Nu(),r.asyncQueue.enqueueAndForget((async()=>(function(s,o){pe(s).Ca.delete(o)})(await Pc(r),t)))}}function A6(r,e,t,n){const s=(function(c,h){let d;return d=typeof c=="string"?q1().encode(c):c,(function(y,_){return new g6(y,_)})((function(y,_){if(y instanceof Uint8Array)return bI(y,_);if(y instanceof ArrayBuffer)return bI(new Uint8Array(y),_);if(y instanceof ReadableStream)return y.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")})(d),h)})(t,Cd(e));r.asyncQueue.enqueueAndForget((async()=>{d6(await Aw(r),s,n)}))}function I6(r,e){return r.asyncQueue.enqueue((async()=>(function(n,s){const o=pe(n);return o.persistence.runTransaction("Get named query","readonly",(c=>o.Ii.getNamedQuery(c,s)))})(await Sw(r),e)))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YC(r){const e={};return r.timeoutSeconds!==void 0&&(e.timeoutSeconds=r.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TI=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JC="firestore.googleapis.com",SI=!0;class AI{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ie(Q.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=JC,this.ssl=SI}else this.host=e.host,this.ssl=e.ssl??SI;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=lC;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<KL)throw new ie(Q.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}$R("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=YC(e.experimentalLongPollingOptions??{}),(function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new ie(Q.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new ie(Q.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new ie(Q.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(n,s){return n.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Nd{constructor(e,t,n,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new AI({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ie(Q.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ie(Q.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new AI(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(n){if(!n)return new c4;switch(n.type){case"firstParty":return new f4(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new ie(Q.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const n=TI.get(t);n&&(ae("ComponentProvider","Removing Datastore"),TI.delete(t),n.terminate())})(this),Promise.resolve()}}function x6(r,e,t,n={}){var m;r=Je(r,Nd);const s=jc(e),o=r._getSettings(),c={...o,emulatorOptions:r._getEmulatorOptions()},h=`${e}:${t}`;s&&(px(`https://${h}`),yx("Firestore",!0)),o.host!==JC&&o.host!==h&&Pi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const d={...o,host:h,ssl:s,emulatorOptions:n};if(!ca(d,c)&&(r._setSettings(d),n.mockUserToken)){let y,_;if(typeof n.mockUserToken=="string")y=n.mockUserToken,_=un.MOCK_USER;else{y=IP(n.mockUserToken,(m=r._app)==null?void 0:m.options.projectId);const E=n.mockUserToken.sub||n.mockUserToken.user_id;if(!E)throw new ie(Q.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");_=new un(E)}r._authCredentials=new u4(new zR(y,_))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jn=class XC{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new XC(this.firestore,e,this._query)}},ft=class bh{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new la(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new bh(this.firestore,e,this._key)}toJSON(){return{type:bh._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(wd(t,bh._jsonSchema))return new bh(e,n||null,new ge(ze.fromString(t.referencePath)))}};ft._jsonSchemaVersion="firestore/documentReference/1.0",ft._jsonSchema={type:Xt("string",ft._jsonSchemaVersion),referencePath:Xt("string")};let la=class ZC extends jn{constructor(e,t,n){super(e,t,qc(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ft(this.firestore,null,new ge(e))}withConverter(e){return new ZC(this.firestore,e,this._path)}};function ek(r,e,...t){if(r=Re(r),D0("collection","path",e),r instanceof Nd){const n=ze.fromString(e,...t);return fA(n),new la(r,null,n)}{if(!(r instanceof ft||r instanceof la))throw new ie(Q.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(ze.fromString(e,...t));return fA(n),new la(r.firestore,null,n)}}function R6(r,e){if(r=Je(r,Nd),D0("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new ie(Q.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new jn(r,null,(function(n){return new us(ze.emptyPath(),n)})(e))}function yg(r,e,...t){if(r=Re(r),arguments.length===1&&(e=P0.newId()),D0("doc","path",e),r instanceof Nd){const n=ze.fromString(e,...t);return dA(n),new ft(r,null,new ge(n))}{if(!(r instanceof ft||r instanceof la))throw new ie(Q.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(ze.fromString(e,...t));return dA(n),new ft(r.firestore,r instanceof la?r.converter:null,new ge(n))}}function tk(r,e){return r=Re(r),e=Re(e),(r instanceof ft||r instanceof la)&&(e instanceof ft||e instanceof la)&&r.firestore===e.firestore&&r.path===e.path&&r.converter===e.converter}function nk(r,e){return r=Re(r),e=Re(e),r instanceof jn&&e instanceof jn&&r.firestore===e.firestore&&Sd(r._query,e._query)&&r.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const II="AsyncQueue";class xI{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new cw(this,"async_queue_retry"),this._c=()=>{const n=Gm();n&&ae(II,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const t=Gm();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Gm();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new wn;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Sa(e))throw e;ae(II,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((n=>{throw this.nc=n,this.rc=!1,jt("INTERNAL UNHANDLED ERROR: ",RI(n)),n})).then((n=>(this.rc=!1,n))))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const s=fw.createAndSchedule(this,e,t,n,(o=>this.hc(o)));return this.tc.push(s),s}uc(){this.nc&&_e(47125,{Pc:RI(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,n)=>t.targetTimeMs-n.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function RI(r){let e=r.message||"";return r.stack&&(e=r.stack.includes(r.message)?r.stack:r.message+`
`+r.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pv(r){return(function(t,n){if(typeof t!="object"||t===null)return!1;const s=t;for(const o of n)if(o in s&&typeof s[o]=="function")return!0;return!1})(r,["next","error","complete"])}class C6{constructor(){this._progressObserver={},this._taskCompletionResolver=new wn,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,n){this._progressObserver={next:e,error:t,complete:n}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k6=-1;let Ut=class extends Nd{constructor(e,t,n,s){super(e,t,n,s),this.type="firestore",this._queue=new xI,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new xI(e),this._firestoreClient=void 0,await e}}};function Rn(r){if(r._terminated)throw new ie(Q.FAILED_PRECONDITION,"The client has already been terminated.");return r._firestoreClient||rk(r),r._firestoreClient}function rk(r){var n,s,o;const e=r._freezeSettings(),t=(function(h,d,m,y){return new J4(h,d,m,y.host,y.ssl,y.experimentalForceLongPolling,y.experimentalAutoDetectLongPolling,YC(y.experimentalLongPollingOptions),y.useFetchStreams,y.isUsingEmulator)})(r._databaseId,((n=r._app)==null?void 0:n.options.appId)||"",r._persistenceKey,e);r._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((o=e.localCache)!=null&&o._onlineComponentProvider)&&(r._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),r._firestoreClient=new _6(r._authCredentials,r._appCheckCredentials,r._queue,t,r._componentsProvider&&(function(h){const d=h==null?void 0:h._online.build();return{_offline:h==null?void 0:h._offline.build(d),_online:d}})(r._componentsProvider))}function N6(r,e){Pi("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=r._freezeSettings();return ik(r,ad.provider,{build:n=>new HC(n,t.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}async function O6(r){Pi("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=r._freezeSettings();ik(r,ad.provider,{build:t=>new m6(t,e.cacheSizeBytes)})}function ik(r,e,t){if((r=Je(r,Ut))._firestoreClient||r._terminated)throw new ie(Q.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(r._componentsProvider||r._getSettings().localCache)throw new ie(Q.FAILED_PRECONDITION,"SDK cache is already specified.");r._componentsProvider={_online:e,_offline:t},rk(r)}function P6(r){if(r._initialized&&!r._terminated)throw new ie(Q.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new wn;return r._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await(async function(n){if(!Ri.v())return Promise.resolve();const s=n+yC;await Ri.delete(s)})(sw(r._databaseId,r._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function D6(r){return(function(t){const n=new wn;return t.asyncQueue.enqueueAndForget((async()=>t6(await Aw(t),n))),n.promise})(Rn(r=Je(r,Ut)))}function V6(r){return w6(Rn(r=Je(r,Ut)))}function M6(r){return b6(Rn(r=Je(r,Ut)))}function j6(r,e){const t=Rn(r=Je(r,Ut)),n=new C6;return A6(t,r._databaseId,e,n),n}function L6(r,e){return I6(Rn(r=Je(r,Ut)),e).then((t=>t?new jn(r,null,t.query):null))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class In{constructor(e){this._byteString=e}static fromBase64String(e){try{return new In(kt.fromBase64String(e))}catch(t){throw new ie(Q.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new In(kt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:In._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(wd(e,In._jsonSchema))return In.fromBase64String(e.bytes)}}In._jsonSchemaVersion="firestore/bytes/1.0",In._jsonSchema={type:Xt("string",In._jsonSchemaVersion),bytes:Xt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wa=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ie(Q.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Tt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let qo=class{constructor(e){this._methodName=e}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wr{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ie(Q.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ie(Q.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Oe(this._lat,e._lat)||Oe(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Wr._jsonSchemaVersion}}static fromJSON(e){if(wd(e,Wr._jsonSchema))return new Wr(e.latitude,e.longitude)}}Wr._jsonSchemaVersion="firestore/geoPoint/1.0",Wr._jsonSchema={type:Xt("string",Wr._jsonSchemaVersion),latitude:Xt("number"),longitude:Xt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ki{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(n,s){if(n.length!==s.length)return!1;for(let o=0;o<n.length;++o)if(n[o]!==s[o])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ki._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(wd(e,ki._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new ki(e.vectorValues);throw new ie(Q.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ki._jsonSchemaVersion="firestore/vectorValue/1.0",ki._jsonSchema={type:Xt("string",ki._jsonSchemaVersion),vectorValues:Xt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U6=/^__.*__$/;class B6{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new ds(e,this.data,this.fieldMask,t,this.fieldTransforms):new $c(e,this.data,t,this.fieldTransforms)}}class sk{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new ds(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function ak(r){switch(r){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw _e(40011,{Ac:r})}}class tp{constructor(e,t,n,s,o,c){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=s,o===void 0&&this.Rc(),this.fieldTransforms=o||[],this.fieldMask=c||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new tp({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const t=(s=this.path)==null?void 0:s.child(e),n=this.Vc({path:t,fc:!1});return n.gc(e),n}yc(e){var s;const t=(s=this.path)==null?void 0:s.child(e),n=this.Vc({path:t,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return _g(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(ak(this.Ac)&&U6.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class F6{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Cd(e)}Cc(e,t,n,s=!1){return new tp({Ac:e,methodName:t,Dc:n,path:Tt.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function $o(r){const e=r._freezeSettings(),t=Cd(r._databaseId);return new F6(r._databaseId,!!e.ignoreUndefinedProperties,t)}function np(r,e,t,n,s,o={}){const c=r.Cc(o.merge||o.mergeFields?2:0,e,t,s);Ow("Data must be an object, but it was:",c,n);const h=ck(n,c);let d,m;if(o.merge)d=new Wn(c.fieldMask),m=c.fieldTransforms;else if(o.mergeFields){const y=[];for(const _ of o.mergeFields){const E=Dv(e,_,t);if(!c.contains(E))throw new ie(Q.INVALID_ARGUMENT,`Field '${E}' is specified in your field mask but missing from your input data.`);hk(y,E)||y.push(E)}d=new Wn(y),m=c.fieldTransforms.filter((_=>d.covers(_.field)))}else d=null,m=c.fieldTransforms;return new B6(new vn(h),d,m)}class Od extends qo{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Od}}function ok(r,e,t){return new tp({Ac:3,Dc:e.settings.Dc,methodName:r._methodName,fc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Iw extends qo{_toFieldTransform(e){return new Id(e.path,new Ac)}isEqual(e){return e instanceof Iw}}class xw extends qo{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=ok(this,e,!0),n=this.vc.map((o=>Ho(o,t))),s=new Do(n);return new Id(e.path,s)}isEqual(e){return e instanceof xw&&ca(this.vc,e.vc)}}class Rw extends qo{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=ok(this,e,!0),n=this.vc.map((o=>Ho(o,t))),s=new Vo(n);return new Id(e.path,s)}isEqual(e){return e instanceof Rw&&ca(this.vc,e.vc)}}class Cw extends qo{constructor(e,t){super(e),this.Fc=t}_toFieldTransform(e){const t=new Ic(e.serializer,D1(e.serializer,this.Fc));return new Id(e.path,t)}isEqual(e){return e instanceof Cw&&this.Fc===e.Fc}}function kw(r,e,t,n){const s=r.Cc(1,e,t);Ow("Data must be an object, but it was:",s,n);const o=[],c=vn.empty();Aa(n,((d,m)=>{const y=Pw(e,d,t);m=Re(m);const _=s.yc(y);if(m instanceof Od)o.push(y);else{const E=Ho(m,_);E!=null&&(o.push(y),c.set(y,E))}}));const h=new Wn(o);return new sk(c,h,s.fieldTransforms)}function Nw(r,e,t,n,s,o){const c=r.Cc(1,e,t),h=[Dv(e,n,t)],d=[s];if(o.length%2!=0)throw new ie(Q.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let E=0;E<o.length;E+=2)h.push(Dv(e,o[E])),d.push(o[E+1]);const m=[],y=vn.empty();for(let E=h.length-1;E>=0;--E)if(!hk(m,h[E])){const S=h[E];let C=d[E];C=Re(C);const k=c.yc(S);if(C instanceof Od)m.push(S);else{const N=Ho(C,k);N!=null&&(m.push(S),y.set(S,N))}}const _=new Wn(m);return new sk(y,_,c.fieldTransforms)}function lk(r,e,t,n=!1){return Ho(t,r.Cc(n?4:3,e))}function Ho(r,e){if(uk(r=Re(r)))return Ow("Unsupported field value:",e,r),ck(r,e);if(r instanceof qo)return(function(n,s){if(!ak(s.Ac))throw s.Sc(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${n._methodName}() is not currently supported inside arrays`);const o=n._toFieldTransform(s);o&&s.fieldTransforms.push(o)})(r,e),null;if(r===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),r instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(n,s){const o=[];let c=0;for(const h of n){let d=Ho(h,s.wc(c));d==null&&(d={nullValue:"NULL_VALUE"}),o.push(d),c++}return{arrayValue:{values:o}}})(r,e)}return(function(n,s){if((n=Re(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return D1(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const o=tt.fromDate(n);return{timestampValue:xc(s.serializer,o)}}if(n instanceof tt){const o=new tt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:xc(s.serializer,o)}}if(n instanceof Wr)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof In)return{bytesValue:G1(s.serializer,n._byteString)};if(n instanceof ft){const o=s.databaseId,c=n.firestore._databaseId;if(!c.isEqual(o))throw s.Sc(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:X0(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof ki)return(function(c,h){return{mapValue:{fields:{[F0]:{stringValue:z0},[Ec]:{arrayValue:{values:c.toArray().map((m=>{if(typeof m!="number")throw h.Sc("VectorValues must only contain numeric values.");return G0(h.serializer,m)}))}}}}}})(n,s);throw s.Sc(`Unsupported field value: ${Lg(n)}`)})(r,e)}function ck(r,e){const t={};return c1(r)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Aa(r,((n,s)=>{const o=Ho(s,e.mc(n));o!=null&&(t[n]=o)})),{mapValue:{fields:t}}}function uk(r){return!(typeof r!="object"||r===null||r instanceof Array||r instanceof Date||r instanceof tt||r instanceof Wr||r instanceof In||r instanceof ft||r instanceof qo||r instanceof ki)}function Ow(r,e,t){if(!uk(t)||!HR(t)){const n=Lg(t);throw n==="an object"?e.Sc(r+" a custom object"):e.Sc(r+" "+n)}}function Dv(r,e,t){if((e=Re(e))instanceof wa)return e._internalPath;if(typeof e=="string")return Pw(r,e);throw _g("Field path arguments must be of type string or ",r,!1,void 0,t)}const z6=new RegExp("[~\\*/\\[\\]]");function Pw(r,e,t){if(e.search(z6)>=0)throw _g(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,t);try{return new wa(...e.split("."))._internalPath}catch{throw _g(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,t)}}function _g(r,e,t,n,s){const o=n&&!n.isEmpty(),c=s!==void 0;let h=`Function ${e}() called with invalid data`;t&&(h+=" (via `toFirestore()`)"),h+=". ";let d="";return(o||c)&&(d+=" (found",o&&(d+=` in field ${n}`),c&&(d+=` in document ${s}`),d+=")"),new ie(Q.INVALID_ARGUMENT,h+r+d)}function hk(r,e){return r.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class od{constructor(e,t,n,s,o){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=s,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new ft(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new q6(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(rp("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class q6 extends od{data(){return super.data()}}function rp(r,e){return typeof e=="string"?Pw(r,e):e instanceof wa?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dk(r){if(r.limitType==="L"&&r.explicitOrderBy.length===0)throw new ie(Q.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Dw{}class Pd extends Dw{}function Js(r,e,...t){let n=[];e instanceof Dw&&n.push(e),n=n.concat(t),(function(o){const c=o.filter((d=>d instanceof Vw)).length,h=o.filter((d=>d instanceof ip)).length;if(c>1||c>0&&h>0)throw new ie(Q.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(n);for(const s of n)r=s._apply(r);return r}class ip extends Pd{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new ip(e,t,n)}_apply(e){const t=this._parse(e);return mk(e._query,t),new jn(e.firestore,e.converter,wv(e._query,t))}_parse(e){const t=$o(e.firestore);return(function(o,c,h,d,m,y,_){let E;if(m.isKeyField()){if(y==="array-contains"||y==="array-contains-any")throw new ie(Q.INVALID_ARGUMENT,`Invalid Query. You can't perform '${y}' queries on documentId().`);if(y==="in"||y==="not-in"){kI(_,y);const C=[];for(const k of _)C.push(CI(d,o,k));E={arrayValue:{values:C}}}else E=CI(d,o,_)}else y!=="in"&&y!=="not-in"&&y!=="array-contains-any"||kI(_,y),E=lk(h,c,_,y==="in"||y==="not-in");return He.create(m,y,E)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function $6(r,e,t){const n=e,s=rp("where",r);return ip._create(s,n,t)}class Vw extends Dw{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Vw(e,t)}_parse(e){const t=this._queryConstraints.map((n=>n._parse(e))).filter((n=>n.getFilters().length>0));return t.length===1?t[0]:st.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(s,o){let c=s;const h=o.getFlattenedFilters();for(const d of h)mk(c,d),c=wv(c,d)})(e._query,t),new jn(e.firestore,e.converter,wv(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Mw extends Pd{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Mw(e,t)}_apply(e){const t=(function(s,o,c){if(s.startAt!==null)throw new ie(Q.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new ie(Q.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new nd(o,c)})(e._query,this._field,this._direction);return new jn(e.firestore,e.converter,(function(s,o){const c=s.explicitOrderBy.concat([o]);return new us(s.path,s.collectionGroup,c,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)})(e._query,t))}}function H6(r,e="asc"){const t=e,n=rp("orderBy",r);return Mw._create(n,t)}class sp extends Pd{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new sp(e,t,n)}_apply(e){return new jn(e.firestore,e.converter,lg(e._query,this._limit,this._limitType))}}function G6(r){return GR("limit",r),sp._create("limit",r,"F")}function K6(r){return GR("limitToLast",r),sp._create("limitToLast",r,"L")}class ap extends Pd{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new ap(e,t,n)}_apply(e){const t=fk(e,this.type,this._docOrFields,this._inclusive);return new jn(e.firestore,e.converter,(function(s,o){return new us(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,o,s.endAt)})(e._query,t))}}function W6(...r){return ap._create("startAt",r,!0)}function Q6(...r){return ap._create("startAfter",r,!1)}class op extends Pd{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new op(e,t,n)}_apply(e){const t=fk(e,this.type,this._docOrFields,this._inclusive);return new jn(e.firestore,e.converter,(function(s,o){return new us(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,o)})(e._query,t))}}function Y6(...r){return op._create("endBefore",r,!1)}function J6(...r){return op._create("endAt",r,!0)}function fk(r,e,t,n){if(t[0]=Re(t[0]),t[0]instanceof od)return(function(o,c,h,d,m){if(!d)throw new ie(Q.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${h}().`);const y=[];for(const _ of cc(o))if(_.field.isKeyField())y.push(Oo(c,d.key));else{const E=d.data.field(_.field);if(qg(E))throw new ie(Q.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+_.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(E===null){const S=_.field.canonicalString();throw new ie(Q.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${S}' (used as the orderBy) does not exist.`)}y.push(E)}return new ya(y,m)})(r._query,r.firestore._databaseId,e,t[0]._document,n);{const s=$o(r.firestore);return(function(c,h,d,m,y,_){const E=c.explicitOrderBy;if(y.length>E.length)throw new ie(Q.INVALID_ARGUMENT,`Too many arguments provided to ${m}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const S=[];for(let C=0;C<y.length;C++){const k=y[C];if(E[C].field.isKeyField()){if(typeof k!="string")throw new ie(Q.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${m}(), but got a ${typeof k}`);if(!$0(c)&&k.indexOf("/")!==-1)throw new ie(Q.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${m}() must be a plain document ID, but '${k}' contains a slash.`);const N=c.path.child(ze.fromString(k));if(!ge.isDocumentKey(N))throw new ie(Q.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${m}() must result in a valid document path, but '${N}' is not because it contains an odd number of segments.`);const G=new ge(N);S.push(Oo(h,G))}else{const N=lk(d,m,k);S.push(N)}}return new ya(S,_)})(r._query,r.firestore._databaseId,s,e,t,n)}}function CI(r,e,t){if(typeof(t=Re(t))=="string"){if(t==="")throw new ie(Q.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!$0(e)&&t.indexOf("/")!==-1)throw new ie(Q.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const n=e.path.child(ze.fromString(t));if(!ge.isDocumentKey(n))throw new ie(Q.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return Oo(r,new ge(n))}if(t instanceof ft)return Oo(r,t._key);throw new ie(Q.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Lg(t)}.`)}function kI(r,e){if(!Array.isArray(r)||r.length===0)throw new ie(Q.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function mk(r,e){const t=(function(s,o){for(const c of s)for(const h of c.getFlattenedFilters())if(o.indexOf(h.op)>=0)return h.op;return null})(r.filters,(function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new ie(Q.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ie(Q.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class jw{convertValue(e,t="none"){switch(ga(e)){case 0:return null;case 1:return e.booleanValue;case 2:return bt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(os(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw _e(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return Aa(e,((s,o)=>{n[s]=this.convertValue(o,t)})),n}convertVectorValue(e){var n,s,o;const t=(o=(s=(n=e.fields)==null?void 0:n[Ec].arrayValue)==null?void 0:s.values)==null?void 0:o.map((c=>bt(c.doubleValue)));return new ki(t)}convertGeoPoint(e){return new Wr(bt(e.latitude),bt(e.longitude))}convertArray(e,t){return(e.values||[]).map((n=>this.convertValue(n,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=$g(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Zh(e));default:return null}}convertTimestamp(e){const t=as(e);return new tt(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=ze.fromString(e);be(rC(n),9688,{name:e});const s=new ma(n.get(1),n.get(3)),o=new ge(n.popFirst(5));return s.isEqual(t)||jt(`Document ${o} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lp(r,e,t){let n;return n=r?t&&(t.merge||t.mergeFields)?r.toFirestore(e,t):r.toFirestore(e):e,n}class X6 extends jw{constructor(e){super(),this.firestore=e}convertBytes(e){return new In(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ft(this.firestore,null,t)}}class To{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}let Ir=class gk extends od{constructor(e,t,n,s,o,c){super(e,t,n,s,c),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new jh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(rp("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ie(Q.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=gk._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};Ir._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ir._jsonSchema={type:Xt("string",Ir._jsonSchemaVersion),bundleSource:Xt("string","DocumentSnapshot"),bundleName:Xt("string"),bundle:Xt("string")};let jh=class extends Ir{data(e={}){return super.data(e)}},Qr=class pk{constructor(e,t,n,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new To(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new jh(this._firestore,this._userDataWriter,n.key,n,new To(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ie(Q.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(s,o){if(s._snapshot.oldDocs.isEmpty()){let c=0;return s._snapshot.docChanges.map((h=>{const d=new jh(s._firestore,s._userDataWriter,h.doc.key,h.doc,new To(s._snapshot.mutatedKeys.has(h.doc.key),s._snapshot.fromCache),s.query.converter);return h.doc,{type:"added",doc:d,oldIndex:-1,newIndex:c++}}))}{let c=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((h=>o||h.type!==3)).map((h=>{const d=new jh(s._firestore,s._userDataWriter,h.doc.key,h.doc,new To(s._snapshot.mutatedKeys.has(h.doc.key),s._snapshot.fromCache),s.query.converter);let m=-1,y=-1;return h.type!==0&&(m=c.indexOf(h.doc.key),c=c.delete(h.doc.key)),h.type!==1&&(c=c.add(h.doc),y=c.indexOf(h.doc.key)),{type:Z6(h.type),doc:d,oldIndex:m,newIndex:y}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ie(Q.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=pk._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=P0.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],s=[];return this.docs.forEach((o=>{o._document!==null&&(t.push(o._document),n.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),s.push(o.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function Z6(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return _e(61501,{type:r})}}function yk(r,e){return r instanceof Ir&&e instanceof Ir?r._firestore===e._firestore&&r._key.isEqual(e._key)&&(r._document===null?e._document===null:r._document.isEqual(e._document))&&r._converter===e._converter:r instanceof Qr&&e instanceof Qr&&r._firestore===e._firestore&&nk(r.query,e.query)&&r.metadata.isEqual(e.metadata)&&r._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e3(r){r=Je(r,ft);const e=Je(r.firestore,Ut);return WC(Rn(e),r._key).then((t=>Lw(e,r,t)))}Qr._jsonSchemaVersion="firestore/querySnapshot/1.0",Qr._jsonSchema={type:Xt("string",Qr._jsonSchemaVersion),bundleSource:Xt("string","QuerySnapshot"),bundleName:Xt("string"),bundle:Xt("string")};class Go extends jw{constructor(e){super(),this.firestore=e}convertBytes(e){return new In(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ft(this.firestore,null,t)}}function t3(r){r=Je(r,ft);const e=Je(r.firestore,Ut),t=Rn(e),n=new Go(e);return E6(t,r._key).then((s=>new Ir(e,n,r._key,s,new To(s!==null&&s.hasLocalMutations,!0),r.converter)))}function n3(r){r=Je(r,ft);const e=Je(r.firestore,Ut);return WC(Rn(e),r._key,{source:"server"}).then((t=>Lw(e,r,t)))}function r3(r){r=Je(r,jn);const e=Je(r.firestore,Ut),t=Rn(e),n=new Go(e);return dk(r._query),QC(t,r._query).then((s=>new Qr(e,n,r,s)))}function i3(r){r=Je(r,jn);const e=Je(r.firestore,Ut),t=Rn(e),n=new Go(e);return T6(t,r._query).then((s=>new Qr(e,n,r,s)))}function s3(r){r=Je(r,jn);const e=Je(r.firestore,Ut),t=Rn(e),n=new Go(e);return QC(t,r._query,{source:"server"}).then((s=>new Qr(e,n,r,s)))}function NI(r,e,t){r=Je(r,ft);const n=Je(r.firestore,Ut),s=lp(r.converter,e,t);return Dd(n,[np($o(n),"setDoc",r._key,s,r.converter!==null,t).toMutation(r._key,St.none())])}function OI(r,e,t,...n){r=Je(r,ft);const s=Je(r.firestore,Ut),o=$o(s);let c;return c=typeof(e=Re(e))=="string"||e instanceof wa?Nw(o,"updateDoc",r._key,e,t,n):kw(o,"updateDoc",r._key,e),Dd(s,[c.toMutation(r._key,St.exists(!0))])}function a3(r){return Dd(Je(r.firestore,Ut),[new Hc(r._key,St.none())])}function o3(r,e){const t=Je(r.firestore,Ut),n=yg(r),s=lp(r.converter,e);return Dd(t,[np($o(r.firestore),"addDoc",n._key,s,r.converter!==null,{}).toMutation(n._key,St.exists(!1))]).then((()=>n))}function _k(r,...e){var d,m,y;r=Re(r);let t={includeMetadataChanges:!1,source:"default"},n=0;typeof e[n]!="object"||Pv(e[n])||(t=e[n++]);const s={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Pv(e[n])){const _=e[n];e[n]=(d=_.next)==null?void 0:d.bind(_),e[n+1]=(m=_.error)==null?void 0:m.bind(_),e[n+2]=(y=_.complete)==null?void 0:y.bind(_)}let o,c,h;if(r instanceof ft)c=Je(r.firestore,Ut),h=qc(r._key.path),o={next:_=>{e[n]&&e[n](Lw(c,r,_))},error:e[n+1],complete:e[n+2]};else{const _=Je(r,jn);c=Je(_.firestore,Ut),h=_._query;const E=new Go(c);o={next:S=>{e[n]&&e[n](new Qr(c,E,_,S))},error:e[n+1],complete:e[n+2]},dk(r._query)}return(function(E,S,C,k){const N=new Zg(k),G=new yw(S,N,C);return E.asyncQueue.enqueueAndForget((async()=>mw(await Pc(E),G))),()=>{N.Nu(),E.asyncQueue.enqueueAndForget((async()=>gw(await Pc(E),G)))}})(Rn(c),h,s,o)}function l3(r,e){return S6(Rn(r=Je(r,Ut)),Pv(e)?e:{next:e})}function Dd(r,e){return(function(n,s){const o=new wn;return n.asyncQueue.enqueueAndForget((async()=>JU(await Aw(n),s,o))),o.promise})(Rn(r),e)}function Lw(r,e,t){const n=t.docs.get(e._key),s=new Go(r);return new Ir(r,s,e._key,n,new To(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c3={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let u3=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=$o(e)}set(e,t,n){this._verifyNotCommitted();const s=ra(e,this._firestore),o=lp(s.converter,t,n),c=np(this._dataReader,"WriteBatch.set",s._key,o,s.converter!==null,n);return this._mutations.push(c.toMutation(s._key,St.none())),this}update(e,t,n,...s){this._verifyNotCommitted();const o=ra(e,this._firestore);let c;return c=typeof(t=Re(t))=="string"||t instanceof wa?Nw(this._dataReader,"WriteBatch.update",o._key,t,n,s):kw(this._dataReader,"WriteBatch.update",o._key,t),this._mutations.push(c.toMutation(o._key,St.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=ra(e,this._firestore);return this._mutations=this._mutations.concat(new Hc(t._key,St.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ie(Q.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function ra(r,e){if((r=Re(r)).firestore!==e)throw new ie(Q.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h3{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=$o(e)}get(e){const t=ra(e,this._firestore),n=new X6(this._firestore);return this._transaction.lookup([t._key]).then((s=>{if(!s||s.length!==1)return _e(24041);const o=s[0];if(o.isFoundDocument())return new od(this._firestore,n,o.key,o,t.converter);if(o.isNoDocument())return new od(this._firestore,n,t._key,null,t.converter);throw _e(18433,{doc:o})}))}set(e,t,n){const s=ra(e,this._firestore),o=lp(s.converter,t,n),c=np(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,n);return this._transaction.set(s._key,c),this}update(e,t,n,...s){const o=ra(e,this._firestore);let c;return c=typeof(t=Re(t))=="string"||t instanceof wa?Nw(this._dataReader,"Transaction.update",o._key,t,n,s):kw(this._dataReader,"Transaction.update",o._key,t),this._transaction.update(o._key,c),this}delete(e){const t=ra(e,this._firestore);return this._transaction.delete(t._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let d3=class extends h3{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=ra(e,this._firestore),n=new Go(this._firestore);return super.get(e).then((s=>new Ir(this._firestore,n,t._key,s._document,new To(!1,!1),t.converter)))}};function f3(r,e,t){r=Je(r,Ut);const n={...c3,...t};return(function(o){if(o.maxAttempts<1)throw new ie(Q.INVALID_ARGUMENT,"Max attempts must be at least 1")})(n),(function(o,c,h){const d=new wn;return o.asyncQueue.enqueueAndForget((async()=>{const m=await v6(o);new y6(o.asyncQueue,m,h,c,d).ju()})),d.promise})(Rn(r),(s=>e(new d3(r,s))),n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m3(){return new Od("deleteField")}function g3(){return new Iw("serverTimestamp")}function p3(...r){return new xw("arrayUnion",r)}function y3(...r){return new Rw("arrayRemove",r)}function _3(r){return new Cw("increment",r)}(function(e,t=!0){(function(s){zc=s})(ba),da(new Ni("firestore",((n,{instanceIdentifier:s,options:o})=>{const c=n.getProvider("app").getImmediate(),h=new Ut(new h4(n.getProvider("auth-internal")),new m4(c,n.getProvider("app-check-internal")),(function(m,y){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new ie(Q.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ma(m.options.projectId,y)})(c,s),c);return o={useFetchStreams:t,...o},h._setSettings(o),h}),"PUBLIC").setMultipleInstances(!0)),Kr(lA,cA,e),Kr(lA,cA,"esm2020")})();const v3="@firebase/firestore-compat",w3="0.4.2";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uw(r,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new ie("invalid-argument",`Invalid options passed to function ${r}(): You cannot specify both "merge" and "mergeFields".`);return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PI(){if(typeof Uint8Array>"u")throw new ie("unimplemented","Uint8Arrays are not available in this environment.")}function DI(){if(!Q4())throw new ie("unimplemented","Blobs are unavailable in Firestore in this environment.")}let vk=class Vv{constructor(e){this._delegate=e}static fromBase64String(e){return DI(),new Vv(In.fromBase64String(e))}static fromUint8Array(e){return PI(),new Vv(In.fromUint8Array(e))}toBase64(){return DI(),this._delegate.toBase64()}toUint8Array(){return PI(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mv(r){return b3(r,["next","error","complete"])}function b3(r,e){if(typeof r!="object"||r===null)return!1;const t=r;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E3{enableIndexedDbPersistence(e,t){return N6(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return O6(e._delegate)}clearIndexedDbPersistence(e){return P6(e._delegate)}}class wk{constructor(e,t,n){this._delegate=t,this._persistenceProvider=n,this.INTERNAL={delete:()=>this.terminate()},e instanceof ma||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Pi("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e={...t,...e},delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,n={}){x6(this._delegate,e,t,n)}enableNetwork(){return V6(this._delegate)}disableNetwork(){return M6(this._delegate)}enablePersistence(e){let t=!1,n=!1;return e&&(t=!!e.synchronizeTabs,n=!!e.experimentalForceOwningTab,$R("synchronizeTabs",t,"experimentalForceOwningTab",n)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,n)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return D6(this._delegate)}onSnapshotsInSync(e){return l3(this._delegate,e)}get app(){if(!this._appCompat)throw new ie("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Dc(this,ek(this._delegate,e))}catch(t){throw Dn(t,"collection()","Firestore.collection()")}}doc(e){try{return new Ar(this,yg(this._delegate,e))}catch(t){throw Dn(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Pn(this,R6(this._delegate,e))}catch(t){throw Dn(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return f3(this._delegate,t=>e(new bk(this,t)))}batch(){return Rn(this._delegate),new Ek(new u3(this._delegate,e=>Dd(this._delegate,e)))}loadBundle(e){return j6(this._delegate,e)}namedQuery(e){return L6(this._delegate,e).then(t=>t?new Pn(this,t):null)}}class cp extends jw{constructor(e){super(),this.firestore=e}convertBytes(e){return new vk(new In(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return Ar.forKey(t,this.firestore,null)}}function T3(r){o4(r)}class bk{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new cp(e)}get(e){const t=So(e);return this._delegate.get(t).then(n=>new ld(this._firestore,new Ir(this._firestore._delegate,this._userDataWriter,n._key,n._document,n.metadata,t.converter)))}set(e,t,n){const s=So(e);return n?(Uw("Transaction.set",n),this._delegate.set(s,t,n)):this._delegate.set(s,t),this}update(e,t,n,...s){const o=So(e);return arguments.length===2?this._delegate.update(o,t):this._delegate.update(o,t,n,...s),this}delete(e){const t=So(e);return this._delegate.delete(t),this}}class Ek{constructor(e){this._delegate=e}set(e,t,n){const s=So(e);return n?(Uw("WriteBatch.set",n),this._delegate.set(s,t,n)):this._delegate.set(s,t),this}update(e,t,n,...s){const o=So(e);return arguments.length===2?this._delegate.update(o,t):this._delegate.update(o,t,n,...s),this}delete(e){const t=So(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class Bo{constructor(e,t,n){this._firestore=e,this._userDataWriter=t,this._delegate=n}fromFirestore(e,t){const n=new jh(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new cd(this._firestore,n),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const n=Bo.INSTANCES;let s=n.get(e);s||(s=new WeakMap,n.set(e,s));let o=s.get(t);return o||(o=new Bo(e,new cp(e),t),s.set(t,o)),o}}Bo.INSTANCES=new WeakMap;class Ar{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new cp(e)}static forPath(e,t,n){if(e.length%2!==0)throw new ie("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new Ar(t,new ft(t._delegate,n,new ge(e)))}static forKey(e,t,n){return new Ar(t,new ft(t._delegate,n,e))}get id(){return this._delegate.id}get parent(){return new Dc(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Dc(this.firestore,ek(this._delegate,e))}catch(t){throw Dn(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=Re(e),e instanceof ft?tk(this._delegate,e):!1}set(e,t){t=Uw("DocumentReference.set",t);try{return t?NI(this._delegate,e,t):NI(this._delegate,e)}catch(n){throw Dn(n,"setDoc()","DocumentReference.set()")}}update(e,t,...n){try{return arguments.length===1?OI(this._delegate,e):OI(this._delegate,e,t,...n)}catch(s){throw Dn(s,"updateDoc()","DocumentReference.update()")}}delete(){return a3(this._delegate)}onSnapshot(...e){const t=Tk(e),n=Sk(e,s=>new ld(this.firestore,new Ir(this.firestore._delegate,this._userDataWriter,s._key,s._document,s.metadata,this._delegate.converter)));return _k(this._delegate,t,n)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=t3(this._delegate):(e==null?void 0:e.source)==="server"?t=n3(this._delegate):t=e3(this._delegate),t.then(n=>new ld(this.firestore,new Ir(this.firestore._delegate,this._userDataWriter,n._key,n._document,n.metadata,this._delegate.converter)))}withConverter(e){return new Ar(this.firestore,e?this._delegate.withConverter(Bo.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Dn(r,e,t){return r.message=r.message.replace(e,t),r}function Tk(r){for(const e of r)if(typeof e=="object"&&!Mv(e))return e;return{}}function Sk(r,e){var n,s;let t;return Mv(r[0])?t=r[0]:Mv(r[1])?t=r[1]:typeof r[0]=="function"?t={next:r[0],error:r[1],complete:r[2]}:t={next:r[1],error:r[2],complete:r[3]},{next:o=>{t.next&&t.next(e(o))},error:(n=t.error)==null?void 0:n.bind(t),complete:(s=t.complete)==null?void 0:s.bind(t)}}class ld{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Ar(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return yk(this._delegate,e._delegate)}}class cd extends ld{data(e){const t=this._delegate.data(e);return this._delegate._converter||l4(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}}class Pn{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new cp(e)}where(e,t,n){try{return new Pn(this.firestore,Js(this._delegate,$6(e,t,n)))}catch(s){throw Dn(s,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Pn(this.firestore,Js(this._delegate,H6(e,t)))}catch(n){throw Dn(n,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Pn(this.firestore,Js(this._delegate,G6(e)))}catch(t){throw Dn(t,"limit()","Query.limit()")}}limitToLast(e){try{return new Pn(this.firestore,Js(this._delegate,K6(e)))}catch(t){throw Dn(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Pn(this.firestore,Js(this._delegate,W6(...e)))}catch(t){throw Dn(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Pn(this.firestore,Js(this._delegate,Q6(...e)))}catch(t){throw Dn(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Pn(this.firestore,Js(this._delegate,Y6(...e)))}catch(t){throw Dn(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Pn(this.firestore,Js(this._delegate,J6(...e)))}catch(t){throw Dn(t,"endAt()","Query.endAt()")}}isEqual(e){return nk(this._delegate,e._delegate)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=i3(this._delegate):(e==null?void 0:e.source)==="server"?t=s3(this._delegate):t=r3(this._delegate),t.then(n=>new jv(this.firestore,new Qr(this.firestore._delegate,this._userDataWriter,this._delegate,n._snapshot)))}onSnapshot(...e){const t=Tk(e),n=Sk(e,s=>new jv(this.firestore,new Qr(this.firestore._delegate,this._userDataWriter,this._delegate,s._snapshot)));return _k(this._delegate,t,n)}withConverter(e){return new Pn(this.firestore,e?this._delegate.withConverter(Bo.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class S3{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new cd(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class jv{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Pn(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new cd(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new S3(this._firestore,t))}forEach(e,t){this._delegate.forEach(n=>{e.call(t,new cd(this._firestore,n))})}isEqual(e){return yk(this._delegate,e._delegate)}}class Dc extends Pn{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new Ar(this.firestore,e):null}doc(e){try{return e===void 0?new Ar(this.firestore,yg(this._delegate)):new Ar(this.firestore,yg(this._delegate,e))}catch(t){throw Dn(t,"doc()","CollectionReference.doc()")}}add(e){return o3(this._delegate,e).then(t=>new Ar(this.firestore,t))}isEqual(e){return tk(this._delegate,e._delegate)}withConverter(e){return new Dc(this.firestore,e?this._delegate.withConverter(Bo.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function So(r){return Je(r,ft)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bw{constructor(...e){this._delegate=new wa(...e)}static documentId(){return new Bw(Tt.keyField().canonicalString())}isEqual(e){return e=Re(e),e instanceof wa?this._delegate._internalPath.isEqual(e._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _o{static serverTimestamp(){const e=g3();return e._methodName="FieldValue.serverTimestamp",new _o(e)}static delete(){const e=m3();return e._methodName="FieldValue.delete",new _o(e)}static arrayUnion(...e){const t=p3(...e);return t._methodName="FieldValue.arrayUnion",new _o(t)}static arrayRemove(...e){const t=y3(...e);return t._methodName="FieldValue.arrayRemove",new _o(t)}static increment(e){const t=_3(e);return t._methodName="FieldValue.increment",new _o(t)}constructor(e){this._delegate=e}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A3={Firestore:wk,GeoPoint:Wr,Timestamp:tt,Blob:vk,Transaction:bk,WriteBatch:Ek,DocumentReference:Ar,DocumentSnapshot:ld,Query:Pn,QueryDocumentSnapshot:cd,QuerySnapshot:jv,CollectionReference:Dc,FieldPath:Bw,FieldValue:_o,setLogLevel:T3,CACHE_SIZE_UNLIMITED:k6};function I3(r,e){r.INTERNAL.registerComponent(new Ni("firestore-compat",t=>{const n=t.getProvider("app-compat").getImmediate(),s=t.getProvider("firestore").getImmediate();return e(n,s)},"PUBLIC").setServiceProps({...A3}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x3(r){I3(r,(e,t)=>new wk(e,t,new E3)),r.registerVersion(v3,w3)}x3(xr);const R3={},Hl=R3??{},Ak={apiKey:Hl.VITE_FIREBASE_API_KEY,authDomain:Hl.VITE_FIREBASE_AUTH_DOMAIN,projectId:Hl.VITE_FIREBASE_PROJECT_ID,storageBucket:Hl.VITE_FIREBASE_STORAGE_BUCKET,messagingSenderId:Hl.VITE_FIREBASE_MESSAGING_SENDER_ID,appId:Hl.VITE_FIREBASE_APP_ID};if(!Ak.apiKey)throw new Error("Firebase config not found. Make sure you have a .env.local file with VITE_FIREBASE_* variables.");xr.apps.length||xr.initializeApp(Ak);const vg=xr.auth(),up=xr.firestore(),{serverTimestamp:C3}=xr.firestore.FieldValue,Vd=up.collection("students"),hp=up.collection("batches"),Ik=up.collection("transactions"),k3=r=>Vd.orderBy("createdAt","desc").onSnapshot(e=>{const t=e.docs.map(n=>({id:n.id,...n.data()}));r(t)}),N3=r=>hp.onSnapshot(e=>{const t=e.docs.map(n=>({id:n.id,...n.data()}));r(t)}),O3=r=>Ik.orderBy("date","desc").onSnapshot(e=>{const t=e.docs.map(n=>({id:n.id,...n.data()}));r(t)}),xk=async r=>await Vd.add({...r,createdAt:C3()}),L_=async(r,e)=>await Vd.doc(r).update(e),P3=async r=>await Vd.doc(r).delete(),D3=async r=>await hp.add(r),U_=async(r,e)=>await hp.doc(r).update(e),V3=async r=>{const e=up.batch();r.studentIds.forEach(n=>{const s=Vd.doc(n);e.delete(s)});const t=hp.doc(r.id);return e.delete(t),await e.commit()},M3=async r=>await Ik.add(r),j3=()=>{const[r,e]=fe.useState(!0),[t,n]=fe.useState(""),[s,o]=fe.useState(""),[c,h]=fe.useState(""),[d,m]=fe.useState(!1),y=async _=>{_.preventDefault(),h(""),m(!0);try{r?await vg.signInWithEmailAndPassword(t,s):await vg.createUserWithEmailAndPassword(t,s)}catch(E){h(E.message)}finally{m(!1)}};return w.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 dark:bg-gray-900",children:w.jsxs("div",{className:"w-full max-w-md p-8 space-y-6 bg-white rounded-lg shadow-md dark:bg-gray-800",children:[w.jsxs("div",{className:"text-center",children:[w.jsx("h1",{className:"text-3xl font-bold text-indigo-600 dark:text-indigo-400",children:"Vidya-Gram"}),w.jsx("h2",{className:"mt-2 text-xl font-semibold text-gray-800 dark:text-white",children:r?"Login to your account":"Create a new account"})]}),w.jsxs("form",{className:"mt-6 space-y-6",onSubmit:y,children:[w.jsxs("div",{className:"rounded-md shadow-sm -space-y-px",children:[w.jsx("div",{children:w.jsx("input",{id:"email-address",name:"email",type:"email",autoComplete:"email",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white",placeholder:"Email address",value:t,onChange:_=>n(_.target.value)})}),w.jsx("div",{children:w.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white",placeholder:"Password",value:s,onChange:_=>o(_.target.value)})})]}),c&&w.jsx("p",{className:"text-sm text-red-500",children:c}),w.jsx("div",{children:w.jsx("button",{type:"submit",disabled:d,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:bg-indigo-400",children:d?"Processing...":r?"Sign in":"Sign up"})})]}),w.jsxs("p",{className:"text-sm text-center text-gray-600 dark:text-gray-400",children:[r?"Don't have an account?":"Already have an account?",w.jsx("button",{onClick:()=>e(!r),className:"ml-1 font-medium text-indigo-600 hover:text-indigo-500",children:r?"Sign up":"Sign in"})]})]})})};var Gn=(r=>(r.Dashboard="DASHBOARD",r.Students="STUDENTS",r.Batches="BATCHES",r.Payments="PAYMENTS",r))(Gn||{});const bm=({icon:r,text:e,active:t,onClick:n})=>w.jsxs("button",{onClick:n,className:`flex items-center w-full px-4 py-2 text-sm font-medium rounded-lg transition-colors duration-200 ${t?"bg-indigo-600 text-white":"text-gray-500 hover:bg-gray-200 dark:text-gray-400 dark:hover:bg-gray-700"}`,children:[r,w.jsx("span",{className:"ml-3",children:e})]}),L3=({currentView:r,setView:e})=>w.jsxs("div",{className:"hidden md:flex flex-col w-64 bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700",children:[w.jsxs("div",{className:"flex items-center justify-center h-16 border-b border-gray-200 dark:border-gray-700 px-4",children:[w.jsx("svg",{className:"w-8 h-8 text-indigo-600 dark:text-indigo-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25"})}),w.jsx("h1",{className:"ml-2 text-xl font-bold text-indigo-600 dark:text-indigo-400",children:"Vidya-Gram"})]}),w.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:w.jsxs("nav",{className:"flex flex-col space-y-2",children:[w.jsx(bm,{href:"#",text:"Dashboard",active:r===Gn.Dashboard,onClick:()=>e(Gn.Dashboard),icon:w.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})})}),w.jsx(bm,{href:"#",text:"Students",active:r===Gn.Students,onClick:()=>e(Gn.Students),icon:w.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M15 21a6 6 0 00-9-5.197m0 0A5.975 5.975 0 0112 13a5.975 5.975 0 013 5.197M15 21a6 6 0 00-9-5.197"})})}),w.jsx(bm,{href:"#",text:"Batches",active:r===Gn.Batches,onClick:()=>e(Gn.Batches),icon:w.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),w.jsx(bm,{href:"#",text:"Payments",active:r===Gn.Payments,onClick:()=>e(Gn.Payments),icon:w.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 8h6m-5 4h.01M4 16V6a2 2 0 012-2h12a2 2 0 012 2v10a2 2 0 01-2 2H6a2 2 0 01-2-2z"})})})]})})]}),U3=({user:r,onAddStudent:e,onBulkUpload:t,theme:n,toggleTheme:s})=>{const[o,c]=fe.useState(!1),h=()=>{vg.signOut()},d=()=>w.jsxs("button",{onClick:s,className:"p-2 rounded-full text-gray-500 hover:bg-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-100 dark:focus:ring-offset-gray-800 focus:ring-indigo-500",children:[w.jsx("span",{className:"sr-only",children:"Toggle theme"}),n==="dark"?w.jsx("svg",{className:"h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}):w.jsx("svg",{className:"h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})})]});return w.jsx("header",{className:"flex items-center justify-end h-16 px-6 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700",children:w.jsxs("div",{className:"flex items-center space-x-4",children:[w.jsx(d,{}),w.jsxs("button",{onClick:t,className:"hidden sm:inline-flex items-center px-3 py-2 text-sm font-medium text-center text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 focus:ring-4 focus:outline-none focus:ring-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600 dark:focus:ring-gray-600",children:[w.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),"Bulk Upload"]}),w.jsxs("button",{onClick:e,className:"inline-flex items-center px-3 py-2 text-sm font-medium text-center text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 focus:ring-4 focus:outline-none focus:ring-indigo-300 dark:bg-indigo-500 dark:hover:bg-indigo-600 dark:focus:ring-indigo-800",children:[w.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Student"]}),w.jsxs("div",{className:"relative",children:[w.jsxs("button",{onClick:()=>c(!o),className:"flex items-center text-sm rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-100 dark:focus:ring-offset-gray-800 focus:ring-indigo-500",children:[w.jsx("span",{className:"sr-only",children:"Open user menu"}),w.jsx("img",{className:"h-8 w-8 rounded-full",src:`https://ui-avatars.com/api/?name=${r.email}&background=random`,alt:"User avatar"})]}),o&&w.jsxs("div",{className:"absolute right-0 w-48 mt-2 origin-top-right bg-white rounded-md shadow-lg py-1 ring-1 ring-black ring-opacity-5 dark:bg-gray-700",children:[w.jsxs("div",{className:"px-4 py-3",children:[w.jsx("p",{className:"text-sm text-gray-900 dark:text-white",children:"Signed in as"}),w.jsx("p",{className:"text-sm font-medium text-gray-900 truncate dark:text-gray-300",children:r.email})]}),w.jsx("div",{className:"border-t border-gray-100 dark:border-gray-600"}),w.jsx("button",{onClick:h,className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 dark:text-gray-200 dark:hover:bg-gray-600",children:"Sign out"})]})]})]})})},Rk=({isOpen:r,onClose:e,onConfirm:t,title:n,message:s})=>r?w.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:w.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-md",children:w.jsxs("div",{className:"p-6",children:[w.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:n}),w.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:s}),w.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[w.jsx("button",{onClick:e,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 focus:outline-none dark:bg-gray-600 dark:text-gray-200 dark:border-gray-500 dark:hover:bg-gray-500",children:"Cancel"}),w.jsx("button",{onClick:t,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 border border-transparent rounded-md shadow-sm hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Confirm"})]})]})})}):null,B3=({students:r,onClose:e})=>{const t=["Roll No","Name","Father","Mother","Phone","Emergency Number","Gender","Batch","Address","Total Fees","Total Paid","Fees Remaining","Full Paid","Mode","Remarks","imageUrl"],[n,s]=fe.useState(new Set(t)),o=d=>{s(m=>{const y=new Set(m);return y.has(d)?y.delete(d):y.add(d),y})},c=d=>{s(d?new Set(t):new Set)},h=()=>{if(n.size===0){alert("Please select at least one column to export.");return}const d=E=>(E.payments||[]).reduce((S,C)=>S+C.amount,0),m=r.map(E=>{const S=d(E),C=E["Total Fees"]-S,k={...E,"Total Paid":S,"Fees Remaining":C>0&&!E["Full Paid"]?C:0},N={};return n.forEach(G=>{N[G]=k[G]}),N}),y=XLSX.utils.json_to_sheet(m),_=XLSX.utils.book_new();XLSX.utils.book_append_sheet(_,y,"Students"),XLSX.writeFile(_,`student_data_${new Date().toISOString().slice(0,10)}.xlsx`),e()};return w.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:w.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-xl w-full max-w-md",children:[w.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Export Student Data"}),w.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:"Select columns for export."}),w.jsxs("div",{className:"mb-4 flex gap-4",children:[w.jsx("button",{onClick:()=>c(!0),className:"text-sm text-indigo-600 hover:underline",children:"Select All"}),w.jsx("button",{onClick:()=>c(!1),className:"text-sm text-indigo-600 hover:underline",children:"Deselect All"})]}),w.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 max-h-60 overflow-y-auto border p-2 rounded-md dark:border-gray-600",children:t.map(d=>w.jsxs("label",{className:"flex items-center space-x-2 text-sm text-gray-700 dark:text-gray-300",children:[w.jsx("input",{type:"checkbox",checked:n.has(d),onChange:()=>o(d),className:"h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),w.jsx("span",{children:d})]},d))}),w.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[w.jsx("button",{onClick:e,className:"px-4 py-2 bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-200 rounded-md hover:bg-gray-300 dark:hover:bg-gray-500",children:"Cancel"}),w.jsx("button",{onClick:h,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:"Export"})]})]})})},F3=({isOpen:r,onClose:e,students:t,onCreateBatch:n})=>{const[s,o]=fe.useState(""),[c,h]=fe.useState(new Set),[d,m]=fe.useState(""),y=fe.useMemo(()=>t.filter(S=>S.Name.toLowerCase().includes(d.toLowerCase())||String(S["Roll No"]).toLowerCase().includes(d.toLowerCase())),[t,d]),_=S=>{h(C=>{const k=new Set(C);return k.has(S)?k.delete(S):k.add(S),k})},E=()=>{s.trim()&&c.size>0?(n(s.trim(),Array.from(c)),e()):alert("Please provide a batch name and select at least one student.")};return r?w.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:w.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-xl w-full max-w-lg flex flex-col",children:[w.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Create New Batch"}),w.jsx("input",{type:"text",placeholder:"Enter batch name",value:s,onChange:S=>o(S.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500"}),w.jsx("input",{type:"text",placeholder:"Search students to add...",value:d,onChange:S=>m(S.target.value),className:"w-full px-3 py-2 mt-4 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500"}),w.jsx("div",{className:"my-4 border rounded-md h-64 overflow-y-auto p-2 dark:border-gray-600",children:y.map(S=>w.jsxs("label",{className:"flex items-center p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300",children:[w.jsx("input",{type:"checkbox",className:"h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500",checked:c.has(S.id),onChange:()=>_(S.id)}),w.jsxs("span",{className:"ml-3 text-sm",children:[S.Name," (",S["Roll No"],")"]})]},S.id))}),w.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-2",children:[c.size," student(s) selected."]}),w.jsxs("div",{className:"mt-4 flex justify-end gap-3",children:[w.jsx("button",{onClick:e,className:"px-4 py-2 bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-200 rounded-md hover:bg-gray-300 dark:hover:bg-gray-500",children:"Cancel"}),w.jsx("button",{onClick:E,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700",children:"Create Batch"})]})]})}):null},z3=({students:r,onEditStudent:e,onCreateBatch:t,onDeleteStudent:n,onDeleteSelected:s,onRecordPayment:o})=>{const[c,h]=fe.useState(""),[d,m]=fe.useState(new Set),[y,_]=fe.useState(!1),[E,S]=fe.useState(!1),[C,k]=fe.useState(null),[N,G]=fe.useState("desc"),[J,K]=fe.useState("All"),[se,ye]=fe.useState("All"),[he,R]=fe.useState(!1),x=Z=>(Z.payments||[]).reduce((ve,V)=>ve+V.amount,0),O=fe.useMemo(()=>["All",...Array.from(new Set(r.map(Z=>Z.Batch).filter(Boolean)))],[r]),L=fe.useMemo(()=>r.filter(Z=>{const ve=c.toLowerCase().trim(),V=!ve||String(Z.Name??"").toLowerCase().includes(ve)||String(Z["Roll No"]??"").toLowerCase().includes(ve)||String(Z.Phone??"").toLowerCase().includes(ve),W=J==="All"||Z.Batch===J,de=x(Z),ce=Z["Full Paid"]||de>=Z["Total Fees"];let Ie=!0;return se==="Fully Paid"?Ie=ce:se==="Partially Paid"&&(Ie=!ce&&de>0),V&&W&&Ie}),[r,c,J,se]),M=Z=>{m(ve=>{const V=new Set(ve);return V.has(Z)?V.delete(Z):V.add(Z),V})},U=Z=>{Z.target.checked?m(new Set(L.map(ve=>ve.id))):m(new Set)},P=Z=>ve=>{Z(ve.target.value),m(new Set)},et=()=>{s(Array.from(d)),R(!1),m(new Set)},We=Z=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0}).format(Z),ee=()=>{G(Z=>Z==="desc"?"asc":"desc")},ue=({label:Z,value:ve})=>w.jsxs("div",{children:[w.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:Z}),w.jsx("p",{className:"text-sm font-medium text-gray-800 dark:text-gray-200",children:ve||"N/A"})]}),oe=({student:Z})=>{const ve=x(Z);if(Z["Full Paid"]||ve>=Z["Total Fees"])return w.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:"PAID"});const W=Z["Total Fees"]-ve;return w.jsx("span",{className:"font-semibold text-red-600 dark:text-red-400",children:We(W)})};return w.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 md:p-6 rounded-lg shadow-lg",children:[w.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-4 gap-4",children:[w.jsxs("div",{children:[w.jsx("h2",{className:"text-2xl font-semibold text-gray-800 dark:text-white",children:"Student List"}),w.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:["Showing ",L.length," of ",r.length," students"]})]}),w.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-2 w-full sm:w-auto",children:[w.jsx("button",{onClick:()=>_(!0),className:"w-full sm:w-auto px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition-colors",children:"Create Batch"}),w.jsx("button",{onClick:()=>S(!0),className:"w-full sm:w-auto px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",children:"Export Data"})]})]}),w.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-4 pb-4 border-b dark:border-gray-700",children:[w.jsx("div",{className:"relative w-full md:w-1/3",children:w.jsx("input",{type:"text",placeholder:"Search by name, roll, or phone...",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700",value:c,onChange:Z=>h(Z.target.value)})}),w.jsxs("div",{className:"flex gap-4",children:[w.jsx("select",{onChange:P(K),value:J,className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-white dark:bg-gray-700",children:O.map(Z=>w.jsx("option",{value:Z,children:Z==="All"?"All Batches":Z},Z))}),w.jsxs("select",{onChange:P(ye),value:se,className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-white dark:bg-gray-700",children:[w.jsx("option",{value:"All",children:"All Statuses"}),w.jsx("option",{value:"Fully Paid",children:"Fully Paid"}),w.jsx("option",{value:"Partially Paid",children:"Partially Paid"})]})]}),w.jsx("div",{className:"md:ml-auto",children:d.size>0&&w.jsxs("button",{onClick:()=>R(!0),className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors",children:["Delete Selected (",d.size,")"]})})]}),w.jsxs("div",{className:"overflow-x-auto",children:[w.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[w.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:w.jsxs("tr",{children:[w.jsx("th",{scope:"col",className:"p-4",children:w.jsx("input",{type:"checkbox",className:"h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500",onChange:U,checked:L.length>0&&d.size===L.length})}),w.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Roll No"}),w.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Name"}),w.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Contact"}),w.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Amount Paid"}),w.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Dues"}),w.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),w.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:L.map(Z=>{const ve=C===Z.id,V=fe.useMemo(()=>[...Z.payments||[]].sort((W,de)=>{const ce=new Date(W.date).getTime(),Ie=new Date(de.date).getTime();return N==="desc"?Ie-ce:ce-Ie}),[Z.payments,N]);return w.jsxs(fx.Fragment,{children:[w.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer",onClick:()=>k(ve?null:Z.id),children:[w.jsx("td",{className:"p-4",onClick:W=>W.stopPropagation(),children:w.jsx("input",{type:"checkbox",className:"h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500",checked:d.has(Z.id),onChange:()=>M(Z.id)})}),w.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:Z["Roll No"]}),w.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:Z.Name}),w.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:Z.Phone}),w.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700 dark:text-gray-300",children:We(x(Z))}),w.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:w.jsx(oe,{student:Z})}),w.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",onClick:W=>W.stopPropagation(),children:[w.jsx("button",{onClick:()=>o(Z),className:"text-green-600 hover:text-green-900 dark:text-green-400 dark:hover:text-green-300",children:"Pay Fee"}),w.jsx("button",{onClick:()=>e(Z),className:"ml-4 text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-300",children:"Edit"}),w.jsx("button",{onClick:()=>n(Z),className:"ml-4 text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",children:"Delete"})]})]}),ve&&w.jsx("tr",{className:"bg-gray-50 dark:bg-gray-900",children:w.jsx("td",{colSpan:7,className:"p-4",children:w.jsxs("div",{className:"space-y-4",children:[w.jsxs("div",{className:"flex gap-6",children:[w.jsx("div",{className:"flex-shrink-0",children:Z.imageUrl?w.jsx("img",{src:Z.imageUrl,alt:Z.Name,className:"h-24 w-24 rounded-full object-cover shadow-md"}):w.jsx("div",{className:"h-24 w-24 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center shadow-md",children:w.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-12 w-12 text-gray-400",viewBox:"0 0 20 20",fill:"currentColor",children:w.jsx("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})})})}),w.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4 flex-1",children:[w.jsx(ue,{label:"Roll No",value:Z["Roll No"]}),w.jsx(ue,{label:"Gender",value:Z.Gender}),w.jsx(ue,{label:"Batch",value:Z.Batch}),w.jsx(ue,{label:"Payment Mode",value:Z.Mode}),w.jsx(ue,{label:"Address",value:Z.Address}),w.jsx(ue,{label:"Father's Name",value:Z.Father}),w.jsx(ue,{label:"Mother's Name",value:Z.Mother}),w.jsx(ue,{label:"Emergency Number",value:Z["Emergency Number"]}),w.jsx(ue,{label:"Total Fees",value:We(Z["Total Fees"])}),w.jsx("div",{className:"col-span-full",children:w.jsx(ue,{label:"Remarks",value:Z.Remarks})})]})]}),w.jsx("div",{className:"pt-4 mt-4 border-t border-gray-200 dark:border-gray-700",children:w.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-inner",children:[w.jsxs("div",{className:"flex flex-wrap justify-between items-center mb-3 gap-2",children:[w.jsx("h4",{className:"text-md font-semibold text-gray-700 dark:text-gray-300",children:"Payment History"}),w.jsxs("div",{className:"flex items-center gap-4",children:[w.jsxs("p",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:["Total Paid: ",w.jsx("span",{className:"font-bold text-green-700 dark:text-green-400",children:We(x(Z))})]}),w.jsxs("p",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:["Fees Remaining: ",w.jsx("span",{className:"font-bold text-red-700 dark:text-red-400",children:We(Math.max(0,Z["Total Fees"]-x(Z)))})]})]})]}),V.length>0?w.jsxs("table",{className:"min-w-full text-sm",children:[w.jsx("thead",{className:"bg-gray-100 dark:bg-gray-700",children:w.jsxs("tr",{children:[w.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500 dark:text-gray-400",children:w.jsxs("button",{onClick:ee,className:"flex items-center gap-1 hover:text-gray-700 dark:hover:text-gray-300",children:["Date",w.jsx("span",{className:"text-indigo-600",children:N==="desc"?"↓":"↑"})]})}),w.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500 dark:text-gray-400",children:"Amount"}),w.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500 dark:text-gray-400",children:"Method"}),w.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500 dark:text-gray-400",children:"Remarks"})]})}),w.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:V.map(W=>w.jsxs("tr",{children:[w.jsx("td",{className:"px-4 py-2",children:W.date}),w.jsx("td",{className:"px-4 py-2",children:We(W.amount)}),w.jsx("td",{className:"px-4 py-2",children:W.method}),w.jsx("td",{className:"px-4 py-2",children:W.remarks})]},W.id))})]}):w.jsx("p",{className:"text-sm text-center text-gray-500 dark:text-gray-400 py-4",children:"No payments recorded for this student."})]})})]})})})]},`${Z.id}-${(Z.payments||[]).length}`)})})]}),L.length===0&&w.jsx("p",{className:"text-center py-4 text-gray-500 dark:text-gray-400",children:"No students found."})]}),w.jsx(F3,{isOpen:y,onClose:()=>_(!1),students:r,onCreateBatch:t}),E&&w.jsx(B3,{students:L,onClose:()=>S(!1)}),he&&w.jsx(Rk,{isOpen:he,onClose:()=>R(!1),onConfirm:et,title:"Delete Selected Students",message:`Are you sure you want to delete ${d.size} student(s)? This action cannot be undone.`})]})},VI={"Roll No":"",Name:"",Father:"",Mother:"",Phone:"","Emergency Number":"",Gender:"Male",Batch:"",Address:"","Total Fees":0,payments:[],Remarks:"","Full Paid":!1,Mode:"One Time",imageUrl:"",imagePath:""},q3=({isOpen:r,onClose:e,onSubmit:t,student:n})=>{const[s,o]=fe.useState(VI),[c,h]=fe.useState(null),[d,m]=fe.useState(null);fe.useEffect(()=>{n?(o(n),m(n.imageUrl||null)):(o(VI),m(null)),h(null)},[n,r]);const y=S=>{const{name:C,value:k,type:N}=S.target;let G=k;N==="checkbox"?G=S.target.checked:C==="Total Fees"&&(G=Number(k)),o(J=>({...J,[C]:G}))},_=async S=>{var k;const C=(k=S.target.files)==null?void 0:k[0];if(C)try{const N={maxSizeMB:1,maxWidthOrHeight:800,useWebWorker:!0},G=await imageCompression(C,N);h(G),m(URL.createObjectURL(G))}catch(N){console.error("Image compression failed:",N),h(C),m(URL.createObjectURL(C))}},E=S=>{S.preventDefault(),t(s,c)};return r?w.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:w.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-2xl max-h-full overflow-y-auto",children:w.jsxs("div",{className:"p-6",children:[w.jsxs("div",{className:"flex justify-between items-start",children:[w.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:n?"Edit Student":"Add New Student"}),w.jsx("button",{onClick:e,className:"text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center dark:hover:bg-gray-600 dark:hover:text-white",children:w.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:w.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),w.jsxs("form",{onSubmit:E,className:"mt-4 space-y-6",children:[w.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-6 p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[d?w.jsx("img",{src:d,alt:"Profile Preview",className:"w-24 h-24 rounded-full object-cover shadow-md"}):w.jsx("div",{className:"w-24 h-24 rounded-full bg-gray-200 dark:bg-gray-600 flex items-center justify-center shadow-md",children:w.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-12 w-12 text-gray-400",viewBox:"0 0 20 20",fill:"currentColor",children:w.jsx("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})})}),w.jsxs("div",{children:[w.jsxs("label",{htmlFor:"photo-upload",className:"cursor-pointer px-4 py-2 bg-white dark:bg-gray-600 border border-gray-300 dark:border-gray-500 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-500",children:[w.jsx("span",{children:"Upload Photo"}),w.jsx("input",{id:"photo-upload",name:"photo-upload",type:"file",className:"sr-only",accept:"image/*",onChange:_})]}),w.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:"PNG or JPG. Recommended size: 800x800px."})]})]}),w.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[w.jsx("input",{type:"text",name:"Name",value:s.Name,onChange:y,placeholder:"Full Name",required:!0,className:"w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:border-gray-600"}),w.jsx("input",{type:"text",name:"Roll No",value:s["Roll No"],onChange:y,placeholder:"Roll No.",required:!0,className:"w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:border-gray-600"}),w.jsx("input",{type:"text",name:"Father",value:s.Father,onChange:y,placeholder:"Father's Name",className:"w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:border-gray-600"}),w.jsx("input",{type:"text",name:"Mother",value:s.Mother,onChange:y,placeholder:"Mother's Name",className:"w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:border-gray-600"}),w.jsx("input",{type:"tel",name:"Phone",value:s.Phone,onChange:y,placeholder:"Phone Number",required:!0,className:"w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:border-gray-600"}),w.jsx("input",{type:"tel",name:"Emergency Number",value:s["Emergency Number"],onChange:y,placeholder:"Emergency Number",className:"w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:border-gray-600"}),w.jsxs("select",{name:"Gender",value:s.Gender,onChange:y,className:"w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:border-gray-600",children:[w.jsx("option",{children:"Male"}),w.jsx("option",{children:"Female"}),w.jsx("option",{children:"Other"})]}),w.jsx("input",{type:"text",name:"Batch",value:s.Batch,onChange:y,placeholder:"Batch",required:!0,className:"w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:border-gray-600"}),w.jsx("input",{type:"number",name:"Total Fees",value:s["Total Fees"],onChange:y,placeholder:"Total Fees",required:!0,className:"w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:border-gray-600"}),w.jsxs("select",{name:"Mode",value:s.Mode,onChange:y,className:"w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:border-gray-600",children:[w.jsx("option",{children:"One Time"}),w.jsx("option",{children:"Monthly"})]})]}),w.jsx("textarea",{name:"Address",value:s.Address,onChange:y,placeholder:"Address",rows:2,className:"w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:border-gray-600"}),w.jsx("textarea",{name:"Remarks",value:s.Remarks,onChange:y,placeholder:"Remarks",rows:2,className:"w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:border-gray-600"}),w.jsxs("div",{className:"flex items-center",children:[w.jsx("input",{id:"full-paid",type:"checkbox",name:"Full Paid",checked:!!s["Full Paid"],onChange:y,className:"w-4 h-4 text-indigo-600 bg-gray-100 border-gray-300 rounded focus:ring-indigo-500 dark:focus:ring-indigo-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"}),w.jsx("label",{htmlFor:"full-paid",className:"ml-2 text-sm font-medium text-gray-900 dark:text-gray-300",children:"Mark as Full Paid"})]}),w.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[w.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 focus:outline-none dark:bg-gray-600 dark:text-gray-200 dark:border-gray-500 dark:hover:bg-gray-500",children:"Cancel"}),w.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 border border-transparent rounded-md shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:n?"Update Student":"Add Student"})]})]})]})})}):null},$3=({student:r,onClose:e,onSave:t})=>{const[n,s]=fe.useState(r),[o,c]=fe.useState(null),[h,d]=fe.useState(r.imageUrl||null);fe.useEffect(()=>{s(r),d(r.imageUrl||null),c(null)},[r]);const m=k=>{const{name:N,value:G,type:J}=k.target;if(J==="checkbox"){const{checked:se}=k.target;s(ye=>({...ye,[N]:se}));return}const K=N==="Total Fees";s(se=>({...se,[N]:J==="number"&&K?parseFloat(G)||0:G}))},y=async k=>{var G;const N=(G=k.target.files)==null?void 0:G[0];if(N)try{const J={maxSizeMB:1,maxWidthOrHeight:800,useWebWorker:!0},K=await imageCompression(N,J);c(K);const se=new FileReader;se.onloadend=()=>{d(se.result)},se.readAsDataURL(K)}catch(J){console.error("Error compressing image:",J),c(N);const K=new FileReader;K.onloadend=()=>{d(K.result)},K.readAsDataURL(N)}},_=k=>{k.preventDefault(),t(n,o||void 0)},E=fe.useMemo(()=>(n.payments||[]).reduce((k,N)=>k+N.amount,0),[n.payments]),S=fe.useMemo(()=>(n["Total Fees"]||0)-E,[n,E]),C=k=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(k);return w.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:w.jsxs("div",{className:"bg-white dark:bg-gray-800 p-8 rounded-lg shadow-2xl w-full max-w-4xl max-h-full overflow-y-auto",children:[w.jsx("h2",{className:"text-2xl font-bold text-gray-800 dark:text-white mb-6",children:"Edit Student Profile"}),w.jsxs("form",{onSubmit:_,className:"space-y-6",children:[w.jsxs("div",{className:"flex flex-col md:flex-row gap-8",children:[w.jsxs("div",{className:"md:w-1/3 space-y-4",children:[w.jsxs("fieldset",{children:[w.jsx("legend",{className:"text-lg font-semibold text-gray-700 dark:text-gray-300 border-b border-gray-200 dark:border-gray-700 pb-2 mb-4",children:"Profile Photo"}),w.jsxs("div",{className:"flex flex-col items-center",children:[h?w.jsx("img",{src:h,alt:"Student",className:"h-32 w-32 rounded-full object-cover shadow-lg mb-4"}):w.jsx("div",{className:"h-32 w-32 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center shadow-lg mb-4",children:w.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-16 w-16 text-gray-400",viewBox:"0 0 20 20",fill:"currentColor",children:w.jsx("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})})}),w.jsxs("label",{htmlFor:"photo-upload",className:"cursor-pointer px-4 py-2 bg-white dark:bg-gray-600 border border-gray-300 dark:border-gray-500 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-500",children:[w.jsx("span",{children:"Change Photo"}),w.jsx("input",{id:"photo-upload",name:"photo-upload",type:"file",className:"sr-only",accept:"image/*",onChange:y})]})]})]}),w.jsxs("div",{className:"text-center md:text-left",children:[w.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Roll No"}),w.jsx("input",{type:"text",name:"Roll No",value:n["Roll No"],onChange:m,className:"mt-1 block w-full px-3 py-2 bg-gray-100 dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none sm:text-sm",readOnly:!0})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Name"}),w.jsx("input",{type:"text",name:"Name",value:n.Name,onChange:m,className:"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm dark:bg-gray-700"})]})]}),w.jsx("div",{className:"md:w-2/3",children:w.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Gender"}),w.jsxs("select",{name:"Gender",value:n.Gender,onChange:m,className:"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[w.jsx("option",{children:"Male"}),w.jsx("option",{children:"Female"}),w.jsx("option",{children:"Other"})]})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Batch"}),w.jsx("input",{type:"text",name:"Batch",value:n.Batch,onChange:m,className:"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm dark:bg-gray-700"})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Father"}),w.jsx("input",{type:"text",name:"Father",value:n.Father||"",onChange:m,className:"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm dark:bg-gray-700"})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Mother"}),w.jsx("input",{type:"text",name:"Mother",value:n.Mother||"",onChange:m,className:"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm dark:bg-gray-700"})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Phone"}),w.jsx("input",{type:"tel",name:"Phone",value:n.Phone,onChange:m,className:"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm dark:bg-gray-700"})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Emergency Number"}),w.jsx("input",{type:"tel",name:"Emergency Number",value:n["Emergency Number"]||"",onChange:m,className:"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm dark:bg-gray-700"})]}),w.jsxs("div",{className:"md:col-span-2",children:[w.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Address"}),w.jsx("input",{type:"text",name:"Address",value:n.Address||"",onChange:m,className:"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm dark:bg-gray-700"})]})]})})]}),w.jsxs("fieldset",{children:[w.jsx("legend",{className:"text-lg font-semibold text-gray-700 dark:text-gray-300 border-b border-gray-200 dark:border-gray-700 pb-2 mb-4",children:"Payment Details"}),w.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Total Fees"}),w.jsx("input",{type:"number",name:"Total Fees",value:n["Total Fees"]||"",onChange:m,className:"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm dark:bg-gray-700",placeholder:"e.g., 50000"})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Payment Mode"}),w.jsxs("select",{name:"Mode",value:n.Mode||"",onChange:m,className:"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[w.jsx("option",{value:"",children:"Not Specified"}),w.jsx("option",{children:"Monthly"}),w.jsx("option",{children:"One Time"})]})]}),w.jsxs("div",{className:"md:col-span-2",children:[w.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Total Paid"}),w.jsx("div",{className:"mt-1 block w-full px-3 py-2 bg-gray-100 dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm sm:text-sm",children:C(E)})]}),w.jsx("div",{className:"md:col-span-2",children:w.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-md text-center",children:[w.jsx("span",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Remaining Fees: "}),w.jsx("span",{className:`font-bold ${S>0?"text-red-600":"text-green-600"}`,children:C(S)})]})}),w.jsxs("div",{className:"flex items-center gap-2 mt-2 md:col-span-2",children:[w.jsx("input",{id:"full-paid",name:"Full Paid",type:"checkbox",checked:n["Full Paid"]??!1,onChange:m,className:"h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),w.jsxs("div",{children:[w.jsx("label",{htmlFor:"full-paid",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Mark as Full Paid"}),w.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Overrides calculated status. Use for discounts or scholarships."})]})]})]}),w.jsxs("div",{className:"mt-4",children:[w.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Student Remarks"}),w.jsx("textarea",{name:"Remarks",value:n.Remarks||"",onChange:m,rows:3,className:"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm dark:bg-gray-700",placeholder:"Add any general remarks for the student here."})]})]}),w.jsxs("fieldset",{className:"mt-6",children:[w.jsx("legend",{className:"text-lg font-semibold text-gray-700 dark:text-gray-300 border-b border-gray-200 dark:border-gray-700 pb-2 mb-4",children:"Transaction History"}),w.jsx("div",{className:"max-h-48 overflow-y-auto border dark:border-gray-600 rounded-md bg-gray-50 dark:bg-gray-900",children:(n.payments||[]).length>0?w.jsxs("table",{className:"min-w-full text-sm",children:[w.jsx("thead",{className:"bg-gray-100 dark:bg-gray-700 sticky top-0",children:w.jsxs("tr",{children:[w.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-600 dark:text-gray-300",children:"Date"}),w.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-600 dark:text-gray-300",children:"Amount"}),w.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-600 dark:text-gray-300",children:"Method"}),w.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-600 dark:text-gray-300",children:"Remarks"})]})}),w.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700 bg-white dark:bg-gray-800",children:[...n.payments].sort((k,N)=>new Date(N.date).getTime()-new Date(k.date).getTime()).map(k=>w.jsxs("tr",{children:[w.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:k.date}),w.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:C(k.amount)}),w.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:k.method}),w.jsx("td",{className:"px-4 py-2",children:k.remarks})]},k.id))})]}):w.jsx("p",{className:"text-center text-gray-500 py-6",children:"No payment history found."})})]}),w.jsxs("div",{className:"flex justify-end gap-4 pt-8 border-t dark:border-gray-700 mt-8",children:[w.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-200 rounded-md hover:bg-gray-300 dark:hover:bg-gray-500",children:"Cancel"}),w.jsx("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700",children:"Save Changes"})]})]})]})})},H3=({isOpen:r,onClose:e,onUploadComplete:t})=>{const[n,s]=fe.useState(null),[o,c]=fe.useState(!1),[h,d]=fe.useState(""),[m,y]=fe.useState(0),_=S=>{S.target.files&&(s(S.target.files[0]),d(""),y(0))},E=async()=>{if(!n){d("Please select a file.");return}c(!0),d(""),y(0);const S=new FileReader;S.onload=async C=>{var k;try{const N=new Uint8Array((k=C.target)==null?void 0:k.result),G=XLSX.read(N,{type:"array"}),J=G.SheetNames[0],K=G.Sheets[J],se=XLSX.utils.sheet_to_json(K);if(se.length===0){d("The file is empty or doesn't contain valid data."),c(!1);return}const ye=se.map(x=>{const O={Name:x.Name||"","Roll No":String(x["Roll No"]||""),Phone:String(x.Phone||""),Batch:x.Batch||"","Total Fees":Number(x["Total Fees"]||0),Father:x.Father||"",Mother:x.Mother||"","Emergency Number":String(x["Emergency Number"]||""),Gender:x.Gender||"Male",Address:x.Address||"",Remarks:x.Remarks||"","Full Paid":!!x["Full Paid"],Mode:x.Mode||"One Time",payments:[]};return!O.Name||!O["Roll No"]||!O.Batch?(console.warn("Skipping row due to missing required fields (Name, Roll No, Batch):",x),Promise.resolve()):xk(O)}),R=(await Promise.allSettled(ye)).filter(x=>x.status==="fulfilled").length;y(R),t(),setTimeout(()=>{e()},2e3)}catch(N){console.error(N),d("Failed to process the file. Please check the format and headers.")}finally{c(!1)}},S.readAsArrayBuffer(n)};return r?w.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:w.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-md",children:w.jsxs("div",{className:"p-6",children:[w.jsxs("div",{className:"flex justify-between items-start",children:[w.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Bulk Upload Students"}),w.jsx("button",{onClick:e,className:"text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center dark:hover:bg-gray-600 dark:hover:text-white",children:w.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:w.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),w.jsxs("div",{className:"mt-4 space-y-4",children:[w.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Upload an Excel (.xlsx, .xls) or CSV file. Required headers: ",w.jsx("strong",{children:"Name, Roll No, Batch"}),". Optional: Phone, Total Fees, Father, etc."]}),w.jsx("input",{type:"file",onChange:_,accept:".xlsx, .xls, .csv",className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100"}),h&&w.jsx("p",{className:"text-sm text-red-500",children:h}),m>0&&w.jsxs("p",{className:"text-sm text-green-500",children:["Successfully uploaded ",m," students!"]})]}),w.jsxs("div",{className:"flex justify-end space-x-3 pt-6",children:[w.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 dark:bg-gray-600 dark:text-gray-200 dark:border-gray-500 dark:hover:bg-gray-500",children:"Cancel"}),w.jsx("button",{onClick:E,disabled:o,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 border border-transparent rounded-md shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:bg-indigo-400",children:o?"Uploading...":"Upload"})]})]})})}):null},G3=({student:r,onClose:e,onSave:t})=>{const[n,s]=fe.useState(""),[o,c]=fe.useState("Online"),[h,d]=fe.useState(new Date().toISOString().slice(0,10)),[m,y]=fe.useState(""),_=fe.useMemo(()=>(r.payments||[]).reduce((N,G)=>N+G.amount,0),[r.payments]),E=fe.useMemo(()=>r["Total Fees"]-_,[r,_]),S=N=>{const G=N.target.value;/^\d*\.?\d*$/.test(G)&&s(G)},C=N=>{N.preventDefault();const G=parseFloat(n);if(!G||G<=0){alert("Please enter a valid positive amount.");return}if(!h||new Date(h).toString()==="Invalid Date"){alert("Please select a valid date.");return}const J={id:`payment-${r.id}-${Date.now()}`,amount:G,method:o,date:h,remarks:m};t(r,J)},k=N=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(N);return w.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:w.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-2xl w-full max-w-md",children:[w.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-2",children:"Record Payment"}),w.jsxs("p",{className:"text-sm text-gray-600 mb-6",children:["For: ",w.jsx("span",{className:"font-semibold",children:r.Name})]}),w.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6 bg-gray-50 p-4 rounded-md",children:[w.jsxs("div",{children:[w.jsx("p",{className:"text-xs text-gray-500",children:"Total Fees"}),w.jsx("p",{className:"font-semibold",children:k(r["Total Fees"])})]}),w.jsxs("div",{children:[w.jsx("p",{className:"text-xs text-gray-500",children:"Fees Remaining"}),w.jsx("p",{className:`font-semibold ${E>0?"text-red-600":"text-green-600"}`,children:k(E)})]})]}),w.jsxs("form",{onSubmit:C,className:"space-y-4",children:[w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Amount"}),w.jsx("input",{type:"text",value:n,onChange:S,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"Enter amount being paid",required:!0,pattern:"^\\d*\\.?\\d*$"})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Payment Method"}),w.jsxs("select",{value:o,onChange:N=>c(N.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[w.jsx("option",{children:"Online"}),w.jsx("option",{children:"Cash"}),w.jsx("option",{children:"Card"}),w.jsx("option",{children:"UPI"}),w.jsx("option",{children:"Other"})]})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Payment Date"}),w.jsx("input",{type:"date",value:h,onChange:N=>d(N.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",required:!0})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Remarks (Optional)"}),w.jsx("textarea",{value:m,onChange:N=>y(N.target.value),rows:2,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"e.g., Transaction ID, partial payment"})]}),w.jsxs("div",{className:"flex justify-end gap-4 pt-4",children:[w.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cancel"}),w.jsx("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700",children:"Save Payment"})]})]})]})})},Em=({title:r,value:e})=>w.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md",children:[w.jsx("h3",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 truncate",children:r}),w.jsx("p",{className:"mt-1 text-3xl font-semibold text-gray-900 dark:text-white",children:e})]}),K3=({transactions:r})=>{const e=fe.useRef(null),t=fe.useRef(null),n=fe.useMemo(()=>{const s={},o=[],c=new Date;for(let h=5;h>=0;h--){const m=new Date(c.getFullYear(),c.getMonth()-h,1).toLocaleString("default",{month:"short",year:"2-digit"});o.push(m),s[m]=0}return r.forEach(h=>{const m=new Date(h.date).toLocaleString("default",{month:"short",year:"2-digit"});s.hasOwnProperty(m)&&(s[m]+=h.amount)}),{labels:o,datasets:[{label:"Fees Collected",data:o.map(h=>s[h]),backgroundColor:"rgba(79, 70, 229, 0.7)",borderColor:"rgba(79, 70, 229, 1)",borderWidth:1,borderRadius:4}]}},[r]);return fe.useEffect(()=>{if(!e.current)return;t.current&&t.current.destroy();const s=e.current.getContext("2d");if(s)return t.current=new Chart(s,{type:"bar",data:n,options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,ticks:{callback:function(o){return o>=1e3?"₹"+o/1e3+"k":"₹"+o}}},x:{grid:{display:!1}}},plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(o){let c=o.dataset.label||"";return c&&(c+=": "),o.parsed.y!==null&&(c+=new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(o.parsed.y)),c}}}}}}),()=>{t.current&&t.current.destroy()}},[n]),w.jsx("canvas",{ref:e})},Lv=r=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0}).format(r),W3=({students:r})=>w.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md",children:[w.jsx("h3",{className:"text-lg font-semibold text-gray-700 dark:text-white mb-4",children:"Recent Students"}),w.jsxs("div",{className:"space-y-4",children:[r.slice(0,5).map(e=>w.jsxs("div",{className:"flex items-center space-x-4",children:[w.jsx("img",{className:"h-10 w-10 rounded-full object-cover",src:e.imageUrl||`https://ui-avatars.com/api/?name=${e.Name}&background=random`,alt:e.Name}),w.jsxs("div",{children:[w.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:e.Name}),w.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Roll No: ",e["Roll No"]]})]})]},e.id)),r.length===0&&w.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No students have been added yet."})]})]}),Q3=({transactions:r})=>w.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md",children:[w.jsx("h3",{className:"text-lg font-semibold text-gray-700 dark:text-white mb-4",children:"Recent Transactions"}),w.jsxs("ul",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:[r.slice(0,5).map(e=>w.jsxs("li",{className:"py-3 flex justify-between items-center",children:[w.jsxs("div",{children:[w.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:e.studentName}),w.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:e.date})]}),w.jsx("p",{className:"text-sm font-semibold text-green-600 dark:text-green-400",children:Lv(e.amount)})]},e.id)),r.length===0&&w.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 pt-2",children:"No transactions recorded yet."})]})]}),Y3=({students:r,batches:e,transactions:t})=>{const n=o=>(o.payments||[]).reduce((c,h)=>c+h.amount,0),s=fe.useMemo(()=>{const o=r.length,c=e.length,h=t.reduce((_,E)=>_+E.amount,0),m=r.reduce((_,E)=>_+E["Total Fees"],0)-h,y=r.filter(_=>_["Full Paid"]||n(_)>=_["Total Fees"]).length;return{totalStudents:o,totalBatches:c,feesCollected:h,feesRemaining:m,fullPaidCount:y}},[r,e,t]);return w.jsxs("div",{children:[w.jsx("h2",{className:"text-2xl font-semibold text-gray-700 dark:text-gray-200 mb-6",children:"Overview"}),w.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:[w.jsx(Em,{title:"Total Students",value:s.totalStudents}),w.jsx(Em,{title:"Total Batches",value:s.totalBatches}),w.jsx(Em,{title:"Total Fees Collected",value:Lv(s.feesCollected)}),w.jsx(Em,{title:"Total Fees Remaining",value:Lv(s.feesRemaining)})]}),w.jsxs("div",{className:"mt-8 grid grid-cols-1 lg:grid-cols-3 gap-6",children:[w.jsxs("div",{className:"lg:col-span-2 p-6 bg-white dark:bg-gray-800 rounded-lg shadow-md",children:[w.jsx("h3",{className:"text-xl font-semibold text-gray-700 dark:text-white mb-4",children:"Monthly Fee Collection"}),w.jsx("div",{className:"h-80",children:w.jsx(K3,{transactions:t})})]}),w.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[w.jsx(W3,{students:r}),w.jsx(Q3,{transactions:t})]})]})]})},J3=({batches:r,students:e,onDeleteBatch:t,onAddWarden:n,onRemoveWarden:s,onAssignStudents:o})=>{const[c,h]=fe.useState(null),[d,m]=fe.useState(null),[y,_]=fe.useState(!1),[E,S]=fe.useState(null),[C,k]=fe.useState(""),[N,G]=fe.useState(!1),[J,K]=fe.useState(null),[se,ye]=fe.useState(new Set),he=fe.useMemo(()=>new Map(e.map(oe=>[oe.id,oe])),[e]),R=oe=>he.get(oe),x=oe=>{h(Z=>Z===oe?null:oe)},O=oe=>m(oe),L=()=>{d&&(t(d.id),m(null))},M=(oe,Z)=>{S({batch:oe,gender:Z}),k(""),_(!0)},U=()=>{C&&E&&n(E.batch.id,C),_(!1),S(null)},P=(oe,Z)=>{K({batch:oe,warden:Z}),ye(new Set(Z.assignedStudentIds)),G(!0)},et=oe=>{ye(Z=>{const ve=new Set(Z);return ve.has(oe)?ve.delete(oe):ve.add(oe),ve})},We=()=>{J&&o(J.batch.id,J.warden.wardenStudentId,Array.from(se)),G(!1),K(null)},ee=()=>{if(!y||!E)return null;const{batch:oe,gender:Z}=E,ve=new Set(oe.wardens.map(W=>W.wardenStudentId)),V=oe.studentIds.map(W=>R(W)).filter(W=>!!(W&&W.Gender===Z&&!ve.has(W.id)));return w.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:w.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-sm w-full p-6",children:[w.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:["Select ",Z," Warden for ",oe.name]}),w.jsxs("select",{value:C,onChange:W=>k(W.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-indigo-500 bg-white dark:bg-gray-700",children:[w.jsx("option",{value:"",children:"-- Select a Student --"}),V.map(W=>w.jsxs("option",{value:W.id,children:[W.Name," (Roll: ",W["Roll No"],")"]},W.id))]}),V.length===0&&w.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-2",children:["No eligible ",Z.toLowerCase()," students available in this batch."]}),w.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[w.jsx("button",{onClick:()=>_(!1),className:"px-4 py-2 bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-200 rounded-md hover:bg-gray-300 dark:hover:bg-gray-500",children:"Cancel"}),w.jsx("button",{onClick:U,disabled:!C,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:bg-indigo-300",children:"Add Warden"})]})]})})},ue=()=>{if(!N||!J)return null;const{batch:oe,warden:Z}=J,ve=R(Z.wardenStudentId),V=new Set(oe.wardens.map(ce=>ce.wardenStudentId)),W=new Set(oe.wardens.flatMap(ce=>ce.wardenStudentId===Z.wardenStudentId?[]:ce.assignedStudentIds)),de=oe.studentIds.map(ce=>R(ce)).filter(ce=>!!(ce&&!V.has(ce.id)&&!W.has(ce.id)));return w.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:w.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full p-6",children:[w.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:["Assign Students to ",ve==null?void 0:ve.Name]}),w.jsxs("div",{className:"max-h-64 overflow-y-auto border border-gray-200 dark:border-gray-600 rounded-md p-2 space-y-2",children:[de.map(ce=>w.jsxs("div",{className:"flex items-center",children:[w.jsx("input",{type:"checkbox",id:`student-${ce.id}`,checked:se.has(ce.id),onChange:()=>et(ce.id),className:"h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),w.jsxs("label",{htmlFor:`student-${ce.id}`,className:"ml-3 text-sm text-gray-700 dark:text-gray-300",children:[ce.Name," (Roll: ",ce["Roll No"],")"]})]},ce.id)),de.length===0&&w.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"No students available for assignment."})]}),w.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-2",children:[se.size," student(s) selected."]}),w.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[w.jsx("button",{onClick:()=>G(!1),className:"px-4 py-2 bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-200 rounded-md hover:bg-gray-300 dark:hover:bg-gray-500",children:"Cancel"}),w.jsx("button",{onClick:We,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700",children:"Save Assignments"})]})]})})};return w.jsxs(w.Fragment,{children:[w.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg",children:[w.jsx("h2",{className:"text-2xl font-semibold text-gray-800 dark:text-white mb-4",children:"Batch Management"}),r.length===0?w.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No batches created yet. Go to the Students tab to select students and create a batch."}):w.jsx("div",{className:"space-y-4",children:r.map(oe=>w.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg",children:[w.jsxs("div",{className:"flex justify-between items-center p-4 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700",onClick:()=>x(oe.id),children:[w.jsxs("div",{children:[w.jsx("h3",{className:"font-semibold text-lg text-indigo-700 dark:text-indigo-400",children:oe.name}),w.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[oe.studentIds.length," members"]})]}),w.jsxs("div",{className:"flex items-center gap-4",children:[w.jsx("button",{onClick:Z=>{Z.stopPropagation(),O(oe)},className:"text-red-500 hover:text-red-700 font-medium text-sm",children:"Delete"}),w.jsx("svg",{className:`w-5 h-5 text-gray-500 transform transition-transform ${c===oe.id?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]})]}),c===oe.id&&w.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 p-4 space-y-6",children:[w.jsxs("div",{children:[w.jsx("h4",{className:"text-md font-medium text-gray-600 dark:text-gray-300 mb-2",children:"Members:"}),w.jsx("ul",{className:"divide-y divide-gray-100 dark:divide-gray-700 max-h-40 overflow-y-auto",children:oe.studentIds.map(Z=>R(Z)).filter(Boolean).map(Z=>w.jsxs("li",{className:"py-2 flex justify-between items-center",children:[w.jsx("span",{children:Z.Name}),w.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Roll: ",Z["Roll No"]]})]},Z.id))})]}),w.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4",children:[w.jsxs("div",{className:"flex justify-between items-center mb-3",children:[w.jsx("h4",{className:"text-md font-semibold text-gray-700 dark:text-gray-200",children:"Warden Management"}),w.jsxs("div",{className:"flex gap-2",children:[w.jsx("button",{onClick:()=>M(oe,"Female"),className:"px-3 py-1 text-xs font-medium text-pink-700 bg-pink-100 rounded-full hover:bg-pink-200 dark:bg-pink-900 dark:text-pink-200 dark:hover:bg-pink-800",children:"Add Girl Warden"}),w.jsx("button",{onClick:()=>M(oe,"Male"),className:"px-3 py-1 text-xs font-medium text-blue-700 bg-blue-100 rounded-full hover:bg-blue-200 dark:bg-blue-900 dark:text-blue-200 dark:hover:bg-blue-800",children:"Add Boy Warden"})]})]}),w.jsxs("div",{className:"space-y-3",children:[oe.wardens.map(Z=>{const ve=R(Z.wardenStudentId);return ve?w.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-md",children:[w.jsxs("div",{className:"flex justify-between items-center",children:[w.jsxs("p",{className:"font-semibold text-gray-800 dark:text-gray-200",children:[ve.Name," ",w.jsx("span",{className:"text-xs text-gray-500",children:"(Warden)"})]}),w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx("button",{onClick:()=>P(oe,Z),className:"text-sm text-indigo-600 hover:text-indigo-800",children:"Assign Students"}),w.jsx("button",{onClick:()=>s(oe.id,Z.wardenStudentId),className:"text-sm text-red-500 hover:text-red-700",children:"Remove"})]})]}),w.jsxs("ul",{className:"mt-2 pl-4 text-sm text-gray-600 dark:text-gray-300 list-disc",children:[Z.assignedStudentIds.map(V=>R(V)).filter(Boolean).map(V=>w.jsx("li",{children:V.Name},V.id)),Z.assignedStudentIds.length===0&&w.jsx("li",{className:"list-none text-xs text-gray-400",children:"No students assigned."})]})]},Z.wardenStudentId):null}),oe.wardens.length===0&&w.jsx("p",{className:"text-sm text-gray-400",children:"No wardens assigned to this batch."})]})]})]})]},oe.id))})]}),d&&w.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:w.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-xl w-full max-w-sm",children:[w.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Confirm Deletion"}),w.jsxs("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:['Are you sure you want to delete the batch "',d.name,'"? This will also delete all ',d.studentIds.length," students in this batch. This action cannot be undone."]}),w.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[w.jsx("button",{onClick:()=>m(null),className:"px-4 py-2 bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-200 rounded-md hover:bg-gray-300 dark:hover:bg-gray-500",children:"Cancel"}),w.jsx("button",{onClick:L,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Delete"})]})]})}),y&&w.jsx(ee,{}),N&&w.jsx(ue,{})]})},X3=({transactions:r})=>{const[e,t]=fe.useState(""),n=fe.useMemo(()=>{if(!e.trim())return r;const o=e.toLowerCase().trim();return r.filter(c=>c.studentName.toLowerCase().includes(o)||String(c.studentRollNo).toLowerCase().includes(o)||c.method.toLowerCase().includes(o)||(c.remarks||"").toLowerCase().includes(o))},[r,e]),s=o=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(o);return w.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg",children:[w.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-4 gap-4",children:[w.jsxs("div",{children:[w.jsx("h2",{className:"text-2xl font-semibold text-gray-800 dark:text-white",children:"Payment History"}),w.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:["Showing ",n.length," of ",r.length," transactions"]})]}),w.jsx("div",{className:"relative w-full sm:w-64",children:w.jsx("input",{type:"text",placeholder:"Search transactions...",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700",value:e,onChange:o=>t(o.target.value)})})]}),w.jsxs("div",{className:"overflow-x-auto",children:[w.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[w.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:w.jsxs("tr",{children:[w.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Date"}),w.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Student Name"}),w.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Roll No"}),w.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Amount"}),w.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Method"}),w.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Remarks"})]})}),w.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:n.map(o=>w.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[w.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:o.date}),w.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:o.studentName}),w.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:o.studentRollNo}),w.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:s(o.amount)}),w.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:o.method}),w.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 dark:text-gray-300",children:o.remarks})]},o.id))})]}),n.length===0&&w.jsx("p",{className:"text-center py-4 text-gray-500 dark:text-gray-400",children:"No transactions found."})]})]})},Z3=({message:r,type:e,onClose:t})=>{fe.useEffect(()=>{const o=setTimeout(t,4e3);return()=>clearTimeout(o)},[t]);const n="fixed top-5 right-5 z-[100] text-white px-6 py-3 rounded-lg shadow-lg flex items-center animate-fade-in-down",s={success:"bg-green-500",error:"bg-red-500"};return w.jsxs("div",{className:`${n} ${s[e]}`,children:[w.jsx("p",{children:r}),w.jsx("button",{onClick:t,className:"ml-4 text-xl font-semibold leading-none",children:"×"})]})},Ck=()=>w.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500"});var Uv=function(r,e){return Uv=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])},Uv(r,e)};function kk(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Uv(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var wg=function(){return wg=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},wg.apply(this,arguments)};function Yc(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(t[n[s]]=r[n[s]]);return t}function Nk(r,e,t,n){var s=arguments.length,o=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(r,e,t,n);else for(var h=r.length-1;h>=0;h--)(c=r[h])&&(o=(s<3?c(o):s>3?c(e,t,o):c(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o}function Ok(r,e){return function(t,n){e(t,n,r)}}function Pk(r,e,t,n,s,o){function c(G){if(G!==void 0&&typeof G!="function")throw new TypeError("Function expected");return G}for(var h=n.kind,d=h==="getter"?"get":h==="setter"?"set":"value",m=!e&&r?n.static?r:r.prototype:null,y=e||(m?Object.getOwnPropertyDescriptor(m,n.name):{}),_,E=!1,S=t.length-1;S>=0;S--){var C={};for(var k in n)C[k]=k==="access"?{}:n[k];for(var k in n.access)C.access[k]=n.access[k];C.addInitializer=function(G){if(E)throw new TypeError("Cannot add initializers after decoration has completed");o.push(c(G||null))};var N=(0,t[S])(h==="accessor"?{get:y.get,set:y.set}:y[d],C);if(h==="accessor"){if(N===void 0)continue;if(N===null||typeof N!="object")throw new TypeError("Object expected");(_=c(N.get))&&(y.get=_),(_=c(N.set))&&(y.set=_),(_=c(N.init))&&s.unshift(_)}else(_=c(N))&&(h==="field"?s.unshift(_):y[d]=_)}m&&Object.defineProperty(m,n.name,y),E=!0}function Dk(r,e,t){for(var n=arguments.length>2,s=0;s<e.length;s++)t=n?e[s].call(r,t):e[s].call(r);return n?t:void 0}function Vk(r){return typeof r=="symbol"?r:"".concat(r)}function Mk(r,e,t){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(r,"name",{configurable:!0,value:t?"".concat(t," ",e):e})}function jk(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)}function Te(r,e,t,n){function s(o){return o instanceof t?o:new t(function(c){c(o)})}return new(t||(t=Promise))(function(o,c){function h(y){try{m(n.next(y))}catch(_){c(_)}}function d(y){try{m(n.throw(y))}catch(_){c(_)}}function m(y){y.done?o(y.value):s(y.value).then(h,d)}m((n=n.apply(r,e||[])).next())})}function Lk(r,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,s,o,c=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return c.next=h(0),c.throw=h(1),c.return=h(2),typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function h(m){return function(y){return d([m,y])}}function d(m){if(n)throw new TypeError("Generator is already executing.");for(;c&&(c=0,m[0]&&(t=0)),t;)try{if(n=1,s&&(o=m[0]&2?s.return:m[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(o=o.call(s,m[1])).done)return o;switch(s=0,o&&(m=[m[0]&2,o.value]),m[0]){case 0:case 1:o=m;break;case 4:return t.label++,{value:m[1],done:!1};case 5:t.label++,s=m[1],m=[0];continue;case 7:m=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(m[0]===6||m[0]===2)){t=0;continue}if(m[0]===3&&(!o||m[1]>o[0]&&m[1]<o[3])){t.label=m[1];break}if(m[0]===6&&t.label<o[1]){t.label=o[1],o=m;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(m);break}o[2]&&t.ops.pop(),t.trys.pop();continue}m=e.call(r,t)}catch(y){m=[6,y],s=0}finally{n=o=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}}var dp=Object.create?(function(r,e,t,n){n===void 0&&(n=t);var s=Object.getOwnPropertyDescriptor(e,t);(!s||("get"in s?!e.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,s)}):(function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]});function Uk(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&dp(e,r,t)}function bg(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Fw(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),s,o=[],c;try{for(;(e===void 0||e-- >0)&&!(s=n.next()).done;)o.push(s.value)}catch(h){c={error:h}}finally{try{s&&!s.done&&(t=n.return)&&t.call(n)}finally{if(c)throw c.error}}return o}function Bk(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(Fw(arguments[e]));return r}function Fk(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var n=Array(r),s=0,e=0;e<t;e++)for(var o=arguments[e],c=0,h=o.length;c<h;c++,s++)n[s]=o[c];return n}function zk(r,e,t){if(t||arguments.length===2)for(var n=0,s=e.length,o;n<s;n++)(o||!(n in e))&&(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return r.concat(o||Array.prototype.slice.call(e))}function Vc(r){return this instanceof Vc?(this.v=r,this):new Vc(r)}function qk(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),s,o=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),h("next"),h("throw"),h("return",c),s[Symbol.asyncIterator]=function(){return this},s;function c(S){return function(C){return Promise.resolve(C).then(S,_)}}function h(S,C){n[S]&&(s[S]=function(k){return new Promise(function(N,G){o.push([S,k,N,G])>1||d(S,k)})},C&&(s[S]=C(s[S])))}function d(S,C){try{m(n[S](C))}catch(k){E(o[0][3],k)}}function m(S){S.value instanceof Vc?Promise.resolve(S.value.v).then(y,_):E(o[0][2],S)}function y(S){d("next",S)}function _(S){d("throw",S)}function E(S,C){S(C),o.shift(),o.length&&d(o[0][0],o[0][1])}}function $k(r){var e,t;return e={},n("next"),n("throw",function(s){throw s}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(s,o){e[s]=r[s]?function(c){return(t=!t)?{value:Vc(r[s](c)),done:!1}:o?o(c):c}:o}}function Hk(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof bg=="function"?bg(r):r[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(o){t[o]=r[o]&&function(c){return new Promise(function(h,d){c=r[o](c),s(h,d,c.done,c.value)})}}function s(o,c,h,d){Promise.resolve(d).then(function(m){o({value:m,done:h})},c)}}function Gk(r,e){return Object.defineProperty?Object.defineProperty(r,"raw",{value:e}):r.raw=e,r}var e5=Object.create?(function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}):function(r,e){r.default=e},Bv=function(r){return Bv=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},Bv(r)};function Kk(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t=Bv(r),n=0;n<t.length;n++)t[n]!=="default"&&dp(e,r,t[n]);return e5(e,r),e}function Wk(r){return r&&r.__esModule?r:{default:r}}function Qk(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)}function Yk(r,e,t,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t}function Jk(r,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof r=="function"?e===r:r.has(e)}function Xk(r,e,t){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var n,s;if(t){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=e[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=e[Symbol.dispose],t&&(s=n)}if(typeof n!="function")throw new TypeError("Object not disposable.");s&&(n=function(){try{s.call(this)}catch(o){return Promise.reject(o)}}),r.stack.push({value:e,dispose:n,async:t})}else t&&r.stack.push({async:!0});return e}var t5=typeof SuppressedError=="function"?SuppressedError:function(r,e,t){var n=new Error(t);return n.name="SuppressedError",n.error=r,n.suppressed=e,n};function Zk(r){function e(o){r.error=r.hasError?new t5(o,r.error,"An error was suppressed during disposal."):o,r.hasError=!0}var t,n=0;function s(){for(;t=r.stack.pop();)try{if(!t.async&&n===1)return n=0,r.stack.push(t),Promise.resolve().then(s);if(t.dispose){var o=t.dispose.call(t.value);if(t.async)return n|=2,Promise.resolve(o).then(s,function(c){return e(c),s()})}else n|=1}catch(c){e(c)}if(n===1)return r.hasError?Promise.reject(r.error):Promise.resolve();if(r.hasError)throw r.error}return s()}function eN(r,e){return typeof r=="string"&&/^\.\.?\//.test(r)?r.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(t,n,s,o,c){return n?e?".jsx":".js":s&&(!o||!c)?t:s+o+"."+c.toLowerCase()+"js"}):r}const n5={__extends:kk,__assign:wg,__rest:Yc,__decorate:Nk,__param:Ok,__esDecorate:Pk,__runInitializers:Dk,__propKey:Vk,__setFunctionName:Mk,__metadata:jk,__awaiter:Te,__generator:Lk,__createBinding:dp,__exportStar:Uk,__values:bg,__read:Fw,__spread:Bk,__spreadArrays:Fk,__spreadArray:zk,__await:Vc,__asyncGenerator:qk,__asyncDelegator:$k,__asyncValues:Hk,__makeTemplateObject:Gk,__importStar:Kk,__importDefault:Wk,__classPrivateFieldGet:Qk,__classPrivateFieldSet:Yk,__classPrivateFieldIn:Jk,__addDisposableResource:Xk,__disposeResources:Zk,__rewriteRelativeImportExtension:eN},r5=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:Xk,get __assign(){return wg},__asyncDelegator:$k,__asyncGenerator:qk,__asyncValues:Hk,__await:Vc,__awaiter:Te,__classPrivateFieldGet:Qk,__classPrivateFieldIn:Jk,__classPrivateFieldSet:Yk,__createBinding:dp,__decorate:Nk,__disposeResources:Zk,__esDecorate:Pk,__exportStar:Uk,__extends:kk,__generator:Lk,__importDefault:Wk,__importStar:Kk,__makeTemplateObject:Gk,__metadata:jk,__param:Ok,__propKey:Vk,__read:Fw,__rest:Yc,__rewriteRelativeImportExtension:eN,__runInitializers:Dk,__setFunctionName:Mk,__spread:Bk,__spreadArray:zk,__spreadArrays:Fk,__values:bg,default:n5},Symbol.toStringTag,{value:"Module"})),i5="modulepreload",s5=function(r){return"/Vidya-Gram/"+r},MI={},Jc=function(e,t,n){let s=Promise.resolve();if(t&&t.length>0){let c=function(m){return Promise.all(m.map(y=>Promise.resolve(y).then(_=>({status:"fulfilled",value:_}),_=>({status:"rejected",reason:_}))))};document.getElementsByTagName("link");const h=document.querySelector("meta[property=csp-nonce]"),d=(h==null?void 0:h.nonce)||(h==null?void 0:h.getAttribute("nonce"));s=c(t.map(m=>{if(m=s5(m),m in MI)return;MI[m]=!0;const y=m.endsWith(".css"),_=y?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${_}`))return;const E=document.createElement("link");if(E.rel=y?"stylesheet":i5,y||(E.as="script"),E.crossOrigin="",E.href=m,d&&E.setAttribute("nonce",d),document.head.appendChild(E),y)return new Promise((S,C)=>{E.addEventListener("load",S),E.addEventListener("error",()=>C(new Error(`Unable to preload CSS for ${m}`)))})}))}function o(c){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=c,window.dispatchEvent(h),!h.defaultPrevented)throw c}return s.then(c=>{for(const h of c||[])h.status==="rejected"&&o(h.reason);return e().catch(o)})},a5=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>Jc(async()=>{const{default:n}=await Promise.resolve().then(()=>Ko);return{default:n}},void 0).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)};class zw extends Error{constructor(e,t="FunctionsError",n){super(e),this.name=t,this.context=n}}class jI extends zw{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class LI extends zw{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class UI extends zw{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Fv;(function(r){r.Any="any",r.ApNortheast1="ap-northeast-1",r.ApNortheast2="ap-northeast-2",r.ApSouth1="ap-south-1",r.ApSoutheast1="ap-southeast-1",r.ApSoutheast2="ap-southeast-2",r.CaCentral1="ca-central-1",r.EuCentral1="eu-central-1",r.EuWest1="eu-west-1",r.EuWest2="eu-west-2",r.EuWest3="eu-west-3",r.SaEast1="sa-east-1",r.UsEast1="us-east-1",r.UsWest1="us-west-1",r.UsWest2="us-west-2"})(Fv||(Fv={}));class o5{constructor(e,{headers:t={},customFetch:n,region:s=Fv.Any}={}){this.url=e,this.headers=t,this.region=s,this.fetch=a5(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return Te(this,arguments,void 0,function*(t,n={}){var s;try{const{headers:o,method:c,body:h,signal:d}=n;let m={},{region:y}=n;y||(y=this.region);const _=new URL(`${this.url}/${t}`);y&&y!=="any"&&(m["x-region"]=y,_.searchParams.set("forceFunctionRegion",y));let E;h&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)?typeof Blob<"u"&&h instanceof Blob||h instanceof ArrayBuffer?(m["Content-Type"]="application/octet-stream",E=h):typeof h=="string"?(m["Content-Type"]="text/plain",E=h):typeof FormData<"u"&&h instanceof FormData?E=h:(m["Content-Type"]="application/json",E=JSON.stringify(h)):E=h;const S=yield this.fetch(_.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},m),this.headers),o),body:E,signal:d}).catch(G=>{throw G.name==="AbortError"?G:new jI(G)}),C=S.headers.get("x-relay-error");if(C&&C==="true")throw new LI(S);if(!S.ok)throw new UI(S);let k=((s=S.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),N;return k==="application/json"?N=yield S.json():k==="application/octet-stream"||k==="application/pdf"?N=yield S.blob():k==="text/event-stream"?N=S:k==="multipart/form-data"?N=yield S.formData():N=yield S.text(),{data:N,error:null,response:S}}catch(o){return o instanceof Error&&o.name==="AbortError"?{data:null,error:new jI(o)}:{data:null,error:o,response:o instanceof UI||o instanceof LI?o.context:void 0}}})}}var Sn={};const Xc=dx(r5);var Tm={},Sm={},Am={},Im={},xm={},l5=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Mc=l5();const c5=Mc.fetch,tN=Mc.fetch.bind(Mc),nN=Mc.Headers,u5=Mc.Request,h5=Mc.Response,Ko=Object.freeze(Object.defineProperty({__proto__:null,Headers:nN,Request:u5,Response:h5,default:tN,fetch:c5},Symbol.toStringTag,{value:"Module"})),d5=dx(Ko);var Rm={},BI;function rN(){if(BI)return Rm;BI=1,Object.defineProperty(Rm,"__esModule",{value:!0});class r extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return Rm.default=r,Rm}var FI;function iN(){if(FI)return xm;FI=1,Object.defineProperty(xm,"__esModule",{value:!0});const r=Xc,e=r.__importDefault(d5),t=r.__importDefault(rN());class n{constructor(o){var c,h;this.shouldThrowOnError=!1,this.method=o.method,this.url=o.url,this.headers=new Headers(o.headers),this.schema=o.schema,this.body=o.body,this.shouldThrowOnError=(c=o.shouldThrowOnError)!==null&&c!==void 0?c:!1,this.signal=o.signal,this.isMaybeSingle=(h=o.isMaybeSingle)!==null&&h!==void 0?h:!1,o.fetch?this.fetch=o.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(o,c){return this.headers=new Headers(this.headers),this.headers.set(o,c),this}then(o,c){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const h=this.fetch;let d=h(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async m=>{var y,_,E,S;let C=null,k=null,N=null,G=m.status,J=m.statusText;if(m.ok){if(this.method!=="HEAD"){const he=await m.text();he===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((y=this.headers.get("Accept"))===null||y===void 0)&&y.includes("application/vnd.pgrst.plan+text"))?k=he:k=JSON.parse(he))}const se=(_=this.headers.get("Prefer"))===null||_===void 0?void 0:_.match(/count=(exact|planned|estimated)/),ye=(E=m.headers.get("content-range"))===null||E===void 0?void 0:E.split("/");se&&ye&&ye.length>1&&(N=parseInt(ye[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(k)&&(k.length>1?(C={code:"PGRST116",details:`Results contain ${k.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},k=null,N=null,G=406,J="Not Acceptable"):k.length===1?k=k[0]:k=null)}else{const se=await m.text();try{C=JSON.parse(se),Array.isArray(C)&&m.status===404&&(k=[],C=null,G=200,J="OK")}catch{m.status===404&&se===""?(G=204,J="No Content"):C={message:se}}if(C&&this.isMaybeSingle&&(!((S=C==null?void 0:C.details)===null||S===void 0)&&S.includes("0 rows"))&&(C=null,G=200,J="OK"),C&&this.shouldThrowOnError)throw new t.default(C)}return{error:C,data:k,count:N,status:G,statusText:J}});return this.shouldThrowOnError||(d=d.catch(m=>{var y,_,E;return{error:{message:`${(y=m==null?void 0:m.name)!==null&&y!==void 0?y:"FetchError"}: ${m==null?void 0:m.message}`,details:`${(_=m==null?void 0:m.stack)!==null&&_!==void 0?_:""}`,hint:"",code:`${(E=m==null?void 0:m.code)!==null&&E!==void 0?E:""}`},data:null,count:null,status:0,statusText:""}})),d.then(o,c)}returns(){return this}overrideTypes(){return this}}return xm.default=n,xm}var zI;function sN(){if(zI)return Im;zI=1,Object.defineProperty(Im,"__esModule",{value:!0});const e=Xc.__importDefault(iN());class t extends e.default{select(s){let o=!1;const c=(s??"*").split("").map(h=>/\s/.test(h)&&!o?"":(h==='"'&&(o=!o),h)).join("");return this.url.searchParams.set("select",c),this.headers.append("Prefer","return=representation"),this}order(s,{ascending:o=!0,nullsFirst:c,foreignTable:h,referencedTable:d=h}={}){const m=d?`${d}.order`:"order",y=this.url.searchParams.get(m);return this.url.searchParams.set(m,`${y?`${y},`:""}${s}.${o?"asc":"desc"}${c===void 0?"":c?".nullsfirst":".nullslast"}`),this}limit(s,{foreignTable:o,referencedTable:c=o}={}){const h=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(h,`${s}`),this}range(s,o,{foreignTable:c,referencedTable:h=c}={}){const d=typeof h>"u"?"offset":`${h}.offset`,m=typeof h>"u"?"limit":`${h}.limit`;return this.url.searchParams.set(d,`${s}`),this.url.searchParams.set(m,`${o-s+1}`),this}abortSignal(s){return this.signal=s,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:s=!1,verbose:o=!1,settings:c=!1,buffers:h=!1,wal:d=!1,format:m="text"}={}){var y;const _=[s?"analyze":null,o?"verbose":null,c?"settings":null,h?"buffers":null,d?"wal":null].filter(Boolean).join("|"),E=(y=this.headers.get("Accept"))!==null&&y!==void 0?y:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${m}; for="${E}"; options=${_};`),m==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(s){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${s}`),this}}return Im.default=t,Im}var qI;function qw(){if(qI)return Am;qI=1,Object.defineProperty(Am,"__esModule",{value:!0});const e=Xc.__importDefault(sN()),t=new RegExp("[,()]");class n extends e.default{eq(o,c){return this.url.searchParams.append(o,`eq.${c}`),this}neq(o,c){return this.url.searchParams.append(o,`neq.${c}`),this}gt(o,c){return this.url.searchParams.append(o,`gt.${c}`),this}gte(o,c){return this.url.searchParams.append(o,`gte.${c}`),this}lt(o,c){return this.url.searchParams.append(o,`lt.${c}`),this}lte(o,c){return this.url.searchParams.append(o,`lte.${c}`),this}like(o,c){return this.url.searchParams.append(o,`like.${c}`),this}likeAllOf(o,c){return this.url.searchParams.append(o,`like(all).{${c.join(",")}}`),this}likeAnyOf(o,c){return this.url.searchParams.append(o,`like(any).{${c.join(",")}}`),this}ilike(o,c){return this.url.searchParams.append(o,`ilike.${c}`),this}ilikeAllOf(o,c){return this.url.searchParams.append(o,`ilike(all).{${c.join(",")}}`),this}ilikeAnyOf(o,c){return this.url.searchParams.append(o,`ilike(any).{${c.join(",")}}`),this}is(o,c){return this.url.searchParams.append(o,`is.${c}`),this}in(o,c){const h=Array.from(new Set(c)).map(d=>typeof d=="string"&&t.test(d)?`"${d}"`:`${d}`).join(",");return this.url.searchParams.append(o,`in.(${h})`),this}contains(o,c){return typeof c=="string"?this.url.searchParams.append(o,`cs.${c}`):Array.isArray(c)?this.url.searchParams.append(o,`cs.{${c.join(",")}}`):this.url.searchParams.append(o,`cs.${JSON.stringify(c)}`),this}containedBy(o,c){return typeof c=="string"?this.url.searchParams.append(o,`cd.${c}`):Array.isArray(c)?this.url.searchParams.append(o,`cd.{${c.join(",")}}`):this.url.searchParams.append(o,`cd.${JSON.stringify(c)}`),this}rangeGt(o,c){return this.url.searchParams.append(o,`sr.${c}`),this}rangeGte(o,c){return this.url.searchParams.append(o,`nxl.${c}`),this}rangeLt(o,c){return this.url.searchParams.append(o,`sl.${c}`),this}rangeLte(o,c){return this.url.searchParams.append(o,`nxr.${c}`),this}rangeAdjacent(o,c){return this.url.searchParams.append(o,`adj.${c}`),this}overlaps(o,c){return typeof c=="string"?this.url.searchParams.append(o,`ov.${c}`):this.url.searchParams.append(o,`ov.{${c.join(",")}}`),this}textSearch(o,c,{config:h,type:d}={}){let m="";d==="plain"?m="pl":d==="phrase"?m="ph":d==="websearch"&&(m="w");const y=h===void 0?"":`(${h})`;return this.url.searchParams.append(o,`${m}fts${y}.${c}`),this}match(o){return Object.entries(o).forEach(([c,h])=>{this.url.searchParams.append(c,`eq.${h}`)}),this}not(o,c,h){return this.url.searchParams.append(o,`not.${c}.${h}`),this}or(o,{foreignTable:c,referencedTable:h=c}={}){const d=h?`${h}.or`:"or";return this.url.searchParams.append(d,`(${o})`),this}filter(o,c,h){return this.url.searchParams.append(o,`${c}.${h}`),this}}return Am.default=n,Am}var $I;function aN(){if($I)return Sm;$I=1,Object.defineProperty(Sm,"__esModule",{value:!0});const e=Xc.__importDefault(qw());class t{constructor(s,{headers:o={},schema:c,fetch:h}){this.url=s,this.headers=new Headers(o),this.schema=c,this.fetch=h}select(s,o){const{head:c=!1,count:h}=o??{},d=c?"HEAD":"GET";let m=!1;const y=(s??"*").split("").map(_=>/\s/.test(_)&&!m?"":(_==='"'&&(m=!m),_)).join("");return this.url.searchParams.set("select",y),h&&this.headers.append("Prefer",`count=${h}`),new e.default({method:d,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(s,{count:o,defaultToNull:c=!0}={}){var h;const d="POST";if(o&&this.headers.append("Prefer",`count=${o}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const m=s.reduce((y,_)=>y.concat(Object.keys(_)),[]);if(m.length>0){const y=[...new Set(m)].map(_=>`"${_}"`);this.url.searchParams.set("columns",y.join(","))}}return new e.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(h=this.fetch)!==null&&h!==void 0?h:fetch})}upsert(s,{onConflict:o,ignoreDuplicates:c=!1,count:h,defaultToNull:d=!0}={}){var m;const y="POST";if(this.headers.append("Prefer",`resolution=${c?"ignore":"merge"}-duplicates`),o!==void 0&&this.url.searchParams.set("on_conflict",o),h&&this.headers.append("Prefer",`count=${h}`),d||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const _=s.reduce((E,S)=>E.concat(Object.keys(S)),[]);if(_.length>0){const E=[...new Set(_)].map(S=>`"${S}"`);this.url.searchParams.set("columns",E.join(","))}}return new e.default({method:y,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})}update(s,{count:o}={}){var c;const h="PATCH";return o&&this.headers.append("Prefer",`count=${o}`),new e.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}delete({count:s}={}){var o;const c="DELETE";return s&&this.headers.append("Prefer",`count=${s}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}}return Sm.default=t,Sm}var HI;function f5(){if(HI)return Tm;HI=1,Object.defineProperty(Tm,"__esModule",{value:!0});const r=Xc,e=r.__importDefault(aN()),t=r.__importDefault(qw());class n{constructor(o,{headers:c={},schema:h,fetch:d}={}){this.url=o,this.headers=new Headers(c),this.schemaName=h,this.fetch=d}from(o){const c=new URL(`${this.url}/${o}`);return new e.default(c,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(o){return new n(this.url,{headers:this.headers,schema:o,fetch:this.fetch})}rpc(o,c={},{head:h=!1,get:d=!1,count:m}={}){var y;let _;const E=new URL(`${this.url}/rpc/${o}`);let S;h||d?(_=h?"HEAD":"GET",Object.entries(c).filter(([k,N])=>N!==void 0).map(([k,N])=>[k,Array.isArray(N)?`{${N.join(",")}}`:`${N}`]).forEach(([k,N])=>{E.searchParams.append(k,N)})):(_="POST",S=c);const C=new Headers(this.headers);return m&&C.set("Prefer",`count=${m}`),new t.default({method:_,url:E,headers:C,schema:this.schemaName,body:S,fetch:(y=this.fetch)!==null&&y!==void 0?y:fetch})}}return Tm.default=n,Tm}var GI;function m5(){if(GI)return Sn;GI=1,Object.defineProperty(Sn,"__esModule",{value:!0}),Sn.PostgrestError=Sn.PostgrestBuilder=Sn.PostgrestTransformBuilder=Sn.PostgrestFilterBuilder=Sn.PostgrestQueryBuilder=Sn.PostgrestClient=void 0;const r=Xc,e=r.__importDefault(f5());Sn.PostgrestClient=e.default;const t=r.__importDefault(aN());Sn.PostgrestQueryBuilder=t.default;const n=r.__importDefault(qw());Sn.PostgrestFilterBuilder=n.default;const s=r.__importDefault(sN());Sn.PostgrestTransformBuilder=s.default;const o=r.__importDefault(iN());Sn.PostgrestBuilder=o.default;const c=r.__importDefault(rN());return Sn.PostgrestError=c.default,Sn.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:n.default,PostgrestTransformBuilder:s.default,PostgrestBuilder:o.default,PostgrestError:c.default},Sn}var oN=m5();const lN=e0(oN),g5=iP({__proto__:null,default:lN},[oN]),{PostgrestClient:p5,PostgrestQueryBuilder:$F,PostgrestFilterBuilder:HF,PostgrestTransformBuilder:GF,PostgrestBuilder:KF,PostgrestError:WF}=lN||g5;class y5{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const t=process.versions;if(t&&t.node){const n=t.node,s=parseInt(n.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const n=this.getWebSocketConstructor();return new n(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const _5="2.78.0",v5=`realtime-js/${_5}`,w5="1.0.0",zv=1e4,b5=1e3,E5=100;var Lh;(function(r){r[r.connecting=0]="connecting",r[r.open=1]="open",r[r.closing=2]="closing",r[r.closed=3]="closed"})(Lh||(Lh={}));var nn;(function(r){r.closed="closed",r.errored="errored",r.joined="joined",r.joining="joining",r.leaving="leaving"})(nn||(nn={}));var Hr;(function(r){r.close="phx_close",r.error="phx_error",r.join="phx_join",r.reply="phx_reply",r.leave="phx_leave",r.access_token="access_token"})(Hr||(Hr={}));var qv;(function(r){r.websocket="websocket"})(qv||(qv={}));var vo;(function(r){r.Connecting="connecting",r.Open="open",r.Closing="closing",r.Closed="closed"})(vo||(vo={}));class T5{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,t,n)}_decodeBroadcast(e,t,n){const s=t.getUint8(1),o=t.getUint8(2);let c=this.HEADER_LENGTH+2;const h=n.decode(e.slice(c,c+s));c=c+s;const d=n.decode(e.slice(c,c+o));c=c+o;const m=JSON.parse(n.decode(e.slice(c,e.byteLength)));return{ref:null,topic:h,event:d,payload:m}}}class cN{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var dt;(function(r){r.abstime="abstime",r.bool="bool",r.date="date",r.daterange="daterange",r.float4="float4",r.float8="float8",r.int2="int2",r.int4="int4",r.int4range="int4range",r.int8="int8",r.int8range="int8range",r.json="json",r.jsonb="jsonb",r.money="money",r.numeric="numeric",r.oid="oid",r.reltime="reltime",r.text="text",r.time="time",r.timestamp="timestamp",r.timestamptz="timestamptz",r.timetz="timetz",r.tsrange="tsrange",r.tstzrange="tstzrange"})(dt||(dt={}));const KI=(r,e,t={})=>{var n;const s=(n=t.skipTypes)!==null&&n!==void 0?n:[];return e?Object.keys(e).reduce((o,c)=>(o[c]=S5(c,r,e,s),o),{}):{}},S5=(r,e,t,n)=>{const s=e.find(h=>h.name===r),o=s==null?void 0:s.type,c=t[r];return o&&!n.includes(o)?uN(o,c):$v(c)},uN=(r,e)=>{if(r.charAt(0)==="_"){const t=r.slice(1,r.length);return R5(e,t)}switch(r){case dt.bool:return A5(e);case dt.float4:case dt.float8:case dt.int2:case dt.int4:case dt.int8:case dt.numeric:case dt.oid:return I5(e);case dt.json:case dt.jsonb:return x5(e);case dt.timestamp:return C5(e);case dt.abstime:case dt.date:case dt.daterange:case dt.int4range:case dt.int8range:case dt.money:case dt.reltime:case dt.text:case dt.time:case dt.timestamptz:case dt.timetz:case dt.tsrange:case dt.tstzrange:return $v(e);default:return $v(e)}},$v=r=>r,A5=r=>{switch(r){case"t":return!0;case"f":return!1;default:return r}},I5=r=>{if(typeof r=="string"){const e=parseFloat(r);if(!Number.isNaN(e))return e}return r},x5=r=>{if(typeof r=="string")try{return JSON.parse(r)}catch(e){return console.log(`JSON parse error: ${e}`),r}return r},R5=(r,e)=>{if(typeof r!="string")return r;const t=r.length-1,n=r[t];if(r[0]==="{"&&n==="}"){let o;const c=r.slice(1,t);try{o=JSON.parse("["+c+"]")}catch{o=c?c.split(","):[]}return o.map(h=>uN(e,h))}return r},C5=r=>typeof r=="string"?r.replace(" ","T"):r,hN=r=>{const e=new URL(r);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class B_{constructor(e,t,n={},s=zv){this.channel=e,this.event=t,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var n;return this._hasReceived(e)&&t((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var WI;(function(r){r.SYNC="sync",r.JOIN="join",r.LEAVE="leave"})(WI||(WI={}));class Uh{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:o,onLeave:c,onSync:h}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Uh.syncState(this.state,s,o,c),this.pendingDiffs.forEach(d=>{this.state=Uh.syncDiff(this.state,d,o,c)}),this.pendingDiffs=[],h()}),this.channel._on(n.diff,{},s=>{const{onJoin:o,onLeave:c,onSync:h}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Uh.syncDiff(this.state,s,o,c),h())}),this.onJoin((s,o,c)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:o,newPresences:c})}),this.onLeave((s,o,c)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:o,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,n,s){const o=this.cloneDeep(e),c=this.transformState(t),h={},d={};return this.map(o,(m,y)=>{c[m]||(d[m]=y)}),this.map(c,(m,y)=>{const _=o[m];if(_){const E=y.map(N=>N.presence_ref),S=_.map(N=>N.presence_ref),C=y.filter(N=>S.indexOf(N.presence_ref)<0),k=_.filter(N=>E.indexOf(N.presence_ref)<0);C.length>0&&(h[m]=C),k.length>0&&(d[m]=k)}else h[m]=y}),this.syncDiff(o,{joins:h,leaves:d},n,s)}static syncDiff(e,t,n,s){const{joins:o,leaves:c}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(o,(h,d)=>{var m;const y=(m=e[h])!==null&&m!==void 0?m:[];if(e[h]=this.cloneDeep(d),y.length>0){const _=e[h].map(S=>S.presence_ref),E=y.filter(S=>_.indexOf(S.presence_ref)<0);e[h].unshift(...E)}n(h,y,d)}),this.map(c,(h,d)=>{let m=e[h];if(!m)return;const y=d.map(_=>_.presence_ref);m=m.filter(_=>y.indexOf(_.presence_ref)<0),e[h]=m,s(h,m,d),m.length===0&&delete e[h]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(n=>t(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,n)=>{const s=e[n];return"metas"in s?t[n]=s.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):t[n]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var QI;(function(r){r.ALL="*",r.INSERT="INSERT",r.UPDATE="UPDATE",r.DELETE="DELETE"})(QI||(QI={}));var Bh;(function(r){r.BROADCAST="broadcast",r.PRESENCE="presence",r.POSTGRES_CHANGES="postgres_changes",r.SYSTEM="system"})(Bh||(Bh={}));var es;(function(r){r.SUBSCRIBED="SUBSCRIBED",r.TIMED_OUT="TIMED_OUT",r.CLOSED="CLOSED",r.CHANNEL_ERROR="CHANNEL_ERROR"})(es||(es={}));class $w{constructor(e,t={config:{}},n){var s,o;if(this.topic=e,this.params=t,this.socket=n,this.bindings={},this.state=nn.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new B_(this,Hr.join,this.params,this.timeout),this.rejoinTimer=new cN(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=nn.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(c=>c.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=nn.closed,this.socket._remove(this)}),this._onError(c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=nn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=nn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=nn.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Hr.reply,{},(c,h)=>{this._trigger(this._replyEventName(h),c)}),this.presence=new Uh(this),this.broadcastEndpointURL=hN(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((o=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||o===void 0)&&o.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var n,s,o;if(this.socket.isConnected()||this.socket.connect(),this.state==nn.closed){const{config:{broadcast:c,presence:h,private:d}}=this.params,m=(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(S=>S.filter))!==null&&s!==void 0?s:[],y=!!this.bindings[Bh.PRESENCE]&&this.bindings[Bh.PRESENCE].length>0||((o=this.params.config.presence)===null||o===void 0?void 0:o.enabled)===!0,_={},E={broadcast:c,presence:Object.assign(Object.assign({},h),{enabled:y}),postgres_changes:m,private:d};this.socket.accessTokenValue&&(_.access_token=this.socket.accessTokenValue),this._onError(S=>e==null?void 0:e(es.CHANNEL_ERROR,S)),this._onClose(()=>e==null?void 0:e(es.CLOSED)),this.updateJoinPayload(Object.assign({config:E},_)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:S})=>{var C;if(this.socket.setAuth(),S===void 0){e==null||e(es.SUBSCRIBED);return}else{const k=this.bindings.postgres_changes,N=(C=k==null?void 0:k.length)!==null&&C!==void 0?C:0,G=[];for(let J=0;J<N;J++){const K=k[J],{filter:{event:se,schema:ye,table:he,filter:R}}=K,x=S&&S[J];if(x&&x.event===se&&x.schema===ye&&x.table===he&&x.filter===R)G.push(Object.assign(Object.assign({},K),{id:x.id}));else{this.unsubscribe(),this.state=nn.errored,e==null||e(es.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=G,e&&e(es.SUBSCRIBED);return}}).receive("error",S=>{this.state=nn.errored,e==null||e(es.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(S).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(es.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,n){return this.state===nn.joined&&e===Bh.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,n)}async httpSend(e,t,n={}){var s;const o=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(t==null)return Promise.reject("Payload is required for httpSend()");const c={method:"POST",headers:{Authorization:o,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},h=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(s=n.timeout)!==null&&s!==void 0?s:this.timeout);if(h.status===202)return{success:!0};let d=h.statusText;try{const m=await h.json();d=m.error||m.message||d}catch{}return Promise.reject(new Error(d))}async send(e,t={}){var n,s;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:o,payload:c}=e,d={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:c,private:this.private}]})};try{const m=await this._fetchWithTimeout(this.broadcastEndpointURL,d,(n=t.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=m.body)===null||s===void 0?void 0:s.cancel()),m.ok?"ok":"error"}catch(m){return m.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var c,h,d;const m=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((d=(h=(c=this.params)===null||c===void 0?void 0:c.config)===null||h===void 0?void 0:h.broadcast)===null||d===void 0)&&d.ack)&&o("ok"),m.receive("ok",()=>o("ok")),m.receive("error",()=>o("error")),m.receive("timeout",()=>o("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=nn.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Hr.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new B_(this,Hr.leave,{},e),n.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=nn.closed,this.bindings={}}async _fetchWithTimeout(e,t,n){const s=new AbortController,o=setTimeout(()=>s.abort(),n),c=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(o),c}_push(e,t,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new B_(this,e,t,n);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>E5){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,n){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,n){var s,o;const c=e.toLocaleLowerCase(),{close:h,error:d,leave:m,join:y}=Hr;if(n&&[h,d,m,y].indexOf(c)>=0&&n!==this._joinRef())return;let E=this._onMessage(c,t,n);if(t&&!E)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(S=>{var C,k,N;return((C=S.filter)===null||C===void 0?void 0:C.event)==="*"||((N=(k=S.filter)===null||k===void 0?void 0:k.event)===null||N===void 0?void 0:N.toLocaleLowerCase())===c}).map(S=>S.callback(E,n)):(o=this.bindings[c])===null||o===void 0||o.filter(S=>{var C,k,N,G,J,K;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in S){const se=S.id,ye=(C=S.filter)===null||C===void 0?void 0:C.event;return se&&((k=t.ids)===null||k===void 0?void 0:k.includes(se))&&(ye==="*"||(ye==null?void 0:ye.toLocaleLowerCase())===((N=t.data)===null||N===void 0?void 0:N.type.toLocaleLowerCase()))}else{const se=(J=(G=S==null?void 0:S.filter)===null||G===void 0?void 0:G.event)===null||J===void 0?void 0:J.toLocaleLowerCase();return se==="*"||se===((K=t==null?void 0:t.event)===null||K===void 0?void 0:K.toLocaleLowerCase())}else return S.type.toLocaleLowerCase()===c}).map(S=>{if(typeof E=="object"&&"ids"in E){const C=E.data,{schema:k,table:N,commit_timestamp:G,type:J,errors:K}=C;E=Object.assign(Object.assign({},{schema:k,table:N,commit_timestamp:G,eventType:J,new:{},old:{},errors:K}),this._getPayloadRecords(C))}S.callback(E,n)})}_isClosed(){return this.state===nn.closed}_isJoined(){return this.state===nn.joined}_isJoining(){return this.state===nn.joining}_isLeaving(){return this.state===nn.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,n){const s=e.toLocaleLowerCase(),o={type:s,filter:t,callback:n};return this.bindings[s]?this.bindings[s].push(o):this.bindings[s]=[o],this}_off(e,t){const n=e.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(s=>{var o;return!(((o=s.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===n&&$w.isEqual(s.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Hr.close,{},e)}_onError(e){this._on(Hr.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=nn.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=KI(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=KI(e.columns,e.old_record)),t}}const F_=()=>{},Cm={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},k5=[1e3,2e3,5e3,1e4],N5=1e4,O5=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class P5{constructor(e,t){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=zv,this.transport=null,this.heartbeatIntervalMs=Cm.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=F_,this.ref=0,this.reconnectTimer=null,this.logger=F_,this.conn=null,this.sendBuffer=[],this.serializer=new T5,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>{let o;return s?o=s:typeof fetch>"u"?o=(...c)=>Jc(async()=>{const{default:h}=await Promise.resolve().then(()=>Ko);return{default:h}},void 0).then(({default:h})=>h(...c)).catch(h=>{throw new Error(`Failed to load @supabase/node-fetch: ${h.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):o=fetch,(...c)=>o(...c)},!(!((n=t==null?void 0:t.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${qv.websocket}`,this.httpEndpoint=hN(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t==null?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=y5.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:w5}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},e?this.conn.close(e,t??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,n){this.logger(e,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Lh.connecting:return vo.Connecting;case Lh.open:return vo.Open;case Lh.closing:return vo.Closing;default:return vo.Closed}}isConnected(){return this.connectionState()===vo.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const n=`realtime:${e}`,s=this.getChannels().find(o=>o.topic===n);if(s)return s;{const o=new $w(`realtime:${e}`,t,this);return this.channels.push(o),o}}push(e){const{topic:t,event:n,payload:s,ref:o}=e,c=()=>{this.encode(e,h=>{var d;(d=this.conn)===null||d===void 0||d.send(h)})};this.log("push",`${t} ${n} (${o})`,s),this.isConnected()?c():this.sendBuffer.push(c)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(b5,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},Cm.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply")try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error")}catch(m){this.log("error","error in heartbeat callback",m)}t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:s,payload:o,ref:c}=t,h=c?`(${c})`:"",d=o.status||"";this.log("receive",`${d} ${n} ${s} ${h}`.trim(),o),this.channels.filter(m=>m._isMember(n)).forEach(m=>m._trigger(s,o,c)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Hr.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const n=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${n}${s}`}_workerObjectUrl(e){let t;if(e)t=e;else{const n=new Blob([O5],{type:"application/javascript"});t=URL.createObjectURL(n)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;e?t=e:this.accessToken?t=await this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(n=>{const s={access_token:t,version:v5};t&&n.updateJoinPayload(s),n.joinedOnce&&n._isJoined()&&n._push(Hr.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(n=>{try{n(t)}catch(s){this.log("error",`error in ${e} callback`,s)}})}catch(n){this.log("error",`error triggering ${e} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new cN(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Cm.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,n,s,o,c,h,d,m,y;if(this.transport=(t=e==null?void 0:e.transport)!==null&&t!==void 0?t:null,this.timeout=(n=e==null?void 0:e.timeout)!==null&&n!==void 0?n:zv,this.heartbeatIntervalMs=(s=e==null?void 0:e.heartbeatIntervalMs)!==null&&s!==void 0?s:Cm.HEARTBEAT_INTERVAL,this.worker=(o=e==null?void 0:e.worker)!==null&&o!==void 0?o:!1,this.accessToken=(c=e==null?void 0:e.accessToken)!==null&&c!==void 0?c:null,this.heartbeatCallback=(h=e==null?void 0:e.heartbeatCallback)!==null&&h!==void 0?h:F_,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(d=e==null?void 0:e.reconnectAfterMs)!==null&&d!==void 0?d:(_=>k5[_-1]||N5),this.encode=(m=e==null?void 0:e.encode)!==null&&m!==void 0?m:((_,E)=>E(JSON.stringify(_))),this.decode=(y=e==null?void 0:e.decode)!==null&&y!==void 0?y:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class Hw extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function At(r){return typeof r=="object"&&r!==null&&"__isStorageError"in r}class D5 extends Hw{constructor(e,t,n){super(e),this.name="StorageApiError",this.status=t,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Hv extends Hw{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}const Gw=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>Jc(async()=>{const{default:n}=await Promise.resolve().then(()=>Ko);return{default:n}},void 0).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)},V5=()=>Te(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Jc(()=>Promise.resolve().then(()=>Ko),void 0)).Response:Response}),Gv=r=>{if(Array.isArray(r))return r.map(t=>Gv(t));if(typeof r=="function"||r!==Object(r))return r;const e={};return Object.entries(r).forEach(([t,n])=>{const s=t.replace(/([-_][a-z])/gi,o=>o.toUpperCase().replace(/[-_]/g,""));e[s]=Gv(n)}),e},M5=r=>{if(typeof r!="object"||r===null)return!1;const e=Object.getPrototypeOf(r);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)},z_=r=>{var e;return r.msg||r.message||r.error_description||(typeof r.error=="string"?r.error:(e=r.error)===null||e===void 0?void 0:e.message)||JSON.stringify(r)},j5=(r,e,t)=>Te(void 0,void 0,void 0,function*(){const n=yield V5();r instanceof n&&!(t!=null&&t.noResolveJson)?r.json().then(s=>{const o=r.status||500,c=(s==null?void 0:s.statusCode)||o+"";e(new D5(z_(s),o,c))}).catch(s=>{e(new Hv(z_(s),s))}):e(new Hv(z_(r),r))}),L5=(r,e,t,n)=>{const s={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"||!n?s:(M5(n)?(s.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),s.body=JSON.stringify(n)):s.body=n,e!=null&&e.duplex&&(s.duplex=e.duplex),Object.assign(Object.assign({},s),t))};function Md(r,e,t,n,s,o){return Te(this,void 0,void 0,function*(){return new Promise((c,h)=>{r(t,L5(e,n,s,o)).then(d=>{if(!d.ok)throw d;return n!=null&&n.noResolveJson?d:d.json()}).then(d=>c(d)).catch(d=>j5(d,h,n))})})}function ud(r,e,t,n){return Te(this,void 0,void 0,function*(){return Md(r,"GET",e,t,n)})}function qr(r,e,t,n,s){return Te(this,void 0,void 0,function*(){return Md(r,"POST",e,n,s,t)})}function Kv(r,e,t,n,s){return Te(this,void 0,void 0,function*(){return Md(r,"PUT",e,n,s,t)})}function U5(r,e,t,n){return Te(this,void 0,void 0,function*(){return Md(r,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),n)})}function Kw(r,e,t,n,s){return Te(this,void 0,void 0,function*(){return Md(r,"DELETE",e,n,s,t)})}class B5{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}execute(){return Te(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(At(e))return{data:null,error:e};throw e}})}}var dN;class F5{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[dN]="BlobDownloadBuilder",this.promise=null}asStream(){return new B5(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return Te(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(At(e))return{data:null,error:e};throw e}})}}dN=Symbol.toStringTag;const z5={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},YI={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class q5{constructor(e,t={},n,s){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=n,this.fetch=Gw(s)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,t,n,s){return Te(this,void 0,void 0,function*(){try{let o;const c=Object.assign(Object.assign({},YI),s);let h=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(c.upsert)});const d=c.metadata;typeof Blob<"u"&&n instanceof Blob?(o=new FormData,o.append("cacheControl",c.cacheControl),d&&o.append("metadata",this.encodeMetadata(d)),o.append("",n)):typeof FormData<"u"&&n instanceof FormData?(o=n,o.append("cacheControl",c.cacheControl),d&&o.append("metadata",this.encodeMetadata(d))):(o=n,h["cache-control"]=`max-age=${c.cacheControl}`,h["content-type"]=c.contentType,d&&(h["x-metadata"]=this.toBase64(this.encodeMetadata(d)))),s!=null&&s.headers&&(h=Object.assign(Object.assign({},h),s.headers));const m=this._removeEmptyFolders(t),y=this._getFinalPath(m),_=yield(e=="PUT"?Kv:qr)(this.fetch,`${this.url}/object/${y}`,o,Object.assign({headers:h},c!=null&&c.duplex?{duplex:c.duplex}:{}));return{data:{path:m,id:_.Id,fullPath:_.Key},error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(At(o))return{data:null,error:o};throw o}})}upload(e,t,n){return Te(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,n)})}uploadToSignedUrl(e,t,n,s){return Te(this,void 0,void 0,function*(){const o=this._removeEmptyFolders(e),c=this._getFinalPath(o),h=new URL(this.url+`/object/upload/sign/${c}`);h.searchParams.set("token",t);try{let d;const m=Object.assign({upsert:YI.upsert},s),y=Object.assign(Object.assign({},this.headers),{"x-upsert":String(m.upsert)});typeof Blob<"u"&&n instanceof Blob?(d=new FormData,d.append("cacheControl",m.cacheControl),d.append("",n)):typeof FormData<"u"&&n instanceof FormData?(d=n,d.append("cacheControl",m.cacheControl)):(d=n,y["cache-control"]=`max-age=${m.cacheControl}`,y["content-type"]=m.contentType);const _=yield Kv(this.fetch,h.toString(),d,{headers:y});return{data:{path:o,fullPath:_.Key},error:null}}catch(d){if(this.shouldThrowOnError)throw d;if(At(d))return{data:null,error:d};throw d}})}createSignedUploadUrl(e,t){return Te(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const s=Object.assign({},this.headers);t!=null&&t.upsert&&(s["x-upsert"]="true");const o=yield qr(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),c=new URL(this.url+o.url),h=c.searchParams.get("token");if(!h)throw new Hw("No token returned by API");return{data:{signedUrl:c.toString(),path:e,token:h},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(At(n))return{data:null,error:n};throw n}})}update(e,t,n){return Te(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,n)})}move(e,t,n){return Te(this,void 0,void 0,function*(){try{return{data:yield qr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(At(s))return{data:null,error:s};throw s}})}copy(e,t,n){return Te(this,void 0,void 0,function*(){try{return{data:{path:(yield qr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(At(s))return{data:null,error:s};throw s}})}createSignedUrl(e,t,n){return Te(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),o=yield qr(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:t},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const c=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return o={signedUrl:encodeURI(`${this.url}${o.signedURL}${c}`)},{data:o,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(At(s))return{data:null,error:s};throw s}})}createSignedUrls(e,t,n){return Te(this,void 0,void 0,function*(){try{const s=yield qr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(c=>Object.assign(Object.assign({},c),{signedUrl:c.signedURL?encodeURI(`${this.url}${c.signedURL}${o}`):null})),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(At(s))return{data:null,error:s};throw s}})}download(e,t){const s=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",o=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),c=o?`?${o}`:"",h=this._getFinalPath(e),d=()=>ud(this.fetch,`${this.url}/${s}/${h}${c}`,{headers:this.headers,noResolveJson:!0});return new F5(d,this.shouldThrowOnError)}info(e){return Te(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const n=yield ud(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:Gv(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(At(n))return{data:null,error:n};throw n}})}exists(e){return Te(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield U5(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(At(n)&&n instanceof Hv){const s=n.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,t){const n=this._getFinalPath(e),s=[],o=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";o!==""&&s.push(o);const h=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",d=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});d!==""&&s.push(d);let m=s.join("&");return m!==""&&(m=`?${m}`),{data:{publicUrl:encodeURI(`${this.url}/${h}/public/${n}${m}`)}}}remove(e){return Te(this,void 0,void 0,function*(){try{return{data:yield Kw(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(At(t))return{data:null,error:t};throw t}})}list(e,t,n){return Te(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},z5),t),{prefix:e||""});return{data:yield qr(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(At(s))return{data:null,error:s};throw s}})}listV2(e,t){return Te(this,void 0,void 0,function*(){try{const n=Object.assign({},e);return{data:yield qr(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},t),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(At(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const fN="2.78.0",mN={"X-Client-Info":`storage-js/${fN}`};class $5{constructor(e,t={},n,s){this.shouldThrowOnError=!1;const o=new URL(e);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(o.hostname)&&!o.hostname.includes("storage.supabase.")&&(o.hostname=o.hostname.replace("supabase.","storage.supabase.")),this.url=o.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},mN),t),this.fetch=Gw(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(e){return Te(this,void 0,void 0,function*(){try{const t=this.listBucketOptionsToQueryString(e);return{data:yield ud(this.fetch,`${this.url}/bucket${t}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(At(t))return{data:null,error:t};throw t}})}getBucket(e){return Te(this,void 0,void 0,function*(){try{return{data:yield ud(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(At(t))return{data:null,error:t};throw t}})}createBucket(e){return Te(this,arguments,void 0,function*(t,n={public:!1}){try{return{data:yield qr(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(At(s))return{data:null,error:s};throw s}})}updateBucket(e,t){return Te(this,void 0,void 0,function*(){try{return{data:yield Kv(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(At(n))return{data:null,error:n};throw n}})}emptyBucket(e){return Te(this,void 0,void 0,function*(){try{return{data:yield qr(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(At(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Te(this,void 0,void 0,function*(){try{return{data:yield Kw(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(At(t))return{data:null,error:t};throw t}})}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}}class H5{constructor(e,t={},n){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},mN),t),this.fetch=Gw(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return Te(this,void 0,void 0,function*(){try{return{data:yield qr(this.fetch,`${this.url}/bucket`,{name:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(At(t))return{data:null,error:t};throw t}})}listBuckets(e){return Te(this,void 0,void 0,function*(){try{const t=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&t.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&t.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&t.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&t.set("sortOrder",e.sortOrder),e!=null&&e.search&&t.set("search",e.search);const n=t.toString(),s=n?`${this.url}/bucket?${n}`:`${this.url}/bucket`;return{data:yield ud(this.fetch,s,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(At(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Te(this,void 0,void 0,function*(){try{return{data:yield Kw(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(At(t))return{data:null,error:t};throw t}})}}const Ww={"X-Client-Info":`storage-js/${fN}`,"Content-Type":"application/json"};class gN extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function or(r){return typeof r=="object"&&r!==null&&"__isStorageVectorsError"in r}class q_ extends gN{constructor(e,t,n){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class G5 extends gN{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}}var JI;(function(r){r.InternalError="InternalError",r.S3VectorConflictException="S3VectorConflictException",r.S3VectorNotFoundException="S3VectorNotFoundException",r.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",r.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",r.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(JI||(JI={}));const Qw=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>Jc(async()=>{const{default:n}=await Promise.resolve().then(()=>Ko);return{default:n}},void 0).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)},K5=r=>{if(typeof r!="object"||r===null)return!1;const e=Object.getPrototypeOf(r);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)},XI=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),W5=(r,e,t)=>Te(void 0,void 0,void 0,function*(){if(r&&typeof r=="object"&&"status"in r&&"ok"in r&&typeof r.status=="number"&&!(t!=null&&t.noResolveJson)){const s=r.status||500,o=r;if(typeof o.json=="function")o.json().then(c=>{const h=(c==null?void 0:c.statusCode)||(c==null?void 0:c.code)||s+"";e(new q_(XI(c),s,h))}).catch(()=>{const c=s+"",h=o.statusText||`HTTP ${s} error`;e(new q_(h,s,c))});else{const c=s+"",h=o.statusText||`HTTP ${s} error`;e(new q_(h,s,c))}}else e(new G5(XI(r),r))}),Q5=(r,e,t,n)=>{const s={method:r,headers:(e==null?void 0:e.headers)||{}};return n?(K5(n)?(s.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),s.body=JSON.stringify(n)):s.body=n,Object.assign(Object.assign({},s),t)):s};function Y5(r,e,t,n,s,o){return Te(this,void 0,void 0,function*(){return new Promise((c,h)=>{r(t,Q5(e,n,s,o)).then(d=>{if(!d.ok)throw d;if(n!=null&&n.noResolveJson)return d;const m=d.headers.get("content-type");return!m||!m.includes("application/json")?{}:d.json()}).then(d=>c(d)).catch(d=>W5(d,h,n))})})}function lr(r,e,t,n,s){return Te(this,void 0,void 0,function*(){return Y5(r,"POST",e,n,s,t)})}class J5{constructor(e,t={},n){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Ww),t),this.fetch=Qw(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(e){return Te(this,void 0,void 0,function*(){try{return{data:(yield lr(this.fetch,`${this.url}/CreateIndex`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(or(t))return{data:null,error:t};throw t}})}getIndex(e,t){return Te(this,void 0,void 0,function*(){try{return{data:yield lr(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(or(n))return{data:null,error:n};throw n}})}listIndexes(e){return Te(this,void 0,void 0,function*(){try{return{data:yield lr(this.fetch,`${this.url}/ListIndexes`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(or(t))return{data:null,error:t};throw t}})}deleteIndex(e,t){return Te(this,void 0,void 0,function*(){try{return{data:(yield lr(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(or(n))return{data:null,error:n};throw n}})}}class X5{constructor(e,t={},n){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Ww),t),this.fetch=Qw(n)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(e){return Te(this,void 0,void 0,function*(){try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield lr(this.fetch,`${this.url}/PutVectors`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(or(t))return{data:null,error:t};throw t}})}getVectors(e){return Te(this,void 0,void 0,function*(){try{return{data:yield lr(this.fetch,`${this.url}/GetVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(or(t))return{data:null,error:t};throw t}})}listVectors(e){return Te(this,void 0,void 0,function*(){try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:yield lr(this.fetch,`${this.url}/ListVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(or(t))return{data:null,error:t};throw t}})}queryVectors(e){return Te(this,void 0,void 0,function*(){try{return{data:yield lr(this.fetch,`${this.url}/QueryVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(or(t))return{data:null,error:t};throw t}})}deleteVectors(e){return Te(this,void 0,void 0,function*(){try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield lr(this.fetch,`${this.url}/DeleteVectors`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(or(t))return{data:null,error:t};throw t}})}}class Z5{constructor(e,t={},n){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Ww),t),this.fetch=Qw(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return Te(this,void 0,void 0,function*(){try{return{data:(yield lr(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(or(t))return{data:null,error:t};throw t}})}getBucket(e){return Te(this,void 0,void 0,function*(){try{return{data:yield lr(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(or(t))return{data:null,error:t};throw t}})}listBuckets(){return Te(this,arguments,void 0,function*(e={}){try{return{data:yield lr(this.fetch,`${this.url}/ListVectorBuckets`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(or(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Te(this,void 0,void 0,function*(){try{return{data:(yield lr(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(or(t))return{data:null,error:t};throw t}})}}class eB extends Z5{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new tB(this.url,this.headers,e,this.fetch)}}class tB extends J5{constructor(e,t,n,s){super(e,t,s),this.vectorBucketName=n}createIndex(e){const t=Object.create(null,{createIndex:{get:()=>super.createIndex}});return Te(this,void 0,void 0,function*(){return t.createIndex.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const e=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return Te(this,arguments,void 0,function*(t={}){return e.listIndexes.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}getIndex(e){const t=Object.create(null,{getIndex:{get:()=>super.getIndex}});return Te(this,void 0,void 0,function*(){return t.getIndex.call(this,this.vectorBucketName,e)})}deleteIndex(e){const t=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return Te(this,void 0,void 0,function*(){return t.deleteIndex.call(this,this.vectorBucketName,e)})}index(e){return new nB(this.url,this.headers,this.vectorBucketName,e,this.fetch)}}class nB extends X5{constructor(e,t,n,s,o){super(e,t,o),this.vectorBucketName=n,this.indexName=s}putVectors(e){const t=Object.create(null,{putVectors:{get:()=>super.putVectors}});return Te(this,void 0,void 0,function*(){return t.putVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(e){const t=Object.create(null,{getVectors:{get:()=>super.getVectors}});return Te(this,void 0,void 0,function*(){return t.getVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const e=Object.create(null,{listVectors:{get:()=>super.listVectors}});return Te(this,arguments,void 0,function*(t={}){return e.listVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(e){const t=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return Te(this,void 0,void 0,function*(){return t.queryVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(e){const t=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return Te(this,void 0,void 0,function*(){return t.deleteVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class rB extends $5{constructor(e,t={},n,s){super(e,t,n,s)}from(e){return new q5(this.url,this.headers,e,this.fetch)}get vectors(){return new eB(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new H5(this.url+"/iceberg",this.headers,this.fetch)}}const iB="2.78.0";let Eh="";typeof Deno<"u"?Eh="deno":typeof document<"u"?Eh="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Eh="react-native":Eh="node";const sB={"X-Client-Info":`supabase-js-${Eh}/${iB}`},aB={headers:sB},oB={schema:"public"},lB={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},cB={},uB=r=>{let e;return r?e=r:typeof fetch>"u"?e=tN:e=fetch,(...t)=>e(...t)},hB=()=>typeof Headers>"u"?nN:Headers,dB=(r,e,t)=>{const n=uB(t),s=hB();return async(o,c)=>{var h;const d=(h=await e())!==null&&h!==void 0?h:r;let m=new s(c==null?void 0:c.headers);return m.has("apikey")||m.set("apikey",r),m.has("Authorization")||m.set("Authorization",`Bearer ${d}`),n(o,Object.assign(Object.assign({},c),{headers:m}))}};function fB(r){return r.endsWith("/")?r:r+"/"}function mB(r,e){var t,n;const{db:s,auth:o,realtime:c,global:h}=r,{db:d,auth:m,realtime:y,global:_}=e,E={db:Object.assign(Object.assign({},d),s),auth:Object.assign(Object.assign({},m),o),realtime:Object.assign(Object.assign({},y),c),storage:{},global:Object.assign(Object.assign(Object.assign({},_),h),{headers:Object.assign(Object.assign({},(t=_==null?void 0:_.headers)!==null&&t!==void 0?t:{}),(n=h==null?void 0:h.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return r.accessToken?E.accessToken=r.accessToken:delete E.accessToken,E}function gB(r){const e=r==null?void 0:r.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(fB(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const pN="2.78.0",nc=30*1e3,Wv=3,$_=Wv*nc,pB="http://localhost:9999",yB="supabase.auth.token",_B={"X-Client-Info":`gotrue-js/${pN}`},Qv="X-Supabase-Api-Version",yN={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},vB=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,wB=600*1e3;class hd extends Error{constructor(e,t,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=n}}function Ae(r){return typeof r=="object"&&r!==null&&"__isAuthError"in r}class bB extends hd{constructor(e,t,n){super(e,t,n),this.name="AuthApiError",this.status=t,this.code=n}}function EB(r){return Ae(r)&&r.name==="AuthApiError"}class wo extends hd{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Ra extends hd{constructor(e,t,n,s){super(e,n,s),this.name=t,this.status=n}}class Fr extends Ra{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function TB(r){return Ae(r)&&r.name==="AuthSessionMissingError"}class Gl extends Ra{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class km extends Ra{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Nm extends Ra{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function SB(r){return Ae(r)&&r.name==="AuthImplicitGrantRedirectError"}class ZI extends Ra{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Yv extends Ra{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function H_(r){return Ae(r)&&r.name==="AuthRetryableFetchError"}class ex extends Ra{constructor(e,t,n){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=n}}class Jv extends Ra{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Eg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),tx=` 	
\r=`.split(""),AB=(()=>{const r=new Array(128);for(let e=0;e<r.length;e+=1)r[e]=-1;for(let e=0;e<tx.length;e+=1)r[tx[e].charCodeAt(0)]=-2;for(let e=0;e<Eg.length;e+=1)r[Eg[e].charCodeAt(0)]=e;return r})();function nx(r,e,t){if(r!==null)for(e.queue=e.queue<<8|r,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;t(Eg[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;t(Eg[n]),e.queuedBits-=6}}function _N(r,e,t){const n=AB[r];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(r)}"`)}}function rx(r){const e=[],t=c=>{e.push(String.fromCodePoint(c))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},o=c=>{RB(c,n,t)};for(let c=0;c<r.length;c+=1)_N(r.charCodeAt(c),s,o);return e.join("")}function IB(r,e){if(r<=127){e(r);return}else if(r<=2047){e(192|r>>6),e(128|r&63);return}else if(r<=65535){e(224|r>>12),e(128|r>>6&63),e(128|r&63);return}else if(r<=1114111){e(240|r>>18),e(128|r>>12&63),e(128|r>>6&63),e(128|r&63);return}throw new Error(`Unrecognized Unicode codepoint: ${r.toString(16)}`)}function xB(r,e){for(let t=0;t<r.length;t+=1){let n=r.charCodeAt(t);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(r.charCodeAt(t+1)-56320&65535|s)+65536,t+=1}IB(n,e)}}function RB(r,e,t){if(e.utf8seq===0){if(r<=127){t(r);return}for(let n=1;n<6;n+=1)if((r>>7-n&1)===0){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=r&31;else if(e.utf8seq===3)e.codepoint=r&15;else if(e.utf8seq===4)e.codepoint=r&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(r<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|r&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function hc(r){const e=[],t={queue:0,queuedBits:0},n=s=>{e.push(s)};for(let s=0;s<r.length;s+=1)_N(r.charCodeAt(s),t,n);return new Uint8Array(e)}function CB(r){const e=[];return xB(r,t=>e.push(t)),new Uint8Array(e)}function Ao(r){const e=[],t={queue:0,queuedBits:0},n=s=>{e.push(s)};return r.forEach(s=>nx(s,t,n)),nx(null,t,n),e.join("")}function kB(r){return Math.round(Date.now()/1e3)+r}function NB(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){const e=Math.random()*16|0;return(r=="x"?e:e&3|8).toString(16)})}const On=()=>typeof window<"u"&&typeof document<"u",oo={tested:!1,writable:!1},vN=()=>{if(!On())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(oo.tested)return oo.writable;const r=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(r,r),globalThis.localStorage.removeItem(r),oo.tested=!0,oo.writable=!0}catch{oo.tested=!0,oo.writable=!1}return oo.writable};function OB(r){const e={},t=new URL(r);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((s,o)=>{e[o]=s})}catch{}return t.searchParams.forEach((n,s)=>{e[s]=n}),e}const wN=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>Jc(async()=>{const{default:n}=await Promise.resolve().then(()=>Ko);return{default:n}},void 0).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)},PB=r=>typeof r=="object"&&r!==null&&"status"in r&&"ok"in r&&"json"in r&&typeof r.json=="function",rc=async(r,e,t)=>{await r.setItem(e,JSON.stringify(t))},lo=async(r,e)=>{const t=await r.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Xs=async(r,e)=>{await r.removeItem(e)};class fp{constructor(){this.promise=new fp.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}fp.promiseConstructor=Promise;function G_(r){const e=r.split(".");if(e.length!==3)throw new Jv("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!vB.test(e[n]))throw new Jv("JWT not in base64url format");return{header:JSON.parse(rx(e[0])),payload:JSON.parse(rx(e[1])),signature:hc(e[2]),raw:{header:e[0],payload:e[1]}}}async function DB(r){return await new Promise(e=>{setTimeout(()=>e(null),r)})}function VB(r,e){return new Promise((n,s)=>{(async()=>{for(let o=0;o<1/0;o++)try{const c=await r(o);if(!e(o,null,c)){n(c);return}}catch(c){if(!e(o,c)){s(c);return}}})()})}function MB(r){return("0"+r.toString(16)).substr(-2)}function jB(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=t.length;let s="";for(let o=0;o<56;o++)s+=t.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(e),Array.from(e,MB).join("")}async function LB(r){const t=new TextEncoder().encode(r),n=await crypto.subtle.digest("SHA-256",t),s=new Uint8Array(n);return Array.from(s).map(o=>String.fromCharCode(o)).join("")}async function UB(r){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),r;const t=await LB(r);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Kl(r,e,t=!1){const n=jB();let s=n;t&&(s+="/PASSWORD_RECOVERY"),await rc(r,`${e}-code-verifier`,s);const o=await UB(n);return[o,n===o?"plain":"s256"]}const BB=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function FB(r){const e=r.headers.get(Qv);if(!e||!e.match(BB))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function zB(r){if(!r)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(r<=e)throw new Error("JWT has expired")}function qB(r){switch(r){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const $B=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Wl(r){if(!$B.test(r))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function K_(){const r={};return new Proxy(r,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const n=t.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function HB(r,e){return new Proxy(r,{get:(t,n,s)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const o=n.toString();if(o==="Symbol(Symbol.toPrimitive)"||o==="Symbol(Symbol.toStringTag)"||o==="Symbol(util.inspect.custom)"||o==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(t,n,s)}return!e.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(t,n,s)}})}function ix(r){return JSON.parse(JSON.stringify(r))}const fo=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),GB=[502,503,504];async function sx(r){var e;if(!PB(r))throw new Yv(fo(r),0);if(GB.includes(r.status))throw new Yv(fo(r),r.status);let t;try{t=await r.json()}catch(o){throw new wo(fo(o),o)}let n;const s=FB(r);if(s&&s.getTime()>=yN["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?n=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(n=t.error_code),n){if(n==="weak_password")throw new ex(fo(t),r.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new Fr}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((o,c)=>o&&typeof c=="string",!0))throw new ex(fo(t),r.status,t.weak_password.reasons);throw new bB(fo(t),r.status||500,n)}const KB=(r,e,t,n)=>{const s={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),t))};async function ke(r,e,t,n){var s;const o=Object.assign({},n==null?void 0:n.headers);o[Qv]||(o[Qv]=yN["2024-01-01"].name),n!=null&&n.jwt&&(o.Authorization=`Bearer ${n.jwt}`);const c=(s=n==null?void 0:n.query)!==null&&s!==void 0?s:{};n!=null&&n.redirectTo&&(c.redirect_to=n.redirectTo);const h=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",d=await WB(r,e,t+h,{headers:o,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(d):{data:Object.assign({},d),error:null}}async function WB(r,e,t,n,s,o){const c=KB(e,n,s,o);let h;try{h=await r(t,Object.assign({},c))}catch(d){throw console.error(d),new Yv(fo(d),0)}if(h.ok||await sx(h),n!=null&&n.noResolveJson)return h;try{return await h.json()}catch(d){await sx(d)}}function zr(r){var e;let t=null;JB(r)&&(t=Object.assign({},r),r.expires_at||(t.expires_at=kB(r.expires_in)));const n=(e=r.user)!==null&&e!==void 0?e:r;return{data:{session:t,user:n},error:null}}function ax(r){const e=zr(r);return!e.error&&r.weak_password&&typeof r.weak_password=="object"&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.message&&typeof r.weak_password.message=="string"&&r.weak_password.reasons.reduce((t,n)=>t&&typeof n=="string",!0)&&(e.data.weak_password=r.weak_password),e}function ea(r){var e;return{data:{user:(e=r.user)!==null&&e!==void 0?e:r},error:null}}function QB(r){return{data:r,error:null}}function YB(r){const{action_link:e,email_otp:t,hashed_token:n,redirect_to:s,verification_type:o}=r,c=Yc(r,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),h={action_link:e,email_otp:t,hashed_token:n,redirect_to:s,verification_type:o},d=Object.assign({},c);return{data:{properties:h,user:d},error:null}}function ox(r){return r}function JB(r){return r.access_token&&r.refresh_token&&r.expires_in}const W_=["global","local","others"];class XB{constructor({url:e="",headers:t={},fetch:n}){this.url=e,this.headers=t,this.fetch=wN(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=W_[0]){if(W_.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${W_.join(", ")}`);try{return await ke(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Ae(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,t={}){try{return await ke(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:ea})}catch(n){if(Ae(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:t}=e,n=Yc(e,["options"]),s=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(s.new_email=n==null?void 0:n.newEmail,delete s.newEmail),await ke(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:YB,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(Ae(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await ke(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:ea})}catch(t){if(Ae(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,n,s,o,c,h,d;try{const m={nextPage:null,lastPage:0,total:0},y=await ke(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:"",per_page:(o=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&o!==void 0?o:""},xform:ox});if(y.error)throw y.error;const _=await y.json(),E=(c=y.headers.get("x-total-count"))!==null&&c!==void 0?c:0,S=(d=(h=y.headers.get("link"))===null||h===void 0?void 0:h.split(","))!==null&&d!==void 0?d:[];return S.length>0&&(S.forEach(C=>{const k=parseInt(C.split(";")[0].split("=")[1].substring(0,1)),N=JSON.parse(C.split(";")[1].split("=")[1]);m[`${N}Page`]=k}),m.total=parseInt(E)),{data:Object.assign(Object.assign({},_),m),error:null}}catch(m){if(Ae(m))return{data:{users:[]},error:m};throw m}}async getUserById(e){Wl(e);try{return await ke(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:ea})}catch(t){if(Ae(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Wl(e);try{return await ke(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:ea})}catch(n){if(Ae(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,t=!1){Wl(e);try{return await ke(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:ea})}catch(n){if(Ae(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){Wl(e.userId);try{const{data:t,error:n}=await ke(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:t,error:n}}catch(t){if(Ae(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Wl(e.userId),Wl(e.id);try{return{data:await ke(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(Ae(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,n,s,o,c,h,d;try{const m={nextPage:null,lastPage:0,total:0},y=await ke(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:"",per_page:(o=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&o!==void 0?o:""},xform:ox});if(y.error)throw y.error;const _=await y.json(),E=(c=y.headers.get("x-total-count"))!==null&&c!==void 0?c:0,S=(d=(h=y.headers.get("link"))===null||h===void 0?void 0:h.split(","))!==null&&d!==void 0?d:[];return S.length>0&&(S.forEach(C=>{const k=parseInt(C.split(";")[0].split("=")[1].substring(0,1)),N=JSON.parse(C.split(";")[1].split("=")[1]);m[`${N}Page`]=k}),m.total=parseInt(E)),{data:Object.assign(Object.assign({},_),m),error:null}}catch(m){if(Ae(m))return{data:{clients:[]},error:m};throw m}}async _createOAuthClient(e){try{return await ke(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(Ae(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await ke(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(Ae(t))return{data:null,error:t};throw t}}async _updateOAuthClient(e,t){try{return await ke(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:t,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Ae(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(e){try{return await ke(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(Ae(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await ke(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(Ae(t))return{data:null,error:t};throw t}}}function lx(r={}){return{getItem:e=>r[e]||null,setItem:(e,t)=>{r[e]=t},removeItem:e=>{delete r[e]}}}const Ql={debug:!!(globalThis&&vN()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class bN extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class ZB extends bN{}async function eF(r,e,t){Ql.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",r,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),Ql.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",r)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(r,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){Ql.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",r,s.name);try{return await t()}finally{Ql.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",r,s.name)}}else{if(e===0)throw Ql.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",r),new ZB(`Acquiring an exclusive Navigator LockManager lock "${r}" immediately failed`);if(Ql.debug)try{const o=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}function tF(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function EN(r){if(!/^0x[a-fA-F0-9]{40}$/.test(r))throw new Error(`@supabase/auth-js: Address "${r}" is invalid.`);return r.toLowerCase()}function nF(r){return parseInt(r,16)}function rF(r){const e=new TextEncoder().encode(r);return"0x"+Array.from(e,n=>n.toString(16).padStart(2,"0")).join("")}function iF(r){var e;const{chainId:t,domain:n,expirationTime:s,issuedAt:o=new Date,nonce:c,notBefore:h,requestId:d,resources:m,scheme:y,uri:_,version:E}=r;{if(!Number.isInteger(t))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${t}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(c&&c.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${c}`);if(!_)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(E!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${E}`);if(!((e=r.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${r.statement}`)}const S=EN(r.address),C=y?`${y}://${n}`:n,k=r.statement?`${r.statement}
`:"",N=`${C} wants you to sign in with your Ethereum account:
${S}

${k}`;let G=`URI: ${_}
Version: ${E}
Chain ID: ${t}${c?`
Nonce: ${c}`:""}
Issued At: ${o.toISOString()}`;if(s&&(G+=`
Expiration Time: ${s.toISOString()}`),h&&(G+=`
Not Before: ${h.toISOString()}`),d&&(G+=`
Request ID: ${d}`),m){let J=`
Resources:`;for(const K of m){if(!K||typeof K!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${K}`);J+=`
- ${K}`}G+=J}return`${N}
${G}`}class Yt extends Error{constructor({message:e,code:t,cause:n,name:s}){var o;super(e,{cause:n}),this.__isWebAuthnError=!0,this.name=(o=s??(n instanceof Error?n.name:void 0))!==null&&o!==void 0?o:"Unknown Error",this.code=t}}class Tg extends Yt{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function sF({error:r,options:e}){var t,n,s;const{publicKey:o}=e;if(!o)throw Error("options was missing required publicKey property");if(r.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Yt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:r})}else if(r.name==="ConstraintError"){if(((t=o.authenticatorSelection)===null||t===void 0?void 0:t.requireResidentKey)===!0)return new Yt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:r});if(e.mediation==="conditional"&&((n=o.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Yt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:r});if(((s=o.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new Yt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:r})}else{if(r.name==="InvalidStateError")return new Yt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:r});if(r.name==="NotAllowedError")return new Yt({message:r.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r});if(r.name==="NotSupportedError")return o.pubKeyCredParams.filter(h=>h.type==="public-key").length===0?new Yt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:r}):new Yt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:r});if(r.name==="SecurityError"){const c=window.location.hostname;if(TN(c)){if(o.rp.id!==c)return new Yt({message:`The RP ID "${o.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:r})}else return new Yt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:r})}else if(r.name==="TypeError"){if(o.user.id.byteLength<1||o.user.id.byteLength>64)return new Yt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:r})}else if(r.name==="UnknownError")return new Yt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:r})}return new Yt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r})}function aF({error:r,options:e}){const{publicKey:t}=e;if(!t)throw Error("options was missing required publicKey property");if(r.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Yt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:r})}else{if(r.name==="NotAllowedError")return new Yt({message:r.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r});if(r.name==="SecurityError"){const n=window.location.hostname;if(TN(n)){if(t.rpId!==n)return new Yt({message:`The RP ID "${t.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:r})}else return new Yt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:r})}else if(r.name==="UnknownError")return new Yt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:r})}return new Yt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r})}class oF{createNewAbortSignal(){if(this.controller){const t=new Error("Cancelling existing WebAuthn API call for new one");t.name="AbortError",this.controller.abort(t)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const lF=new oF;function cF(r){if(!r)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(r);const{challenge:e,user:t,excludeCredentials:n}=r,s=Yc(r,["challenge","user","excludeCredentials"]),o=hc(e).buffer,c=Object.assign(Object.assign({},t),{id:hc(t.id).buffer}),h=Object.assign(Object.assign({},s),{challenge:o,user:c});if(n&&n.length>0){h.excludeCredentials=new Array(n.length);for(let d=0;d<n.length;d++){const m=n[d];h.excludeCredentials[d]=Object.assign(Object.assign({},m),{id:hc(m.id).buffer,type:m.type||"public-key",transports:m.transports})}}return h}function uF(r){if(!r)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(r);const{challenge:e,allowCredentials:t}=r,n=Yc(r,["challenge","allowCredentials"]),s=hc(e).buffer,o=Object.assign(Object.assign({},n),{challenge:s});if(t&&t.length>0){o.allowCredentials=new Array(t.length);for(let c=0;c<t.length;c++){const h=t[c];o.allowCredentials[c]=Object.assign(Object.assign({},h),{id:hc(h.id).buffer,type:h.type||"public-key",transports:h.transports})}}return o}function hF(r){var e;if("toJSON"in r&&typeof r.toJSON=="function")return r.toJSON();const t=r;return{id:r.id,rawId:r.id,response:{attestationObject:Ao(new Uint8Array(r.response.attestationObject)),clientDataJSON:Ao(new Uint8Array(r.response.clientDataJSON))},type:"public-key",clientExtensionResults:r.getClientExtensionResults(),authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function dF(r){var e;if("toJSON"in r&&typeof r.toJSON=="function")return r.toJSON();const t=r,n=r.getClientExtensionResults(),s=r.response;return{id:r.id,rawId:r.id,response:{authenticatorData:Ao(new Uint8Array(s.authenticatorData)),clientDataJSON:Ao(new Uint8Array(s.clientDataJSON)),signature:Ao(new Uint8Array(s.signature)),userHandle:s.userHandle?Ao(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function TN(r){return r==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(r)}function cx(){var r,e;return!!(On()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((r=navigator==null?void 0:navigator.credentials)===null||r===void 0?void 0:r.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function fF(r){try{const e=await navigator.credentials.create(r);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Tg("Browser returned unexpected credential type",e)}:{data:null,error:new Tg("Empty credential response",e)}}catch(e){return{data:null,error:sF({error:e,options:r})}}}async function mF(r){try{const e=await navigator.credentials.get(r);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Tg("Browser returned unexpected credential type",e)}:{data:null,error:new Tg("Empty credential response",e)}}catch(e){return{data:null,error:aF({error:e,options:r})}}}const gF={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},pF={userVerification:"preferred",hints:["security-key"]};function Sg(...r){const e=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),t=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),n={};for(const s of r)if(s)for(const o in s){const c=s[o];if(c!==void 0)if(Array.isArray(c))n[o]=c;else if(t(c))n[o]=c;else if(e(c)){const h=n[o];e(h)?n[o]=Sg(h,c):n[o]=Sg(c)}else n[o]=c}return n}function yF(r,e){return Sg(gF,r,e||{})}function _F(r,e){return Sg(pF,r,e||{})}class vF{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:n,signal:s},o){try{const{data:c,error:h}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!c)return{data:null,error:h};const d=s??lF.createNewAbortSignal();if(c.webauthn.type==="create"){const{user:m}=c.webauthn.credential_options.publicKey;m.name||(m.name=`${m.id}:${n}`),m.displayName||(m.displayName=m.name)}switch(c.webauthn.type){case"create":{const m=yF(c.webauthn.credential_options.publicKey,o==null?void 0:o.create),{data:y,error:_}=await fF({publicKey:m,signal:d});return y?{data:{factorId:e,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:y}},error:null}:{data:null,error:_}}case"request":{const m=_F(c.webauthn.credential_options.publicKey,o==null?void 0:o.request),{data:y,error:_}=await mF(Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:m,signal:d}));return y?{data:{factorId:e,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:y}},error:null}:{data:null,error:_}}}}catch(c){return Ae(c)?{data:null,error:c}:{data:null,error:new wo("Unexpected error in challenge",c)}}}async _verify({challengeId:e,factorId:t,webauthn:n}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:n})}async _authenticate({factorId:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:s}},o){if(!t)return{data:null,error:new hd("rpId is required for WebAuthn authentication")};try{if(!cx())return{data:null,error:new wo("Browser does not support WebAuthn",null)};const{data:c,error:h}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:n},signal:s},{request:o});if(!c)return{data:null,error:h};const{webauthn:d}=c;return this._verify({factorId:e,challengeId:c.challengeId,webauthn:{type:d.type,rpId:t,rpOrigins:n,credential_response:d.credential_response}})}catch(c){return Ae(c)?{data:null,error:c}:{data:null,error:new wo("Unexpected error in authenticate",c)}}}async _register({friendlyName:e,rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:s},o){if(!t)return{data:null,error:new hd("rpId is required for WebAuthn registration")};try{if(!cx())return{data:null,error:new wo("Browser does not support WebAuthn",null)};const{data:c,error:h}=await this._enroll({friendlyName:e});if(!c)return await this.client.mfa.listFactors().then(y=>{var _;return(_=y.data)===null||_===void 0?void 0:_.all.find(E=>E.factor_type==="webauthn"&&E.friendly_name===e&&E.status!=="unverified")}).then(y=>y?this.client.mfa.unenroll({factorId:y==null?void 0:y.id}):void 0),{data:null,error:h};const{data:d,error:m}=await this._challenge({factorId:c.id,friendlyName:c.friendly_name,webauthn:{rpId:t,rpOrigins:n},signal:s},{create:o});return d?this._verify({factorId:c.id,challengeId:d.challengeId,webauthn:{rpId:t,rpOrigins:n,type:d.webauthn.type,credential_response:d.webauthn.credential_response}}):{data:null,error:m}}catch(c){return Ae(c)?{data:null,error:c}:{data:null,error:new wo("Unexpected error in register",c)}}}}tF();const wF={url:pB,storageKey:yB,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:_B,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function ux(r,e,t){return await t()}const Yl={};class dd{get jwks(){var e,t;return(t=(e=Yl[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){Yl[this.storageKey]=Object.assign(Object.assign({},Yl[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=Yl[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Yl[this.storageKey]=Object.assign(Object.assign({},Yl[this.storageKey]),{cachedAt:e})}constructor(e){var t,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=dd.nextInstanceID,dd.nextInstanceID+=1,this.instanceID>0&&On()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},wF),e);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new XB({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=wN(s.fetch),this.lock=s.lock||ux,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:On()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=eF:this.lock=ux,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new vF(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:vN()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=lx(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=lx(this.memoryStorage)),On()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${pN}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=OB(window.location.href);let n="none";if(this._isImplicitGrantCallback(t)?n="implicit":await this._isPKCECallback(t)&&(n="pkce"),On()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:o}=await this._getSessionFromURL(t,n);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),SB(o)){const d=(e=o.details)===null||e===void 0?void 0:e.code;if(d==="identity_already_exists"||d==="identity_not_found"||d==="single_identity_not_deletable")return{error:o}}return await this._removeSession(),{error:o}}const{session:c,redirectType:h}=s;return this._debug("#_initialize()","detected session in URL",c,"redirect type",h),await this._saveSession(c),setTimeout(async()=>{h==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",c):await this._notifyAllSubscribers("SIGNED_IN",c)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return Ae(t)?{error:t}:{error:new wo("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,n,s;try{const o=await ke(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=e==null?void 0:e.options)===null||s===void 0?void 0:s.captchaToken}},xform:zr}),{data:c,error:h}=o;if(h||!c)return{data:{user:null,session:null},error:h};const d=c.session,m=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:m,session:d},error:null}}catch(o){if(Ae(o))return{data:{user:null,session:null},error:o};throw o}}async signUp(e){var t,n,s;try{let o;if("email"in e){const{email:y,password:_,options:E}=e;let S=null,C=null;this.flowType==="pkce"&&([S,C]=await Kl(this.storage,this.storageKey)),o=await ke(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:E==null?void 0:E.emailRedirectTo,body:{email:y,password:_,data:(t=E==null?void 0:E.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:E==null?void 0:E.captchaToken},code_challenge:S,code_challenge_method:C},xform:zr})}else if("phone"in e){const{phone:y,password:_,options:E}=e;o=await ke(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:y,password:_,data:(n=E==null?void 0:E.data)!==null&&n!==void 0?n:{},channel:(s=E==null?void 0:E.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:E==null?void 0:E.captchaToken}},xform:zr})}else throw new km("You must provide either an email or phone number and a password");const{data:c,error:h}=o;if(h||!c)return{data:{user:null,session:null},error:h};const d=c.session,m=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:m,session:d},error:null}}catch(o){if(Ae(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithPassword(e){try{let t;if("email"in e){const{email:o,password:c,options:h}=e;t=await ke(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:c,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:ax})}else if("phone"in e){const{phone:o,password:c,options:h}=e;t=await ke(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:c,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:ax})}else throw new km("You must provide either an email or phone number and a password");const{data:n,error:s}=t;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Gl}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(t){if(Ae(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,n,s,o;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(o=e.options)===null||o===void 0?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,n,s,o,c,h,d,m,y,_,E;let S,C;if("message"in e)S=e.message,C=e.signature;else{const{chain:k,wallet:N,statement:G,options:J}=e;let K;if(On())if(typeof N=="object")K=N;else{const O=window;if("ethereum"in O&&typeof O.ethereum=="object"&&"request"in O.ethereum&&typeof O.ethereum.request=="function")K=O.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof N!="object"||!(J!=null&&J.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");K=N}const se=new URL((t=J==null?void 0:J.url)!==null&&t!==void 0?t:window.location.href),ye=await K.request({method:"eth_requestAccounts"}).then(O=>O).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!ye||ye.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const he=EN(ye[0]);let R=(n=J==null?void 0:J.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!R){const O=await K.request({method:"eth_chainId"});R=nF(O)}const x={domain:se.host,address:he,statement:G,uri:se.href,version:"1",chainId:R,nonce:(s=J==null?void 0:J.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(c=(o=J==null?void 0:J.signInWithEthereum)===null||o===void 0?void 0:o.issuedAt)!==null&&c!==void 0?c:new Date,expirationTime:(h=J==null?void 0:J.signInWithEthereum)===null||h===void 0?void 0:h.expirationTime,notBefore:(d=J==null?void 0:J.signInWithEthereum)===null||d===void 0?void 0:d.notBefore,requestId:(m=J==null?void 0:J.signInWithEthereum)===null||m===void 0?void 0:m.requestId,resources:(y=J==null?void 0:J.signInWithEthereum)===null||y===void 0?void 0:y.resources};S=iF(x),C=await K.request({method:"personal_sign",params:[rF(S),he]})}try{const{data:k,error:N}=await ke(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:S,signature:C},!((_=e.options)===null||_===void 0)&&_.captchaToken?{gotrue_meta_security:{captcha_token:(E=e.options)===null||E===void 0?void 0:E.captchaToken}}:null),xform:zr});if(N)throw N;return!k||!k.session||!k.user?{data:{user:null,session:null},error:new Gl}:(k.session&&(await this._saveSession(k.session),await this._notifyAllSubscribers("SIGNED_IN",k.session)),{data:Object.assign({},k),error:N})}catch(k){if(Ae(k))return{data:{user:null,session:null},error:k};throw k}}async signInWithSolana(e){var t,n,s,o,c,h,d,m,y,_,E,S;let C,k;if("message"in e)C=e.message,k=e.signature;else{const{chain:N,wallet:G,statement:J,options:K}=e;let se;if(On())if(typeof G=="object")se=G;else{const he=window;if("solana"in he&&typeof he.solana=="object"&&("signIn"in he.solana&&typeof he.solana.signIn=="function"||"signMessage"in he.solana&&typeof he.solana.signMessage=="function"))se=he.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof G!="object"||!(K!=null&&K.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");se=G}const ye=new URL((t=K==null?void 0:K.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in se&&se.signIn){const he=await se.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},K==null?void 0:K.signInWithSolana),{version:"1",domain:ye.host,uri:ye.href}),J?{statement:J}:null));let R;if(Array.isArray(he)&&he[0]&&typeof he[0]=="object")R=he[0];else if(he&&typeof he=="object"&&"signedMessage"in he&&"signature"in he)R=he;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in R&&"signature"in R&&(typeof R.signedMessage=="string"||R.signedMessage instanceof Uint8Array)&&R.signature instanceof Uint8Array)C=typeof R.signedMessage=="string"?R.signedMessage:new TextDecoder().decode(R.signedMessage),k=R.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in se)||typeof se.signMessage!="function"||!("publicKey"in se)||typeof se!="object"||!se.publicKey||!("toBase58"in se.publicKey)||typeof se.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");C=[`${ye.host} wants you to sign in with your Solana account:`,se.publicKey.toBase58(),...J?["",J,""]:[""],"Version: 1",`URI: ${ye.href}`,`Issued At: ${(s=(n=K==null?void 0:K.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((o=K==null?void 0:K.signInWithSolana)===null||o===void 0)&&o.notBefore?[`Not Before: ${K.signInWithSolana.notBefore}`]:[],...!((c=K==null?void 0:K.signInWithSolana)===null||c===void 0)&&c.expirationTime?[`Expiration Time: ${K.signInWithSolana.expirationTime}`]:[],...!((h=K==null?void 0:K.signInWithSolana)===null||h===void 0)&&h.chainId?[`Chain ID: ${K.signInWithSolana.chainId}`]:[],...!((d=K==null?void 0:K.signInWithSolana)===null||d===void 0)&&d.nonce?[`Nonce: ${K.signInWithSolana.nonce}`]:[],...!((m=K==null?void 0:K.signInWithSolana)===null||m===void 0)&&m.requestId?[`Request ID: ${K.signInWithSolana.requestId}`]:[],...!((_=(y=K==null?void 0:K.signInWithSolana)===null||y===void 0?void 0:y.resources)===null||_===void 0)&&_.length?["Resources",...K.signInWithSolana.resources.map(R=>`- ${R}`)]:[]].join(`
`);const he=await se.signMessage(new TextEncoder().encode(C),"utf8");if(!he||!(he instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");k=he}}try{const{data:N,error:G}=await ke(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:C,signature:Ao(k)},!((E=e.options)===null||E===void 0)&&E.captchaToken?{gotrue_meta_security:{captcha_token:(S=e.options)===null||S===void 0?void 0:S.captchaToken}}:null),xform:zr});if(G)throw G;return!N||!N.session||!N.user?{data:{user:null,session:null},error:new Gl}:(N.session&&(await this._saveSession(N.session),await this._notifyAllSubscribers("SIGNED_IN",N.session)),{data:Object.assign({},N),error:G})}catch(N){if(Ae(N))return{data:{user:null,session:null},error:N};throw N}}async _exchangeCodeForSession(e){const t=await lo(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(t??"").split("/");try{const{data:o,error:c}=await ke(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:zr});if(await Xs(this.storage,`${this.storageKey}-code-verifier`),c)throw c;return!o||!o.session||!o.user?{data:{user:null,session:null,redirectType:null},error:new Gl}:(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:Object.assign(Object.assign({},o),{redirectType:s??null}),error:c})}catch(o){if(Ae(o))return{data:{user:null,session:null,redirectType:null},error:o};throw o}}async signInWithIdToken(e){try{const{options:t,provider:n,token:s,access_token:o,nonce:c}=e,h=await ke(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:o,nonce:c,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:zr}),{data:d,error:m}=h;return m?{data:{user:null,session:null},error:m}:!d||!d.session||!d.user?{data:{user:null,session:null},error:new Gl}:(d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),{data:d,error:m})}catch(t){if(Ae(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,n,s,o,c;try{if("email"in e){const{email:h,options:d}=e;let m=null,y=null;this.flowType==="pkce"&&([m,y]=await Kl(this.storage,this.storageKey));const{error:_}=await ke(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:h,data:(t=d==null?void 0:d.data)!==null&&t!==void 0?t:{},create_user:(n=d==null?void 0:d.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:m,code_challenge_method:y},redirectTo:d==null?void 0:d.emailRedirectTo});return{data:{user:null,session:null},error:_}}if("phone"in e){const{phone:h,options:d}=e,{data:m,error:y}=await ke(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:h,data:(s=d==null?void 0:d.data)!==null&&s!==void 0?s:{},create_user:(o=d==null?void 0:d.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},channel:(c=d==null?void 0:d.channel)!==null&&c!==void 0?c:"sms"}});return{data:{user:null,session:null,messageId:m==null?void 0:m.message_id},error:y}}throw new km("You must provide either an email or phone number.")}catch(h){if(Ae(h))return{data:{user:null,session:null},error:h};throw h}}async verifyOtp(e){var t,n;try{let s,o;"options"in e&&(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo,o=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:c,error:h}=await ke(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:o}}),redirectTo:s,xform:zr});if(h)throw h;if(!c)throw new Error("An error occurred on token verification.");const d=c.session,m=c.user;return d!=null&&d.access_token&&(await this._saveSession(d),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",d)),{data:{user:m,session:d},error:null}}catch(s){if(Ae(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(e){var t,n,s;try{let o=null,c=null;return this.flowType==="pkce"&&([o,c]=await Kl(this.storage,this.storageKey)),await ke(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=e==null?void 0:e.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:c}),headers:this.headers,xform:QB})}catch(o){if(Ae(o))return{data:null,error:o};throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:n}=e;if(n)throw n;if(!t)throw new Fr;const{error:s}=await ke(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(Ae(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:n,type:s,options:o}=e,{error:c}=await ke(this.fetch,"POST",t,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},redirectTo:o==null?void 0:o.emailRedirectTo});return{data:{user:null,session:null},error:c}}else if("phone"in e){const{phone:n,type:s,options:o}=e,{data:c,error:h}=await ke(this.fetch,"POST",t,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:h}}throw new km("You must provide either an email or phone number and a type")}catch(t){if(Ae(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=t();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await lo(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<$_:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.userStorage){const c=await lo(this.userStorage,this.storageKey+"-user");c!=null&&c.user?e.user=c.user:e.user=K_()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const c={value:this.suppressGetSessionWarning};e.user=HB(e.user,c),c.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:s,error:o}=await this._callRefreshToken(e.refresh_token);return o?{data:{session:null},error:o}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await ke(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:ea}):await this._useSession(async t=>{var n,s,o;const{data:c,error:h}=t;if(h)throw h;return!(!((n=c.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Fr}:await ke(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(s=c.session)===null||s===void 0?void 0:s.access_token)!==null&&o!==void 0?o:void 0,xform:ea})})}catch(t){if(Ae(t))return TB(t)&&(await this._removeSession(),await Xs(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async n=>{const{data:s,error:o}=n;if(o)throw o;if(!s.session)throw new Fr;const c=s.session;let h=null,d=null;this.flowType==="pkce"&&e.email!=null&&([h,d]=await Kl(this.storage,this.storageKey));const{data:m,error:y}=await ke(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:h,code_challenge_method:d}),jwt:c.access_token,xform:ea});if(y)throw y;return c.user=m.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),{data:{user:c.user},error:null}})}catch(n){if(Ae(n))return{data:{user:null},error:n};throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Fr;const t=Date.now()/1e3;let n=t,s=!0,o=null;const{payload:c}=G_(e.access_token);if(c.exp&&(n=c.exp,s=n<=t),s){const{data:h,error:d}=await this._callRefreshToken(e.refresh_token);if(d)return{data:{user:null,session:null},error:d};if(!h)return{data:{user:null,session:null},error:null};o=h}else{const{data:h,error:d}=await this._getUser(e.access_token);if(d)throw d;o={access_token:e.access_token,refresh_token:e.refresh_token,user:h.user,token_type:"bearer",expires_in:n-t,expires_at:n},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return{data:{user:o.user,session:o},error:null}}catch(t){if(Ae(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var n;if(!e){const{data:c,error:h}=t;if(h)throw h;e=(n=c.session)!==null&&n!==void 0?n:void 0}if(!(e!=null&&e.refresh_token))throw new Fr;const{data:s,error:o}=await this._callRefreshToken(e.refresh_token);return o?{data:{user:null,session:null},error:o}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(Ae(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!On())throw new Nm("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Nm(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new ZI("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Nm("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new ZI("No code detected.");const{data:J,error:K}=await this._exchangeCodeForSession(e.code);if(K)throw K;const se=new URL(window.location.href);return se.searchParams.delete("code"),window.history.replaceState(window.history.state,"",se.toString()),{data:{session:J.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:o,refresh_token:c,expires_in:h,expires_at:d,token_type:m}=e;if(!o||!h||!c||!m)throw new Nm("No session defined in URL");const y=Math.round(Date.now()/1e3),_=parseInt(h);let E=y+_;d&&(E=parseInt(d));const S=E-y;S*1e3<=nc&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${S}s, should have been closer to ${_}s`);const C=E-_;y-C>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",C,E,y):y-C<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",C,E,y);const{data:k,error:N}=await this._getUser(o);if(N)throw N;const G={provider_token:n,provider_refresh_token:s,access_token:o,expires_in:_,expires_at:E,refresh_token:c,token_type:m,user:k.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:G,redirectType:e.type},error:null}}catch(n){if(Ae(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await lo(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var n;const{data:s,error:o}=t;if(o)return{error:o};const c=(n=s.session)===null||n===void 0?void 0:n.access_token;if(c){const{error:h}=await this.admin.signOut(c,e);if(h&&!(EB(h)&&(h.status===404||h.status===401||h.status===403)))return{error:h}}return e!=="others"&&(await this._removeSession(),await Xs(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=NB(),n={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async t=>{var n,s;try{const{data:{session:o},error:c}=t;if(c)throw c;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",o)),this._debug("INITIAL_SESSION","callback id",e,"session",o)}catch(o){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",o),console.error(o)}})}async resetPasswordForEmail(e,t={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await Kl(this.storage,this.storageKey,!0));try{return await ke(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(o){if(Ae(o))return{data:null,error:o};throw o}}async getUserIdentities(){var e;try{const{data:t,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(Ae(t))return{data:null,error:t};throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:n,error:s}=await this._useSession(async o=>{var c,h,d,m,y;const{data:_,error:E}=o;if(E)throw E;const S=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(c=e.options)===null||c===void 0?void 0:c.redirectTo,scopes:(h=e.options)===null||h===void 0?void 0:h.scopes,queryParams:(d=e.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:!0});return await ke(this.fetch,"GET",S,{headers:this.headers,jwt:(y=(m=_.session)===null||m===void 0?void 0:m.access_token)!==null&&y!==void 0?y:void 0})});if(s)throw s;return On()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:e.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(Ae(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var n;try{const{error:s,data:{session:o}}=t;if(s)throw s;const{options:c,provider:h,token:d,access_token:m,nonce:y}=e,_=await ke(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=o==null?void 0:o.access_token)!==null&&n!==void 0?n:void 0,body:{provider:h,id_token:d,access_token:m,nonce:y,link_identity:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:zr}),{data:E,error:S}=_;return S?{data:{user:null,session:null},error:S}:!E||!E.session||!E.user?{data:{user:null,session:null},error:new Gl}:(E.session&&(await this._saveSession(E.session),await this._notifyAllSubscribers("USER_UPDATED",E.session)),{data:E,error:S})}catch(s){if(Ae(s))return{data:{user:null,session:null},error:s};throw s}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var n,s;const{data:o,error:c}=t;if(c)throw c;return await ke(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(n=o.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(t){if(Ae(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const n=Date.now();return await VB(async s=>(s>0&&await DB(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await ke(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:zr})),(s,o)=>{const c=200*Math.pow(2,s);return o&&H_(o)&&Date.now()+c-n<nc})}catch(n){if(this._debug(t,"error",n),Ae(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",n),On()&&!t.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,t;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const s=await lo(this.storage,this.storageKey);if(s&&this.userStorage){let c=await lo(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!c&&(c={user:s.user},await rc(this.userStorage,this.storageKey+"-user",c)),s.user=(e=c==null?void 0:c.user)!==null&&e!==void 0?e:K_()}else if(s&&!s.user&&!s.user){const c=await lo(this.storage,this.storageKey+"-user");c&&(c!=null&&c.user)?(s.user=c.user,await Xs(this.storage,this.storageKey+"-user"),await rc(this.storage,this.storageKey,s)):s.user=K_()}if(this._debug(n,"session from storage",s),!this._isValidSession(s)){this._debug(n,"session is not valid"),s!==null&&await this._removeSession();return}const o=((t=s.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<$_;if(this._debug(n,`session has${o?"":" not"} expired with margin of ${$_}s`),o){if(this.autoRefreshToken&&s.refresh_token){const{error:c}=await this._callRefreshToken(s.refresh_token);c&&(console.error(c),H_(c)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:c,error:h}=await this._getUser(s.access_token);!h&&(c!=null&&c.user)?(s.user=c.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(c){console.error("Error getting user data:",c),this._debug(n,"error getting user data, skipping SIGNED_IN notification",c)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(n,"error",s),console.error(s);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var t,n;if(!e)throw new Fr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new fp;const{data:o,error:c}=await this._refreshAccessToken(e);if(c)throw c;if(!o.session)throw new Fr;await this._saveSession(o.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);const h={data:o.session,error:null};return this.refreshingDeferred.resolve(h),h}catch(o){if(this._debug(s,"error",o),Ae(o)){const c={data:null,error:o};return H_(o)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(c),c}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(o),o}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,n=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:t});const o=[],c=Array.from(this.stateChangeEmitters.values()).map(async h=>{try{await h.callback(e,t)}catch(d){o.push(d)}});if(await Promise.all(c),o.length>0){for(let h=0;h<o.length;h+=1)console.error(o[h]);throw o[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),n=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&t.user&&await rc(this.userStorage,this.storageKey+"-user",{user:t.user});const s=Object.assign({},t);delete s.user;const o=ix(s);await rc(this.storage,this.storageKey,o)}else{const s=ix(t);await rc(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await Xs(this.storage,this.storageKey),await Xs(this.storage,this.storageKey+"-code-verifier"),await Xs(this.storage,this.storageKey+"-user"),this.userStorage&&await Xs(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&On()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),nc);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:n}}=t;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-e)/nc);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${nc}ms, refresh threshold is ${Wv} ticks`),s<=Wv&&await this._callRefreshToken(n.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof bN)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!On()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,n){const s=[`provider=${encodeURIComponent(t)}`];if(n!=null&&n.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[o,c]=await Kl(this.storage,this.storageKey),h=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(c)}`});s.push(h.toString())}if(n!=null&&n.queryParams){const o=new URLSearchParams(n.queryParams);s.push(o.toString())}return n!=null&&n.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var n;const{data:s,error:o}=t;return o?{data:null,error:o}:await ke(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(Ae(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var n,s;const{data:o,error:c}=t;if(c)return{data:null,error:c};const h=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:d,error:m}=await ke(this.fetch,"POST",`${this.url}/factors`,{body:h,headers:this.headers,jwt:(n=o==null?void 0:o.session)===null||n===void 0?void 0:n.access_token});return m?{data:null,error:m}:(e.factorType==="totp"&&d.type==="totp"&&(!((s=d==null?void 0:d.totp)===null||s===void 0)&&s.qr_code)&&(d.totp.qr_code=`data:image/svg+xml;utf-8,${d.totp.qr_code}`),{data:d,error:null})})}catch(t){if(Ae(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:s,error:o}=t;if(o)return{data:null,error:o};const c=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?hF(e.webauthn.credential_response):dF(e.webauthn.credential_response)})}:{code:e.code}),{data:h,error:d}=await ke(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:c,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return d?{data:null,error:d}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+h.expires_in},h)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",h),{data:h,error:d})})}catch(t){if(Ae(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:s,error:o}=t;if(o)return{data:null,error:o};const c=await ke(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});if(c.error)return c;const{data:h}=c;if(h.type!=="webauthn")return{data:h,error:null};switch(h.webauthn.type){case"create":return{data:Object.assign(Object.assign({},h),{webauthn:Object.assign(Object.assign({},h.webauthn),{credential_options:Object.assign(Object.assign({},h.webauthn.credential_options),{publicKey:cF(h.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},h),{webauthn:Object.assign(Object.assign({},h.webauthn),{credential_options:Object.assign(Object.assign({},h.webauthn.credential_options),{publicKey:uF(h.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(Ae(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:n}=await this.getUser();if(n)return{data:null,error:n};const s={all:[],phone:[],totp:[],webauthn:[]};for(const o of(e=t==null?void 0:t.factors)!==null&&e!==void 0?e:[])s.all.push(o),o.status==="verified"&&s[o.factor_type].push(o);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(){var e,t;const{data:{session:n},error:s}=await this.getSession();if(s)return{data:null,error:s};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=G_(n.access_token);let c=null;o.aal&&(c=o.aal);let h=c;((t=(e=n.user.factors)===null||e===void 0?void 0:e.filter(y=>y.status==="verified"))!==null&&t!==void 0?t:[]).length>0&&(h="aal2");const m=o.amr||[];return{data:{currentLevel:c,nextLevel:h,currentAuthenticationMethods:m},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:n},error:s}=t;return s?{data:null,error:s}:n?await ke(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:n.access_token,xform:o=>({data:o,error:null})}):{data:null,error:new Fr}})}catch(t){if(Ae(t))return{data:null,error:t};throw t}}async _approveAuthorization(e,t){try{return await this._useSession(async n=>{const{data:{session:s},error:o}=n;if(o)return{data:null,error:o};if(!s)return{data:null,error:new Fr};const c=await ke(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"approve"},xform:h=>({data:h,error:null})});return c.data&&c.data.redirect_url&&On()&&!(t!=null&&t.skipBrowserRedirect)&&window.location.assign(c.data.redirect_url),c})}catch(n){if(Ae(n))return{data:null,error:n};throw n}}async _denyAuthorization(e,t){try{return await this._useSession(async n=>{const{data:{session:s},error:o}=n;if(o)return{data:null,error:o};if(!s)return{data:null,error:new Fr};const c=await ke(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"deny"},xform:h=>({data:h,error:null})});return c.data&&c.data.redirect_url&&On()&&!(t!=null&&t.skipBrowserRedirect)&&window.location.assign(c.data.redirect_url),c})}catch(n){if(Ae(n))return{data:null,error:n};throw n}}async fetchJwk(e,t={keys:[]}){let n=t.keys.find(h=>h.kid===e);if(n)return n;const s=Date.now();if(n=this.jwks.keys.find(h=>h.kid===e),n&&this.jwks_cached_at+wB>s)return n;const{data:o,error:c}=await ke(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;return!o.keys||o.keys.length===0||(this.jwks=o,this.jwks_cached_at=s,n=o.keys.find(h=>h.kid===e),!n)?null:n}async getClaims(e,t={}){try{let n=e;if(!n){const{data:S,error:C}=await this.getSession();if(C||!S.session)return{data:null,error:C};n=S.session.access_token}const{header:s,payload:o,signature:c,raw:{header:h,payload:d}}=G_(n);t!=null&&t.allowExpired||zB(o.exp);const m=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,t!=null&&t.keys?{keys:t.keys}:t==null?void 0:t.jwks);if(!m){const{error:S}=await this.getUser(n);if(S)throw S;return{data:{claims:o,header:s,signature:c},error:null}}const y=qB(s.alg),_=await crypto.subtle.importKey("jwk",m,y,!0,["verify"]);if(!await crypto.subtle.verify(y,_,c,CB(`${h}.${d}`)))throw new Jv("Invalid JWT signature");return{data:{claims:o,header:s,signature:c},error:null}}catch(n){if(Ae(n))return{data:null,error:n};throw n}}}dd.nextInstanceID=0;const bF=dd;class EF extends bF{constructor(e){super(e)}}class TF{constructor(e,t,n){var s,o,c;this.supabaseUrl=e,this.supabaseKey=t;const h=gB(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",h),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",h),this.storageUrl=new URL("storage/v1",h),this.functionsUrl=new URL("functions/v1",h);const d=`sb-${h.hostname.split(".")[0]}-auth-token`,m={db:oB,realtime:cB,auth:Object.assign(Object.assign({},lB),{storageKey:d}),global:aB},y=mB(n??{},m);this.storageKey=(s=y.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(o=y.global.headers)!==null&&o!==void 0?o:{},y.accessToken?(this.accessToken=y.accessToken,this.auth=new Proxy({},{get:(_,E)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(E)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((c=y.auth)!==null&&c!==void 0?c:{},this.headers,y.global.fetch),this.fetch=dB(t,this._getAccessToken.bind(this),y.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},y.realtime)),this.rest=new p5(new URL("rest/v1",h).href,{headers:this.headers,schema:y.db.schema,fetch:this.fetch}),this.storage=new rB(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),y.accessToken||this._listenForAuthEvents()}get functions(){return new o5(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,n)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,t;if(this.accessToken)return await this.accessToken();const{data:n}=await this.auth.getSession();return(t=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:s,userStorage:o,storageKey:c,flowType:h,lock:d,debug:m},y,_){const E={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new EF({url:this.authUrl.href,headers:Object.assign(Object.assign({},E),y),storageKey:c,autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:s,userStorage:o,flowType:h,lock:d,debug:m,fetch:_,hasCustomAuthorizationHeader:Object.keys(this.headers).some(S=>S.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new P5(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,n)=>{this._handleTokenChanged(t,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(e,t,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const SF=(r,e,t)=>new TF(r,e,t);function AF(){if(typeof window<"u"||typeof process>"u")return!1;const r=process.version;if(r==null)return!1;const e=r.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}AF()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const IF={VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imt4ZnN4cW95aG9rbHFnd3Z6aHBkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE4ODcxNjcsImV4cCI6MjA3NzQ2MzE2N30.mW3MNPAlWXFvAgu1RL4BW_1OWVjCzJat5OddK4GgW64",VITE_SUPABASE_URL:"https://kxfsxqoyhoklqgwvzhpd.supabase.co"},SN=IF??{},AN=SN.VITE_SUPABASE_URL,IN=SN.VITE_SUPABASE_ANON_KEY;if(!AN||!IN)throw new Error("Supabase config not found. Make sure you have a .env.local file with VITE_SUPABASE_URL and VITE_SUPABASE_ANON_KEY variables.");const Xv=SF(AN,IN),Zv="profile-pictures",hx=async(r,e)=>{const{error:t}=await Xv.storage.from(Zv).upload(e,r);if(t)throw console.error("Error uploading image to Supabase:",t),t;const{data:n}=Xv.storage.from(Zv).getPublicUrl(e);if(!n.publicUrl)throw new Error("Could not get public URL for uploaded image.");return n.publicUrl},Q_=async r=>{if(!r)return;const{error:e}=await Xv.storage.from(Zv).remove([r]);if(e&&e.message!=="The resource was not found")throw console.error("Error deleting image from Supabase:",e),e;e&&e.message==="The resource was not found"&&console.warn("Image to delete not found in Supabase, skipping:",r)},xF=r=>{const[e,t]=fe.useState([]),[n,s]=fe.useState(!0);fe.useEffect(()=>{const _=k3(E=>{t(E),s(!1)});return()=>_()},[]);const o=async(_,E)=>{try{let S,C;if(E){const k=await imageCompression(E,{maxSizeMB:1,maxWidthOrHeight:1024});C=`profilePictures/${Date.now()}_${k.name}`,S=await hx(k,C)}await xk({..._,imageUrl:S,imagePath:C}),r("Student added successfully!","success")}catch(S){console.error("Error adding student:",S),r("Failed to add student.","error")}},c=async(_,E)=>{try{let S={..._};if(delete S.id,E){_.imagePath&&await Q_(_.imagePath);const C=await imageCompression(E,{maxSizeMB:1,maxWidthOrHeight:1024}),k=`profilePictures/${Date.now()}_${C.name}`,N=await hx(C,k);S.imageUrl=N,S.imagePath=k}await L_(_.id,S),r("Student profile updated.","success")}catch(S){console.error("Error updating student:",S),r("Failed to update student profile.","error")}},h=async _=>{try{_.imagePath&&await Q_(_.imagePath),await P3(_.id),r("Student deleted successfully.","success")}catch(E){console.error("Error deleting student:",E),r("Failed to delete student.","error")}},d=async _=>{if(_.length===0)return;const E=e.filter(C=>_.includes(C.id)),S=xr.firestore();try{const C=E.map(N=>N.imagePath).filter(N=>!!N).map(N=>Q_(N));await Promise.all(C);const k=S.batch();_.forEach(N=>{const G=S.collection("students").doc(N);k.delete(G)}),await k.commit(),r(`${_.length} student(s) deleted successfully.`,"success")}catch(C){console.error("Error deleting selected students:",C),r("Failed to delete selected students.","error")}},m=async(_,E)=>{try{const C=(_.payments||[]).reduce((k,N)=>k+N.amount,0)+E.amount>=_["Total Fees"];await L_(_.id,{payments:xr.firestore.FieldValue.arrayUnion(E),"Full Paid":C}),await M3({...E,studentId:_.id,studentName:_.Name,studentRollNo:_["Roll No"]}),r("Payment recorded successfully.","success")}catch(S){console.error("Failed to save payment:",S),r("Failed to record payment.","error")}},y=fe.useCallback(async(_,E)=>{const S=_.map(C=>L_(C,{Batch:E}));await Promise.all(S)},[]);return{students:e,loading:n,addStudentWithImage:o,updateStudentWithImage:c,deleteStudentAndImage:h,deleteSelectedStudents:d,recordPayment:m,updateStudentBatch:y}},RF=(r,e)=>{const[t,n]=fe.useState([]),[s,o]=fe.useState(!0);return fe.useEffect(()=>{const _=N3(E=>{n(E),o(!1)});return()=>_()},[]),{batches:t,loading:s,createBatch:async(_,E)=>{try{await D3({name:_,studentIds:E,wardens:[]}),await e(E,_),r(`Batch "${_}" created.`,"success")}catch(S){console.error("Failed to create batch:",S),r("Failed to create batch.","error")}},deleteBatch:async _=>{const E=t.find(S=>S.id===_);if(E)try{await V3(E),r(`Batch "${E.name}" and its students have been deleted.`,"success")}catch(S){console.error("Failed to delete batch:",S),r("Failed to delete batch.","error")}},addWarden:async(_,E)=>{const S=t.find(C=>C.id===_);if(S){const C={wardenStudentId:E,assignedStudentIds:[]},k=[...S.wardens,C];await U_(_,{wardens:k}),r("Warden added successfully.","success")}},removeWarden:async(_,E)=>{const S=t.find(C=>C.id===_);if(S){const C=S.wardens.filter(k=>k.wardenStudentId!==E);await U_(_,{wardens:C}),r("Warden removed.","success")}},assignStudentsToWarden:async(_,E,S)=>{const C=t.find(k=>k.id===_);if(C){const k=C.wardens.map(N=>N.wardenStudentId===E?{...N,assignedStudentIds:S}:N);await U_(_,{wardens:k}),r("Student assignments updated.","success")}}}},CF=r=>{const[e,t]=fe.useState([]),[n,s]=fe.useState(!0);return fe.useEffect(()=>{const o=O3(c=>{t(c),s(!1)});return()=>o()},[]),{transactions:e,loading:n}},kF=({user:r,theme:e,toggleTheme:t})=>{const[n,s]=fe.useState(Gn.Dashboard),[o,c]=fe.useState(null),h=(Ne,Le="success")=>{c({id:Date.now(),message:Ne,type:Le})},{students:d,loading:m,addStudentWithImage:y,updateStudentWithImage:_,deleteStudentAndImage:E,deleteSelectedStudents:S,recordPayment:C,updateStudentBatch:k}=xF(h),{batches:N,loading:G,createBatch:J,deleteBatch:K,addWarden:se,removeWarden:ye,assignStudentsToWarden:he}=RF(h,k),{transactions:R,loading:x}=CF(),O=m||G||x,[L,M]=fe.useState(!1),[U,P]=fe.useState(!1),[et,We]=fe.useState(!1),[ee,ue]=fe.useState(null),[oe,Z]=fe.useState(null),[ve,V]=fe.useState(null),W=Ne=>{ue(Ne),We(!0)},de=async(Ne,Le)=>{await _(Ne,Le),We(!1),ue(null)},ce=async()=>{oe&&(await E(oe),Z(null))},Ie=()=>{if(O)return w.jsx("div",{className:"flex justify-center items-center h-full",children:w.jsx(Ck,{})});switch(n){case Gn.Students:return w.jsx(z3,{students:d,onEditStudent:W,onDeleteStudent:Z,onDeleteSelected:S,onCreateBatch:J,onRecordPayment:V});case Gn.Batches:return w.jsx(J3,{batches:N,students:d,onDeleteBatch:K,onAddWarden:se,onRemoveWarden:ye,onAssignStudents:he});case Gn.Payments:return w.jsx(X3,{transactions:R});case Gn.Dashboard:default:return w.jsx(Y3,{students:d,batches:N,transactions:R})}};return w.jsxs("div",{className:"flex h-screen bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-200",children:[w.jsx(L3,{currentView:n,setView:s}),w.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[w.jsx(U3,{user:r,onAddStudent:()=>M(!0),onBulkUpload:()=>P(!0),theme:e,toggleTheme:t}),w.jsx("main",{className:"flex-1 overflow-x-hidden overflow-y-auto bg-gray-100 dark:bg-gray-900 p-6",children:Ie()})]}),o&&w.jsx(Z3,{message:o.message,type:o.type,onClose:()=>c(null)},o.id),L&&w.jsx(q3,{isOpen:L,onClose:()=>M(!1),onSubmit:y,student:null}),et&&ee&&w.jsx($3,{student:ee,onClose:()=>We(!1),onSave:de}),U&&w.jsx(H3,{isOpen:U,onClose:()=>P(!1),onUploadComplete:()=>{}}),oe&&w.jsx(Rk,{isOpen:!!oe,onClose:()=>Z(null),onConfirm:ce,title:"Delete Student",message:`Are you sure you want to delete ${oe.Name}? This action cannot be undone.`}),ve&&w.jsx(G3,{student:ve,onClose:()=>V(null),onSave:C})]})},NF=()=>{const[r,e]=fe.useState(null),[t,n]=fe.useState(!0),[s,o]=fe.useState(()=>{const h=localStorage.getItem("theme"),d=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;return h||(d?"dark":"light")});fe.useEffect(()=>{const h=window.document.documentElement;s==="dark"?h.classList.add("dark"):h.classList.remove("dark"),localStorage.setItem("theme",s)},[s]),fe.useEffect(()=>{const h=vg.onAuthStateChanged(d=>{e(d),n(!1)});return()=>h()},[]);const c=()=>{o(h=>h==="light"?"dark":"light")};return t?w.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100 dark:bg-gray-900",children:w.jsx(Ck,{})}):r?w.jsx(kF,{user:r,theme:s,toggleTheme:c}):w.jsx(j3,{})},xN=document.getElementById("root");if(!xN)throw new Error("Could not find root element to mount to");const OF=gP.createRoot(xN);OF.render(w.jsx(fx.StrictMode,{children:w.jsx(NF,{})}));
